---

title: Network-based system for rerouting phone calls from phone networks to VoIP clients for roamers and subscribers who do not answer
abstract: A system, method, computer product and service are provided which, when a subscriber's VoIP client is online and the subscriber's non-VoIP wireless or fixed line number is called, will automatically route the call over IP to the subscriber's VoIP client. This routing may be performed by the subscriber's wireless or fixed line home operator and can be conditioned to depend on whether the non-VoIP number is roaming or not answering.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08478277&OS=08478277&RS=08478277
owner: Roamware Inc.
number: 08478277
owner_city: San Jose
owner_country: US
publication_date: 20061103
---
This application claims priority to U.S. Provisional Patent Application No. 60 733 439 filed Nov. 3 2005 entitled Integrating Cellular VoIP Client with Cellular or Fixed Line Phone Services for Automatic Call Rerouting to Roamers or Subscribers Away From Phones and also is a continuation in part of U.S. patent application Ser. No. 11 064 200 filed on Feb. 23 2005 now U.S. Pat. No. 7 379 436 entitled Integrated Cellular VoIP for Call Rerouting hereinafter VoIP Call Rerouting Patent Application which claims priority from U.S. Provisional Patent Application No. 60 547 389 filed Feb. 23 2004 and is also a continuation in part of U.S. patent application Ser. No. 10 778 970 filed Feb. 13 2004 entitled Integrating GSM and WiFi Services in Mobile Communications Devices which claims priority from U.S. Provisional Patent Application No. 60 448 000 filed Feb. 18 2003 and also is a continuation in part of U.S. patent application Ser. No. 11 503 301 filed Aug. 14 2006 now U.S. Pat. No. 7 512 098 entitled Method and System for Wireless Voice Channel Data Channel Integration which claims priority from U.S. patent application Ser. No. 09 932 439 filed Aug. 15 2001 now U.S. Pat. No. 7 092 370 the 370 patent bearing the same title issued Aug. 15 2006 the 370 patent also claiming priority to U.S. Provisional Patent Application No. 60 226 255 filed Aug. 17 2000. The entirety of each of the foregoing is incorporated by reference herein.

The present invention generally relates to roaming users in mobile networks. More specifically the invention relates to steering the traffic of the roaming users in VoIP clients.

VoIP Voice Over Internet Protocol services use Internet Protocol to carry voice and related content and beside other advantages offer better rates than traditional switched circuit voice services so called Plain Old Telephone Service or POTS and can also provide better and more efficient integration of other data services as well such as multimedia context and video.

The advent and widespread use of the VoIP client Skype on personal computers has increased the popularity of VoIP services. In addition to built in presence management and instant messaging Skype also provides Skype out for calling out to and Skype in for receiving calls from fixed or mobile phone lines. Other providers such as MSN Yahoo and Google have also added VoIP service to their instant messaging clients.

Cellular IP phones such as a window enabled mobile GSM WiFi phone configured with a Skype client allow the IP phone user to enjoy the same free VoIP service as a personal computer Skype user. This however requires a special WiFi phone or a dual system phone with a Skype client installed.

Skype has also enhanced its VoIP client and service to enable a user to receive calls to his Skype ID or Skype IN number on an ordinary mobile or on a fixed line phone via call forwarding. Additionally ISkoot a Skype add on service allows a user to make outbound Skype calls to either a phone number or another Skype ID with ordinary mobile phones by using SMS to send call out information to the ISkoot service. Thus a two way call out bridge connecting the caller s mobile phone and his called party is established. The bridge may use Skype Out to call both the called party and the caller s mobile number. Skype also provides a plug in API Applications Programming Interface used to develop presence information applications at network servers in a scalable manner as well as server side APIs to support simultaneous VoIP calls.

However whether a GSM WiFi or WiMax or VoIP mobile phone is used or an ordinary phone is used these services fail to address the case in which a mobile user is roaming when called on his ordinary mobile phone number. For example in the case of GSM WiFi phone even though the phone can make an inexpensive outbound Skype call when it is on a WiFi connection it cannot seamlessly receive a call over VoIP when called on the WiFi phone s mobile number. Another unaddressed case is when an ordinary cell phone is called on its mobile number while roaming the call cannot be received via Skype on the user s laptop even if the user is connected online to an IP connection and the mobile is out of its coverage area. Normally a mobile subscriber roaming internationally might prefer to receive calls over Skype or his VoIP account either to save money on roaming charges for improved quality or in order to benefit from the additional presence or other services associated with their chosen VoIP method.

Yet another missing case is an enhanced Skype call in service to forward a call to an SMS alert or for a mobile phone to use SMS to set up a bridged VoIP call via a VoIP to POTS service such as Skype Out. That type of call setup would assist an international roamer to carry on the desired phone call without needing to pay his home mobile carrier lofty international roaming charges.

The co pending VoIP Call Rerouting Patent Application describes a service that allows automatic rerouting of a call to a mobile or fixed line subscriber over an IP network to the subscriber s phone. That VoIP Call Rerouting Patent Application teaches a way for a special cellular VoIP integrated handset to detect a broadband IP connection enabling the client to automatically set call forwarding to the VoIP number that corresponds to the current IP address. A similar concept also applies to any ordinary mobile phone so that as soon as a mobile goes on roaming a user may receive calls on a VoIP phone number corresponding to the user s location via IP.

That co pending VoIP Call Rerouting Patent Application also describes a service that allows a mobile or fixed line subscriber to receive a call automatically rerouted over an IP network at the subscriber mobile. This application also teaches how an ordinary phone can accomplish this rerouting to a VoIP mobile phone and how VPMN HPMN or IP service providers can enable this service based on various business models.

In accordance with the foregoing there is a need in the art for a system method computer product and service which will automatically route a call to the subscriber s non VoIP wireless or fixed line number over IP to the subscriber s VoIP client when a subscriber s VoIP client is online. The subscriber s wireless or fixed line carrier or home wireless network operator may perform the routing operation and can condition the routing to depend on whether the non VoIP number is roaming or not answering.

The present invention is directed to a service that will automatically route a call to the subscriber s non VoIP wireless or fixed line number over IP to the subscriber s VoIP client when a subscriber s VoIP client is online. The subscriber s wireless or fixed line home operator may perform the routing and system can route to different destinations based on conditions such as whether the non VoIP number is roaming or whether it is not answering.

An aspect of the present invention comprises a system for routing a subscriber s calls associated with a first communication network including a home network or a visited network by means of a gateway coupled to that first communications network. That gateway monitors roaming links of the first communication network and detects the subscriber registering with the visited network and which receives location information corresponding to the location of the subscriber and selects a routing identifier associated with at least one client coupled to the gateway via a second communication network. The routing identifier is associated with the client and the gateway transfers the traffic of the subscriber to the client at the associated routing identifier using the first or second communication network. The gateway further includes a mechanism to determine status of the client or the subscriber.

Another aspect of the present invention provides a system including a gateway coupled to a first communication system and a client application coupled to a client which detects a coupling with a second communication system and transfers at least one message to the gateway via the coupling. The message may include identification information of the client or instructions and status information. The gateway establishes an association between a subscriber and a routing identifier associated with the client on the second communication system and determines routing to the client via the second communication system that corresponds to the routing identifier of the client. The gateway transfers the traffic received at the first communication system to the client as a VoIP call via the second communication system using the routing and the status information.

Yet another aspect of the present invention presents a method for routing subscriber traffic that includes detecting the status or presence of the subscriber in a visited network. The method includes detecting a subscriber registration to a visited network the subscriber being initially registered to a home network the home network and the visited network being a part of a first communication network receiving location information corresponding to a location of the subscriber detecting at a gateway status of at least one client associated with the subscriber the client being coupled to the gateway via a second communication network the gateway coupled to the first communication network selecting a routing identifier associated with the client the routing identifier corresponding to the location of the subscriber and transferring traffic of the subscriber to the client at the associated routing identifier using at least one of the first communication network and the second communication network wherein the transfer of traffic is performed based on the detected status of the client.

Another aspect of the present invention provides a computer program product including computer usable program code for routing subscriber traffic detecting a subscriber registration to a visited network in which the subscriber is initially registered to a home network and the home and visited networks being a part of a first communication network receiving subscriber location information detecting client status at a gateway the client being coupled to the gateway via a second communication network and the gateway being coupled to the first communication network selecting a routing identifier corresponding to the location of the subscriber associated with the client and transferring traffic of the subscriber to the client at the associated routing identifier using at least one of the first communication network and the second communication network in which the transfer of traffic is performed based on the detected status of the client.

In the following description for purposes of explanation specific numbers materials and configurations are set forth in order to provide a thorough understanding of the invention. It will be apparent however to one having ordinary skill in the art that the invention may be practiced without these specific details. In some instances well known features may be omitted or simplified so as not to obscure the present invention. Furthermore reference in the specification to one embodiment or an embodiment means that a particular feature structure or characteristic described in connection with the embodiment is included in at least one embodiment of the invention. The appearance of the phrase in an embodiment in various places in the specification does not necessarily refer to the same embodiment.

The first communications network or second communications network under the present invention can be WiMax. Many embodiments of the present invention are illustrated in this patent application using examples of subscribers using the present invention to integrate phone calls with VoIP and the Internet. In the current state of the art phone calls are often made using POTS or GSM or CDMA cellular networks. VoIP calls are often received over the Internet connected via Ethernet WiFi DSL cable modem connected by DOCSYS or other physical layers or even by dialup connections. Integrating presence and routing phone calls from one such network to any other such network are possible under the present invention. In addition in the state of the art so called WiMax networks are being established worldwide using public free spectrum or spectrum specially allocated and licensed by governments. WiMax is a very high bandwidth protocol for transmitting data by radio frequency carrier wave. It is ammenable to use for phone calls and video calls such as those known in todays POTS cellular and so called 3G networks. WiMax is also ammenable to use by personal computers laptops or smart devices for data or Internet connectivity in the same manner as WiFi connections are commonly used today. In the present invention phone calls to be rerouted may be placed in WiMax networks using WiMax enabled phone devices or alternatively phone calls from any source can be rerouted to VoIP clients or other second communications networks to which a subscriber connects by means of a WiMax transceiver.

In accordance with an embodiment of the invention subscriber uses a communication device such as but not limited to a mobile station a fixed line phone a Wi Fi enabled mobile phone a WiMax enabled mobile phone a personal computer connected to a widely accessible network such as the Internet a portable computing device connected to a widely accessible network such as the Internet a portable telephone a portable communication device a phone adaptor or a personal digital assistant connected to a communications network.

HPMN includes a GMSC Gateway Mobile Switching Center and an HLR Home Location Register which receives subscriber s location information when it is roaming in VPMN from a VLR VMSC Visited Location Register Visited Mobile Switching Center connected to the HLR such as by a SS7 link . There may be a case when subscriber is not in the coverage of either HPMN or VPMN . For example the subscriber may have his mobile phone switched off or may not be picking up the calls. In such cases a gateway is able to route any calls intended to subscriber originally intended for mobile termination instead to a client associated with subscriber via second communication network . Client preferably couples to gateway via second communication network . In accordance with an embodiment of the invention the gateway can be any sort of gateway for person to person communications including but not limited to a VoIP gateway a Skype gateway a Vonage like gateway a SIP IMS gateway or an IM VoIP gateway or any other type of VoIP SIP or instant messaging type gateway. Client is a VoIP client such as but not limited to Skype Yahoo Google GizmoProject MSN Vonage or any SIP VoIP or messaging client. Client may be a VoIP based application installed on a PC a laptop or a smart device associated with subscriber . The client installed on any one of the devices listed above hereinafter interchangeably refers to as client .

In one embodiment of the invention gateway couples to both HPMN and VPMN . Alternatively HPMN may deploy gateway or a third network that has access to HPMN may host gateway . If the third network hosts the gateway the gateway can support multiple home operators thereby making the implementation scalable. In another embodiment of the invention the visited network operator deploys ICV system and gateway couples to VPMN . Usually gateway has an SS7 interface to HLR of HPMN and hence is always online from HLR s perspective. When subscriber subscribes to the services provided by ICV system the client installed at subscriber s device is able mutually to accept VoIP client interface of gateway at HPMN as buddies. In other words this embodiment enables each client to indicate the presence of other VoIP clients as being available for communications to the extent that each VoIP client has designated the other as a buddy or as being permitted to indicate presence. Subscriber can turn on or turn off incoming calls on his mobile number via IP when connected by configuring client s presence indication to the home operator s VoIP client at gateway . for example visible invisible or block unblock or visible but not available or visible but do not disturb or invisible but available a designation meaning the client will be able to see which buddies are present but will not display its own presence to them  This client control of visibility to gateway is referred to herein as presence management of the client. The presence management of a VoIP client can be controlled via an API a client application built on the application programming interface of the VoIP client which may also provide a user interface to the VoIP client. For example the API of the VoIP client can switch the visibility status of its client towards the VoIP gateway.

In accordance with an embodiment of the invention the client application i.e. the API coupled to client detects a coupling of client with the second communication system and transfers one or more messages to the gateway via the coupling. The messages may include identification information of client and one or more instructions and status information pertaining to client . The message may contain in its header routing information from client to gateway . The status information is either blocking or unblocking information of client . The status information may also define the call forwarding status of client with the required call forwarding number. Gateway may receive these instructions including control instructions such as an Instant Message IM or an SMS.

In one embodiment of the invention gateway can support any number of types of VoIP clients to support different subscribers. Often ordinary users will subscribe to a number of different VoIP or messaging services. For example a person might generally use Skype to communicate with all other Skype subscribers but might also operate a SIP client for Vonage Softphone in order to make calls from his laptop using his home Vonage account. Or a person might both subscribe to AOL Instant Messenger for buddies in the U.S. but also Neophone to make calls in Europe. Or a person may have one set of friends that are buddies on MSN Messenger but another set of friends that use Google Talk. A gateway that supports multiple types of VoIP or messaging clients could enable a single subscriber to have phone calls forwarded to various VoIP clients based on configurable conditions.

In particular gateway supports different subscribers or phone numbers fixed or mobile with a single VoIP client or multiple VoIP clients. There could also be one physical gateway supporting multiple types of VoIP clients or one gateway for each type of VoIP client. For example there may be a Skype VoIP gateway for a Skype type client and a Yahoo VoIP gateway for a Yahoo type client. In another embodiment of the invention a subscriber may have multiple associated VoIP clients of different types. In such cases the subscriber may choose to have a client preferential order such that only the most preferred client available online with the VoIP gateway client is called. The preference can also be sequential whereby a caller may call the next preferred client only when the most preferred client is unavailable. In yet another embodiment of the invention the gateway couples to the HPMN to cater to multiple subscribers present in the home network.

Gateway monitors the SS7 link i.e. the roaming SCCP link exchanged between HPMN and VPMN thereby detecting registration of subscriber with VPMN . In one embodiment of the invention gateway uses a roamer probe database RPD to intercept the SS7 link . Gateway connects to the RPD using an IP protocol. RPD monitors messages including but not limited to MAP location update InsertSubscriberData ISD Cancel Location and PurgeMS messages at the roaming links of the operator i.e. HPMN . RPD stores the subscriber s current VLR VMSC SGSN locations IMSI MSISDN conditional forwarding information and other subscriber profile data. Further when HPMN receives a PurgeMS or a CancelLocation without a new location update the current roamer s RPD deletes the subscriber record. Gateway may access RPD to check if subscriber is roaming with VPMN . Thus gateway receives the location information corresponding to the location of subscriber from RPD . Hence gateway embodies a mechanism to determine the status of both subscriber and client . Gateway uses RPD to detect whether subscriber is in any operator s coverage in first communication network . Also the VoIP client of gateway at HPMN receives the client s status information via the second communication network .

Also gateway selects a routing identifier associated with client . The routing identifier is typically a number associated with the client. Examples of routing identifiers may include but are not limited to a Skype IN number a mobile number of the subscriber a fixed landline number associated with the subscriber a temporary assigned routing number corresponding to the location of the subscriber and a temporarily assigned late call forwarding number for the subscriber. Gateway selects the routing identifier based on the type of VoIP client is used. In addition the selection also depends on whether the subscriber is a wireless or a wireline subscriber. The VoIP client may or may not have a call in number associated with it. For example a VoIP client such as Skype has a Skype IN number associated with it. However a VoIP client like MSN does not have any associated call in number. Even in such a case it is possible to route the traffic call traffic etc. for the subscriber at a routing identifier associated with such client. The routing identifier in this case may be a temporary assigned routing number. In one embodiment of the invention the routing identifier may be corresponding to the location of the subscriber. In the case of a temporarily assigned number the HPMN operator may configure program the VoIP Gateway to support independent VoIP calls between the HPMN s VoIP Client and each subscriber s VoIP Client. Thereafter gateway transfers the traffic associated with the subscriber to client at the associated routing identifier using second communication network . The traffic associated with the subscriber may be call traffic or value added services traffic such as an SMS. In other words gateway may forward a subscriber s call text message or a text message indicating the call to the client. Gateway typically would transfer the traffic to the routing identifier using second communication network i.e. the IP based network. The case in which the IP network is down gateway routes the traffic using first communication network i.e. the cellular network. However in such cases gateway routes the call to the mobile number of the subscriber and not to the VoIP client of the subscriber.

The ICV system described herein integrates VoIP with SS7 signaling and in contrast to typical integrated communication systems allows roaming subscribers to receive telephone calls as VoIP calls at the routing numbers of the client associated with the subscriber. The ICV system also supports integrated cellular Wi Fi services for cellular telephones. The ICS system also supports multiple cellular technologies including GSM CDMA and TDMA to name a few.

SS7 signaling is a Common Channel Signaling CCS system defined by the International Telecommunications Union Telecommunication Standardization Sector ITU T . SS7 signaling is common in telecommunication networks and provides a suite of protocols which enables routing of circuit and non circuit related information within and between networks. The protocols of SS7 signaling include but are not limited to Message Transfer Part MTP Signaling Connection Control Part SCCP and Integrated Service Digital Network ISDN User Part ISUP .

This embodiment uses DP 12 terminating trigger to implement the conditional late call forwarding. At step subscriber B connects to the Internet or any other IP based network using Skype client . At step Skype client informs his online status to Skype gateway present in HPMN of subscriber B. Thereafter at step subscriber A calls subscriber B at his mobile number and the call reaches GMSC of B s network. At step GMSC requests B s routing information from HLR by sending a MAP SRI message in a GSM implementation to HLR . In case of a CDMA network implementation an IS 41 MAP Location Request message is used. Thereafter at step HLR returns the terminating trigger to GMSC . The terminating trigger may be a Camel T CSI in GSM implantation or a WIN in CDMA implementation. The terminating trigger used may also depend on specific switch vendors such as Siemens Nokia etc. GMSC downloads the terminating trigger only when the subscriber is roaming. At step GMSC issues a trigger request such as Initial DP in IN protocol to the Skype gateway which is equipped with support of IN protocols.

Thereafter at step Skype gateway issues a MAP ISD IMSI B message to VLR VMSC of subscriber B. The Skype gateway receives VLR VMSC information either from Initial DP or from RPD . The Skype gateway sends the MAP ISD message to remove set to empty the conditional forwarding information from the VLR VMSC. Next at step Skype gateway requests the monitoring of call events such as NO ANSWER and BUSY from GMSC and issues a CONTINUE message to GMSC . At step GMSC again requests HLR for the routing information of subscriber B. At step HLR returns the routing number i.e. the routing identifier such as MSRN in GSM implementation and TLDN in CDMA implementation. GMSC then continues the call setup using the routing number at step . If subscriber B does not respond to the call at the MSRN then at step GMSC sends an event report to Skype gateway . At step Skype gateway again requests for monitoring of call events such as NO ANSWER and BUSY from GMSC . Thereafter at step Skype gateway requests GMSC to connect subscriber B s Skype IN number. Hence at step GMSC initiates a call set up using subscriber A s number subscriber B s called number as the originally called number and the Skype IN number of subscriber B.

In case Skype client did not respond to the call at the Skype IN number at step GMSC is able to send an event report to Skype gateway . If subscriber B sets the Skype client with call forwarding such as to a Skype voicemail the call goes to the forwarded number. Thereafter at step Skype gateway gets the conditional forwarding number of subscriber B either from RPD or by issuing MAP Interrogate SS or messages like AnyTimeSubscriberProfile restoreData or SendParameters to HLR on the late call forwarding number corresponding to the late forwarding condition received. The late call forwarding number maybe a temporarily allocated number. At step Skype gateway requests GMSC to connect to the late call forwarding number of subscriber B. Hence at step Skype gateway re directs the call initially destined to mobile number of subscriber B to the late call forwarding number of subscriber B.

Next at step GMSC issues the DP2 or DP3 network trigger request on the DN e.g. InitialDP in IN protocol to Skype Gateway which is equipped with support for IN protocols. In this case the IDP parameters should contain the original called number of subscriber B. At step Skype gateway issues a MAP ISD IMSI B message to VLR VMSC of subscriber B. Skype gateway receives the information of VLR VMSC either from Initial DP or from RPD . Skype gateway sends the MAP ISD message to remove set to empty the conditional forwarding information from VLR VMSC . Then at step Skype gateway requests the monitoring of call events such as NO ANSWER and BUSY from GMSC . Thereafter at step Skype gateway issues a MAP PRN IMSI B message to VLR VMSC with the information received from RPD . At step VLR VMSC returns the routing number to Skype gateway . The routing number is the MSRN in GSM implementation while it is the TLDN in CDMA implementation. Upon receiving the routing number Skype gateway at step issues an IN protocol message CONNECT A MSRN to GMSC . At step GMSC continues the call setup towards the routing number. In case subscriber B did not respond to the call at the mobile number at step GMSC sends the event report to Skype gateway .

Thereafter at step Skype gateway again requests for monitoring of call events such as NO ANSWER and BUSY from GMSC . Thereafter at step Skype gateway requests GMSC to connect subscriber B s Skype IN number. Hence at step GMSC initiates a call set up using subscriber A s number subscriber B s called number as originally called number and the Skype IN number of subscriber B. The Skype client can answer the call when ringing.

In case Skype client did not respond to the call at the Skype IN number either at step GMSC sends the event report to Skype gateway . In case the subscriber B sets Skype client with call forwarding such as a Skype voicemail the call goes to the forwarded number. At step Skype gateway gets the conditional forwarding number of B either from RPD or by issuing MAP Interrogate SS or messages like AnyTimeSubscriberProfile restoreData or SendParameters to HLR on the late call forwarding number corresponding to the late forwarding condition received. At step Skype gateway requests GMSC to connect to the late call forwarding number of subscriber B. Hence at step the Skype gateway re directs the call initially destined to mobile number of subscriber B to the late call forwarding number of subscriber B.

In some of the above explanations accompanying the figures the VoIP clients may be busy not answering or not reachable. Hence it is desirable for the ICV system to have the ability to switch the calls from VoIP clients to mobile station and vice versa. The reason for switching from VoIP client to mobile may due to improvement in the voice quality during the middle of VoIP client call by switching the call to the mobile.

Thereafter at step Skype gateway requests monitoring of call events such as DISCONNECT Busy or No Answer from GMSC and issues a CONNECT Skype IN number . At step GMSC sets up the call from subscriber A to Skype IN number of subscriber B. At step Skype client answers the call at Skype IN number. Thereafter at step Skype client sends an Instant Message IM to Skype gateway requesting to switch the ongoing call to subscriber B s mobile number. At step Skype gateway grants switching and asks Skype client to disconnect the call. Hence at step Skype client disconnects the call. GMSC at step issues the event report of DISCONNECT to Skype gateway . Further at step Skype gateway issues the PRN IMSI B to VLR VMSC . Skype gateway receives the information of VLR VMSC either from Initial DP or from RPD . At step VLR returns the routing number i.e. the routing identifier such as MSRN in GSM implementation and TLDN in CDMA implementation. Skype gateway issues a Connect to routing number to GMSC step . Finally at step subscriber B answers the voice call from A at his mobile number.

There may also be a requirement of switching an ongoing call and not just a no responding call from a mobile number to the VoIP client. The reason for this would be the higher cost of a call to the mobile in comparison to the call at the VoIP client when it is online. represents a flow diagram for switching of traffic from first communication network to second communication network in accordance with another embodiment of the invention. This embodiment uses DP 2 or DP 3 trigger to implement the switching of traffic. At step subscriber B connects to the Internet or any other IP based network using Skype client . At step Skype client informs his online status to Skype gateway present in HPMN of subscriber B. At step Skype gateway checks the roaming status and unconditional call forwarding CFU status against RPD . Thereafter Skype gateway sets the CFU to a Dummy Number DN via MAP RegisterSS at subscriber B s HLR entry. Since GMSC uses DP 2 or DP 3 trigger it is able to perform event supervision on the DN. At step subscriber A calls subscriber B at his mobile number and the call reaches GMSC of subscriber B s network. At step GMSC requests subscriber B s routing information from HLR by sending a MAP SRI message in a GSM implementation to the HLR. In case of a CDMA network implementation an IS 41 MAP Location Request message is used. Further at step HLR returns the DN to GMSC .

Thereafter at step GMSC issues the DP2 or DP3 network trigger request on the DN e.g. InitialDP in IN protocol to Skype Gateway which is equipped with support for IN protocols. In this case the IDP parameters should contain the original called number of B. At step Skype gateway requests monitoring of events such as DISCONNECT from GMSC . Thereafter at step Skype gateway issues PRN IMSI B message to VLR VMSC of subscriber B. VLR VMSC returns the routing number MSRN at step . GMSC at step routes the call to the mobile. Subscriber B answers the call at step . At step Skype client sends an IM to the Skype gateway requesting to switch the call to Skype client . Thereafter at step Skype gateway grants the switching and requests the subscriber to disconnect the call to the mobile. The subscriber disconnects the call at his mobile number at step . At step GMSC issues the DISCONNECT event report to Skype gateway . Thereafter at step Skype gateway issues a CONNECT Skype IN to GMSC . GMSC routes the call to the Skype IN number at step . Hence the voice call gets through the IP network when the Skype client answers the call.

In both the above embodiments Skype is an explanatory VoIP client for switching call flow. However it would be apparent to a person skilled in the art that similar call flows would be applicable to other VoIP clients like Yahoo Google Gizmon MSN etc. It would also be apparent to a person skilled in the art that the implementation as explained above also allows the subscriber to alternate between one device and another several times using the instructions communicated to the VoIP Skype Gateway from the IM Skype client.

Thereafter at step IM VoIP gateway issues a MAP ISD IMSI B message to VLR VMSC of subscriber B. IM VoIP gateway receives the information of VLR VMSC either from Initial DP or from RPD . Skype gateway sends the MAP ISD message to remove set to empty the conditional forwarding information from VLR VMSC . Further at step IM VoIP gateway requests the monitoring of call events such as NO ANSWER and BUSY from GMSC and issues a CONTINUE message to GMSC . At step GMSC again requests to HLR for the routing information of subscriber B. At step HLR returns the routing number i.e. the routing identifier such as MSRN in GSM implementation and TLDN in CDMA implementation. GMSC continues the call setup towards the routing number at step . In case subscriber B does not respond to the call setup at his routing number which is the mobile number in this case. Thereafter at step GMSC sends event report to IM VoIP gateway . ICV system may perform the steps and after step to avoid assign pre assigning a temporary number until a conditional forwarding call on subscriber B s mobile number takes place. At step IM VoIP gateway again requests for monitoring of call events such as NO ANSWER and BUSY from GMSC . Thereafter at step IM VoIP gateway requests GMSC to connect subscriber B s assigned number F by voice gateway . Hence at step GMSC initiates a call set up using subscriber A s number subscriber B s called number and the assigned number F for B towards the voice gateway . Thereafter at step voice gateway uses the stored record for subscriber B to route the call over IP to subscriber B s IM VoIP client . IM VoIP client can answer the call when ringing.

In case IM VoIP client did not respond to the call at the number F at step GMSC sends the event report to IM VoIP gateway . In case subscriber B sets IM VoIP client with call forwarding such as a voicemail the call goes to the forwarded number. At step IM VoIP gateway gets the conditional forwarding number of B from either RPD or by issuing MAP Interrogate SS or AnyTimeSubscriberProfile restoreData or SendParameters to HLR on the late call forwarding number corresponding to the late forwarding condition received. At step IM VoIP gateway requests GMSC to connect to the late call forwarding number of B. Thereafter voice gateway releases the temporary assigned F back to the free number pool. Hence at step IM VoIP gateway re directs the call initially destined to mobile number of subscriber B to the late call forwarding number of subscriber B.

Thereafter at step IM VoIP gateway again requests for monitoring of call events such as NO ANSWER and BUSY from GMSC . Thereafter at step IM VoIP gateway requests GMSC to connect subscriber B s temporary number F to IM VoIP gateway . Hence at step GMSC initiates a call set up using subscriber A s number subscriber B s called number as the originally called number and number F for subscriber B. At step voice gateway uses the stored record number F on B to route the call over IP to subscriber B s IM VoIP client . The IM VoIP client can answer the call when ringing.

In case IM VoIP client does not respond to the call at the number F at step GMSC sends the event report to IM VoIP gateway . In case the subscriber B sets the IM VoIP client with call forwarding such as a voicemail the call goes to the forwarded number. At step IM VoIP gateway gets the conditional forwarding number of subscriber B from either RPD or by issuing MAP Interrogate SS or AnyTimeSubscriberProfile restoreData or SendParameters to HLR on the late call forwarding number corresponding to the late forwarding condition received. At step IM VoIP gateway requests GMSC to connect to the late call forwarding number of subscriber B. Finally voice gateway releases the assigned number F back to free pool of number. Hence at step IM VoIP gateway re directs the call initially destined to mobile number of subscriber B to the late call forwarding number of subscriber B.

Another embodiment of the invention provides the re routing service to subscribers using Vonage like service. represents a system for implementing an ICV system using the Vonage like service. This embodiment caters to wireless subscribers in first communication network . ICV system is a modified version of ICV system to include a Vonage like gateway instead of IM VoIP gateway to cater to any Vonage based VoIP service. Further ICV system includes subscriber s Vonage like Client device phone adaptor that has an IP interface and a phone interface to a phone . Each time the phone adaptor connects to an IP network it reports the IP address and phone number to a Vonage like Directory Service . Vonage like Gateway subscribes to Directory Service for any information pertaining to subscriber of the network deploying ICV system . Whenever such a subscriber s Vonage like Client device registers with Directory Service Directory Service notifies Vonage like Gateway . Further there is RPD for monitoring the roaming links to capture information about roamers subscribers in a database. The architecture caters to VoIP clients like Vonage SunRocket where there is a call in number service and an IP phone adaptor. There is no IM or presence component. However there is still a registration of IP address with the phone number on a directory service.

Thereafter at step Vonage like Gateway requests the monitoring of call events such as NO ANSWER and BUSY from GMSC and issues CONTINUE message. The GMSC requests routing information from HLR again on subscriber B at step . At step HLR returns the routing number MSRN to GMSC . GMSC continues the call set up towards the routing number at step . There may be a case when subscriber B i.e. the mobile does not answer the call on its MSRN. Hence at step GMSC sends event report to Vonage like Gateway . Vonage like Gateway again requests the monitoring of call events such as NO ANSWER and BUSY from GMSC . Vonage like Gateway at step requests via IN CONNECT GMSC to connect to the subscriber B s Vonage number. At step GMSC continues the call set up using subscriber A s number subscriber B s called number as originally called number and the Vonage like number of subscriber B. Again in case subscriber B s Vonage like client did not answer the call at step GMSC sends event report to Vonage like Gateway . In cases when Vonage like Client itself is set with call forwarding on a voicemail the call goes to the forwarding number. Thereafter at step Vonage like Gateway gets conditional call forwarding number from RPD or by issues a MAP Interrogate SS or AnyTimeSubscriberProfile restoreData or SendParameters etc to HLR of subscriber B on the late call forwarding number corresponding to the late forwarding condition received. Further at step Vonage like Gateway then requests GMSC via IN CONNECT message to connect to the subscriber B s late call forwarding number. Finally at step the GMSC initiates the call setup to the subscriber B s late call forwarding number.

In each of the above embodiments subscriber B i.e. subscriber is associated with a wireless operator. It is also desirable to have an ICV system for providing services to subscriber B when he is associated with the wireline fixed line operators. Further it is also desirable to provide ICV systems that cater to various types of VoIP clients such as Skype IM VoIP like and Vonage. represents an ICV system using the Skype IN like service for a fixed line subscriber B in accordance with an embodiment of the invention. The ICV system includes a Skype gateway a fixed line switch and a switch directory in HPMN of the fixed line subscriber B. The subscriber s Skype client may be associated with a device such as but note limited to a laptop a PC or a smart device that has an IP interface. Skype client of the subscriber connects to Skype gateway via an IP network. ICV system does not require a Roamer Probe Database RPD because the objective for this system is to connect to the subscriber when he is online on his VoIP client and unavailable at the fixed line. Further in this embodiment subscriber B registers for the call in number service for its VoIP client.

In accordance with an embodiment of the invention when a SIP IM VoIP client device registers with Directory Service Directory Service notifies subscriber B s status information i.e. presence information to SIP IMS Gateway . Thereafter SIP IMS Gateway sets the unconditional or conditional call forwarding of subscriber B either at the HLR of subscriber B or at the fixed line switch of subscriber B. Now when subscriber A calls subscriber B the call gets rerouted over an IP network to SIP IM VoIP client via Voice Gateway . Voice Gateway is responsible to assign a temporary local number in the current area of subscriber B so to reduce the forwarding call cost. Voice Gateway also routes the final call to SIP IM VoIP client device .

It would be apparent to a person skilled in the art that signal flow for non call related traffic is similar to the one as explained in one or more of the above embodiments of routing call related traffic. A mobile terminated SMS MT SMS is usually free even when the subscriber is roaming. The forwarding of a MT SMS is preferred when subscriber s mobile is not in coverage area yet connects to IP network. It may not be necessary that the subscriber is out of coverage only when he s roaming it may also be possible that mobile subscriber is at the home network and yet may be unreachable because subscriber may have switched off his mobile or may not answer the call. In such cases the gateway delivers any mobile terminated SMS to the subscriber via the IP network.

In both cases the VoIP client responds to the received SMS from the sending party. The response will reach the VoIP gateway at the HPMN. The VoIP Gateway will put the responding party s mobile number as the sending number and the original sending party as the destination number. In some cases the original sending party may be a VoIP client or a mobile.

The generic method explained in one or more of the above embodiments is represented in as a flow chart for implementing an ICV system in accordance with an embodiment of the invention. At step the gateway detects a subscriber registration to the visited network when the subscriber initially registers with the home network. At step the gateway receives location information corresponding to the subscriber s current location of the subscriber by using the RPD to probe the roaming SS7 links between the home network and the visited network. At step the gateway detects the status of the client VoIP client associated with the subscriber. Further at step the gateway selects a routing identifier associated with the client. The routing identifier corresponds to the subscriber s current location. Thereafter at step the gateway transfers the subscriber s traffic to the client at the associated routing identifier using the second communication network based upon the status of the client. In accordance with another embodiment of the invention the VoIP gateway transfers the subscriber s traffic using the first communication network when the status of the client is seen either as offline or unreachable.

The present invention can take the form of an entirely hardware embodiment an entirely software embodiment or an embodiment containing both hardware and software elements. In accordance with an embodiment of the present invention software including but is not limited to firmware resident software and microcode implements the invention.

Furthermore the invention can take the form of a computer program product accessible from a computer usable or computer readable medium providing program code for use by or in connection with a computer or any instruction execution system. For the purposes of this description a computer usable or computer readable medium can be any apparatus that can contain store communicate propagate or transport the program for use by or in connection with the instruction execution system apparatus or device.

The medium can be an electronic magnetic optical electromagnetic infrared or semiconductor system or apparatus or device or a propagation medium. Examples of a computer readable medium include a semiconductor or solid state memory magnetic tape a removable computer diskette a random access memory RAM a read only memory ROM a rigid magnetic disk and an optical disk. Current examples of optical disks include compact disk read only memory CDROM compact disk read write CD RAN and Digital Versatile Disk DVD .

An HPMN operator uses the Integrated Cellular VoIP ICV system to serve subscribers associated with its network even when they are not the coverage of home network. The ICV system connects with its subscribers via an IP network to provide call related and value added service. The subscriber may be using various VoIP clients which may connect to the home operator via a VoIP gateway deployed at the HPMN. The ICV system may forward a call destined to the subscriber at his mobile number as a VoIP call to a client associated with the subscriber. The ICV system is capable of switching an ongoing call on mobile to a call on a VoIP client and vice versa. In case of multiple VoIP clients with a subscriber the subscriber may specify preferential order amongst multiple clients.

The components of ICV system described above include any combination of computing components and devices operating together. The components of the ICV system can also be components or subsystems within a larger computer system or network. The ICV system components can also be coupled with any number of other components not shown for example other buses controllers memory devices and data input output devices in any number of combinations. In addition any number or combination of other processor based components may be carrying out the functions of the ICV system.

It should be noted that the various components disclosed herein may be described using computer aided design tools and or expressed or represented as data and or instructions embodied in various computer readable media in terms of their behavioral register transfer logic component transistor layout geometries and or other characteristics. Computer readable media in which such formatted data and or instructions may be embodied include but are not limited to non volatile storage media in various forms e.g. optical magnetic or semiconductor storage media and carrier waves that may be used to transfer such formatted data and or instructions through wireless optical or wired signaling media or any combination thereof.

Unless the context clearly requires otherwise throughout the description and the claims the words comprise comprising and the like are to be construed in an inclusive sense as opposed to an exclusive or exhaustive sense that is to say in a sense of including but not limited to. Words using the singular or plural number also include the plural or singular number respectively. Additionally the words herein hereunder above below and words of similar import refer to this application as a whole and not to any particular portions of this application. When the word or is used in reference to a list of two or more items it covers all of the following interpretations any of the items in the list all of the items in the list and any combination of the items in the list.

The above description of illustrated embodiments of the ICV system is not intended to be exhaustive or to limit the ICV system to the precise form disclosed. While specific embodiments of and examples for the ICV system are described herein for illustrative purposes various equivalent modifications are possible within the scope of the ICV system as those skilled in the art will recognize. The teachings of the ICV system provided herein can be applied to other processing systems and methods. They may not be limited to the systems and methods described above.

The elements and acts of the various embodiments described above can be combined to provide further embodiments. These and other changes can be made to the AITRS in light of the above detailed description.

In describing certain embodiments of the ICV system under the present invention this specification follows the path of a telecommunications call from a calling party to a called party. For the avoidance of doubt that call can be for a normal voice call in which the subscriber telecommunications equipment is also capable of visual audiovisual or motion picture display. Alternatively those devices or calls can be for text video pictures or other communicated data.

In the foregoing specification specific embodiments of the present invention have been described. However one of ordinary skill in the art will appreciate that various modifications and changes can be made without departing from the scope of the present invention as set forth in the claims below. Accordingly the specification and figures are to be regarded in an illustrative rather than a restrictive sense and all such modifications are intended to be included within the scope of present invention. The benefits advantages solutions to problems and any element s that may cause any benefit advantage or solution to occur or become more pronounced are not to be construed as a critical required or essential features or elements of any or all the claims.

