---

title: Application service invocation based on filter criteria
abstract: An Internet Protocol Multimedia Subsystem (IMS) device includes a memory configured to store a subscriber profile, where the subscriber profile includes at least one criterion relating to an event that occurs after a session request has been forwarded to a terminating party. The IMS device further includes a processor configured to invoke at least one application service for a session based on the at least one criterion in the subscriber profile.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08234388&OS=08234388&RS=08234388
owner: Verizon Patent and Licensing Inc.
number: 08234388
owner_city: Basking Ridge
owner_country: US
publication_date: 20061219
---
The present application is a Continuation in Part of U.S. patent application Ser. No. 11 460 750 filed Jul. 28 2006 and entitled NETWORK ROUTING which claims priority to U.S. Provisional Patent Application No. 60 703 812 filed Jul. 29 2005 and U.S. Provisional Patent Application No. 60 764 748 filed Feb. 3 2006. The contents of all of these applications are incorporated herein by reference in their entireties.

The Internet Protocol Multimedia Subsystem IMS provides mobile and fixed multimedia services. The aim of IMS is not only to provide new services but also all of the services current and future that the Internet provides. In this way IMS gives network operators and service providers the ability to control and charge for each service. In addition users are given the ability to execute services from their home networks as well as when the users are roaming.

The following detailed description of implementations consistent with principles of the invention refers to the accompanying drawings. The same reference numbers in different drawings may identify the same or similar elements. Also the following detailed description does not limit the invention.

Implementations described herein relate to providing filter criteria for invoking application services in an IMS.

S CSCF I CSCF and P CSCF may be considered call session control components in system . The call session control components may be responsible for parsing a session e.g. a session initiation protocol SIP session and applying logic e.g. business logic service logic operational logic etc. on a per event basis. The outcome of the session control may be to route an event to the appropriate components and or append SIP headers and values.

S CSCF may be viewed as the brains of the IMS core. S CSCF may perform session control registration and service invocation for the subscribers of the IMS core. Hence S CSCF may be viewed as the run time engine deciding to whom and under what conditions specific services in the form of Application Servers are accessed by a SIP request. S CSCF may receive subscriber profiles from HSS at registration time or later for unregistered users to learn the subscribers chosen services and the rules under which the services should be brokered. Additionally S CSCF may perform user authentication based on information from HSS . S CSCF may receive session requests from for example P CSCF or I CSCF . After service invocation is completed S CSCF may disposition the sessions by routing the session requests to the destinations via for example P CSCF BGCF and or I SBC .

As illustrated S CSCF may include SCIM and Resource Management RM function . SCIM may be considered an extension of S CSCF and may be responsible for orchestrating the offerings of one or more application services across various service enabling technologies and platforms to produce valued services for IMS users. As such SCIM may be viewed as an adjunct IMS platform function that orchestrates service invocation at session setup modification or teardown. Accordingly SCIM may also be based on a subscriber s profile and predefined interaction rules to determine which services are to be invoked at run time and what type of application and or media capabilities should be engaged in order to properly execute the services. SCIM may allow for more complex rules to be used for services determination based on the subscriber s profile and for example on external information such as policy information location information presence information the readiness condition of an application server e.g. load balancing information network outage information application server status information resource availability information etc. etc. Additional information regarding S CSCF and SCIM may be found in U.S. patent application Ser. No. 11 564 984 filed Nov. 30 2006 and entitled APPLICATION SERVICE INVOCATION the entire contents of which are incorporated by reference herein.

RM as will be discussed in further detail below may be responsible for executing business rules and service level agreements SLAs by allocating the appropriate resources.

I CSCF may act as the main point of contact for connections to and from a subscriber in the IMS platform. I CSCF may be located at the edge of the IMS core. I CSCF may receive SIP messages and identify the next hops for the SIP messages. To achieve this I CSCF may query HSS for the location e.g. an address of the appropriate S CSCF to which a particular SIP message is to be forwarded.

P CSCF may receive session requests from end points located at both public IP networks and private IP networks. P CSCF may validate requests forward the requests to selected destinations and process and forward the responses. P CSCF may generate chargeable events and send information relating to the chargeable events to CF . Additionally P CSCF may interact with PDF to grant reject or downgrade a session request based on platform resources and quality of service QoS measurements.

HSS may include one or more servers that act as the central repository for user related information. HSS may contain user related subscription information for handling multimedia sessions. Some of the information contained in HSS may include information identifying the location of a particular S CSCF for a particular user. As indicated above the location of a particular S CSCF may be conveyed to I CSCF upon receiving a query from a network element. HSS may also include subscriber profile information that contains in one exemplary implementation extended filter criteria service trigger points and information identifying the corresponding resources e.g. applications media services etc. that offer the services. The subscriber profile information may be forwarded to S CSCF for session control and service treatment. Moreover HSS may provide and receive updates directly from application servers .

SLF may include one or more databases that contain subscription location information for subscribers. SLF may receive a query which may contain identification information for a subscriber from I CSCF and may return based on the subscriber identification information information identifying an HSS e.g. HSS that serves the subscriber.

System may include various components that bridge the IMS core to external networks such as a public switched telephone network PSTN the Internet etc. These components which may include MGW function MGCF SLG NGW BGCF and BIGCF may perform protocol conversion and event routing to or from the IMS core. In one exemplary implementation SLG and NGW may be replaced with more generic gateways that include MGW and MGCF .

MGW function may connect PSTN networks and the IMS core. In one implementation MGW function may terminate bearer channels from a PSTN network and media streams from the IMS core e.g. real time transport protocol RTP streams in an IP network or Asynchronous Transfer Mode ATM Adaptation Layer 2 AAL2 ATM connections in an ATM backbone may execute the conversion between these terminations and may perform transcoding and signal processing. In addition MGW function may provide tones and announcements to circuit switched CS users. In one exemplary implementation MGW function may operate under the control of MGCF .

MGCF may be part of the gateway infrastructure that enables communication between the IMS core and PSTN networks. MGCF may contain signaling gateway functions that perform protocol conversion between the Integrated Services Digital Network ISDN User Part ISUP or Primary Rate Interface PRI and SIP protocols before forwarding a session to the IMS core. In a similar fashion IMS originated sessions directed towards PSTN users may traverse MGCF . MGCF may use media gateway control protocols control media channels in MGW . In addition MGCF may report account information to CF .

SLG may include a set of MGCF and MGW entities. SLG may connect the IMS core to Class 5 networks. In one implementation the interfaces between SLG and the Class 5 networks may include Digital Signal 1 DS1 based Non Facilities Associated Signaling NFAS PRIs.

NGW may include a set of MGCF and MGW entities. NGW may connect the IMS core to Class 3 networks. In one implementation the interfaces between MGCF of NGW and the Class 3 networks may include DS1 based signaling system 7 SS7 interfaces and the interfaces between MGW of NGW and Class 3 networks may include DS1 bearer channels.

BGCF may connect IMS initiated calls to Circuit Switch CS customers e.g. an IMS subscriber calling a telephone number in the PSTN . BGCF may based on a routing policy select an appropriate network in which the connection is to be made or may select the appropriate gateway to the other network.

BIGCF may correspond to an ingress point that handles incoming calls from PSTN gateways e.g. NGW SLG wholesale gateways other IP based carriers e.g. based on Voice over Internet Protocol VoIP peering agreements Emergency Services Peering Points etc. BIGCF may route calls from and to non IMS subscribers. BIGCF may route calls to the IMS core when the calls are destined for IMS subscribers or when IMS applications are invoked or may bypass the IMS core elements P CSCF I CSCF S CSCF HSS etc. when calls are destined for non IMS subscribers and no IMS applications are invoked by the calling party or called party. BIGCF may route calls to PSTN based termination points to BGCF and route calls to IP based termination points e.g. a wholesale termination point IP based carriers etc. directly to I SBCs associated with the IP based termination points. If calls are either from and or to IMS subscribers or IMS applications or services are invoked BIGCF may route the calls to the IMS core via I CSCF and using S CSCF to invoke calling and or called party features.

The IMS core may provide multimedia services. Examples of multimedia services or applications include playing announcements audio video recording and playback interactive voice response IVR fax reception and transmission automatic speech recognition ASR text to speech conversion TTS multimedia conferencing customized ring back tones push to talk over cellular PoC video messaging etc. MRF may be part of the IMS core and may support services that use multimedia streams.

As illustrated in MRF may include MRFC MRFP and MRB . MRFC and MRFP are the IMS resources that provide support for bearer related services e.g. multi party sessions announcements to a user bearer transcoding etc. . MRFC may provide bearer control related services. MRFP may provide user plane resources that may be requested and instructed by MRFC . MRB may provide a resource management function that is able to allow media resources to become common resources shared among multiple applications.

Application servers may include one or more servers that provide enhanced audio video messaging and data services within the application layer of system . Application servers may be accessible to the users of the IMS core and provide value added multimedia services to those users. Application servers may submit charges to the IMS core for the services that application servers provide to the IMS user community.

Two types of application servers that may be used within system may include macro applications or macro application services and micro applications or micro application services . Macro applications may include standalone application servers that typically contain support functions e.g. registration media resource etc. .

Each of the macro applications may correspond directly to a service and a trigger in a subscriber s profile. S CSCF may detect the trigger point of a macro application and invoke the macro application via the S CSCF SCIM functionality. S CSCF SCIM may manage interactions among the intact macro applications and the composite services constituted by multiple micro applications described in the following paragraph or a combination of one to many macro and one to many micro applications.

Examples of macro application services may include Hosted IP CENTREX HIPC Unified Messaging UM GLMS and Presence service . CENTREX may correspond to a type of Private Branch Exchange PBX service in which switching occurs at a local telephone office instead of at the company premises where the traditional PBX is located may be referred to as Customer Premise Equipment CPE . In one implementation CENTREX may be replaced by or supplemented with a SIP Voice Features server. Unified messaging may allow users to retrieve and send voice messages from a single interface regardless of the technology e.g. telephone personal computer etc. and may provide other unified messaging services e.g. fax deposit retrieval voice to email etc. .

Micro applications may be provided on one or more Services Creation Environment SCE with service execution capability formulating SIP Application Servers. Micro applications may include a wide variety of enhanced multimedia services that allow for a rapid development and deployment cycle. Multiple micro applications may be assembled into a composite service. This composite service in the same manner as the macro applications may be represented by a trigger in a subscriber s profile. S CSCF may detect the trigger point of a composite service and invoke the composite service via SCIM functionality.

SCIM may also play a role in managing interactions among the micro applications when such a composite service is invoked. SCIM may apply the following processes in managing the interactions among micro applications sequences the micro applications invocation based on predefined priority detects mid call triggers and determines the subsequent micro application invocation accordingly resolves service conflicts based on the predefined interaction rules and or applies default handling in exception cases. These processes may be similar to what S CSCF applies on macro applications. However micro applications have a stronger disproportionate reliance on the richer SCIM functionality in comparison to macro services. For example if a Location Service is blended with a CENTREX service most of the session control may reside within the CENTREX service. Comparatively if micro applications such as Find Me Do Not Disturb voicemail and Location services all as micro services are blended then there may be a disproportionately higher reliance on session control from SCIM . That is SCIM may be used to handle mid call triggers fully manage exception cases etc. Accordingly the need for robust orchestration may be significantly higher in an environment where there is significant service decomposition micro services .

One example of a micro application is Carrier AS which may facilitate feature rich toll free call processing. Other examples of micro applications may include as indicated above a Find Me service a Do Not Disturb service a voicemail service a location service etc.

SCE may provide a foundation for rapid development of next generation services. SCE may support Java Specification Request JSR SIP Servlet and a suite of externalized application programming interfaces APIs for developers to gain access to the IMS core. A single SCE may support a number of macro application servers and may contain basic service capabilities support the building of micro applications.

The IMS core may support a number of different services such as GLMS Presence service and ENUM server . GLMS may include one or more services that allow for group list creation management and use across multiple applications within the IMS core. GLMS may enforce access and visibility rules. Presence service may include one or more services that automate the task of aggregating both presence and availability information. Presence service may inform one user about the status of another user s availability and willingness to communicate. Presence service may use a Presence User Agent PUA to manage the presence of the IMS subscribers and handle presence subscription requests. For example an application or an TMS subscriber may act as a watcher which is an entity that subscribes to presence information provided by Presence service . ENUM server may provide translation of E.164 to SIP URIs. BIGCF and S CSCF may query ENUM server to determine a next hop for a call. In some exemplary implementations BIGCF may execute ENUM queries for both calling and called number resolution. Additional information regarding ENUM server may be found in co pending U.S. patent application Ser. No. 11 460 668 filed Jul. 28 2006 and entitled ROUTING CALLS IN A NETWORK which is incorporated by reference herein in its entirety.

The IMS core may include one or more session border controllers SBCs that provide control of the boundary between different service provider networks provide signaling protocol inter working between the SIP based IMS core and other service provider networks control the transport boundary between service provider networks and or provide usage metering and Quality of Service QoS measurements for media flows. Two types of SBCs that may be associated with the IMS core are A SBC and I SBC . In other implementations A SBC and I SBC may be replaced with border control and border gateway functions.

A SBC may correspond to an ingress point to the IMS core for Customer Premises Equipment CPE traffic. A SBC may provide SIP aware firewall capabilities that support network address translation NAT prevent denial of service DoS attacks and execute other security enforcement features. A SBC may be the first SIP events normalization point prior to the IMS core.

I SBC may serve as a connection point between the IMS core and wholesale gateways and also between the IMS core and IP peering VoIP carriers. I SBC may provide SIP normalization and Topology Hiding and Internetwork Gateway TRIG services.

System may include a number of policy components. For example system may as illustrated in include policy engine PDF and RM . Policy engine may include one or more rule based engines that govern subscriber access to the IMS core subscriber access to resources and routing decisions for several different types of event requests made within the IMS core. In one implementation policy engine may provide decision logic to policy components also called policy decision points within the IMS core. Policy engine may manage two general categories of resources 1 network bandwidth resources related to the transport of multimedia content streams and 2 application resources related to the service logic and media processing used to initiate and control multimedia content streams. Policy engine may maintain real time information regarding the state of all resource requests e.g. bandwidth requests media requests etc. being made in system and update the appropriate policy components e.g. PDF and or RM in system based on the real time information. Moreover policy engine may allow for policies to be created modified and or deleted and may update the appropriate policy components e.g. PDF and or RM in real time to reflect the policy changes. Policy engine may interface with PDF and RM using the extensible markup language XML protocol. Policy engine may also interface with one or more external operations support systems OSSs not shown for policy creation modification and or deletion and with one or more network management systems for obtaining resource status updates. Additional information regarding policy engine may be found in co pending U.S. patent application Ser. No. 11 460 672 filed Jul. 28 2006 and entitled POLICY ENGINE which is incorporated by reference herein in its entirety.

PDF may provide service based local policy control. PDF may make policy decisions based on session and media related information. PDF may exchange this decision information with another IMS element such as A SBC or I SBC to control the flow and characteristics of a communication link. PDF may manage the bandwidth resources. PDF may act as a sub component of the platform border signaling elements P CSCF BIGCF BGCF and SBCs and and may enforce policies to ensure that multimedia streams are transported with the proper bandwidth utilization properties and Quality of Service QoS in accordance with subscriber service level agreements SLAs .

RM may be used to execute a policy at the component level. As illustrated in RM may be associated with for example S CSCF BGCF BIGCF A SBC and I SBC . In one implementation RM may store and execute the policy decisions that are relevant for the location at which RM is associated.

CF may include a unified system for providing both offline charging and online charging. Offline charging is a process where charging information for network resource usage is collected concurrently with that resource usage. The charging information may be passed through a chain of CFs . At the end of this process Charging Detail Record CDR files may be generated by the network which are then transferred to the network operator s billing domain for the purpose of subscriber billing.

Online charging is a process where the actual charging for network resource usage occurs in real time concurrently with that resource use. The charges may be debited from an appropriately funded subscriber account. An example of online charging includes pre paid calling card usage.

CDF may compile chargeable events gathered from IMS components into a single Charging Detail Record CDR for offline billing activities. CDF may gather the chargeable events from a Charging Trigger Function CTF that may be associated with components of system and after creating the CDR pass the billing data to the CGF .

CGF may act as a gateway between both the offline charging system the online system and an external post processing system such as a billing domain.

GUP may include a collection of data that is stored and managed by different entities such as the user equipment the home environment the visited network and the value added service providers which may affect the way in which an individual user experiences services. GUP may include a number of user profile components and an individual service may make use of a subset of the available user profile components.

Bus may permit communication among the components of S CSCF . Processing logic may include any type of processor or microprocessor that interprets and executes instructions. In other implementations processing logic may be implemented as or include an application specific integrated circuit ASIC field programmable gate array FPGA or the like. Memory may include a random access memory RAM or another type of dynamic storage device that stores information and instructions for execution by processing logic a read only memory ROM or another type of static storage device that stores static information and instructions for the processing logic and or some other type of magnetic or optical recording medium and its corresponding drive for storing information and or instructions.

Input device may include a device that permits an operator to input information to S CSCF such as a keyboard a keypad a mouse a pen a microphone one or more biometric mechanisms and the like. Output device may include a device that outputs information to the operator such as a display a speaker etc.

Communication interface may include any transceiver like mechanism that enables S CSCF to communicate with other devices and or systems. For example communication interface may include mechanisms for communicating with other components within system .

As will be described in detail below S CSCF may perform processing associated with invoking services in an IMS environment. S CSCF may perform these and other functions in response to processing logic executing software instructions contained in a computer readable medium such as memory . A computer readable medium may be defined as one or more memory devices and or carrier waves. The software instructions may be read into memory from another computer readable medium or from another device via communication interface . The software instructions contained in memory may cause processing logic to perform processes that will be described later. Alternatively hardwired circuitry may be used in place of or in combination with software instructions to implement processes consistent with the principles of the invention. Thus systems and methods described herein are not limited to any specific combination of hardware circuitry and software.

S CSCF service brokering component may receive a message e.g. a SIP message parse the message and apply brokering rules to determine to which application server s the message should be sent. The message may include for example a SIP INVITE message. S CSCF service brokering component may parse the message to identify the originating party and terminating party. S CSCF service brokering component may separately process the service invocation for the calling party and the called party. Depending on the stage of session processing S CSCF service brokering component may use the originating party identity to lookup a subscriber profile for the originating party and use the terminating party identity to lookup a subscriber profile for the terminating party. S CSCF service brokering component may identify the application servers based on brokering rules in the subscriber profile s .

SCIM service orchestration component may identify one or more micro applications based on a more complex set of brokering rules in the subscriber profile s . In some implementations SCIM service orchestration component may also make micro application selections based upon external information such as information from policy service s location services and or presence locations information regarding the readiness condition of an application server e.g. load balancing information network outage information the current state of an application server resource availability information etc. etc.

SCIM service orchestration component may also manage the interaction among micro applications. SCIM service orchestration component may sequence micro application invocations based on predefined priority in the subscriber profile s . SCIM service orchestration component may detect triggers during an ongoing call and invoke the appropriate micro application s . SCIM service orchestration component may resolve service conflicts based on predefined interaction rules and may apply default handling in exception cases.

As illustrated database may include a subscriber profile field . Database may include other fields that facilitate identifying one or more subscriber profiles for a received message.

Subscriber profile field may store profiles for registered subscribers with which the particular S CSCF is associated. Each subscriber profile may include specific data about the subscriber such as IMS subscription data to correlate private and public identifiers the specific S CSCF where the user is registered authentication password s and a service profile for the subscriber. In other implementations subscriber profiles may include other information.

In one implementation the service profile may include filter criteria also called rules that may be used to determine the logic to be executed when a particular condition is met and any services chaining that may be requested by an originating or terminating party.

The filter criteria may cause application services to be invoked for a session. The filter criteria may include initial filter criteria iFC and extended filter criteria. The filter criteria may include zero or one trigger point TP and application server information. A trigger point may be a resultant logical operation of one or more service point triggers SPTs . The initial filter criteria may cause application services to be invoked for initial SIP request messages or events arising during processing of initial REQUEST methods. The extended filter criteria may cause application services to be invoked for additional trigger points that contain SIP response messages returned from the terminating party or events arising during the processing of these SIP response messages. Multiple trigger points might be detected in an incoming request or response message hence multiple filter criteria might satisfy the triggering condition. Additionally a single trigger point might have multiple filter criteria associated with it. In order to allow S CSCF SCIM to handle the multiple filter criteria in the sequence that delivers services in meaningful manner a priority may be associated with each criterion.

In addition a third type of filter criteria the subsequent filter criteria sFC may be signaled from the SIP AS to the S CSCF. sFC may allow for dynamic definition of the relevant SPTs at application execution time. As such the sFC might override the rest of the service invocation sequence in the current active session in the following ways 1 insert a filter criterion as the next highest priority 2 suppress resume one or more filter criteria 3 cancel the rest unexecuted filter criteria. Consequently if S CSCF SCIM receives a subsequent filter criterion as result of an application execution the remaining not yet executed filter criteria may be temporarily re prioritized temporarily inactivated and resumed in a follow up sFC or revoked as per instructions in the sFC. The life of an sFC spans from the time it arrives at S CSCF SCIM until the time the corresponding session ends. After the end of the session the filter criteria in the subscriber s service profile may return to the state as provisioned.

SPTs may include those instances in the SIP signaling as well as non SIP signaling events on which filter criteria can be set. SPTs which may be part of initial trigger points for initial filter criteria may include headers and contents of SIP request messages. The initial triggers may include for example SPTs relating to the Request Uniform Resource Identifier URI any initial known or unknown request method type e.g. INVITE REGISTER BYE ACK OPTIONS CANCEL INFO SUBSCRIBE NOTIFY UPDATE MESSAGE REFER PRACK COMET PUBLISH etc. the presence or absence of a header field the registration type e.g. whether a REGISTER request is an initial request re registration request or a de registration request content of any known or unknown header field direction of the request with respect to the served user e.g. originating or terminating session description protocol information etc.

SPTs which may be part of additional trigger points for extended filter criteria may include headers and contents of SIP response messages that may cause service invocation after the initial request. These SPTs may include additional SIP signaling instances relating to portions of a response message from the terminating party. For example SPTs may include instances relating to the response message type e.g. 1XX 2XX 3XX 4XX 5XX 6XX etc. the presence or absence of any known or unknown headers in the response message the content of any known or unknown header field in the response message content of any session description protocol SDP field within the body of the response message the content of the message body of the response message one or more reference filter criteria FC identifiers IDs etc. The response code used as a SPT may be properly attributed so that the response message corresponding to the SPT may either be passed along to the originator or suppressed according to the value defined in this SPT attribute. In some implementations a trigger to a particular filter criterion may relate to the status of other filter criteria referred to as the reference filter criteria as described above. This relationship may be dependent or conflict. For example if service B is said to be dependent on service A this means that the invocation of service A is a condition to be met in order to invoke service B. If service B is said to be a conflict to service A this means that the invocation of service A may preclude the invocation of service B. A trigger point may include this relationship as part of the logical operation with other SPTs. For example a trigger point may indicate that if a particular filter criterion which may be identified by an FC identifier has been satisfied and already executed for an initial SIP request message and a response from the terminating party includes particular information e.g. a busy code 486 then a specified application service should be invoked. SPTs may also include instances relating to definable non SIP signaling trigger events. The additional triggers may be monitored when services are armed corresponding to the reference FC. For example a filter criterion may include a trigger event based on a timer. The definable trigger event may be defined in one exemplary implementation using the following format 

Several SPTs may be combined in a single trigger point via a Boolean operator such as an OR an AND or a NOT operator. As an example the SPT could identify a SIP method INVITE and a string 7325551212 in the RURI or From field of the message. The TP may use the AND operation to combine these two together. The result may look like TP Method INVITE AND String 7325551212 IN RURI .

Table 1 below illustrates exemplary filter criteria that may be included in a subscriber profile. As illustrated the filter criteria may include the filter criterion FC identification ID field the public user identification ID field the priority field the trigger point field and an application server identification field. The subscriber profile may include additional and or other fields than illustrated in Table 1. The FC identification field may identify either the initial filter criteria or extended filter criteria with which the trigger point in the trigger point field is associated. The public user identifier field may store information that uniquely identifies a user of the IMS. The priority field may include information identifying a priority associated with an entry of filter criteria. The trigger point field may store a trigger point associated with the user identified in the public user identification field. The application server identification field may store information identifying an application server from which an application service is to be invoked.

Trigger Point class describes the trigger points that should be checked in order to find out whether or not the indicated Application Server should be contacted. As indicated above each Trigger Point may be provided as a Boolean expression. The absence of a Trigger Point instance may indicate an unconditional triggering of the identified application server. The ConditionTypeCNF attribute may define how the set of SPTs are expressed e.g. an ORed set of ANDed sets of SPT statements an ANDed set of ORed sets of statements etc. . Each Trigger Point may include 1 to n Service Point Triggers where n is an integer greater than 1. The Condition Negated attribute may allow individual SPT indicator statements to be negated. The Group attribute may identify ANDed or ORed sets of SPTs.

Application server class may define the application server which is contacted if the trigger points are met. The server name attribute may identify the SIP URL of the application server to contact. The default handling attribute may determine whether the dialog should be released if the application server could not be reached. Application server class may be associated with zero or one Service Information class . Service Information class may allow information to be downloaded to S CSCF that is to be transferred transparently to an application server when the trigger points of a filter criterion are satisfied. The Service Information attribute includes a string conveying that information.

Request URI may define a SPT relating to portions of the Request URI from an originating party. SIP Response may define as described above a SPT relating to portions of a response message from the terminating party. SIP Response may include an attribute identifying the response code and whether or not the response from the terminating party should be suppressed. SIP Method may define a SPT for any known or unknown request method type e.g. INVITE REGISTER BYE ACK OPTIONS CANCEL INFO SUBSCRIBE NOTIFY UPDATE MESSAGE REFER PRACK COMET PUBLISH etc. . SIP Header may define a SPT for the presence or absence of any SIP header or for the content of any SIP header. SIP Header may include a header attribute that identifies the SIP header and a content attribute that defines the value of the SIP header if needed. Session Case may represent an enumerated type with for example possible values Originating Terminating Registered and Terminating Unregistered indicating whether the filter should be used by the S CSCF SCIM handling the originating or terminating for a registered end user or terminating for an unregistered end user. Session Description may define a SPT for the content of any SDP field within the body of a SIP Method. Session Description may include a line attribute that identifies the line inside the session description and a content attribute that defines the content of the line identified by the line attribute. Definable trigger may as indicated above define a SPT relating to a definable non SIP signaling trigger event. Definable trigger may include for example a trigger name attribute that identifies the definable trigger and a value that indicates whether the trigger has been met. Reference Filter Criteria may identify a filter criterion on which SPT depends. Reference Filter Criteria may include a filter criteria type attribute that defines the type of filter criterion on which SPT depends and an identification attribute that uniquely identifies the filter criterion.

Database may temporarily store subsequent filter criteria until the session ends. The subsequent filter criteria may include filter criteria that may be satisfied based on a result of run time execution sent from the application server to S CSCF SCIM . The subsequent filter criteria may allow for dynamic definition of SPTs at application execution time. In one exemplary implementation the subsequent filter criteria may be stored in the appropriate application server as part of the subscriber data and sent to S CSCF SCIM as a result of service execution by the application server. The subsequent filter criteria may be sent from the application server to S CSCF SCIM via for example a SIP message e.g. INVITE NOTIFY INFO etc. in the header portion of the SIP message or the body portion of the SIP message.

As illustrated database may include a public user identification ID field a priority field a trigger point field and an application server identification field . Database may include additional and or other fields than illustrated in . For example database may also include an application type field that identifies the type of application service to be invoked.

Public user identifier field may store information that uniquely identifies a user of the IMS. Priority field may include information identifying a priority associated with a particular subsequent filter criteria entry. Trigger point field may store a trigger point for the user identified in the public user identification field. Application server identification field may store information identifying an application server from which an application service is to be invoked.

The subscriber profile may include the information described above with respect to . In one implementation the subscriber profile may include filter criteria for invoking one or more application services prior to and or after a session has been established between an originating party and a terminating party.

S CSCF may store the received subscriber profile block . For example S CSCF may store the subscriber profile in database .

S CSCF may parse the received call request block . For example S CSCF may parse the call request to identify information in the header of the request and or body of the request. In one implementation S CSCF may identify the originating party for the call request block . S CSCF may use the originating party s identity to obtain a subscriber profile associated with the originating party s identity block . The subscriber profile may include initial filter criteria extended filter criteria and may also at session execution time include subsequent filter criteria.

S CSCF SCIM may invoke one or more application services for the call request based on the initial filter criteria stored in the originating party s subscriber profile block . As set forth above the subscriber profile may include initial filter criteria that may be used to determine the service s to be invoked for the originating party. S CSCF SCIM may use the initial filter criteria against the public user identity that was used to place the call request i.e. the originating party s identity to check the existence of trigger points in the call request that match unexecuted initial filter criteria in the context of this call request. S CSCF SCIM may analyze the trigger points starting from the highest priority trigger point. S CSCF SCIM may invoke the application service that is associated with the highest priority trigger point. Once invoked S CSCF SCIM may invoke the next highest priority application service and so on until all applicable application services have been invoked block .

S CSCF may also parse the call request to identify the terminating party for the call request block . S CSCF may use the terminating party s identity to obtain a subscriber profile associated with the terminating party s identity block . If the terminating party is a registered subscriber S CSCF may use the terminating party s identity to obtain a subscriber profile from database . If the terminating party is an unregistered user S CSCF may use the terminating party s identity to obtain a subscriber profile from HSS . Alternatively S CSCF may route the call request to another S CSCF that is served by the terminating party. The subscriber profile may include initial filter criteria extended filter criteria and may also at session execution time include subsequent filter criteria.

S CSCF SCIM may invoke one or more application services for the call request based on the initial filter criteria stored in the terminating party s subscriber profile block . As set forth above the subscriber profile may include initial filter criteria that may be used to determine the service s to be invoked for the terminating party. S CSCF SCIM may use the initial filter criteria against the public user identity to which the call request is destined i.e. the terminating party s identity to check the existence of trigger points in the call request that match unexecuted initial filter criteria in the context of this call request. S CSCF SCIM may analyze the trigger points starting from the highest priority trigger point. S CSCF SCIM may invoke the application service that is associated with the highest priority trigger point. Once invoked S CSCF SCIM may invoke the next highest priority application service and so on until all applicable application services have been invoked block .

S CSCF SCIM may determine whether additional filter criteria have been specified by the originating party s subscriber profile or the terminating party s subscriber profile block . As indicated above a subscriber profile may include additional trigger points e.g. relating to extended filter criteria for events occurring after the call request has been processed by S CSCF SCIM . The events may relate to a response from the terminating party and or other user defined events that occur during the ongoing session. S CSCF SCIM may determine whether the additional filter criteria have been suppressed by a subsequent filter criterion sent by an application server block . As will be described in further detail below with respect to S CSCF SCIM may receive a subsequent filter criterion which may affect the execution of additional filter criteria specified by the originating party and or terminating party.

If additional trigger points have been specified by the originating party and or terminating party block YES and the additional trigger points are not suppressed block NO S CSCF SCIM may begin monitoring traffic from the originating party and or terminating party and or begin monitoring a mechanism based on the additional trigger points block . For example if the additional trigger points relates to a response from the terminating party S CSCF SCIM may monitor the response message from the terminating party. As another example if the additional trigger points relates to a definable event e.g. a timer based event S CSCF SCIM may set a monitoring mechanism e.g. a timer specified by the additional trigger point and may monitor the mechanism to determine when the event occurs.

Once S CSCF has begun monitoring based on the additional trigger point block S CSCF SCIM has determined that no additional trigger points have been specified by the originating party or terminating party block NO or any additional filter criteria that have been specified by the originating party or terminating party have been suppressed by an sFC sent by an application server block YES S CSCF may forward the call request toward the appropriate destination e.g. the terminating party block . For example S CSCF may forward the call request to P CSCF BGCF or I SBC for completing the call.

Processing may begin with S CSCF SCIM setting the status code for monitoring a response message from the terminating party when an iFC has been armed i.e. when the iFC has been satisfied block . As indicated above additional trigger points may include dependency from one or more iFCs e.g. see the last two entries in Table 1 above . When a subscriber profile includes an additional trigger point relating to a response message that depends from a particular iFC S CSCF SCIM may monitor the response message from the terminating party when the particular iFC has been armed or satisfied .

S CSCF SCIM may receive the response message from the terminating party block . S CSCF SCIM may parse the received response message block . For example S CSCF SCIM may parse the response message to identify portions of the header and or body of the response message. For example if originating party s subscriber profile includes a trigger point relating to the presence or absence of a particular header field in the response message S CSCF SCIM may parse the response message to determine whether the header field is present or absent.

S CSCF SCIM may invoke one or more application services for the response message based on the trigger point s in the extended filter criteria stored in the originating party s subscriber profile block . If multiple trigger points apply to the response message S CSCF SCIM may analyze the trigger points starting from the highest priority trigger point. S CSCF SCIM may invoke the application service associated with the highest priority trigger point. Once invoked S CSCF SCIM may invoke the next highest priority application service and so on until all applicable application services have been invoked for the response message.

Processing may begin with S CSCF SCIM receiving subsequent filter criteria block . The subsequent filter criteria may be received in response to an application service being invoked on the application server. In one implementation the application server may send the subsequent filter criteria to S CSCF SCIM via a SIP message such as an INVITE message a NOTIFY message an INFO message etc. The subsequent filter criteria may be stored in the header and or the body of the SIP message.

S CSCF SCIM may process the message from the application service that contains the subsequent filter criteria in a number of ways. For example S CSCF SCIM may determine whether the subsequent filter criteria cancels all of the unexecuted filter criteria block . If so block YES S CSCF SCIM may process the session according to the result of the last executed application service i.e. the application server sends the subsequent filter criteria which causes S CSCF SCIM to revoke all the rest of the filter criteria block . S CSCF SCIM may determine whether the subsequent filter criteria suppresses one or more unexecuted filter criterion in the service profile block . If so block YES S CSCF SCIM may process the session according to the result of the last executed application service i.e. the application server sends the subsequent filter criteria which causes S CSCF SCIM to temporarily deactivate the referenced filter criteria according to the subsequent filter criteria block . S CSCF SCIM may determine if the subsequent filter criteria indicates that one or more filter criteria should be inserted in the list of unprocessed filter criteria block . In some situations the subsequent filter criteria may specify where the one or more filter criteria are to be inserted e.g. the one or more filter criteria may be associated with the default next highest priority . If the subsequent filter criteria identify one or more filter criteria to be inserted S CSCF SCIM may add the one or more filter criteria to the rest of unprocessed filter criteria and recalculate the combined filter criteria including the one or more filter criteria sent from the application server block . S CSCF SCIM may process the session according to the new priority ordering of the filter criteria block . For example S CSCF SCIM may based on the recalculated priority values automatically process the subsequent filter criteria by invoking the appropriate application service s and then resume processing the unprocessed filter criteria. As another example S CSCF SCIM may automatically process the subsequent filter criteria by invoking the appropriate application service s and canceling the processing of any unprocessed filter criteria. If the subsequent filter criteria identifies one or more filter criteria to be inserted block NO S CSCF SCIM may process the session according to the result of the last application service execution and process the session according to the rest of executed filter criteria pre set service profile block .

Implementations described herein relate to providing filter criteria for invoking application services in an IMS.

The foregoing description of exemplary implementations provides illustration and description but is not intended to be exhaustive or to limit the invention to the precise form disclosed. Modifications and variations are possible in light of the above teachings or may be acquired from practice of the invention. For example while series of acts have been described with respect to the order of the acts may be varied in other implementations. Moreover non dependent acts may be implemented in parallel.

Embodiments of the invention as described above may be implemented in many different forms of software firmware and hardware. The actual software code or specialized control hardware used to implement embodiments of the invention is not limiting of the invention. Thus the operation and behavior of embodiments were described without reference to the specific software code it being understood that design software and control hardware may be designed to implement embodiments based on the description herein.

Further certain portions of the invention may be implemented as logic that performs one or more functions. This logic may include hardware such as an application specific integrated circuit a field programmable gate array a processor or a microprocessor software or a combination of hardware and software.

No element act or instruction used in the description of the present application should be construed as critical or essential to the invention unless explicitly described as such. Also as used herein the article a is intended to include one or more items. Where only one item is intended the term one or similar language is used. Further the phrase based on is intended to mean based at least in part on unless explicitly stated otherwise.

