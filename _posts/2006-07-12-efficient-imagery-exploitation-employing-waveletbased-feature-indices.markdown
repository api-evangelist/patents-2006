---

title: Efficient imagery exploitation employing wavelet-based feature indices
abstract: A wavelet-based band difference-sum ratio method reduces the computation cost of classification and feature extraction (identification) tasks. A Generalized Difference Feature Index (GDFI), computed using wavelets such as Daubechies wavelets, is employed in a method to automatically generate a large sequence of generalized band ratio images. In select embodiments of the present invention, judicious data mining of the large set of GDFI bands produces a small subset of GDFI bands suitable to identify specific Terrain Category/Classification (TERCAT) features. Other wavelets, such as Vaidyanathan, Coiflet, Beylkin, and Symmlet and the like may be employed in select embodiments. The classification and feature extraction (identification) performance of the band ratio method of the present invention is comparable to that obtained with the same or similar data sets using much more sophisticated methods such as discriminants, neural net classification, endmember Gibbs-based partitioning, and genetic algorithms.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07805005&OS=07805005&RS=07805005
owner: The United States of America as represented by the Secretary of the Army
number: 07805005
owner_city: Washington
owner_country: US
publication_date: 20060712
---
Under 35 U.S.C. 119 e 1 this application claims the benefit of prior co pending U.S. Provisional Patent Application Ser. No. 60 704 416 Wavelet Based Feature Indices and Their Use as a Data Mining Tool for Hyperspectral Imagery Exploitation by Simental et al. filed Aug. 2 2005 and incorporated herein by reference.

Under paragraph 1 a of Executive Order 10096 the conditions under which this invention was made entitle the Government of the United States as represented by the Secretary of the Army to an undivided interest therein on any patent granted thereon by the United States. This patent has multiple assignees. This and related patents are available for licensing to qualified licensees. Please contact Jeff Walaszek at 703 428 672 or Phillip Stewart at 601 634 4113.

Multispectral and hyperspectral images are composed of amounts of data that are impractical to analyze manually. These data include multiple spectral bands that are not visualized or assessed readily. Conventional multi spectral sensors provide only a few spectral bands of imagery nominally covering pre specified portions of the visible to the near infrared spectra. Conventional hyperspectral sensors may cover hundreds of spectral bands spanning a pre specified portion of the electromagnetic spectrum. Thus hyperspectral sensors may provide greater spectral discrimination than multispectral sensors and allow non literal processing of data to detect and classify material content as well as structure.

An image may be represented mathematically as a matrix of m rows and n columns of elements. An element of such a matrix defining a two dimensional 2 D image is termed a picture element or pixel. An image is usable when a viewer is able to partition the image into a number of recognizable regions that correspond to known features such as trees lakes and man made objects. Once this level of imaging is attained each distinct feature and object may be identified since each is represented by an essentially uniform field. The process that generates such uniform fields is known as segmentation.

Many techniques have been used to segment images. Segmentation may be class interval based edge based and region based.

For 8 bit precision data a given image may assume pixel element values from a minimum of zero to a maximum of 255. By mapping into one category those pixels whose intensity values are within a certain range or class interval e.g. 0 20 a simple threshold method may be used to segment.

An edge may be defined by observing the difference between adjacent pixels. Edge based segmentation generates an edge map linking the edge pixels to form a closed contour. In conventional edge based segmentation well defined mathematical formulae are used to define an edge. After edges are extracted another set of mathematical rules may be used to join eliminate or both join and eliminate edges thus generating a closed contour around a uniform region. That is the scene itself is not used to define an edge even though globally an edge may be defined by the scene.

Region based segmentation is the antithesis of edge based segmentation. It begins at the interior of a potentially uniform field rather than at its outer boundary. It may be initiated with any two interior adjacent pixels. One or more rules such as a Markov Random Field MRF approach are used to decide whether merging of these two candidates should occur. In general conventional region based segmentation is performed on an image within but a single spectral band follows well defined mathematical decision rules is computationally intensive and thus expensive and is not self determining or self calibrating.

Color based segmentation requires input of three spectrally distinct bands or colors. A true color video image may be generated from a scene taken by three bands of blue green and red. They may be combined into a composite image using individual filters of the same three colors. The resultant color image may be considered a segmented image because each color may represent a uniform field.

If a region or an edge may be generated from the content of the scene it should be possible to integrate both region based and edge based segmentation methods into a single integrated process. The process by which a segment or region is matched with a rule set or model is termed identification.

Identification occurs after segmentation. It results in labeling structure using commonly accepted names such as river forest or automobile. While identification may be achieved in a number of ways such as statistical document functions and rule based and model based matching all require extracting representative features as an intermediate step. Extracted features may be spectral reflectance based texture based and shape based.

Statistical pattern recognition exploits standard multivariate statistical methods. Rule based recognition schemes use conventional artificial intelligence AI . Shape analysis employs a model based approach that requires extraction of features from the boundary contour or a set of depth contours. Sophisticated features that may be extracted include Fourier descriptors and moments. Structure is identified when a match is found between observed structure and a calibration sample. A set of calibration samples constitutes a calibration library. A conventional library is both feature and full shape based.

Feature extraction utilizes a few but effective representative attributes to characterize structure. While it capitalizes on economy of computation it may select incorrect features and apply incomplete information sets in the recognition process. A full shape model assumes that structure is not contaminated by noise obscured by ground clutter or both. In general this assumption does not correspond to the operation of actual sensors.

Depth contours match three dimensional 3 D structure generated from a sensor with 3 D models generated from wire frames. In general all actual images are 3 D because the intensity values of the image constitute the third dimension although all are not created equal. For example a LADAR image has a well defined third dimension and a general spectral based image does not. However most objective discrimination comes from the boundary contour not the depth contour.

Detection classification segmentation and identification techniques applied to hyperspectral imagery are inherently either full pixel or mixed pixel techniques in which each pixel vector in the image records the spectral information. Full pixel techniques operate on the assumption that each pixel vector measures the response of one predominate underlying material or signal at each site in a scene. However the underlying assumption for mixed pixel techniques is that each pixel vector measures the response of multiple underlying materials or signals at each site. In actuality an image may be represented best by a combination of the two. Although some sites represent a single material others are mixtures of multiple materials. Rand Robert S. and Daniel M. Keenan IEEE Transactions on Geoscience and Remote Sensing Vol. 39 No. 7 pp. 1421 1434 July 2001.

The simplest full pixel technique involves spectral matching. Spectra of interest in an image are matched to training spectra obtained from a library or the image itself. Metrics for determining the degree of match include Euclidian distance derivative difference and spectral angle. If the relative number of mixed pixels in a scene is significant then spectral matching of this type is not employed. Class label assignments generated by spectral matching algorithms are not affected by spatial neighborhoods however consistency of class labels in localized spatial neighborhoods termed spatial localization is important in mapping applications.

Other full pixel methods include various supervised and unsupervised segmentation techniques. These are based on statistical and pattern recognition methods normally applied to multispectral image processing. The training is also done using data from libraries or the scene imagery itself. Specific techniques include statistical linear discrimination e.g. Fisher s linear discriminant quadratic multivariate classifiers e.g. Mahalanobis and Bayesian maximum likelihood ML classifiers and neural networks.

The quadratic methods require low dimensional pixel vectors and thus are preceded by a data reduction operation to reduce the number of spectral bands addressed. Effective neural networks such as the multilayer feedforward neural network MLFN may be built to model quadratic and higher order decision surfaces without data reduction. Although the MLFN may be trained to identify materials perturbed by a limited amount of mixing usually it does not include any spatial localization in the decision process.

The most common unsupervised algorithms for clustering imagery are KMEANS and ISODATA in which the metric used in determining cluster membership is Euclidian distance. Euclidian distance does not provide an adequate response when fine structure or shapes are presented in high resolution spectra being overly sensitive to intensity changes. Additionally these methods do not include any spatial localization in the clustering operation.

Spectral mixture analysis SMA techniques used with mixed pixel approaches address some of the shortcomings of full pixel techniques. SMA employs linear statistical modeling signal processing techniques or both. SMA techniques are governed by the relationship 1 where 

The matrix H is presumed known and fixed although for most actual materials there exists no single fixed spectral signatures to represent the pure materials.

The basic SMA may be modified to partition the H matrix into desired and undesired signatures. Subspace projections orthogonal or oblique to the undesired signatures and noise components are computed. Orthogonal subspace projection OSP is applied to hyperspectral imagery to suppress undesirable signatures and detect signatures of interest. This is shown in the relationship H D U 2 where 

From the early days of multi spectral remote sensing to the present earth scientists have been thoroughly and meticulously measuring the wavelengths and intensity of visible and near infrared light reflected by the land surface back up into space. In some instances they have used either a Vegetation Index VI or a Normalized Difference Vegetation Index NDVI to quantify the concentrations of green leaf vegetation around the planet. Weier J. and D. Herring Earth Observatory September 1999. These indices may be described mathematically as 

VI and NDVI involve mathematical operations of a combination of two or more bands aimed at enhancing vegetation features. VI and NDVI yield estimates of vegetation health provide a means of monitoring changes in vegetation relative to biomass and color and serve as indicators of drought climate change precipitation and the like. Kidwell K. B. U.S. Department of Commerce National Oceanic and Atmospheric Administration July 1997 estimate of health Boone R. K. Galvin N. Smith and S. Lynn Photogrammetric Engineering Remote Sensing Vol. 66 6 pages 737 744 June 2000 monitoring changes Kassa A. Master of Science Dissertation University College London UK August 1999 indicator of climate .

The usefulness of the VI and NDVI is well documented and it is clear that these techniques have contributed substantial information to vegetation studies and other investigations using remote sensing. VI and NDVI have been suggested as means for identifying features other than vegetation but these suggestions have not been aggressively investigated. Deer P. J. International Symposium on Spectral Sensing Research Melbourne Australia November 1995.

Analysis of all possible ratio combinations in hyperspectral data approaches mathematical chaos thus it was postulated that other difference sum band ratios may provide unexpected relationships yielding useful information about terrain features both in multi spectral and hyperspectral data. Embodiments of the present invention address reducing the number of ratio combinations to identify multiple object classes not just vegetation.

Advances in hyperspectral sensor technology provide high quality data for the accurate generation of terrain categorization classification TERCAT maps. The generation of TERCAT maps from hyperspectral imagery can be accomplished using a variety of spectral pattern analysis algorithms however the algorithms are sometimes complex and the training of such algorithms can be tedious. Further hyperspectral imagery implies large data files since contiguous spectral bands are highly correlated. The correlation further implies redundancy in classification feature extraction computations.

The use of wavelets to generate a set of Generalized Difference Feature Indices GDFI transforms a hyperspectral image cube into a derived set of GDFI bands. Each index is a derived band that is a generalized ratio of the originally available bands. Thus select embodiments of the present invention generate a set of derived bands. For example an index may be generated with a Daubechies wavelet with two 2 four 4 eight 8 or more vanishing moments. 

Vanishing moments filter and smoothing coefficients and low and high frequency coefficients are all related to the order of the wavelet and these terms are sometimes used interchangeably e.g. a wavelet of order four 4 may be referred to as a wavelet with four 4 vanishing moments. A wavelet with x vanishing moments i.e. order x means that the first x moments starting from zero 0 moment are equal to zero 0 . This suppresses signals that are of a polynomial of degree less than or equal to x 1 .

The number of filter coefficients is chosen when the order of the wavelet is established. For example in research into data mining for select embodiments of the present invention the initial effort started with Daubechies 2 lag 3 i.e. the Haar wavelet and increased both Daubechies order and lag to perform efficient data mining. The collection of these derived bands becomes the indices for the specific feature of interest. For example if the difference sum ratios and Daubechies wavelets with one vanishing moment i.e. two 2 filtering coefficients and lag of 3 that identifies or highlights roads and roads may also be identified with two vanishing moments i.e. four 4 filtering coefficients and a lag of 5 then the indices for roads may be described as Daubechies 2 lag 3 and Daubechies 4 lag 5 .

A commonly known special case of a GDFI is a Limited Difference Feature Index LDFI approach as described above for the Normalized Difference Vegetation Index NDVI . Numerous other limited band ratio indices readily identifying individual specific scene features are LDFIs i.e. single purpose special cases of the GDFI. Generating a set of GDFI bands is fast and simple. However there are a large number of possible bands and only a few generalized ratios indices prove useful. Judicious data mining of the large set of GDFI bands produces a small subset of GDFI bands suitable to identify specific TERCAT features.

In select embodiments of the present invention a wavelet based difference sum band ratio method reduces the computation cost of classification and feature extraction identification tasks. A Generalized Difference Feature Index GDFI computed using wavelets such as Daubechies wavelets is employed in an embodiment of the present invention as a method to automatically generate a large sequence of generalized band ratio images. Other wavelets such as Vaidyanathan Coiflet Beylkin and Symmlet and the like may be employed in select embodiments of the present invention. Selection of the optimum wavelet is important for computational efficiency. Simental E. and T. Evans International Symposium for Spectral Sensing Research San Diego Calif. June 1997.

A description of a method for analyzing a signal by wavelets is provided in U. S. Pat. No. 5 124 930 Method for Analyzing a Signal by Wavelets to Nicolas et al. Jun. 23 1992 incorporated herein by reference.

The classification and feature extraction performance of a band ratio method of the present invention was comparable to results obtained with the same data sets using much more sophisticated methods such as discriminants and neural net classification and endmember Gibbs based partitioning. Rand R. S. and E. H. Bosch SPIE Defense and Security Symposium Orlando Fla. April 2004 discriminants and neural net . Rand and Keenan 2001 endmember partitioning . The performance of an embodiment of the present invention was comparable to results obtained from a similar data set using genetic algorithms. Simental E. D. Ragsdale E. Bosch R. Dodge Jr. and R. Pazak American Society for Photogrammetry and Remote Sensing Conference Anchorage Ak. May 2003.

Select embodiments of the present invention extract identify features from hyperspectral imagery rapidly and reliably inexpensively permitting ready identification of pre specified features.

In select embodiments of the present invention the expansion of a simple hyperspectral ratio with wavelet coefficients provides an easy fast and reliable method for analysis categorization or feature extraction identification . In addition to the analysis of hyperspectral datasets select embodiments of the present invention are sufficiently general for use with any high dimensional dataset.

Select embodiments of the present invention sample all band ratio combinations in hyperspectral data for rapid combinatorial computations that integrate wavelet and wavelet variogram techniques for better data anomaly filtering and detection. In select embodiments of the present invention a very efficient software package display results in a form that is easily comprehensible for classification and feature extraction analysis. In select embodiments of the present invention one is able to investigate if there are band ratios that provide potentially useful information in support of classification and feature extraction tasks.

In select embodiments of the present invention all possible band ratio combinations need not be computed. Several factors contribute to yielding a small subset of ratios that provides viable information.

Refer to provided for illustration purposes only. is a black and white version of the more readily discernible color . Wavelength nanometers m is plotted against radiance for most of the features in a hyperspectral data scene. Note that the reflectance values greater than 1799 m do not vary much i.e. the spectral curve is flat with radiance values close to zero. Therefore all ratios generated from bands between 1799 and 2500 m will provide essentially the same information and one ratio computation within any of these bands is sufficient.

As noted above inherent disadvantages of a hyperspectral data set are the vast amount of data and contiguous bands highly correlated due to close proximity within the electromagnetic spectrum. For example ratios involving adjacent bands generally provide the same information as ratios within those bands separated by two or three bands.

Refer to showing two images generated using two different ratios from a hyperspectral data set. The image on the reader s left was generated from the difference between band wavelength 1437.3 m and band wavelength 1451.1 m and the image on the reader s right generated from the difference between band and band wavelength 1464.9 m . The two images appear almost identical so both are likely to provide the same information. The similarity between these images suggests that computing and analyzing ratios involving adjacent bands and ratios involving bands separated by two bands yield the same information so computation of ratios separated by two bands is sufficient in this case.

Another factor that reduces the number of ratios needed is the number of features in a hyperspectral scene. Normally the number of features of interest is less than the total number of features in the scene. Thus in many situations most features of interest are extracted employing the analysis of but a few band ratios.

Unlike the work to derive either VI or NDVI in which the user is interested mostly in the numerical value of a ratio in select embodiments of the present invention the image display of the resulting ratio data is desired. Thus of interest is the numerator of the NDVI approaching zero 0 for a particular vegetation feature such as trees. This occurs when the radiance of the spectra of this pre specified feature e.g. trees is the same for two different wavelengths i.e. the difference in radiance equals zero and the radiance of all other features in the dataset are different non zero at these wavelengths. If these conditions are true and the resulting dataset is displayed as an image the pixels for the trees will appear black and all other pixels a shade of gray. It is then easy to identify the trees in the image. The converse is also useful. If the radiance of the spectra for the trees is different in two wavelengths and the radiance of the spectra for all other features is the same in the same two wavelengths then the image data will appear with the trees a shade of gray and all other features as black. The numerator does not have to vanish totally but as long as there is separation in radiance between one feature and all the other features then that one feature may be extracted easily.

A Generalized Difference Feature Index GDFI computed using Daubechies wavelets automatically generates a large sequence of generalized band ratio images.

Ordinary band ratio methods for the ready identification of vegetation cloud cover and other features usually take the difference of two bands divided by their sum. For example for bands and in LANDSAT multi spectral imagery the NDVI for each pixel in the image is computed by 

This can be considered a first order scaled derivative. The data produced by applying this ratio accentuates discontinuities and suppresses slowly varying data within a spectral signature.

At any pixel Eqn. 6 may be generalized by applying the ratio throughout the components of the spectral signature z yielding a simplified relationship describing the Generalized Difference Feature Index GDFI of the present invention 

The subscript 2 in GDFIrefers to the number of filter coefficients used in the ratio. For example using LANDSAT imagery yields the NDVI by NDVI GDFI 5 2 8 where for LANDSAT imagery conventionally used to yield the NVDI i is 5 Band 5 and t lag is 2 such that the difference between Bands 7 and 5 is divided by the sum of Bands 5 and 7 to yield the NDVI.

The method may be further generalized to include other wavelet coefficients with a higher number of vanishing moments. A natural extension of Eqn. 7 accounts for more filter coefficients such as Daubechies high and low frequency filter coefficients. Eqn. 7 can be written as 

Daubechies maxflat filters comprise an even number of coefficients where the high frequency filters satisfy n vanishing moments according to 0 1 21 0 10 and the low frequency coefficients g satisfy square root over 2 11 for 0 k n 1.

Eqns. 10 and 11 establish the criteria that a wavelet s high frequency h and low frequency g coefficients must satisfy to form a wavelet. For example Eqn. 10 for a wavelet with three 3 vanishing moments i.e. n 3 would be written as three separate expressions 0 1 2 3 4 5 0 zero moment or k 0 10a 0 1 2 3 4 5 0 first moment or k 1 10b 0 1 2 3 4 5 0 second moment or k 2 10c 

These coefficients gand h are used to compute the GDFI generalized ratios of derived bands indices as defined in Eqn. 9 . The sequence of GDFI bands is then used to identify features of interest in a scene for example. Individual GDFI bands are linked to specific features of interest and once linked are used to quickly and efficiently process data to identify or highlight only those features of interest.

A desired image with specific features highlighted is provided by employing a specific GDFI band s ratio and multiplying it by an appropriate constant such as the Daubechies coefficients. In select embodiments of the present invention a feature or features becomes very bright e.g. appearing as a distinct color or shade lighter than the remainder of the image. Of course an increase in the number of band ratios in the image increases the complexity of the image with a concomitant need for higher coefficients i.e. higher order wavelets. Thus there is a limit at which so many of the pixels are highlighted as to make the image no more valuable than the original unmodified image. Thus it is appropriate to employ the least ordered wavelet that enables a select few features to be readily identified.

Vanishing moments are related to scaled derivatives. Mallat S. Academic Press San Diego Calif. 1998. Due to the wavelets higher number of vanishing moments as with Eqn. 5 this technique will suppress slowly varying regions of the image or higher order polynomials in the spectra while also accentuating discontinuities. Bosch et al. note that for a fixed value of the lag t the sum of the squares of the numerator of Eqn. 9 scaled by

The experimental variogram circumflex over t as used in geostatistics is obtained when n 1 Haar wavelet filter . The experimental variogram circumflex over t analyzes spatial properties of data at different scales.

The GDFIis applied as a data mining technique to expose identify features of interest. The resulting generalization produces band ratios that depend on the number of spectral bands the lag parameter and the length of the Daubechies maxflat filter. Through employing the band ratio images as a data mining tool one is able to rapidly display identify those pre specified features enhanced by an embodiment of the present invention. The desired pre specified features may be viewed as grayscale images but as with images displayed using the NDVI color composites may also be formed using an embodiment of the present invention. Hyperspectral imagery provides more flexibility given the availability of a higher number of spectral bands. This is why embodiments of the present invention apply the filtered ratios first and then display the images.

As with the experimental variogram circumflex over t this technique depends on the assumption that data points are regularly spaced a generally valid assumption since spectral bands from the employed sensors approximate regular spacing.

Data were collected with a Hyperspectral Digital Collection Experiment HYDICE airborne sensor. This sensor uses a 320 210 array with multiple gain regions to support imaging at 400 2500 m. The sensor is flown at 5000 to 25000 ft and achieves spatial resolution of about 0.8 to 4 m. Basedow R. W. D. C. Carmer and M. E. Anderson Proceedings of the SPIE Vol. 2480 May 1994.

Data were collected over Copperas Cove Tex. and the neighboring vicinity. The aircraft flew at an altitude of 20 000 ft to provide a spatial resolution of three 3 meters in 210 spectral bands from 398.5 2499.2 m. Twelve 12 features were identified in the hyperspectral scene buildings roads soil rooftops canvas not shown separately rubber not shown separately metal not shown separately shrubs plastic grass trees and calibration panels not shown separately . Refer to depicting the hyperspectral composite class map of the Copperas Cove area in gray scale and to showing the same composite class map in color.

Data were also collected over Yuma City Ariz. The aircraft flew at an altitude of 5000 ft to provide a spatial resolution of one 1 meter in the same number of bands as in Example 1. However for this example only 204 bands were employed to image. These data are not calibrated. Eight 8 features were identified in the scene including buildings roads soil rooftops shrubs grass trees and swimming pools . is a grayscale composite of the imaged area while is the same Yuma City composite in color.

In the data sets for Examples I and II the interval between bands is not constant. Table I below summarizes the first three 3 and last five 5 wavelengths measured for each data set. The plot of the wavelength interval for Copperas Cove is a monotonic curve starting with an approximate interval of 3.3 and increasing to about 8.3 m. The same plot for Yuma City data is a step function with the interval a constant amount for several wavelengths followed by a jump. The two data sets are different although both were collected with the same sensor. The adjacent bands of each data set even with the jump in the Yuma City data are reasonably close enough to preclude any discontinuity problems.

Several pre specified desired features were extracted identified from scenes by using an embodiment of the present invention. Daubechies filtering wavelets with two 2 four 4 and eight 8 filter coefficients were used to generate numerous difference sum ratios. Thesholding was applied to separate the pre specified features from the rest of the image and produce a binary image. Normally thresholding is not amenable to automated computation. Thus the threshold value is manually adjusted until a satisfactory result is obtained. Alternatively thresholding is done by employing some statistical measure such as a standard deviation from a class mean. Both of these thresholding methods can be time consuming.

Refer to an enhanced grayscale image of and its color rendition generated from Eqn. 9 where n 1 i 17 and t 6. These values equate to the difference sum ratio of bands and employing Daubechies wavelets and two 2 filter coefficients. has been remapped with histogram equalization for better visual display. The light gray shading green in represents vegetation consisting of trees shrubs and bushes but no grass. This is consistent with ground truth information and with the same scene as represented in . The very dark areas represent trees shrubs bushes or a combination thereof.

Refer to an enhanced gray scale image of and its color rendition generated from Eqn. 9 where n 1 i 120 t 9. These values equate to the difference sum ratio of bands and employing Daubechies wavelets and two 2 filter coefficients. The light shaded areas blue in a color rendition represent buildings. These buildings correlate very well with the buildings identified in and with ground truth. Buildings are not a detectable class in hyperspectral classification but in this case all the light colored pixels have some commonality. One possibility is a delicate combination of asphalt rooftops with just enough paint to exclude asphalt parking lots and roads.

Refer to an enhanced gray scale image of and its color rendition generated from Eqn. 9 where n 1 i 153 t 6. These values equate to the difference sum ratio of bands and employing Daubechies wavelets and two 2 filter coefficients. The light shading light yellowish brown in represents the grass shown in . At three 3 meter resolution most of the pixels are not homogeneous but may be a mix of grass leaves topsoil and some tree branches in different combinations.

Refer to gray scale ground truth photo of a typical grassy area of and a color rendition of . These grassy areas as depicted in are a mix of low growing vegetation grass branches and soil.

Refer to an enhanced grayscale image of and its color rendition generated from Eqn. 9 where n 1 i 18 t 5. These values equate to the difference sum ratio of bands and employing Daubechies wavelets and two 2 filter coefficients. The light shading red in represents dirt roads concrete and bright rooftops of the scene from . The complex constitution of some roads e.g. debris tire marks and the like may cause some roads to appear to have disconnected segments.

Refer to an enhanced grayscale image of and its color rendition a classification class map of Copperas Cove generated from data used to create and and their respective color renditions A A and A. No attempt was made to optimize color but this can be done. In the color rendition of the major features are well separated viz. trees shrubs and bushes are green dirt roads are orange grass and soil are brownish and asphalt is black. Purple pixels represent bright rooftops . There are some pixels that did not get classified but most of them are sparsely scattered throughout the image and most are probably mixed pixels such as those that may represent mixed vegetation i.e. a mix of topsoil grass trees shrubs and bushes. There may be other features that could be extracted identified e.g. swimming pools but they are too small to be clearly identified in the image of .

Ground truth at Copperas Cove provided five 5 other features rubber plastic metal canvas and calibration panels. These were not clearly identified with an embodiment of the present invention. All these features however are very small in size and in number and are very challenging to detect under any circumstances. Calibration panels are detectable but they are so small that it is not possible to conclusively identify them and normally these pixels are dismissed as artifacts.

Refer to an enhanced grayscale image of and its color rendition generated from Eqn. 9 where n 2 i 26 and t 16. The relevant bands are 26 42 58 and 74 with Daubechies wavelets four 4 filter coefficients and thresholding. The light shaded portions of and the corresponding green of represent trees shrubs bushes and grass. The trees shrubs bushes and grass in the image correlate very well with and with ground truth given that are not exact duplicate representations of the area of i.e. they correlate to only a part of the area of .

Refer to an enhanced grayscale image of and its color rendition generated from Eqn 9 where n 2 i 135 and t 16. The relevant bands are and with Daubechies wavelets four 4 filter coefficients and thresholding. The small light shaded signatures of blue signatures in the color rendition of represent parked and moving vehicles and the larger light shaded signatures of blue signatures in the color rendition of are rooftops that have some commonality with automotive paint. The large solid signature is a commercial building having an asphalt rooftop with some metallic paint on it. Ground truth verified that the other light shaded signatures blue signatures in the color rendition of have painted surfaces. Not all the vehicles in the scene have been extracted identified because different color shades have substantially different spectra. Vehicles and rooftops are not considered to constitute a unique independent class in hyperspectral classification unless all have identical surface paint. The spectral response for wood and metal painted the same color is very nearly the same. Evans T. P. Henley and E. Gonzalez submitted to Hyperspectral MASINT Support to Military Operations HYMSMO Program Office October 1995.

Refer to an enhanced grayscale image of and its color no gray scale rendition generated from Eqn. 9 where n 1 i 15 t 16. These values equate to the difference sum ratio of bands and employing Daubechies wavelets and two 2 filter coefficients. The white areas represent roads and parking lots of . The composition of roads and parking lots in this area is gravel concrete and asphalt in different combinations. All these materials have very similar spectral properties so that in most cases roads whether all one material or a combination of several will appear the same. Evans et al. 1995 . The white areas correlate well with the roads parking lots and some gravel covered or asphalt not bright rooftops of .

Refer to an enhanced grayscale image of and its color rendition generated from Eqn. 9 where n 1 i 32 t 6. These values equate to the difference sum ratio of bands and employing Daubechies wavelets and two 2 filter coefficients. The light shaded areas pink in the color rendition of represent surfaces painted the same color e.g. roofing edges. Most of these surfaces are on rooftops and the small dots are vehicles. The horizontal broken line in both is an artifact.

Refer to an enhanced grayscale image and its color rendition represent a rudimentary class map of the Yuma City image of generated from and and A A A and A respectively. Vegetation including grass is shown in green in the color rendition of roads parking lots and some rooftops are gray in colored rooftops are blue in colored sides of buildings are orange in and everything that was not classified is black in .

A single pre specified feature may be extracted identified with different combinations of bands. Table II below shows some features and the bands that were used for the extraction identification and associated wavelengths. The fourth column shows the number of coefficients used with the Daubechlies wavelet employed with this particular embodiment of the present invention. For example D4 stands for Daubechies wavelets with four 4 filter coefficients. Lag is the interval between the bands i.e. number of skipped bands used in this embodiment of the present invention. The sequence of difference sum ratio images generated with the same lag and same filter wavelet constitutes an image cube. Often all pre specified features of interest may be extracted identified within one of these image cubes.

Refer to a sample flow diagram for a process used in select embodiments of the present invention to perform data mining to streamline the processing of hyperspectral data in those cases in which specific features are to be identified or highlighted. To start the process at a 1step the pre specified limit of the wavelet array index K is selected and set and start values of wavelet array index K and lag T are set to zero and 1 respectively. Next at a 2step the limit for lag is set. Having set these two limits a 3step involves reading in the hyperspectral data set. A 4step discards those bands that contain compromised bad data. Although this step is taken early in the process to reduce the amount of data handled early on bad bands would be eliminated at the 10step below in any case. The wavelet array index K is then incremented appropriately in a 5step . In a 6step the lag T is incremented by 1 and a 7 th step calculates the ratios that are appropriate to generate indices in an 8step . A cube of the indices is generated in a 9step to provide the source from which indices for extracting specific features are selected in a 10 th step . It is in 10step that the number of bands are reduced. It is possible to have started with hundreds of bands and after the 10step many derived bands are eliminated. One advantage of this process is that there is no need to determine if a band is good or bad just if that band is appropriate to identify the specified structure. In an 11step a threshold is applied and only those indices meeting the threshold are selected for further use. The thresholded indices are saved in a 12step and two limits are applied to them. In a 13step a lag limit is applied. The lag limit t is defined as

If an index meets the lag limit it is passed to 14step where a wavelet order limit is applied. Upon passing both the wavelet order and lag limits the index is approved for the desired feature extraction and the process is ended . If the lag limit is not met in a 13step the process is recycled to the 6step the lag is incremented by one and the process reiterated from 7step until once again reaching the 13step whereupon a determination of whether it meets the lag limit is made. This process is repeated until the lag limit is met at the 13step and then passed to a 14step to determine if the wavelet order limit is met. If the wavelet order limit is not met the process goes to a 15step where the lag is reset to zero and the process iterated from 5step by incrementing the wavelet order by one and continuing the process to the 14step until the wavelet order limit is met at which time the process is ended . This process reduces the number of bands to be considered making the feature extraction process much more efficient than previously possible using more complex methods.

Under these conditions and as another alternative embodiment it is possible to use a standard computer suitably programmed to perform all these operations.

The convolution product in itself is a computation commonly performed in a computer with programs that exist in the market and the sequence of successive processing operations may be obtained by adequate programming wherein the intermediate results are stored in memory to be brought out again when they are necessary. In the same way the coefficients of wavelets are placed in the central memory of the computer and in the sequence of operations there is provision for obtaining the product of convolution on the number of points needed for the rate of the analysis operation. Although the analog digital conversion too can be done in the computer it is nevertheless desirable to use a specialized circuit which will be faster for this function. It is also possible to use a specialized circuit to perform the convolution here again for reasons of speed since many micro computers provide for the use of a co processor associated with the microprocessor in order to make particular computations.

In sum the band ratio method of select embodiments of the present invention reduces computation cost in classification and feature extraction tasks. The shear number of possible ratios is as stated enormous. Selective band utilization reduces them to a manageable number although the introduction of wavelets may increase computations several fold. There are several more wavelets that may be employed with select embodiments of the present invention such as Vaidyanathan Coiflet Beylkin and Symmlet among others.

The abstract of the disclosure is provided to comply with the rules requiring an abstract that will allow a searcher to quickly ascertain the subject matter of the technical disclosure of any patent issued from this disclosure. 37 CFR 1.72 b . Any advantages and benefits described may not apply to all embodiments of the invention.

While the invention has been described in terms of some of its embodiments those skilled in the art will recognize that the invention can be practiced with modifications within the spirit and scope of the appended claims. For example although specific types of image processing are discussed other similar configurations or methods including those that may have only some of the constituents or steps used in the above examples may be suitable for extracting identifying pre specified features and thus fall within the ambit of a preferred embodiment of the present invention as provided in the claims herein.

In the claims means plus function clauses are intended to cover the structures described herein as performing the recited function and not only structural equivalents but also equivalent structures. Thus although a nail and a screw may not be structural equivalents in that a nail employs a cylindrical surface to secure wooden parts together whereas a screw employs a helical surface in the environment of fastening wooden parts a nail and a screw may be equivalent structures.

Thus it is intended that all matter contained in the foregoing description or shown in the accompanying drawings shall be interpreted as illustrative rather than limiting and the invention should be defined only in accordance with the following claims and their equivalents.

