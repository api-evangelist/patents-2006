---

title: Automated real-time site survey in a shared frequency band environment
abstract: An intelligent spectrum management (ISM) system and method that includes sophisticated features to detect, classify, and locate sources of RF activity. The system comprises one or more radio sensor devices positioned at various locations in a region where activity in a shared radio frequency band is occurring. A server is coupled to the radio sensor devices and aggregates the data generated by the sensor devices. The server receives data from each of the plurality of sensor devices and executes functions to process the data. One feature of the system is to correlate data collected from the sensor or from suitably equipped devices that operate (and may move about) in a space with locations where provocation of that data occurs. To this end, radio frequency energy is received at each of a plurality of known positions (e.g., the sensors) in a space. The positions in the space of one or more devices emitting radio frequency energy in the space is determined from the received radio frequency energy at the plurality of known positions (e.g., the sensors). A variety of positioning techniques may be employed, such as received signal strength, time-difference-of arrival, time-of-arrival, etc. Activity data representing characteristics of received radio frequency energy in the space is generated at the sensors or at suitable equipped devices that may move about the space. The server correlates the activity data with the positions in the space that are associated with the provocation of the activity data.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07444145&OS=07444145&RS=07444145
owner: Cisco Technology, Inc.
number: 07444145
owner_city: San Jose
owner_country: US
publication_date: 20060808
---
This application is a continuation of U.S. application Ser. No. 10 909 455 filed Aug. 2 2004 and entitled Automated Real Time Site Survey in a Shared Frequency Band Environment now U.S. Pat. No. 7 110 756 which in turn claims priority to U.S. Provisional Application No. 60 508 635 filed Oct. 3 2003 and to U.S. Provisional Application No. 60 556 513 filed Mar. 25 2004. The entirety of each of the above listed applications is incorporated herein by reference.

The explosive growth in wireless applications and devices over the past few years has produced tremendous public interest benefits. Wireless networks and devices have been deployed in millions of offices homes and more recently in increasing numbers of public areas. These wireless deployments are forecast to continue at an exciting pace and offer the promise of increased convenience and productivity.

This growth which is taking place mostly in the unlicensed bands is not without its downsides. In the United States the unlicensed bands established by the FCC consist of large portions of spectrum at 2.4 GHz and at 5 GHz which are free to use. The FCC currently sets requirements for the unlicensed bands such as limits on transmit power spectral density and limits on antenna gain. It is well recognized that as unlicensed band devices become more popular and their density in a given area increases a tragedy of the commons effect will often become apparent and overall wireless utility and user satisfaction will collapse. This phenomenon has already been observed in environments that have a high density of wireless devices.

The types of signaling protocols used by devices in the unlicensed bands are not designed to cooperate with signals of other types also operating in the bands. For example a frequency hopping signal e.g. a signal emitted from a device that uses the Bluetooth communication protocol or a signal emitted from certain cordless phones may hop into the frequency channel of an IEEE 802.11 wireless local area network WLAN causing interference with operation of the WLAN. Thus technology is needed to exploit all of the benefits of the unlicensed band without degrading the level of service that users expect.

Historically the wireless industry s general approach to solving tragedy of the commons problems has been for manufacturers to simply move to another commons further up the spectrum. This solution however is not workable for much longer due to spectrum scarcity and to the less attractive technical characteristics of the higher bands decreased signal propagation and the inability to penetrate surfaces .

Enterprise uses of the unlicensed band are focused on larger scale deployment of wireless networks e.g. WLANs and integration into wired networks. WLANs can complicate existing network management schemes because they introduce the additional requirement of efficiently managing radio spectrum. Current WLAN systems and management technology are focused on managing activity at the network level of the WLAN but provide little or no capability to manage the frequency band where signals of multiple types e.g. communication protocol network types device types etc. are present.

There are many shortcomings of existing WLAN system technologies. Current WLAN technologies are only generally aware of other network elements. They have no way to discover other nearby sources emitting RF signals in the unlicensed bands. The lack of device discovery and location functions exposes existing WLANs to significant security vulnerabilities. While current WLANs can perform standard authentication services and encryption services they are vulnerable to imposter stations denial of service attacks parking lot attacks and other security breaches.

Briefly an intelligent spectrum management ISM system and method are provided that includes sophisticated features to detect classify and locate sources of RF activity. The system comprises one or more radio sensor devices positioned at various locations in a region where activity in a shared radio frequency band is occurring. A server is coupled to the radio sensor devices and aggregates the data generated by the sensor devices.

The server receives data from each of the plurality of sensor devices and executes functions to process the data. For example the server executes a performance function that monitors and generates events related to the performance of the wireless network a discovery function that monitors and generates events pertaining to devices operating in the wireless network or other radio frequency emitters in the frequency band and a security function that monitors and generates events related to security threats to the wireless network. In addition the server interfaces data generated by its various functions to a client application e.g. a network management application.

One feature of the system is an automatic site survey feature in which data collected from one or more sensors or from suitably equipped devices that operate and may move about in a space is correlated with location data associated with the activity that led to generation of that activity data. To this end radio frequency energy is received at each of a plurality of known positions e.g. the sensors in a space. The positions in the space of one or more devices emitting radio frequency energy in the space is determined from the received radio frequency energy at the plurality of known positions e.g. the sensors . A variety of positioning techniques may be employed such as received signal strength time difference of arrival time of arrival etc. Activity data representing characteristics of received radio frequency energy in the space is generated at the sensors or at suitable equipped devices that may move about the space. The server correlates the activity data with the positions in the space that are associated with the provocation of the activity data. The correlated data may be displayed on a map that represents the physical space that is being monitored.

The system methods software and other technologies described herein are designed to cooperatively manage use of a shared frequency band where signals of multiple types occur often simultaneously such as an unlicensed band and interference among the users of the band may occur. Many of the concepts described herein may apply to frequency bands that are not necessarily unlicensed such as when a licensed frequency band is used for secondary licensed or unlicensed purposes.

The term network is used hereinafter in many ways. There may be one or more wireless networks each comprising multiple devices or nodes that operate in the shared frequency band. One example of such a network is a WLAN. There are also networks called piconets which are formed with Bluetooth capable devices. Many of the examples described herein are made with respect to an IEEE 802.11 also known as WiFi WLAN mostly due in part to the expansive use that the WLAN has seen and is expected to continue to see. In addition the term network is referred to a wired network and to an aggregation of one or more wired and wireless networks. The spectrum management systems methods software and device features described herein new are not limited to any particular wireless network and are equally applicable to any wireless network technologies now known or hereinafter developed for use in a shared frequency band.

Referring first to a high level diagram of the client server sensor system is shown. The sensors to N connect to the server via a local area network e.g. Ethernet. The client application e.g. a console graphical user interface GUI application connects to the server via the Ethernet and or Internet. The interface between the sensors and the server is referred to as a network spectrum interface NSI.

The server may run on a dedicated server box or it may be integrated with other servers such as WLAN switches authentication servers or management servers. The server consists of an application or applications that implements several services or functions described hereinafter. The server interfaces with the client applications by an application programming interface API called the intelligent spectrum management interface ISMI .

The server manages all of the sensors it communicates with. It aggregates data from the sensors performs analysis on the data and presents the data in formats amenable to other network management entities. The server software analyzes the raw data on at least three axes 

Discovery Determine the complete set of spectrum emitting devices e.g. 802.11 wireless network APs and STAs and other non 802.11 compliant emitters that are present and track their physical location of devices.

Performance Analyze the spectrum protocol and location data in order to detect and mitigate performance problems. Examples include network load problems frequency retransmissions interference and cold spots. Process streams of RF and related air quality data.

Security Analyze the spectrum protocol and location data in order to detect and mitigate security issues. Examples include rogue APs ad hoc networks perimeter breaches denial of service attacks protocol and RF level and movement of otherwise designated stationary assets.

Turning now to each sensor comprises a spectrum monitoring section to monitor RF activity in the frequency band and a traffic monitoring section that is capable of sending and receiving traffic according to a communication protocol such as an IEEE 802.11 WLAN protocol. The spectrum monitoring section comprises a radio primarily for receive operations that is capable of tuning to receive energy at each channel or simultaneously all channels in a wideband mode of for example any of the unlicensed bands 2.4 GHz and 5 GHz in which IEEE 802.11 WLANs operate. An analog to digital converter ADC is coupled to the radio that converts the downconverted signals from the radio to digital signals. A radio interface I F is coupled directly to the radio and also to the output of the ADC . A real time spectrum analysis engine SAGE is coupled to the radio I F . The SAGE includes a spectrum analyzer a signal detector consisting of a peak detector and one or more pulse detectors and and a snapshot buffer . A Fast Fourier Transform FFT block not shown is coupled between the I F and the spectrum analyzer or included in the spectrum analyzer . The SAGE generates spectrum activity information that is used in the sensor and the server to determine the types of signals occurring in the frequency band and captures signals for location measurement operations. A dual port random access memory RAM is coupled to receive the output of the SAGE and a processor I F interfaces data output by the SAGE to a processor and couples configuration information from the processor to the SAGE .

The functions of the SAGE will be briefly described in further detail hereinafter but more details on the SAGE can be found in commonly assigned U.S. Pat. No. 6 714 605 commonly assigned co pending U.S. application Ser. No. 10 420 511 filed Apr. 22 2003 entitled System and Method for Real Time Spectrum Analysis in a Radio Device and commonly assigned co pending U.S. Provisional Patent Application No. 60 587 834 filed Jul. 14 2004 entitled Pulse Detection Scheme for Use in Real Time Spectrum Analysis. The spectrum analyzer generates data representing a real time spectrogram of a bandwidth of radio frequency RF spectrum such as for example up to 100 MHz. The spectrum analyzer may be used to monitor all activity in a frequency band for example the 2.4 2.483 GHz ISM band or the 5.15 5.35 GHz and 5.725 5.825 GHz UNII bands. The FFT block referred to above is for example a 256 frequency bin FFT block that provides I and Q FFT data for each of 256 frequency bins that span the bandwidth of frequency band of interest. An FFT block with greater resolution or bandwidth may be used as well. A spectrum correction block may be included to correct for I and Q channel imbalance by estimating an I Q channel imbalance parameter related to phase error and amplitude offset between the I and Q channels and to suppress a side tone resulting from the RF downconversion process. The spectrum analyzer may further comprise a power computation block that computes FFTdataI 2 and FFTdataQ 2 respectively and adds them together to output a power value for each FFT frequency bin. The spectrum analyzer may further include a stats logic block that has logic to accumulate statistics for average power duty cycle maximum power and a peaks histogram. Statistics are accumulated in the dual port RAM over successive FFT time intervals. After a certain number of FFT intervals determined by a configurable value stored in the spectrum analyzer control registers an interrupt is generated to output the stats from the dual port RAM. For example the stats are maintained in the dual port RAM for 10 000 FFT intervals before the processor reads out the values. The power versus frequency data generated by the spectrum analyzer is also used as input to the signal detector.

The signal detector detects signal pulses in the frequency band and outputs pulse event information entries which include one or more of the start time duration power center frequency and bandwidth of each pulse that satisfies configurable pulse characteristic criteria associated with a corresponding pulse detector.

In the signal detector the peak detector looks for spectral peaks in the power versus frequency data derived from FFT block output and reports the bandwidth center frequency and power for each detected peak. The output of the peak detector is one or more peaks and related information. The pulse detectors detect and characterize signal pulses based on input from the peak detector . A pulse detector lite may be employed to generate pulse events in a manner slightly different from pulse detectors as described in the aforementioned co pending application entitled Pulse Detection Scheme for Use in Real Time Spectrum Analysis filed on Jul. 14 2004.

The snapshot buffer collects a set of raw digital signal samples useful for signal classification and other purposes such as location measurements. The snapshot buffer can be triggered to begin sample collection from either the signal detector or from an external trigger source such as a signal from the processor to capture received signal data for a period of time sufficient to include a series of signal exchanges used for location processing explained hereinafter. Alternatively the snapshot buffer will be in a free running state continuously storing captured and then in response to detecting the first signal e.g. the Probe Request frame the snapshot buffer is put into a post store mode that extends long enough to capture the ACK frame signal data.

The traffic monitoring section monitors packet activity in a wireless network e.g. a WLAN and sends and receives certain packets that are used for location measurement processes. For example as described hereinafter a sensor may transmit an 802.11 Probe Request frame data frame or request to send frame that may be addressed to the device to be located. Included in the traffic monitoring section are a radio transceiver comprising a transmitter Tx and a receiver Rx and a baseband signal processor . The radio transceiver and baseband signal processor may be part of a package chipset available on the market today such as an 802.11 WLAN chipset for any one or more of the 802.11a b g or other WLAN communication standards. The baseband signal processor is capable of performing the baseband modulation demodulation and other PHY layer functions compliant with the one or more communication standards of interest e.g. IEEE 802.11a b g h etc. . An I F couples the baseband signal processor and radio transceiver to the processor .

There may be other traffic monitoring sections in the sensor to monitor communication protocol type activity of other types such as Bluetooth communications.

The processor performs the various processing algorithms described herein on the output of the SAGE and on received packets from the traffic monitoring section . The processor I F of the spectrum monitoring section and the processor I F of traffic monitoring section may be a Mini PCI or PC Card e.g. Cardbus interface or any other interface known in the art. While not shown in there is also an LAN interface block e.g. Ethernet that is coupled to the processor to enable the sensor to communicate with the server with a wired LAN connection. The processor may generate signals to control the radio independently of the radio transceiver such that spectrum monitoring is occurring on one channel while protocol monitoring is simultaneously occurring on another channel for example.

It is envisioned that a WLAN AP may include all of the functionality of a sensor described above and may be switched between AP operating mode and a sensor operating mode.

Turning to a high level diagram is shown of the major functional blocks in the sensor and server as well as the interfaces between the sensor and server and between client applications and the server . In the sensor there are functions performed by the processor executing one or more software programs including a measurement engine a classification engine a location engine and a protocol engine . The measurement engine and classification engine operate on RF data from the SAGE . The location engine operates on raw received signal data obtained by the SAGE and the protocol engine operates on packet data generated by the baseband signal processor .

The server may run on a dedicated server box or it may be integrated with other servers such as WLAN switches authentication servers or management servers. There are high level services low level services and interface services . The high level services include a database discovery manager performance manager and security manager . The low level services are invoked by one or more or the high level services and include an RF manager location manager and protocol manager . The interface services include an SNMP agent a Syslog interface and a web interface . The server interfaces with the client applications by an application programming interface API called the intelligent spectrum management interface ISMI .

The functions provided by the server can be summarized as follows. The server manages all of the sensors it communicates with. It aggregates data from the sensors performs analysis on the data and presents the data in formats amenable to other network management entities

The measurement engine software in the sensor is responsible for communicating with the SAGE driver software to configure the SAGE in the sensor . In addition the measurement engine manages the resources of the SAGE between spectrum monitoring functions and device location functions. The measurement engine also collects and aggregates data from the SAGE into meaningful units. The functions of the measurement engine and classification engine may be incorporated into a single functional block. Furthermore the measurement engine may configure reporting of data and statistics generated by the SAGE and adjust the frequency channel and or scan rate on which the SAGE operates. The measurement engine may also operate the radio receiver in the sensor in a wideband mode to simultaneously process data across an entire unlicensed frequency band of interest. The measurement engine produces the spectrum activity data from raw spectrum analysis and snapshot buffer data output by the SAGE . The spectrum activity data simply put comprises data represents one or more of time frequency and power of radio frequency energy received in a portion or all of a frequency band.

One function of the measurement engine is to control which bands are monitored and to produce streams from spectrum analyzer statistics SA STAT and pulses produced by the SAGE. A SA STAT stream consists of one or more of maximum power average power and average duty cycle.

A pulse histogram stream provides histogram data on attributes of pulses detected by the sensor including histograms for center frequency bandwidth duration inter pulse gap e.g. start to start and power.

In addition the measurement engine produces air quality AQ metrics that measure different attributes of a given channel . The channels can be any requested range of frequencies and might include an entire band if so desired. There are also protocol related AQ metrics derived by the server from the protocol monitoring records produced by the protocol engine in a sensor.

Although many of the previously described measurements can be decimated over longer time intervals to reduce network bandwidth the AQ metrics are intended for longer statistical measures and would normally be enabled for intervals in the range of once a minute as an example.

Maximum Power Derived from the SA STATs this is the maximum power measurement in any bin for the channel.

Average Power Derived from the SA STATs this is the average of average power measurement across all bins for the channel.

Duty Cycle For all pulses that overlap the channel it is the measure of the time that 1 or more pulses are present divided by the time spent monitoring this channel normalized for overlap of dwell with channel . A configurable IFS setting can be used to approximate impact on CSMA CA protocols such as 802.11. This extends the pulse durations for a configured additional back off time before treating the channel as inactive.

Pulses Per Second For all pulses that overlap the channel this is the total number of pulses divided by the time spent monitoring this channel normalized for overlap of dwell with channel .

Average Pulse Duration For all pulses that overlap the channel this is the average of the pulse durations.

An AQ stream request can specify up to 32 frequency ranges to take measurements over an IFS value described for duty cycle and a bitmap of requested metrics.

To summarize each sensor s AQ measurements will consist of the following statistics for each configured frequency range over a period of time longer than that provided by the SA STATs 

Sensors will send a continual background air quality statistic stream to the server to be stored in the database. In the case of the protocol portion of the air quality statistics the server computes the noted statistics from the packet analysis data produced by the protocol engine in the sensor. The use and analysis of the air quality data is described further hereinafter.

The classification engine classifies identifies signals occurring in the frequency based on the output of the SAGE . Examples of signals that the classification engine may identify include Bluetooth signals microwave oven signals cordless telephones wireless headsets radar etc. Techniques for signal classification are described in greater detail in U.S. patent application Ser. No. 10 246 364 filed Sep. 18 2002 entitled System and Method for Signal Classification of Signals in a Frequency Band U.S. patent application Ser. No. 10 420 362 filed Apr. 22 2003 entitled System and Method for Classifying Signals Occurring in a Frequency Band and U.S. patent application Ser. No. 10 628 603 filed Jul. 28 2003 entitled System and Method for Classifying Signals Using Timing Templates Power Templates and Other Techniques. The classification engine may generate events at a configurable update rate associated with identified signals and may further make a generalized air quality analysis of the frequency band given the type of signals determined to be occurring in the frequency band.

There are several types of classification events that indicate why a message has been sent. These types include the following.

Up A device has been detected and has met some minimal confidence level. The measurements include all pulses received until the record is generated.

Down A device is no longer detectable. This may result because the device has stopped transmitting that its transmissions are below the sensor s detection sensitivity that the template has been unloaded or that monitoring of the band has been cancelled. The measurements include all pulses since the last event record for this instance and under some cases there may have been no pulses since the last record.

Periodic Update Since an instance may persist for an extended period of time and the measurements may vary over that interval the SMC can be directed to produce periodic measurement records. The measurements include all pulses since the last event record for this instance.

Instance ID This is a unique ID assigned to each new instance as it is classified. It can be used to match Update and Down events with the matching Up event.

Template ID This identifies the template used to classify the device. This implies the name version and framework ID to the server.

Examples of the statistics and events output by the measurement engine and classification engine are described hereinafter.

The location engine in the sensor is responsible for capturing received signal data that is used to compute the location of devices operating in a space in which the sensors are positioned. Many location or position techniques are known in the art such as time of arrival TOA time difference of arrival TDOA power of arrival POA or received signal strength RSS data. The location engine makes measurements on received signals from the device to be located and perhaps from another sensor device and sends those computations to the server where the location computation is made. For example the location engine may be employed to process data based on received signals from 802.11 devices clients or APs in order to locate their positions as well as other non 802.11 devices operating in the relevant frequency band s and which would potentially interfere with 802.11 communication protocol activity. In so doing the location engine negotiates access to the snapshot buffer of the SAGE to capture raw received signal data by sending a request to the measurement engine .

The protocol engine captures data pertaining to packets transmitted over the air in accordance with a communication protocol such as the IEEE 802.11 protocols. This data is referred to as protocol activity data and is useful to indicate the performance of communication occurring according to the communication protocol The baseband signal processor section of the sensor may operate in a promiscuous mode by which it can receive packets sent by any device on a particular 802.11 channel but may not have access to the content of packets . In this manner the sensor can develop statistics about the type of packets being sent the volume of packet traffic packet retransmissions intruding APs or STAs etc. Upon receiving a packet the protocol engine collects statistics on the packet on a per channel per device or per BSSID basis. Then it applies a configurable user defined filter to the packet for purposes of generating statistics. If the filter passes the packet it is sent to the server for further processing otherwise it is bit bucketed. For example the filter may be configurable with a Boolean expression of packet characteristics. Examples of the statistics and events output by the protocol engine are described hereinafter. The protocol engine is responsive to a service configuration Config message from the server to configure how to capture and report protocol information. In addition the protocol engine performs functions to support location determination of other devices such as scheduling the transmission of a reference packet that is used in TDOA location computations.

The protocol engine configures the process by which the sensor scans 802.11 channels to obtain packet information. The channel scan parameters may include channel selection dwell time on the channel hop pattern between channels measurement intervals etc.

Finally the protocol engine configures criteria for protocol based asynchronous alerts associated with network performance or security or sensor operational conditions according to corresponding threshold based alarm criteria. Examples of techniques useful for protocol based intrusion detection and address spoofing are described in the paper entitled Layer 2 Analysis of WLAN Discovery Applications for Intrusion Detection Joshua Wright Nov. 18 2002 and in the paper entitled Detecting Wireless LAN MAC Address Spoofing Joshua Wright Jan. 21 2003. These papers are available from the Internet using a suitable search engine and their entirety is incorporated herein by reference.

The capabilities of the sensor shown in may be incorporated into a client device such as an 802.11 WLAN client device that may be mobile device in the sense that it may move about a space. For example the client device may be a laptop computer wireless voice over IP phone etc. The term client is to denote a device that is a client with respect to a WLAN AP. Other terms for this type of device may be a remote device unit or station or mobile device whereas an AP may also be called a base device unit or station. In this case the traffic monitoring section would handle all 802.11 communications and the spectrum monitoring section would handle the real time spectrum analysis together with the processor which would handle the software functions described above for measurement classification location etc. Alternatively the spectrum monitoring section and traffic section may share the same 802.11 radio. A client station so equipped can generate spectrum measurement data signal classification pulse events pulse histograms stream spectrum analysis statistics and air quality statistics based on the RF environment it experiences as it moves about. There are advantages to such an enabled client station one of which is described below in conjunction with . Similarly these capabilities may be incorporated in a WLAN access point AP device.

The database provides physical storage of spectrum information events protocol information and related information generated by the sensors. In addition the database maintains configuration information pertaining to the functions in the server and many functions in the sensors. A database schema is defined for the storage of this information and is described hereinafter.

The discovery manager in the server processes data pertaining to the discovery of new devices operating in the frequency band such as 802.11 and other devices and the physical location of those devices. Discovery involves handling reports from sensors concerning the up and new and down state of such devices. Also multiple sensors may see the same 802.11 device coming up. The discovery manager detects and suppresses the duplicate event. A discovery event associated with an 802.11 device may fall into one of the following classes ours known others new and rogue. To this end the discovery manager may maintain a list of authorized APs and STAs so that when a new device is detected by a sensor the discovery manager can determine whether or not it is authorized. Alternatively the security manager described hereinafter could be the software process that maintains the list of authorized devices and determines the status of newly discovered devices.

Similarly the discovery manager also processes data pertaining to known and unknown interferers and handles associated events including up down new and duplicate suppression. The sensors report on new known and unknown interferer devices. Also multiple sensors may see the same known and unknown interferer device coming up and the discovery manager suppresses the duplicate event.

The discovery manager executes a scan policy. When a new device is discovered and is in the management domain of the server a request is made to the location manager to determine the location of the device.

Finally the discovery manager handles event action association. Given an event e.g. when a new AP comes up the discovery manager initiates one or a series of actions i.e. check whether the server should manage that device and if so locate it etc. .

The performance manager manages performance issues concerning the operation of wireless networks under the domain of the server in the shared frequency band. One such function is based on the air quality analysis by which the performance manager generates an air quality analysis that may indicate to the user overall network and spectrum air quality.

The performance manager also sets a variety of thresholds which if crossed generates alarms. For example an alarm may be generated if an AP has too many associated STAs etc.

The security manager in the server is responsible for managing security of one or more wireless networks operating in the frequency band under its domain. One type of security function is rogue AP detection. In rogue AP detection a user can specify which APs are inside a security perimeter of the server and are authorized to operate in that security perimeter based on IP or MAC address. Sensors report the APs and STAs that they detect. The security manager processes these reports and determines whether an AP that is not authorized to operate inside the security perimeter has been detected. If so then the security manager generates an alarm indicating the presence of a rogue AP. A sensor detects the presence of an AP. The security manager has the responsibility to declare the detected AP a rogue.

A client application user can specify the parameters of the security perimeter. The security manager configures the security perimeter accordingly which may be a polygon or volume region specified by the user. Inside this perimeter are the devices that the user wants to protect. The security manager may generate an alert when a device physically located outside the security perimeter accesses a WLAN that is located inside the security perimeter. Conversely the security manager may generate an alert when a device physically located inside the security perimeter accesses or sends data to a device outside the security perimeter or associates with an AP outside the security perimeter. Moreover a client user can give a particular device operating within the domain of the server a fixed location attribute. The security manager detects whenever that fixed location device moves and reports it or generates an alert.

The security manager may also use trend information to detect suspicious protocol usage. A sequence of packets that meets certain filter characteristics might be deemed to be suspicious. For example suspicious activity may be alerted when a sensor detects repeated attempts to associate with an AP using different MAC addresses. Alternatively something more subtle that may be deemed suspicious is if a sensor detects packets from a particular STA that have non sequential sequence numbers potentially suggesting that a device user is masquerading as a particular STA. Another example is a probe packet that matches a signature of a well known piece of hacker software such as NetStumbler. These types of activities need to be monitored at the sensor since it requires examination of detailed packet traces. The security manager responds to suspicious protocol activity reports sent by sensors.

Another high level server service is a correlation engine . The correlation engine correlates protocol data and or spectrum data and AQ metrics derived therefrom with location. generally illustrates how the correlation engine correlates protocol data and or spectrum data produced either by the sensors or by suitably enabled client stations with location data pertaining to the sensing of the protocol data and or spectrum data. Protocol data and spectrum data may be allocated to database fields managed by the server database application and the correlation engine keeps track of the location of the spectrum enabled client devices which are in many cases move throughout a space that supplied the spectrum and or protocol data or keeps track of the client devices that provoked the protocol data sensed by the sensors. The time of occurrence associated with detection of the spectrum protocol and location data is also noted when stored in the database and useful during correlation.

Turning to a first correlation scheme is shown for correlating location data with data gathered by one or more sensors. In this scheme protocol data derived by the sensors is correlated with locations of one or more client 802.11 devices. The protocol data provoked by the client devices is captured by the traffic monitoring sections of the sensors and meanwhile the server is also initiating location operations with the sensors to track the location of the client devices.

In step the sensors detect received RF energy demodulate the energy and derived supply protocol data. The protocol data is described above and from the protocol data metrics may be produced at the sensors or the server that include the AQ statistics such as average 802.11 data rate number of simultaneous different client stations detected percentage of 802.11 retries etc. This data is transferred from the sensors to the server and logged into the database in step in association with the time of occurrence. Packets from to the client station whose location is being tracked may be noted as well to facilitate correlation of the corresponding protocol statistics with the location of that station. As noted in step it is also possible that spectrum data generated by the sensors in association with the activity provoked by the client devices may also be transferred to the server and logged into the database in step .

In step the locations of the client stations are tracked. This is achieved by the server interacting with the sensors to perform the location operations described above. The server will store the location data in the database.

Steps and are performed continuously to update the locations of the client devices locations over time together with new protocol and or spectrum data. The data produced by steps and is logged into the database in step .

In step the server correlates the protocol data received from the sensors with the location of the devices that provoked the protocol traffic activity in order to ascertain characteristics of the protocol traffic in the physical locations of the devices. In particular protocol related metrics derived from the protocol data such as average data rate number of client stations and number of packet resends are correlated with the physical location of the client devices. As a result protocol data characteristics and metrics may be displayed on a map correlated in space and time with the physical locations of the devices that provoked the protocol data as represented by step . Similarly in step spectrum data and related characteristics detected by one or more sensors may also be correlated in time with the position of the devices that provoked that data.

The correlation techniques described above in connection with are useful to automatically and dynamically provide a real time site survey of a space where wireless radio activity is occurring. Correlating the protocol and or spectrum data collected by the sensors or client devices with location allows for a visual display of information relevant to the performance of a wireless network such as an 802.11 WLAN. In addition the correlated data may be stored over time to allow for later playback of the correlated data for user specified time intervals with controls being provided by a graphical user interface to set a start time play pause rewind and fast forward.

The types of spectrum and protocol data that may be detected and correlated with location are not limited to those associated with AQ metrics described above. Moreover the spectrum and protocol data may be associated with one or more 802.11 channels or the entire frequency band of interest rather than a specified frequency range or channel. Examples of other types of spectrum data are power average or maximum versus frequency in a graphical plot for a sub band channel or entire band number of non WLAN interferer signals detected or classified pulse histograms pulse duration pulse bandwidth pulse center frequency pulse gap histogram or any other spectrum related data that can be derived from received radio frequency energy by one or more sensors or one or more client devices. Protocol data may comprise any data that may be derived from protocol analysis performed on packets detected by one or more of the sensors or client devices. For example protocol data may include per observed BSSID 

An example of how this data may be displayed against a map of a space is shown in which is described in conjunction with . The solid lines in the map represent walls that delineate rooms such as offices from corridors in a building. The dotted lines form a grid that overlays the map. By clicking in a cell in the grid protocol and or spectrum data may be displayed for that corresponding cell or for the closest cell for which data is available. Alternatively data may be displayed anywhere along the movement path of a device as shown for example by client devices 1 and 3 . While the space in is shown as a two dimensional space it should be understood that it may be a three dimensional space such as a multi story building in which case the sensors are deployed on each of the floors of the building.

Turning to a process for controlling the display of the correlated information is shown. In step a location on a map is selected for display of correlated data spectrum and or protocol data . In step a frequency range and or channel is selected for display of data. The entire band may be selected for display of data. In step a time basis is selected for display of data such as current real time data or a specified time in the past with or without a playback feature. The playback feature of spectrum or protocol data is described more fully on co pending and commonly assigned U.S. Application No. 60 556 513 filed Mar. 25 2004 and entitled User Interface and Display of Data in a Server and Multiple Sensor System that Monitors Activity in a Shared Radio Frequency Band. In step the protocol and or spectrum data according to the parameters selected in the previous steps is displayed in either a text view or a plot view.

The RF manager is responsible for aggregating and logging signal classification events from the classification engine in a sensor and for aggregating and logging spectrum statistics and raw spectrum information from the measurement engine . The RF manager may also supply new or update existing classification templates or reference files to each sensor that the classification engine uses to classify RF signals.

The location manager in the server handles the location processing to determine a location of a device operating in the frequency band. Location of a device WLAN or interferer can be a driving point for other analysis particularly security analysis. The location manager selects a group of sensors e.g. 4 sensors for a location measurement operation to locate a particular device. Each location operation usually needs several sensors working in concert. The location manager selects the subset sensors to be used in a location operation. An example of a location process using time difference of arrival techniques is disclosed in commonly assigned and co pending U.S. application Ser. No. 10 409 563 filed Apr. 8 2003 referred to above. An example of a RSS location process is described in commonly assigned and co pending U.S. Provisional Application No. 60 582 317 filed Jun. 23 2004 entitled System and Method for Locating Radio Emitters Using Self Calibrated Interpolated Path Loss Computation. The entirety of these prior applications is incorporated herein by reference. Many other TOA TDOA RSS and other location techniques are known in the art. The location manager dispatches location request messages to each of the sensors that are to be part of the location operation. Each sensor generates TDOA or RSS information with respect to their respective receipt of the signals from the target device to be located and sends this information in a message to the location manager . The location manager performs the final calculations from the TDOA or RSS information to compute the location of the device that is the subject of the location request. The location manager may have a configurable retry policy for a failed location operation.

The protocol manager in the server is responsible for logging the captured packets by the various sensors into a log file for later processing. There may be a time sync difference between sensors. Different sensors come up power up at different times and do not have a concrete time of day concept. They have a notion of ticks with respect to which the server software needs to normalize. For example sensor 1 s tick 30 may represent the same instance of time as sensor 2 s tick number 1000. The protocol manager software accounts for such skews.

The protocol manager may also provide aggregate packet statistic streams to a requesting client application. The protocol manager synchronizes the packet arrival from different sensors into a common time line. That is packets captured at the same time in two different sensors may reach the server at a certain time skew. The protocol manager ensures that this time skew does not affect the packet traces. The protocol manager also detects when multiple sensors may see the same packet and report it to the server and remove the duplicate packet.

A set of filters may be used to configure background and real time filtering of packets as well as configuring the size of the background log and are executed by the protocol manager .

In sum a method is provided for monitoring wireless activity in a radio frequency band comprising receiving radio frequency energy at each of a plurality of known positions in a space determining positions in the space of one or more devices emitting radio frequency energy in the space from the received radio frequency energy at the plurality of known positions generating activity data representing characteristics of received radio frequency energy in the space and correlating the activity data with the positions in the space that are associated with provocation of the activity data.

Similarly a system is provided comprising a plurality of sensor devices each at a corresponding known position in a space each sensor device receiving radio frequency energy at their corresponding known position a computing device coupled to the plurality of sensor devices wherein the computing device determines positions in the space of one or more devices emitting radio frequency energy in the space from the radio frequency energy received by the sensor devices at the known positions and correlates the activity data representing characteristics of received radio frequency energy with positions in the space associated with provocation of the activity data.

Further a method is provided for monitoring wireless activity in a radio frequency band comprising computing positions in a space of one or more devices emitting radio frequency energy in the space from radio frequency energy received at a plurality of known positions and correlating the activity data representing characteristics of received radio frequency energy in the space with positions in the space that are associated with provocation of the activity data.

