---

title: Enhanced security memory access method and architecture
abstract: A memory device includes: at least one storage area for storing data; a protection control structure adapted to selectively allow an external device access to the at least one storage area of the memory, the storage area being not freely accessible by the external device if protected; a control logic adapted to identify an access request by the external device to the at least one storage area and cooperating with the protection control structure for managing an unlock procedure for selectively granting the external device at least temporary access rights to the storage area if protected; means for providing a first code to the external device in said unlock procedure; means for receiving a second code from the external device in response to said first code; means for verifying validity of the received second code. The means for verifying validity are adapted to ascertain a correspondence of the second code with the first code based on a predetermined relationship. The control logic instructs the protection control structure to grant access to the storage area if the validity of the received second code has been verified. The first code issued by the memory device to the external device upon receiving an access request is changed after performing predetermined number of unlock procedures.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08276185&OS=08276185&RS=08276185
owner: Micron Technology, Inc.
number: 08276185
owner_city: Boise
owner_country: US
publication_date: 20060119
---
This application claims priority from European patent application Nos. EP05100310.1 and EP05100308.5 both filed Jan. 19 2005 which are incorporated herein by reference.

This application is related to U.S. patent application Ser. No. 11 336 411 entitled METHOD AND ARCHITECTURE FOR RESTRICTING ACCESS TO A MEMORY DEVICE which has a common filing date and owner and which is incorporated by reference.

The present invention relates generally to the field of integrated circuits and more specifically to semiconductor memories.

In the field of semiconductor memories flash memories have become rather popular because they combine the capability of storing relatively large amounts of data with the possibility of modifying their content directly in the field.

Flash memories are for example used to store the code to be executed by data processing units e.g. microcontrollers microprocessors coprocessors digital signal processors and the like in a variety of electronic apparatuses such as personal computers mobile phones digital cameras set top boxes for cable or satellite or digital terrestrial television just to mention a few.

In particular using flash memories it is possible to modify the stored code without having to remove the memory component from the respective socket. It has thus become possible to e.g. change the code fix code bugs update the code version directly at the premises of the users the new code can be for example downloaded over the internet or received directly by the mobile phone from the service provider company.

There are applications in which these possibilities offered by flash memories raise problems of security. Electronic piracy acts may for example cause the code stored in the memory to be read without authorization or to be corrupted.

Referring to a conventional flash memory the modification of the data stored in the memory is related to the erase and program operations. Stored data can be shielded from undesired read erase and program operations by means of particular protection arrangements that allow to selectively protect unprotect distinct sectors of the memory. For example U.S. Pat. No. 5 974 500 describes a non volatile memory device comprising a set of first access control bits to control the access authorization to perform the operations of erasing programming and reading to the memory array and a set of second control bits to control write access to the first access control bits in such a way to consent to the changing of the memory access authorization. Every time the external devices request an access operation to the memory they must provide their access authorizations thereto. In fact according to this solution to access a protected memory zone it is necessary to change the memory access authorization however this change is performed without any particular security protocol simply by issuing on the part of the external device a request to modify the access authorization there is no control on which device is requesting to change the access authorization scheme.

Therefore in view of the state of the art outlined in the foregoing a need has arisen for a technique to implement security in a semiconductor memory and particularly in respect of aspects relating the grant of access authorization to external devices in an efficient way assuring a high level of security.

According to an embodiment of the present invention a memory device includes at least one storage area for storing data and a protection control structure adapted to selectively allow an external device access to the at least one storage area of the memory. Such storage area is not freely accessible by the external device if protected. The memory device further includes a control logic adapted to identify an access request by the external device to the at least one storage area and to cooperate with the protection control structure for managing an unlock procedure for selectively granting the external device at least temporary access rights to the storage area if protected. The memory device further includes means for providing a first code to the external device in said unlock procedure means for receiving a second code from the external device in response to said first code and means for verifying validity of the received second code. Said means for verifying validity are adapted to ascertain a correspondence of the second code with the first code based on a predetermined relationship and said control logic instructs the protection control structure to grant access to the storage area if the validity of the received second code has been verified. Said first code is changed after performing a predetermined number of unlock procedures.

According to another embodiment of the present invention a method to allow access to a memory device by an external device includes receiving at the memory device an access request to a selected storage area by the external device in case the selected storage area is not a freely accessible area performing an unlock procedure. Said unlock procedure includes having the memory issuing to the external device a first code at the external device receiving the first code and responsive thereto sending to the memory device a second code depending on the first code at the memory device at least temporarily unlocking the selected storage area to allow access thereto by the external device based on the received second code.

Said first code issued by the memory device to an external device upon receiving an access request is changed after performing predetermined number of unlock procedures.

Other embodiments of the present invention regard an electronic device adapted to interact with a memory device of the previous embodiment and an electronic system including such a memory device and electronic device.

With reference to the drawings is a diagram that illustrates in a simplified way a dialoguing sequence between a memory device and an electronic device in the example a microprocessor external thereto implementing a memory access method including an access protocol scheme according to an embodiment of the present invention. The memory device includes a memory matrix of memory cells forming the storage area of the memory and several devices that contribute to its functioning that are not shown in being either known per se or described later on in connection with . The memory matrix is divided into a plurality of n memory zones each one including a corresponding plurality of memory cells. The external microprocessor represents any electronic system intended and adapted to interact with the memory device . The external microprocessor may for example control the memory device in such a way to require the reading of particular data stored in selected groups of memory cells thereof. More particularly the dialoguing sequence illustrated in the figure relates to a case wherein an address of the memory cells that are to be accessed by the external microprocessor for reading the stored content corresponds i.e. falls in a range of addresses corresponding to a protected memory zone of the memory matrix . By protected memory zone there is intended a zone of the storage area of the memory device that is not freely accessible by e.g. external devices in particular the dialoguing sequence includes a sequence of operations adapted to unlock the protected zone of the memory device said unlock operations sequence enabling the external microprocessor to obtain the right of accessing in reading the addressed memory cells belonging to the protected memory zone .

Quite schematically the external microprocessor executes a read add operation on the memory device for requesting the memory device to read the content of the memory cells of the memory matrix corresponding to the address add.

Let it be assumed that the address add provided by the external microprocessor corresponds to a protected memory zone of the memory matrix i.e. according to the definition given above a memory zone that is not freely accessible. The memory device denies the reading access to the external microprocessor and wrong data are for example provided the microprocessor can recognize that the data are wrong by checking the data validity in a status register .

Once the external microprocessor has realized that the reading access has been denied it triggers an unlocking sequence directed to be granted access right to the protected memory zone and obtain the reading of the data stored in the memory matrix in the location s corresponding to the specified address add. In particular the unlocking sequence is started by the external microprocessor requesting the memory device provide a code which the microprocessor will use to generate an unlocking password. The memory device for example generates a random number RND e.g. 64 bit long and makes it available to the microprocessor .

The external microprocessor encrypts the received code RND by means of a predetermined encryption algorithm e.g. a DES Data Encryption Standard algorithm using a predetermined encryption key obtaining as a result an encrypted code des data crypt for example of 64 bits which is an encrypted version of the code RND issued by and received from the memory device the encrypted code des data crypt will be exploited as an unlock password that the microprocessor provides to the memory device for being granted the access authorization. From now on for the purposes of the present description by encryption process there is intended a process of encrypting and or decrypting data. Once the encryption of the code RND has been completed the external microprocessor communicates to the memory device that it is ready to convey the unlock password by means of an unlock pwd cmd command. Subsequently the external microprocessor sends to the memory device the unlock password des data crypt.

The memory device decrypts the received password des data crypt using a suitable decryption algorithm e.g. the DES algorithm and a decryption key which may be stored therein for example in the memory matrix preferably in a protected non externally accessible area thereof or in a separate storage area non accessible to the external user. The decryption of the received password des data crypt produces a code e.g. 64 bit long which is used by the memory for establishing whether or not the external microprocessor is authorized to access the protected memory zone . The external microprocessor is granted access right and allowed to read the data stored in the addressed location s of the protected memory zone of the memory matrix if the code obtained by decrypting the password des data crypt is equal or generally corresponds to the previously generated code RND in this case the memory device unlocks the protected memory zone. This in fact means that the encryption algorithm and encryption key used by the external microprocessor to encrypt the random number RND are the same as or corresponds to those used by the memory device to decrypt the password des data crypt and thus the memory device recognizes that the external microprocessor is authorized to read the data stored in the protected memory zone of the memory matrix .

After unlocking the protected memory zone the memory device reads the addressed memory cells and makes the requested valid data available to the external microprocessor .

The dialoguing sequence described above provides a significant security because a protected memory zone is not unlockable by whichever external device i.e. it cannot be rendered freely accessible but only by authorized ones having been provisioned of the necessary right in particular in term of tools algorithm key for encrypting codes sent by the memory.

According to an embodiment of the present invention for an increased security the unlocking operations sequence up to now described provides to external devices e.g. the external microprocessor only a temporary i.e. limited in time authorization to read the locations belonging to the protected memory zone which has been unlocked. In fact after a predetermined time interval int for example of the order of some milliseconds e.g. 5 ms the protected memory zone that has been unlocked returns to a protected states and the memory device inhibits any further reading access and data transfer to the external microprocessor possibly signaling thereto that the validity of the code RND and thus of the password des data crypt is expired. Consequently access requests received by the memory after the expiration of the access authorization to the protected memory zone are again denied the memory device sends to the external microprocessor mem zone prot replies .

Preferably for an even increased level of security the expiration of the access authorization to the protected memory zone corresponds to an expiration of the validity of the unlock password des data crypt that the external microprocessor provided to the memory device for unlocking the protected memory zone and the memory device locks again the reading access to the addressed memory cells.

To be granted again the authorization of accessing the protected memory zone or another protected memory zone authorization the unlocking operations sequence described above is repeated preferably having the memory generating and providing to the external microprocessor a new code RND. The external microprocessor encrypts again the newly received code RND thus obtaining a new unlock password des data crypt to be sent to the memory device . Once the new password des data crypt is received the memory device decrypts it and verifies if the obtained decrypted code is equal corresponds to the new code RND and based on the outcome it grants or not the external microprocessor the access authorization to the addressed memory cells.

In this way the reading access to the data stored in the locked zones of the memory matrix needs a confirmation after a predetermined time interval. Moreover the expiration of the unlock password for example in consequence to the fact that the code RND generated by the memory device changes in reply to successive unlock requests makes a fraudulent access for example by determining the encryption key very difficult.

Referring now to a simplified functional block diagram of the memory device according to an embodiment of the present invention is illustrated. It is pointed out that only the functional blocks involved in a reading operation on the memory are shown and for simplicity of the drawing signals and corresponding physical lines carrying them are denoted with the same reference numerals.

The memory device interacts with the external environment by means of a plurality of data input output I O pads for receiving outputting data and command codes and of address pads for receiving address codes adapted to select locations i.e. memory cells in the memory matrix . The pads and are connected to an input block including input buffers for the addresses and the data. The input block is connected by means of a bus of lines identified as command in the drawing to a Command User Interface CUI and it is further connected by means of a bus of lines labeled add to an address decoder and selector block adapted to receive address codes provided for example by the external microprocessor over the bus command a generic command received by the memory for example from the external microprocessor is conveyed to the CUI which decodes the command so as to determine a proper operations sequence among the others the CUI receives and decodes the command unlock pwd cmd sent by the external microprocessor when it is ready to send the unlock password des data crypt to the memory device .

The memory matrix includes a plurality of memory cells not shown in the drawing arranged in rows and columns controlled by bit lines and word lines respectively. The address decoder and selector block receives from the input block the address add corresponding to the memory cells that are to be read and selects them by means of wordline selection signals wl and bitline selection signals bl. The selected bitlines normally a packet of e.g. eight or sixteen or more bit lines is selected at a time depending on the degree of parallelism of the memory are connected to a sense amplifier block . The sense amplifier block receives memory cell current values corresponding to the states of the selected memory cells and provides an amplified full logic version thereof to a data output block that is connected to the outside by means of the input output pads .

The memory device further includes a logic block interacting with the CUI and responsible of the management of the operations necessary to the functioning of the memory device .

The memory device includes a code generator block e.g. a random number generator adapted to generate random numbers for generating the 64 bit code RND used during the dialoguing sequence between the memory device and the external microprocessor . The code generator block is controlled by the logic block and is for this purpose depicted as connected to the data output block by means of a bus of lines.

The logic block is connected to a memory zone lock unlock block adapted to manage the protection of the memory zones and to allow inhibit access thereto according to their protection status. In particular the lock unlock block is adapted to check if a received address add corresponds i.e. falls in a range of addresses corresponding to a protected memory zone and in the affirmative case to inhibit the access to the data stored in the addressed memory cells for example by controlling the output block so as to selectively enable disable the transfer of the read data from the sense amplifier to the input output pads .

The logic block further interacts with a DES block including an ensemble of circuital elements and possibly program instructions adapted to implement the encryption decryption operations of a DES algorithm. The DES block interacts with the memory matrix for receiving the decryption key stored therein and with the input block for receiving the unlock password des data crypt.

The memory device further includes a comparator block controlled by the logic block adapted to receive from the DES block the decrypted version of the unlock password des data crypt and from the code generator block the code RND.

Under the control of the logic block the DES block loads the decryption key read from the memory matrix and the unlock password des data crypt received from the external microprocessor and starts a decryption process to obtain a e.g. 64 bit code des data decrypt representing a decrypted version of the unlock password in particular in the exemplary embodiment of the invention herein described such a decryption process includes decrypting the received encrypted password des data crypt using the decryption key according to a sequence of mathematical operations implementing the DES algorithm. When the decryption process ends the DES block notifies the logic block and the comparator block . The decrypted password des data decrypt generated by the decryption process is subsequently fed to the e.g. 64 bit comparator block . The comparator block also receives from the code generator block the code RND.

The comparator block compares the decrypted password des data decrypt and the code RND. If the decrypted password des data decrypt coincides with the code RND the comparator block asserts a signal data decrypt eq rnd to inform the logic block of the successful outcome of the comparison.

In this case the logic block asserts a signal pwd unlock that is normally kept deasserted thus instructing the lock unlock block to drive the output block so as to enable the data transfer from the sense amplifier block to the input output pads . The external microprocessor is thus authorized to read the data stored in the protected memory zone in particular the data stored in the location s corresponding to the address add.

If instead the signal data decrypt eq rnd is set to the low logic value meaning that the code des data decrypt and the code RND are not equal the memory device preferably signals to the external microprocessor that the unlock request has not been successful for example issuing a fail notification not shown in the figures . In this case the signal pwd unlock is kept deasserted so the lock unlock block continues to inhibit the data transfer by the output block from the sense amplifier block to the input output pads . These situation may typically arise in case the external microprocessor does not have the authorization to obtain the reading of the data stored in the memory matrix corresponding to the address add not possessing the correct encryption key. Another situation in which this may occur is a possible corruption of the exchanged data code RND unlock password between the memory device and the external microprocessor for example due to disturbs. The external microprocessor may retry preferably for a limited number of times to be granted the read access authorization to the memory matrix repeating the unlocking process for example requesting a new code RND from the memory device .

Referring to a flow chart relating to an illustrative implementation of the operations executed by the memory device and the external microprocessor relating the grant of access authorization thereto is illustrated in a first embodiment of the present invention.

The flow chart progresses between two different lanes . The blocks of the flow chart belonging to the first lane lane represent operations executed by the memory device while the blocks belonging to the other lane lane represent operations executed by the external microprocessor .

In response to the notification by the memory device that memory location s addressed by the external microprocessor belong s to a protected memory zone that is a memory zone that is not freely accessible the external microprocessor issues the unlocking request to the memory device block .

Upon receipt of the unlock request the memory device acquires the code RND from the code generator block block and sends it to the external microprocessor block .

The external microprocessor receives the code RND sent by the memory device and reads it block . Subsequently the code RND is encrypted in such a way to obtain the encrypted password des data crypt block .

The memory device keeps the code RND sent to the external microprocessor in order to use it for verifying the unlock password when the latter will be received from the external microprocessor decision block exit branch N while waiting for the password the memory device may perform other operations .

When the external microprocessor is ready to do so it sends the encrypted password des data crypt to the memory device block .

Once the password des data crypt is received decision block exit branch Y the memory device decrypts the received password des data crypt exploiting the functions of the DES block using the decryption key thus obtaining a decrypted version thereof des data decrypt the decrypted password is then compared with the code RND previously generated and sent to the external microprocessor by means of the comparator block as previously explained block .

Based on the comparison of the decrypted password des data decrypt with the code RND the memory device establishes the validity of the password des data crypt received from the microprocessor . The password des data crypt is to be intended as valid if the decrypted version thereof des data decrypt coincides with or corresponds to the code RND. In the affirmative case decision block exit branch Y the logic block of the memory device instructs the lock unlock block to drive the output block so as to enable the data transfer from the sense amplifier block to the input output pads block .

The logic block of the memory device then controls the code generator block in such a way to trigger the start of the generation of a new code RND block that will be exploited for a possible successive unlocking operations sequence. A change of the code RND implies a change in the unlock password that the memory expects to receive by an external device e.g. the external microprocessor in a subsequent unlock request in this way the validity of a password is limited to a single access only. This increases the degree of security.

Then the memory device reads out and makes the addressed data available to the external microprocessor block which reads the data block .

After the protected memory zone has been unlocked the microprocessor can access the memory one or more times and in between consecutive accesses it can perform other operations thus block in the drawing should be intended to represent one or more read accesses by the external microprocessor to the unlocked protected memory zone of the memory device. As long as a predetermined time interval int is not lapsed the external microprocessor may go on fetching data from the unlocked protected zone of the memory device exit branch N of block .

After the lapse of a time interval int the logic block of the memory device instructs the lock unlock block to drive the output block so as to disable again the data transfer from the sense amplifier block to the input output pads block . Any further read access attempt by the microprocessor is denied by the memory device consequently the addressed data become no more available to the external microprocessor the memory device outputs wrong data the invalidity of which can be detected by the external microprocessor looking at e.g. a status register of the memory thereby the external microprocessor receives knowledge of the fact that the authorization to read is expired. In case the external microprocessor needs to fetch further data from the protected zone of the memory device it may issue another unlocking request to the memory device output branch Y of block with operation flow jumping back to block .

Back to decision block in case the password received from the external microprocessor is found invalid decision block exit branch N the memory device may wait a prescribed time e.g. 10 s for a new password to be received from the external microprocessor decision block then it preferably notifies the external microprocessor of the failure of the unlock operation block . In this last case the external microprocessor is not granted the access authorization to the addressed memory cells the output block inhibits the data transfer from the sense amplifier to the I O pads . The external microprocessor receiving the unlock failure notification decision block may retry preferably for a limited number of times to be granted the access authorization to the memory matrix repeating some operations of the unlocking process for example sending again the unlock password exit branch N of decision block jumping back to the block .

It can be appreciated that the increased security given by the change of code to be sent to an external device by the memory may imply that successive unlock requests may be serviced only provided that they do not take place in a too short time for the new code to be generated by the code generator .

The generation of a new code may take some time especially in the case the code is a random number generated by a random number generator.

Generating a random number involves performing a sequence of mathematical operations. In particular obtaining a random number of sufficient length in bits and with a low autocorrelation value typically necessary for assuring a high level of access security a quite high number of processing steps may be required and the time necessary for generating the new code may easily reach the order of 100 s. Thus a new unlock request may not be serviced until such a time is lapsed. This may in some cases represent a drawback.

Referring to a simplified flow chart according to an embodiment of the invention adapted to overcome the above mentioned drawback is illustrated.

Also in this case the flow chart progresses between two different lanes . The blocks of the flow chart belonging to the first lane lane represent operations executed by the memory device while the blocks belonging to the other lane lane represent operations executed by the external microprocessor .

At the power on of the memory device a power on reset procedure is typically initiated block . The power on typically takes a relatively long time of some hundreds of s in order to permit the correct functioning of some device included in it. For example charge pump voltage boosters embedded in the memory device for generating the voltages required to perform some operations of the memory cells of the memory matrix such as erasing programming and possibly reading may necessitate a relatively long period of time for generating a stable output voltage.

Expediently immediately after the start of the power on for example when the power on reset procedure is started the memory device starts the operations for generating a new code particularly a random number RND block . To this purpose the code generator block is started. It is noted that the duration of the operations of the random number RND generation may be less than or equal to the settling time of the charge pumps of the memory device . However the code generator block may be realized in a way that does not necessitate the voltages usually higher than the supply voltage generated by the charge pumps thus the random number generator may perform the operations to generate the random number code RND during the power on of the memory device saving time. In this way the random number code RND will be immediately ready for the first possible unlock request received after the power on by an external device e.g. the external microprocessor .

When the code generator block has performed the necessary operations the random number code RND is ready to be sent block .

Let it be assumed that at a given time after the memory device power on the external microprocessor tries to access a protected zone of the memory and that the memory device denies access and issues a notification as described in the foregoing in connection with .

In response to the notification that the addressed memory cells of the memory matrix belong to a protected zone the external microprocessor issues an unlocking request to the memory device block .

The random number code RND has already been generated during the power on procedure and is therefore ready to be sent upon receipt of the unlock request by the microprocessor block the memory device acquires the code RND from the code generator block and sends it to the external microprocessor block .

The external microprocessor receives the code RND sent by the memory device and reads it block . Subsequently in the block the code RND is encrypted in such a way to obtain the encrypted password des data crypt.

In a first branch the memory device performs the unlocking operations similarly to the case explained in connection with the flowchart of .

More particularly the memory device keeps the code RND sent to the external microprocessor in order to use it for verifying the unlock password when the latter will be received from the external microprocessor decision block exit branch N while waiting for the password the memory device may perform other operations .

When the external microprocessor is ready to do so it sends the encrypted password des data crypt to the memory device block .

Once the password des data crypt is received decision block exit branch Y the memory device decrypts the received password des data crypt exploiting the functions of the DES block using the decryption key thus obtaining a decrypted version thereof des data decrypt the decrypted password is then compared with the code RND previously generated and sent to the external microprocessor by means of the comparator block as previously explained block .

Based on the comparison of the decrypted password des data decrypt with the code RND the memory device establishes the validity of the password des data crypt received from the microprocessor . The password des data crypt is to be intended as valid if the decrypted version thereof des data decrypt coincides with or corresponds to the code RND. In the affirmative case decision block exit branch Y the logic block of the memory device instructs the lock unlock block to drive the output block so as to enable the data transfer from the sense amplifier block to the input output pads block .

Then the memory device reads out and makes the addressed data available to the external microprocessor block which reads the data block .

After the protected memory zone has been unlocked the microprocessor can access the memory one or more times and in between consecutive accesses it can perform other operations thus block in the drawing should be intended to represent one or more read accesses by the external microprocessor to the unlocked protected memory zone of the memory device. As long as a predetermined time interval int is not lapsed the external microprocessor may go on fetching data from the unlocked protected zone of the memory device exit branch N of block .

After the lapse of a time interval int the logic block of the memory device instructs the lock unlock block to drive the output block so as to disable again the data transfer from the sense amplifier block to the input output pads block . Any further read access attempt by the microprocessor is denied by the memory device consequently the addressed data become no more available to the external microprocessor the memory device outputs wrong data the invalidity of which can be detected by the external microprocessor looking at e.g. a status register of the memory thereby the external microprocessor obtains knowledge of the fact that the authorization to read is expired. In case the external microprocessor needs to fetch further data from the protected zone of the memory device it may issue another unlocking request to the memory device output branch Y of block with operation flow jumping back to block .

Back to decision block in case the password received from the external microprocessor is found invalid decision block exit branch N the memory device may wait a prescribed time e.g. 10 s for a new password to be received from the external microprocessor decision block then it preferably notifies to the external microprocessor of the failure of the unlock operation block .

In this last case the external microprocessor is not granted the access authorization to the addressed memory cells the output block inhibits the data transfer from the sense amplifier to the I O pads . The external microprocessor receiving the unlock failure notification decision block may retry preferably for a limited number of times to be granted the access authorization to the memory matrix repeating some operations of the unlocking process for example sending again the unlock password exit branch N of decision block jumping back to the block .

In parallel to the operations just described the memory device second branch of the flowchart performs the operations necessary for generating a new random number code RND in particular similarly to the operations performed during the power on the memory device starts the operations for generating a new random number code RND block . To this purpose the code generator block is started. When the code generator block has performed the necessary operations the random number code RND is ready to be sent block .

The unlocking operations first branch of the flowchart do not involve the use of the code generator block so the generation of the new random number code can be carried out in parallel to the operations performed in the first branch.

Note that provided the memory is ready to provide to the external microprocessor a random code RND when requested the operations of receiving the password checking the validity thereof reading the accessed locations and providing the read data to the external microprocessor are typically quite fast taking a time which is significantly shorter 1 3 s compared to approximately 100 s than the time that would be needed to generate a fresh random code RND. Thus it is advantageous to provide for having the random code RND be generated prior to the moment it will be required. Considering that after the unlock the protected memory zone may remain unlocked for a relatively long time e.g. 5 ms the new random number code RND is expediently generated during this time period and it thus becomes ready to be sent before the unlock timeout expires possibly during a series of accesses by the external microprocessor .

At the next unlock request for example after the timeout is lapsed and the protected memory zone is locked again this may occur before the microprocessor has terminated reading all the desired locations the external microprocessor has to apply for another unlocking request back to block that will be serviced by the memory device using the new random number code RND previously generated.

It may happen that a new unlock request is received before the completion of the random number code generation in case such a new unlock request is received after the unlock block and before the timeout expires the new unlock request is ignored or delayed by the memory. The new unlock request may however be received before the protected memory zone is unlocked block for example due to miscommunication between the memory device and the external device. In this second case if the new unlock request follows the previous one by a time which has been sufficient for the generation of the random number code the new unlock request can be serviced on the contrary if the delay of the new unlock request from the previous one is too short the new unlock request may not be serviced until the new random number code is generated and ready block .

Referring to an exemplary application of one or more embodiments of the present invention is illustrated. In particular shows a simplified block diagram of an electronic system for example a set top box apparatus adapted to cable or satellite or digital terrestrial television or a DVD player recorder or a mobile communications terminal.

The memory device interacts with the external microprocessor by means of a bus of lines . The external microprocessor includes an input terminal for receiving for example a TV signal IN provided by an antenna or a TV cable and an output terminal for providing for example a TV signal OUT to a TV set . The external microprocessor is also connected to a plurality of communication ports for example a serial port RS232 a modem device and a smartcard reader . The system may include other peripherals such as one or more RAM modules human interface devices e.g. a keyboard a display device a loudspeaker remote control input port .

According to a proposed access protocol according to an embodiment of the invention it is possible to protect reserved code data stored in the memory device from unauthorized reading. Referring for example to a DVD classic consumer system the memory device may store in a protected zone thereof the instructions of a new and efficient algorithm of compression which could give advantages in speed or cost of the system. Given that the same memory device may be used in different DVD systems it may be necessary to shield the data stored therein in an effective way. In the application of set top box the security features provided by one or more embodiments of the present invention give the advantage to protect reserved information made available in the system by a service provider. In this case the additional security provided makes more difficult an unauthorized copying of firmware thus protecting the interests of the service provider itself.

Although the present invention has been described above with a certain degree of particularity with reference to embodiment s thereof it should be understood that various changes in the form and details as well as other embodiments are possible. Particularly it is expressly intended that all combinations of those elements and or method steps that substantially perform the same function in the same way to achieve the same results are within the spirit and scope of the invention.

For example it is possible to change the code after a predetermined number more than one of memory accesses.

Also nothing prevents that different protected memory zones of a memory device may be unlocked exploiting different unlock passwords i.e. in the example previously considered different encryption decryption keys and or different encryption decryption algorithms .

Moreover the memory device may generate the code e.g. the random number and encrypt it and then send the encrypted code to the external microprocessor the external microprocessor may then decrypt the received encrypted code and send back the decrypted code to the memory which then performs a comparison between the generated code and the received code. Stated more generally at least two encryption processes are performed on a code e.g. on the random number generated by the memory device one process at the memory device and another process at the external device wishing to be granted access thereto. Alternatively the microprocessor may re encrypt the received code before sending it back to the memory the re encryption using a different algorithm than the original encryption by the memory device.

