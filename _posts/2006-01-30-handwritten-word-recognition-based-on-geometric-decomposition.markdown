---

title: Handwritten word recognition based on geometric decomposition
abstract: A method of recognizing a handwritten word of cursive script includes providing a template of previously classified words, and optically reading a handwritten word so as to form an image representation thereof comprising a bit map of pixels. The external pixel contour of the bit map is extracted and the vertical peak and minima pixel extrema on upper and lower zones respectively of this external contour are detected. Feature vectors of the vertical peak and minima pixel extrema are determined and compared to the template so as to generate a match between the handwritten word and a previously classified word. A method for classifying an image representation of a handwritten word of cursive script is also provided. Also provided is an apparatus for recognizing a handwritten word of cursive script.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08077973&OS=08077973&RS=08077973
owner: IMDS Software, Inc.
number: 08077973
owner_city: Montreal, Quebec
owner_country: CA
publication_date: 20060130
---
The present application requests priority on U.S. Provisional Application No. 60 647 396 filed Jan. 28 2005 which is incorporated by reference herein in its entirety.

The present invention relates to handwritten word recognition. More specifically but not exclusively the present invention relates to handwritten word recognition based on geometric decomposition.

Handwriting is one of the basic human communication tools such as speech sign and expression. Handwriting has been widely applied in our daily life. For example people sign their signature in bank cheques and letters. Students acquire the knowledge in class when teachers write their lecture notes on the blackboard. Businesses recruit new employees by way of graphology which is the study of handwriting shapes and patterns to determine the personality and behaviour of the writer. Although handwriting is such an efficient communication tool in our mind how handwritten signals are mentally represented in the brain and what kinds of functionality mechanism underlies handwritten recognition is little known to us. Automatic analysis and recognition of handwritten signals by computers can help us better understand this problem to some extent.

The general off line cursive handwritten recognition is a very challenging task although considerable progress 1 2 3 4 5 6 7 has been made in this domain over the last few years. Most recognition systems 8 9 have achieved a good performance which greatly depends on the constraints imposed such as contextual knowledge size of the vocabulary writing style and experimental conditions. Recently an off line cursive recognition system dealing with large vocabulary unconstrained handwritten texts has been investigated 10 . Instead of modelling a word this recognition system models a handwritten line by the integration of Hidden Markov models and N gram word statistical language models in order to avoid the problem of handwritten word segmentation and make efficient use of contextual information. Although authors have shown that the use of language models improves the performance on some databases the computational cost of this system is much higher than that based on an isolated word. It is well known that linguistic information plays an important role in cursive word recognition. From a biological point of view the computational efficiency is as important as the accuracy in a human s recognition system. Therefore the computer based cursive word recognition system where that information is integrated should abide by the principle of computational efficiency.

Although a considerable number of off line cursive handwriting recognition systems have been presented in the literature the solutions to several key problems related to handwritten word recognition remain unknown. One of the most important problems is the representation of a cursive word image for a classification task. Intuitively although a handwritten word is concatenated by a small set of handwritten characters 52 characters in English from left to right its shape exhibits various variations which depend on the uncertainty of human writing. The boundaries between characters in a handwritten word are intrinsically ambiguous due to overlapping and inter connections. The changes in the appearance of a character usually depend on the shapes of neighbouring characters coarticulation effects . In the current literature these representation methods for cursive words usually fall into the categories described hereunder.

The image of the given word is considered as an entity in its whole and the difficult problem of segmenting a word into its individual characters is completely avoided. A word is characterized by a sequence of features such as length loops ascenders descenders. No sub models are used as a part of its classification strategy. The recognition method based on this representation is called holistic approach see a recent survey in 11 . This method can model coarticulation effects. However no uniform framework in the current literature is presented to extract those features. It is not clear how to solve the corresponding problem of feature points if some features are used as local shape descriptors. Moreover the method does not make use of information of sub models. As a result information cannot be shared across different words. It is difficult to apply this method to cursive word recognition with a large lexicon since samples for each word is not sufficient.

The word image is segmented into a sequence of graphemes in left to right order. A grapheme may be one character or a part of a character. After the segmentation all possible combinations of adjacent graphemes up to a maximum number are considered and fed into a recognizer for isolated characters. Then a dynamic programming technique is used to choose the best sequence of characters. There are two problems related to this method. One is that segmentation and grapheme recombination are both based on heuristic rules that are derived by human intuition. They are error prone. The other is that the proposed framework is not computationally efficient since a character recognizer has to be used to evaluate each grapheme combination. For a large lexicon the computational cost is prohibitively high.

Features are extracted in a left to right scan over the word by a sliding window. No segmentation is required. There are two main problems related to this method. One is that some topological information such as stroke continuity will be partially lost. But stroke continuity is an important constraint for handwritten signals. The other is how to determine the optimal width of a sliding window. From a signal viewpoint the method based on a sliding window can be regarded as a one dimensional uniform sampling on a two dimensional signal. In general the sampling width depends on the sampling position. Some information will be lost based on uniform sampling.

The other important problem is how to integrate the orthography or phonology into the recognition system effectively. It is known that orthography and phonology play important roles in human word reading 12 13 . Orthography and phonology impose strong constraints on cursive word recognition. Most of the existing methods use statistical language models such as character or word N gram as a post processing tool in the recognition. These language models are basically built based on a large text corpus. To our knowledge no work is done to investigate how orthographic representations directly develop from primitive visual representations word images visual features .

In the following subsections a general viewpoint of cursive word recognition from several disciplines such as visual perception and linguistics is first presented in order to understand the essential nature of this problem. Then the literature related to word skew slant corrections and word representation is reviewed

How many words are there into English There is no single sensible answer to this question. It is impossible to count all words. English words have many inflections such as noun plural tense of a verb. Is hot dog really two words since we may also find hot dog or even hotdog In addition many words from other languages enter into English. Sometimes new scientific terms will be generated.

In order to obtain an approximated size one can resort to the Oxford English Dictionary. The Second Edition of the Oxford English Dictionary OED 14 contains full entries for 171 476 words in current use and 47 156 obsolete words. To this may be added around 9 500 derivative words included as subentries. Over half of these words are nouns about a quarter adjectives and about a seventh verbs the rest is made up of interjections conjunctions prepositions suffixes etc. These figures take no account of entries with senses for different parts of speech such as noun and adjective . This suggests that there are at the very least a quarter of a million distinct English words excluding infections and words from technical and regional vocabulary not covered by the OED or words not yet added to the published dictionary of which perhaps 20 percent are no longer in current use. If distinct senses were counted the total would probably approach three quarters of a million.

As we know that there is a huge size of vocabulary it is impossible to work on all word entries in the Oxford English Dictionary for the research of cursive word recognition at the current stage. Then we have to choose a part of vocabulary. One of the important criteria for word selection is word frequency which can be calculated according to a large language corpus. Some dictionaries such as the Collins COBUILD Advanced learner s English Dictionary provide information about word frequency. The other strategy is to cluster the vocabulary according to some similarity measures. Then we focus on the research of cursive recognition in individual group.

Visually handwritten word images mainly consist of some primitives such as lines arc and dots. shows some examples.

In it can be observed that neighbouring characters are usually connected and it is very difficult to segment a word image into character components. This suggests that the crude segmentation by means of heuristic rules be not robust due to the intrinsic ambiguity of character boundaries. From we can also observe other characteristics of handwritten signals. For example character n and r in images h and l are almost skipped respectively. For image i and k it is difficult to identify individual characters. Intuitively the useful information seems to exist in the global shapes which are characterized by some extreme points. For image g it should be identified as aud from a pure shape recognition. But orthography imposes strong constraints on word identity. Humans can easily recognize it as and . This indicates that orthography plays an important role in cursive word recognition. The identity of word image o is ambiguous. It can be care or case . In this case the contextual information in a sentence will be required to identify it. Usually humans can identify most isolated words without the contextual information in a sentence. We can draw from this fact that word image and orthography and phonology may provide enough information for recognition without higher level linguistic information. From the computational viewpoint the computational structure will be modularized easily and the dependence of functionality modules between difference levels will be reduced. As a result computational efficiency will be enhanced.

What is the good representation of cursive word recognition Although the complete answer to this question is still unknown we may obtain some clues from the research of computer vision psychology and human reading. Marr 15 suggested that the representations underlying visual recognition are hierarchical and involve a number of levels during the early visual processing. Each level involves a symbolic representation of the information in the retinal image. For example the primal sketch defined by Marr consists of some primitives and makes explicit important information about two dimensional images. Edge blobs contour and curvilinear organization contains useful information for visual recognition. Cursive word image is binary and 2D shape which is not a function of depth. Moreover it consists of line drawing patterns such as lines and arcs. The important information such as curvatures orientations loops global shape convex and concave properties can be derived from a word image contour. Biederman 16 17 proposed a theory of entry level objection that assumes that a given view of an object is represented as an arrangement of simple viewpoint invariant volumetric primitives called geons. The position relationships among the geons are specified so that the same geons in different relations will represent different objects. These geons are activated by local image features. This view of part based representation sounds attractive for cursive word recognition. Although the size of vocabulary is large each word basically consists of a small number of letters. But letters in a word are possibly activated in high level stage since in image level it is hard to solve the segmentation problem. McClelland and Rumelhart 18 proposed an interactive activation word reading model. A bottom up and top down process is integrated to this model. This indicates that letter representation is driven by bottom up low level features to letter and top down word to letter information. Learning must play an important role in the representation.

Is wavelet based coding a good representation of cursive word image Although wavelet based coding is mathematically complete or over complete the wavelet code does not meet the explicit criteria 19 . A wavelet code is simply a linear transform of the original image into a set of new images. There is no interpretation or inference in the process. The structures and features are not explicitly represented. For example for cursive word recognition we know that loops and word length are useful information for recognition. It is hard to extract them from redundant wavelet codes.

Words in the English language have a specified structure. These structure constraints are usually imposed by orthography the way a word is spelled and phonology the way a word is pronounced . For words of length 10 10 letters although the maximal combination is 26 valid words only exist in a small size subset. In the context of cursive word recognition a statistical language model such as n grams is usually used to improve the performance 10 . Those models usually have several shortcomings. First the accuracy of language models is very sensitive to the text domains. When the domain is changed the language model has to be trained with data in a new domain. In some cases the large text corpus in a domain may be not available. Second the orthography information is not directly encoded from local image features. The extra complexity is introduced by statistical language model and it may be not necessary to infer the identity of a word image. As a result the system accuracy will be degraded. In our view a connectionist approach could be applied to implement the nonlinear transformation. shows the transformation framework concept.

In the phonology transformation network is enclosed with a dotted line. In current research it is not very clear whether the phonology information is applied to visual word recognition. The distribution code can be slot based 18 or a relational unit 20 13 . For the first case each letter goes to its corresponding position. For the second case the relational unit called grapheme consists of one or more letters e.g. L T TCH . A word can be translated into several graphemes. When a multi letter grapheme is present its components are activated. For example TCH will activate T and CH . The main characteristic of the above representation is that the strength of orthographic units output depends on not only co occurrence frequency but also network structure and current input data.

Handwriting production is a complex process which involves a large number of highly cognitive functions including vision motor control and natural language understanding. The production of handwriting requires a hierarchically organized flow of information through different transforms 21 . shows this process.

The writer starts with the intention to write a message. Then this message is converted to words by means of lexical and syntactical levels. During the writing the writer plans to select the suitable allographs shape variants of letters in advance of the execution process. The choice may depend on the context of neighbouring allographs. This indicates that a visual feedback mechanism is involved in the writing process. Hollerbach 22 proposed an oscillatory motion model of handwriting. In this model cursive handwriting is described by two independent oscillatory motions superimposed on a constant linear drift along the line of writing. The parametric form is given by cos cos 1 

where wand ware the angular velocities respectively A t and B t are the horizontal and the vertical amplitude modulations respectively and C is the horizontal drift. On online handwriting a general pen trajectory can be encoded by the parameters in the above model 23 . The simplified model indicates what kinds of information are important in cursive handwriting signals. This information can guide us to extract the features in offline cursive word recognition.

The studies of handwriting have found that the atomic movement unit in handwriting is a stroke which is a movement trajectory bounded by two points of high curvature or a trajectory between two velocity minima 24 . Handwriting signals can be segmented reliably into strokes based on this method 24 . This important information indicates that neither letters nor graphemes are basic units at the stage of low level feature extraction.

Handwriting analysis also called graphology is the study of handwriting shapes and patterns to determine the personality and behaviour of the writer. The graphologists forensic document examiners examines some features such as loops dotted i s and crossed t s letter and line spacing slants heights ending strokes etc. and they believe that such handwriting features are physical manifestations of unconscious mental functions. There is a basic principle underlying graphology handwriting is brain writing. From the viewpoint of ecology interactions of individual experiences and social environments have an effect in handwriting since handwriting is a graphic realization of natural human communication. Although this area is less related to cursive word recognition than computer vision and psychology it shows that a lot of features are shared by different individuals. The features examined by graphologists could provide some information about feature extraction to the researchers of handwritten recognition.

Although there is no high performance system for large scale cursive word recognition the development of such a system may require to underlie the following rules from the above perspective 

The recognition system must be hierarchical. For example the units such as strokes graphemes letters and words must be constructed in an increasing level.

Perceptual relevance must conform with well established experiments and principles from Gestalt Psychology.

In most cursive word recognition correcting the skew deviation of the baseline from the horizontal direction and the slant deviation of average near vertical strokes from the vertical direction is an important pre processing step 25 . The slant and slope are introduced by writing styles. Both corrections can reduce handwritten word shape variability which depends on writer and help the latter operations such as segmentation and feature extraction.

For the skew and slant corrections the crucial problem is to detect the skew and slant angles correctly. Once two angles are found skew and slant corrections are implemented by rotation and by a shear transformation respectively. In the literature several methods have been proposed to deal with this problem. In 6 the horizontal and vertical density histograms are used to estimate the middle zone. Then a reference line is estimated by fitting through stroke local minima in the middle zone. In 26 image contour is used to detect those minima. Marita et al. 27 proposed a method based on mathematical morphology to obtain a pseudo convex hull image. Then minima are detected on the pseudo convex image and a reference line is fit through those points. The primary challenge for these methods is the rejection of spurious minima. Also the regression based methods do not work well on short words because of lack of sufficient number of minima points. The other approaches for the detection of slope angle are based on the density distribution. In 28 several histograms are computed for different y vertical projections. Then the entropy is calculated for each of them. The histogram with the lowest entropy will determine the slope angle. In 29 the Wigner Ville distribution is calculated for several horizontal projection histograms. The slope angle is selected by Wigner Ville distribution with the maximal intensity. The main problem for those distribution based methods is a high computational cost since an image has to be rotated for each angle. Also these methods do not perform well for short words. For the slant estimation the most common method is the calculation of the average near vertical strokes 1 5 7 . These methods use different criteria to select near vertical strokes. The slopes of those selected strokes are estimated from contours. The main disadvantage of those methods is that many heuristic parameters have to be specified. Vinciarelli et al. 30 proposed a technique based on a cost function which measures slant absence across the word image. The cost function is evaluated on multiple shear transformed word images. The angle with the maximal cost is taken as a slant estimate. Kavallieratou et al. 29 proposed a slant estimation algorithm based on the use of vertical projection profile of word images and the Wigner Ville distribution. The approaches based on the optimization are relatively robust. However the above two methods are computationally heavy since multiple shear transformed word images corresponding to different angles in an interval have to be calculated.

One of the important problems in cursive word recognition is to extract the discriminative features. There has been extensive research in the extraction of different level features for handwritten words. The ascenders and descenders 31 and word length 32 are perceptual features in human reading. These features are usually used in holistic recognition of handwritten words 33 . But the accurate detection of these features become a challenge due to the uneven writing and curved baseline. Highly local low level structure features such as stroke direction distribution based on image gradients 34 that have been successfully applied to character recognition are generally unsuitable for offline cursive word recognition due to wide variation in style. In 35 10 a word image is represented as a sequence of slice windows from left to right. In each small window an observation vector will be extracted and used in Hidden Markov Models. Although this strategy attempts to avoid the segmentation there are several shortcomings for this method. The slice window does not correspond to any perceptual units such as strokes letters. In most cases these windows contain meaningless fragments which are not compatible with the Gestalt principles of perception similarity 36 . Moreover no inference has been made during the process. In contrast to the method of slice windows the other strategy is to segment a word image into graphemes that are ordered from left to right 9 7 and then extract geometrical and structure features for each grapheme. But the segmentation is usually done in the horizontal direction and is still one dimension while handwriting is a two dimensional signal.

By reviewing the above methods it has been found that none of them imply where the important information is located in a word image and how to organize them efficiently. The research in psychology and computer vision has indicated that a good representation underlying visual recognition is hierarchical and involves a number of levels 15 . Edge blobs contour and curvilinear organization contain useful information for visual recognition. A cursive word image is usually binary and 2D in shape which is not a function of depth. Moreover it consists of line drawing patterns such as lines and arcs. Since words are written by humans handwriting signals may satisfy some physical constraints such as Newton s laws of motion. When a word image is viewed as a 2D curve most of the important information such as curvatures orientations loops global shape local convex and concave properties can be derived from an image contour. The corners on a contour exhibit more invariant properties than other points.

In accordance with the present invention there is provided a method of recognizing a handwritten word of cursive script the method comprising providing a template of previously classified words optically reading a handwritten word so as to form an image representation thereof comprising a bit map of pixels extracting an external pixel contour of the bit map detecting vertical peak and minima pixel extrema on upper and lower zones of the external contour respectively determining respective feature vectors of the vertical peak and minima pixel extrema and comparing the feature vectors with the template so as to generate a match between a handwritten word and a previously classified word.

In accordance with another aspect of the present invention there is provided a method for classifying an image representation of a handwritten word of cursive script the method comprising optically reading a handwritten word so as to form an image representation thereof comprising a bit map of pixels extracting a pixel contour of the bit map detecting vertical peak and minima pixel extrema on upper and lower zones of the contour respectively organizing the peak and minima pixel extrema into respective independent peak and minima sequences determining the respective feature vectors of the peak and minima sequences and classifying the word image according to the peak and minima feature vectors.

In an embodiment organizing comprises organizing the peak and minima pixel extrema into respective independent peak and minima sequences before said determining respective feature vectors of said vertical peak and minima pixel extrema. In an embodiment determining comprises determining feature vectors of the vertical peak and minima sequences.

In an embodiment a vertical peak pixel extrema comprises a pixel point on the upper zone of said pixel contour wherein neighbouring pixel segments are convex relative thereto. In an embodiment a vertical minima pixel extrema comprises a pixel point on the lower zone of the pixel contour wherein neighbouring pixel segments are concave relative thereto.

In an embodiment organizing the peak and minima pixel extrema into the respective independent peak and minima sequences comprises extracting features at each of the extrema selected from the group consisting of 

In an embodiment determining the respective feature vectors comprises extracting features at each extrema selected from the group consisting of 

In accordance with a further aspect of the present invention there is provided an apparatus for recognizing a handwritten word of cursive script the apparatus comprising

wherein said controller forms an image representation of said handwritten word comprising a bit map of pixels extracts a pixel contour of the bit map detects vertical peak and minima pixel extrema on upper and lower zones of the contour respectively determines respective feature vectors of the peak and minima sequences and compares these feature vectors with the template so as to generate a match between the handwritten word and a previously classified word.

In accordance with yet another aspect of the present invention there is provided an apparatus for recognizing a handwritten word of cursive script the apparatus comprising

means for optically reading a handwritten word so as to form an image representation thereof comprising a bit map of pixels 

means for detecting vertical peak and minima pixel extrema on upper and lower zones of the external contour respectively 

means for comparing said feature vectors with the template so as to generate a match between said handwritten word and a said previously classified word.

In accordance with yet a further aspect of the present invention there is provided a method for correcting a slant of an image representation of a handwritten word of cursive script comprising a bit map of pixels the method comprising 

In accordance with still yet another aspect of the present invention there is provided a method for correcting the skew of an image representation of a handwritten word comprising a bit map of pixels the method comprising 

pre computing a look up table of the image representation that maps Cartesian coordinates to polar coordinates 

The following definitions have been attributed to the terms hereunder for indicative purposes only and by no means as a limitation of scope. In fact as the person having ordinary skill in the art easily understands the terminology with respect to the present invention can be varied and the same word can have a variety of meanings depending on the context for this reason and for this reason only and unless otherwise specified by the text or the context thereof in association with the appended drawings the following definitions have been attributed for clarity purposes.

The term contour should be construed herein to include without limitation the series of external or edge pixels of a whole broken or unbroken word image. Examples of a contour or a word image pixel contour are shown in to and .

The term closed curve should be construed herein to include without limitation a fully closed series of external or edge pixels which may be a word image or a portion of a word image such as a letter for example. An example of closed curves is shown in which shows an image of the word different while the contour refers to the external pixels of the whole word different as previously defined the closed curves are closed portions of this contour such as the portions d i ff and erent . In the art these portions may sometimes be called contours as well yet for clarity purposes the term closed curve is used instead.

The term contour portion should be construed herein to include without limitation a series of contiguous pixels on a word image pixel contour between two given pixel points.

The term convex attribute should be construed herein to include without limitation the general geometric shape or curvature of an extrema. For example as shown in to and the convex attribute of peak extrema is a convex shape or configuration relative to the peak extrema pixel point while the convex attribute of the minima extrema is a concave shape relative to the minima extrema pixel point. Therefore peak extrema have a corresponding convex attribute convex shape minima extrema have a corresponding convex attribute concave shape and a peak extrema and a minima extrema have different convex shape since one is convex and the other is concave respectfully.

The term inner loop should be construed herein to include without limitation an additional inner closed curve of pixels within a closed curve or a contour. For example shows the closed curve or contour of the letter image O pixel A is on the contour or closed curve and the inner loop is within this contour or closed curve.

The term controller should be construed herein to include without limitation a computer a processor a programmer and the like.

A peak extrema a minima extrema and an extrema may refer to a single pixel point a plurality of those single pixel points or a short segment of pixels defining the aforementioned convex attribute and being contiguous with the given extrema pixel point.

The present disclosure refers to a number of documents which are incorporated by reference herein in their entirety.

The foregoing and other objects advantages and features of the present invention will become more apparent upon reading of the following non restrictive description of illustrative embodiments thereof given by way of example only with reference to the accompanying drawings.

The description of non restrictive illustrative embodiments of the present invention is organized as follows. Section I is a brief introduction. In section II the acquisition of cursive word databases will be described. In section III two algorithms for word skew slant correction based on Radon transform are presented. In section IV a concept framework of low level word image representation is provided and its relationship with the process of handwriting production is discussed as well as some principles in vision and psychology. In sections V and VI the detailed algorithms are proposed to implement the above representation. In section V an algorithm to locate those meaningful extreme points and build a classifier based on support vector machine to classify them into two independent channels is proposed. In section VI a sequence of feature vectors are extracted at those extreme points in each channel respectively. Dynamic time wrapping is used to evaluate the performance of the proposed representation. Experimental results are given in section VII and show the effectiveness of the proposed low level word image representation. Finally section VIII is a brief conclusion.

In accordance with an embodiment of the present invention certain extreme points in the vertical direction on a contour are located and then support vector machines are applied to classify those points into two channels local peaks in the upper external contour and local minima in the lower external contour. For classification local feature vectors are extracted at those points. As a result a cursive word image is represented by two sequences of feature vectors.

A perceptive global approach to word recognition is used. This approach provides for uncovering the modular parameters of handwritten word images and as such for the mathematical modulation of word images that are sought to be recognized. Hence a low level word image representation for classification is provided where a word image can be represented as one sequence of peak feature vectors on the upper zone and one sequence of minima feature vectors in the lower zone. The representation conforms to the Gestalt principles of perceptual organizations and is very suitable for the development of hierarchical learning systems when the top down information such as orthography is used. A complete recognition system based on this representation is provided. Also efficient and robust algorithms for word skew and slant corrections are provided. In a non limiting illustrative example the recognition rates on IRONOFF French check database and IMDS cursive word database are 94.3 and 56.1 respectively when the matching method of dynamic time wrapping is used.

A database with large amounts of data allows for building a handwriting recognition system. When more and more recognition methods are available the performance comparison of these methods on benchmark databases are becoming increasingly important. Although several public databases are available for academic research 37 the shortcoming with these databases is that lexicon is small or less controlled. For example IRONOFF French check database 38 contains thirty words. The underlying lexicon in IAM databases 39 includes 10 841 different words. But this lexicon contains many word inflections. Identifying word inflections may require the contextual information in a sentence. Since the cursive word recognition rate without constraints for the current recognition system is still rather low it is better to build a database in which the lexicon is increasing in a proper way so that one can investigate the factors that affect the recognition performance in a controlled manner.

Before collecting handwritten word samples the following three questions have to be considered First question Which words are chosen Second question How many samples of each word are required to be collected Third question How can we design a form such that word labelling is automatic 

For the first question words are chosen in terms of rankings of their frequencies since psychology research has shown that humans read texts with highly frequent words more fluently. From a viewpoint of Bayesian learning the word frequency appears in the expression of a Bayesian classifier. The Collins English dictionary for Advanced Learners 40 provides a good resource for word frequency. The frequency in the dictionary is calculated in a large corpus called Collins Bank of English which is a collection of around 400 million words of written and spoken English and covers many sources such as texts from newspapers television British and American English and other sources. Information on the frequency of words is given using five frequency bands. The most frequent words have Band 5 the next most frequent Band 4 and so on. Words which occur less frequently do not have a frequency band. Table I shows the number of words in five frequency bands. The words in the five frequency bands make up 95 of all spoken and written English and the words in the top two bands account for about 75 of all English usage. Therefore word frequency is a good measure for selection. In the first stage words in frequency Band 5 are collected. After good progress has been made we continue to collect words in other frequency bands. Inside each frequency band about the same number of samples is collected for each word. The higher the frequency band is the more samples we collect. As a result samples in the database show how often words are used in real life. Moreover the recognition system becomes more complex when more words in the low frequency bands require to be recognized. This simple to complex strategy facilitates the research of cursive word recognition.

For the second question there is no simple answer to it since the size of samples depends on many factors such as the discriminative ability of features and the complexity of the classifier in order to achieve a good generalization performance. Although a large amount of data is always preferable sample collections are costly. Currently we decide to collect about 2 000 handwritten samples for each word in frequency Band 5. The samples are written by a variety of persons from different ethno linguistic backgrounds such as Arabic Asian Canadian French from various vocations such as students university professors corporate employees and others. No constraints are imposed on the writers in order to obtain the most natural handwritten samples.

For the third question in order to label words automatically an electronic form has been designed having the following features given a number of words handwritten collection forms e.g. Microsoft Word format can be generated automatically handwritten words in the form image can be segmented robustly and easily and word labelling is automatic by high accuracy machine printed digit recognition techniques.

Until now the total number of collected samples is 52528. Since the size of vocabulary is 670 the average number of samples of each word is about 78. These samples are randomly split into training and testing sets. As a result the training and testing sets consists of 38795 and 13733 samples respectively. In the training set letter distribution and word length distribution are shown in . It can be observed that words of length 4 are the most frequent in the training set.

An algorithm for skew correction and a fast algorithm for slant correction are proposed. Both algorithms are based on Radon transform 41 . Compared with previous methods they are not only robust but also computationally efficient while the principle of computational efficiency usually is not taken into account in the previous methods.

Intuitively it can be observed in that a handwriting signal oscillates the most frequently in the writing direction. For a binary word image a black white image the foreground being defined by black pixels edge and foreground pixels characterize the shape variations and image energy respectively. When two signals are projected onto the axis orthogonal to the writing direction the correlation is maximized. Before this problem is formalized it is useful to introduce some notations. The 2D image is denoted as f x y . The Radon transform 41 of f is the integral of f x y over a line in the xy plane which is illustrated in . Mathematically the radon transform of f is given by 

This transform is depicted in . For a binary handwritten word image the Radon transform of gradient flow is mainly used to estimate the average frequency in the projection direction. The angle can be obtained by maximizing the following function 

Finally when a handwritten word image is de skewed should correspond to the x axis. Therefore the skew angle is 2 . In order to solve the optimization in 6 an efficient algorithm will be required. The image width and height of image f x y are denoted by w and h respectively. f x y is a black white 1 0 image. The input image is mapped from the Cartesian domain to the polar domain where

In the above algorithm most float operations are replaced with integer ones. Although the precision of Radon transform is reduced the detection accuracy of the skew angle is not decreased. The reason is that in step 3.1 an angle which corresponds to the maximum response is obtained. High precision Radon transform is not necessary in our algorithm. In addition the most expensive operations can be pre computed as look up tables in the initial stage and the number of evaluated angles can be much smaller than 180.

The basic idea of slant correction is to estimate the average angle of long vertical strokes. can be used to give a geometric explanation. In line segment AB is a part of long vertical stroke CD and EF are a part of two short vertical strokes respectively. In order to classify two cases AB CD EF are projected onto the direction . Then the ratio of the projection length to the maximal range for the fixed s in 2 is calculated using the expression 

In the above algorithm the vector vcorresponds to g in Eq. 2 and vcorresponds to the denominator in Eq. 8 .

Extreme points play an important role from the perspective of handwriting production. In the process of handwriting production strokes are basic units and a handwriting signal can be represented as a sequence of strokes in the temporal dimension. A stroke is bounded by two points with curvature. That is strokes are separated by extreme points and a handwriting signal can be broken up into strokes under the assumption of contiguity. In terms of an oscillatory motion model of handwriting 22 the horizontal and vertical directions assuming that the vertical direction is orthogonal to the writing direction are more important than the other orientations. Then strokes are split into two groups strokes in the upper contour and those in the lower contour. Those strokes are ordered from left to right. This representation has several characteristics 

1 It is compatible with the study in psychology which shows that strokes are basic units of handwriting signals.

3 It is a local representation of word image. It is easier to extract low level invariant local features.

5 The operations of extracting those strokes are feasible since high curvature extreme points can be extracted robustly.

Also unlike wavelet coding where an image signal is decomposed into orientation and frequency sub bands and wavelet coefficients do not correspond to perceptual meaningful units explicitly more high level units such as letters and words can be visually constructed from the above representation. As a result this representation will facilitate building of a hierarchical system of cursive word recognition. In order to obtain the above representation those interesting points with high curvature are first located. In the writing process the most important part of a curve seems to be where the writing speed has reached a minimum and curvature reaches a maximum 42 43 31 . The vertical extrema on an external contour are the segmentation points of handwritten strokes. shows the procedures of the extraction of vertical extrema. The interesting locations are the peaks in the upper external contour and minima in the lower external contour. The neighbouring curved segments at those extrema have a convex attribute that is either convex with relation to that extrema or concave with relation to that extreme. If the curves are smooth the curvatures at those points are positive. Theoretically there exists a point with negative curvature between two neighbouring extrema. This indicates that a point with negative curvature depends on its neighbouring points with positive curvature. Therefore it is reasonable to assume that peaks in the upper external contours are pairwisely independent. So are the minima in the lower external contours. Also these locations are analogous to the centers of receptive fields 44 which attract visual attention 45 .

The spatial configuration of those extreme points usually approximates the basic topology of a word image. Separating these extrema into two groups has the following advantages 

2D spatial configuration of these extrema can be approximated by two 1D spatial configurations. Consequently the problem related to complexity will be greatly reduced.

It conforms with the Gestalt principles of perceptual organization proximity principle vertical distances and similarity local curve shape at these points .

When the signal similarity is modeled independently and signals in one group are degraded the model in the other group is not affected.

Besides the spatial configuration of these extreme points some topological constraints have to be represented by features at those points. For example for the inner contour as a loop we associate it with the closest extrema on the external contour.

This proposed conceptual representation framework which differs from the methods in the literature explicitly and systematically organizes low level visual information based on some principles from handwriting production vision and psychology.

Based on the representation framework in section III an algorithm to detect vertical extrema on the image external contours robustly has been developed. In order to express pixel locations in an image a Cartesian coordinate system is defined. In this coordinate system an image is treated as a grid of discrete elements. The top left corner is chosen as the origin. The x coordinate increases to the right and y coordinate increases to the bottom. Pixel coordinates are integer values. This coordinate system is used in the rest of the paper unless mentioned otherwise. After the coordinate system has been defined the proposed algorithm is given below 

In the above algorithm a contour is assumed to be external and closed. At step 4.1 and 4.2 nand ndenote the number of initial peaks and number of initial minima respectively. At step 5 and 6 three primary measures are used to prune invalid extreme points contour length height difference and bounded variation between two neighbouring extreme points. For example if the contour length between two neighbouring peaks is small they will be merged into one peak that will be located at the middle point on the contour. Also if a local minimum point is located in the upper zone it will be pruned. In the same manner if a local peak point is located in the lower zone it will be pruned. For instance in extreme points and will be pruned.

Although the algorithm in subsection V.A. can be applied to group of peaks and minima and prune invalid extrema it is still not good enough due to various variations of word shapes. Therefore a classifier is built to refine the grouping and pruning process. Several features are extracted at each extreme point. With reference to these features are listed as follows 

1 Number of local minima on the current closed curve of the word image contour f . In the feature values at points and are 2.

2 Number of local peaks on the current closed curve of the word image contour f . In the feature values at points and are 2 and 1 respectively.

3 Minimum height difference with neighbouring extrema f . When the current point is a local minimum the two neighbours are local minima when the current point is a local peak the two neighbours are local peaks. Neighbours may not be on the same closed curve of the word image contour as the current one. In the feature value at point is min y y y y .

4 Minimum height difference with neighboring extrema f . When the current point is a local minimum the two neighbours are local peaks when the current point is a local peak the two neighbours are local minima Neighbours may not be on the same closed curve of the word image contour as the current one. In two neighbors of point are 2 and 3. The feature value at point is min y y y y 

7 Relative position in y axis f . The feature is defined by y h where y is the coordinate of the current point in the y axis and h is the image height.

8 Minimum contour portion length with neighbouring peaks f . Note that neighbouring peaks are on the same contour as the current point.

9 Minimum contour portion length with neighbouring minima f . Note that neighbouring minima are on the same contour as the current point.

10 Minimum height difference with neighbouring peaks f . The neighbouring peaks must be on the same closed curve of the word image contour as the current point.

11 Minimum height difference with neighbouring minima f . The neighbouring minima must be on the same closed curve of the word image contour as the current point.

12 Height ratio with neighbouring extrema f . In the two neighbors of point are and . Point is the lowest point among the three points. Let ybe the y coordinate of top left corner of a closed curve of the word image contour where point is located. Let ybe the y coordinate of the top left corner of a contour where point is located. The ratio is defined by y y 1.0 y y .

13 Vertical intersection distance f . In point local minima is on the upper contour. If we scan horizontally and vertically from point the scanning line will intersect the left contour and lower contour in a short range as will be understood by a skilled artisan. In an embodiment this short rage is less than about 30 pixels including every interval number of pixels between 30 and 0. In another embodiment this short range is less than about 2 including every interval number of pixels between 30 and 0. The distance between point and vertical intersection point is the feature value otherwise this value will be set to the fixed value.

In the above features fand fcharacterize the information of word length. frepresents the information of the ascender and the descender. For each feature value a reasonable upper bound will be set. If the feature value is greater than the corresponding bound it will be rounded to this bound. In biological learning it is called peak effect 46 . Given the specified bound bof the feature f the round operation is given by min 12 

For fast learning the feature values will be first transformed into the interval 0 1 the variable transformation xis applied to each component of the feature vector such that the distribution of each feature is Gaussian like 47 . The formula is given by

Then a support vector classifier 48 is constructed to classify points to two classes extrema on the upper contour and extrema on the lower contour. If one local minima is classified to the upper contour it will be pruned. If one local peak is classified to the lower contour it will be pruned. As a result the valid local peaks will be on the upper contour while the valid local minima will be on the lower contour.

After valid extrema are selected and grouped into two channels two sequences of extrema can be constructed peaks on the upper external contour and minima on the lower external contour. But orders of those extrema in the sequence have to be determined. Given two reference points on a contour orders of contour points along the contour path are intrinsic and invariant to many transforms. Therefore in each channel extreme points are first sorted by their x coordinates in an increasing order. Then extreme points are sorted in the same contour from left to right along the contour path. The dots associated with letters i and j are detected and put at the end of peak sequences

After valid extrema are classified into two groups discriminative features will be extracted at those points for word classification task. Some features are global and will be distributed to all extrema in the corresponding channel. The feature extraction is described according to local peaks similar operations are applied to local minima.

3 Relative horizontal position f . Let the coordinate of the current point be x y . The enclosed box of the word image is a rectangle. The coordinate of the top left corner is x y and the width and height of the rectangle are w and h respectively. The feature is defined by

5 Projection ratio in the horizontal direction f . Project the word image onto the x axis. Let the projection function be p x bounded by the interval a b . The x coordinate of the current point is c. These parameters are shown in and defined by 

6 With reference to the projection ratio in the vertical direction f which is similar to fis defined by 

7 Maximal height difference of two neighboring peaks f . This feature characterizes ascender information. It is a global feature.

16 Number of pixels with the horizontal orientation on the contour portion between the current peak and left local minima f .

17 Number of pixels with the vertical orientation on the contour portion between the current peak and left local minima f .

18 Number of pixels with the horizontal orientation on the contour portion between the current peak and right local minima f .

19 Number of pixels with the vertical orientation on the contour portion between the current peak and right local minima f .

20 Projection ratio of neighboring local minima on the left in the horizontal direction f . The same operation for feature fis applied to extract this feature. The difference is that c is the x coordinate of the neighbouring local minima on the left.

22 Dominant crossing number. Project the vertical crossing number i.e the transition between a black pixel and a white pixel onto the x axis. Then the projection function is quantized to three intervals 0 3 3 5 5 . Then the histogram is calculated when the crossing number falls into the three intervals. The histogram values are features f fand f.

23 Crossing ratio in the horizontal direction f . The operation is similar to that for feature f. But the projection is the profile of vertical crossing.

24 Projection ratio of neighbouring local minima on the left in the horizontal direction f . This feature is similar to f. The difference is that the projection profile corresponds to the vertical crossing number.

The above features are extracted to encode the information of local and global context. The normalization operation in subsection V.B is also applied to these features.

Since word images are represented as two sequences of feature vectors dynamic programming technique 49 can be used to measure the similarity of two word images. The dynamic time wrapping 50 have been applied to speech recognition. In order to mention the model parameters and make the method self contained dynamic time wrapping will be briefly described. Let A and B be two sequences of feature vectors A x x . . . x . . . x B x x . . . x . . . x

Consider the problem of eliminating the time difference between two patterns. Let us consider a i j plane in where A and B are developed along the i axis and j axis respectively. The time difference can be depicted by a sequence of points c i j 1 2 . . . . . . 16 where c k i k j k . The sequence can be regarded as a function which maps the time axis of pattern A into that of pattern B. It is called a wrapping function. A measure of the difference between two feature vectors xand x a distance 17 where . is a vector norm. The weighted summation of distances on wrapping function F becomes

Initial condition is g 1 1 d 1 1 . The time normalized distance is g I J I J . In our case we calculate the time normalized distance for peaks and minima respectively. Then the sum of two distances is considered as the matching distance between two word images.

The word representation method described in the present specification has been implemented in C on Windows XP and compiled by Microsoft visual C 6.0. It is a part of IMDS handwritten word recognition engine. The experiments were conducted on IMDS cursive word database. Training set and testing set consists of 38795 and 13733 word images respectively. The size of lexicon is 670

In subsection VI.B. the vector norm is set to L and the size r of the adjusting window is set to 1. In the remaining section the performance of the proposed method is first investigated for extrema detection and grouping on IMDS database. Then the generalization performance of the proposed method is investigated on IRONOFF French cheque database 38 and IMDS cursive databases.

A support vector machine SVM is used as a classifier to classify extrema into two categories. The radial basis function RBF is chosen as the SVM kernel given by

The value of C in the dual form of SVM 48 is set to 10.0. SVM is trained by HeroSvm2 51 . Some labelled samples have to be collected before the support vector machine is trained. The strategy is first to label a small number of extrema in the word images manually. Then these samples are divided into training and testing sets. A SVM classifier is constructed. The classifier is used to label other extrema. The misclassified errors are corrected manually. Since the recognition rate of SVM classifier is very high more than 99 the number of manual corrections is small. Much time consuming cost has been saved. Table III shows the performance of SVM classifier 

In table III SV and BSV denote the number of support vectors and number of bounded support vectors respectively. The number of support vectors is small compared with the size of the whole training set. It may indicate that features are discriminative so that a small portion of SVs can characterize the classification boundary. The above results are very promising. They indicate that the extrema can be grouped into two categories with a high accuracy though cursive word shapes exhibit considerable variations. It also infers that in low level visual processing the data driven learning technique with top down information can eliminate the uncertainty of a decision to a great extent. Traditionally the baseline information has been used to determine the upper and lower zones. But the detection of baseline is not robust due to uneven writing. Moreover it is difficult to find a baseline for some short words. One of the appealing properties of the method according to the invention is that the output of the SVM classifier can be used as the confidence value. When the confidence value of the SVM s output is larger the decision of the classifier becomes more reliable. Some examples are shown in .

The obtained feature vectors are compared with a template such as a database to generate a match between a selected handwritten word and a previously classified word. IRONOFF French check database 38 and IMDS cursive word database have been used to test the method according to the present invention. There are 30 French words in IRONOFF French check database which consists of a training set of size 7898 and a testing set of size 3948. Some samples from this database are shown in .

In order to compare the performance we also implemented two discrete Hidden Markov Models HMM 52 were implemented for each word one models sequential peak feature vectors the other models sequential minima feature vectors. The two models are combined by a sum rule. The size of the codebooks is 300. The topology of Hidden Markov Models are left right structure. Jumping over one state and looping on a state are allowed. The number of states is twice the number of letters in a word. The Hidden Markov Models are trained by Baum Welch algorithm. The performance of two methods on IRONOFF check database and IMDS cursive database is shown in Table V.

Hidden Markov Models perform slightly better than dynamic time wrapping. But their computational cost is much higher than that of dynamic time wrapping. The recognition rates of both methods on IMDS test set are low. There are several reasons. First size of vocabulary on IMDS database is larger than that on IRONOFF check database. Second there are many similar words in IMDS database. Finally the average number of training samples for each word on IMDS database is 40 while the average number of training samples for each word is about 300. In order to obtain a good performance a large number of samples are necessary.

Two new algorithms for word skew and slant corrections are proposed. Compared with previous methods the method according to the invention is not only robust but also computationally efficient. In addition a novel low level word image representation for classification is proposed where a word image can be represented as one sequence of peak feature vectors on the upper zone and one sequence of minima feature vectors in the lower zone. A cursive word recognition system based on the method according to the invention has been built and achieved a good performance on IRONOFF check database. Moreover the new low level word representation is very suitable for the construction of a hierarchical learning system where the top down information such as orthography which plays a key role in word recognition can be introduced during the training stage.

It is to be understood that the invention is not limited in its application to the details of construction and parts illustrated in the accompanying drawings and described hereinabove. The invention is capable of other embodiments and of being practiced in various ways. It is also to be understood that the phraseology or terminology used herein is for the purpose of description and not limitation. Hence although the present invention has been described hereinabove by way of embodiments thereof it can be modified without departing from the spirit scope and nature of the subject invention as defined in the appended claims.

