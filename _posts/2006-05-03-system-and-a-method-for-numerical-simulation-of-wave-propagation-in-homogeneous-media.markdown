---

title: System and a method for numerical simulation of wave propagation in homogeneous media
abstract: The present invention provides a method to construct stable, high-order explicit discretization for the wave equation based on the discretization of the evolution formula. The present invention provides independent computation of discretization in one, two, or more spaces for bulk propagation, near boundaries propagation, and discretization of a projection operator to enforce boundary conditions. More specifically, the method includes an act of discretizing propagation operators Lby using an identity that is derived using central differencing in time. The method also includes an act of providing a high-order discretization of a boundary projection operator that enforces boundary conditions independent of the discretization of the propagation operators L. Additionally, the method includes an act of alternating an application of a discretization of an evolution formula having a spatial filtering operator Lwith a boundary projection operation for stepping forward in time to determine wave propagation in the media.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07822585&OS=07822585&RS=07822585
owner: HRL Laboratories, LLC
number: 07822585
owner_city: Malibu
owner_country: US
publication_date: 20060503
---
The present application is a non provisional application claiming the benefit of priority of U.S. Provisional Application No. 60 677 581 filed on May 3 2005 entitled A System and a Method for Numerical Simulation of Wave Propagation in Homogenous Media. 

This invention relates to work performed in contract with the U.S. Government under contract number MDA972 01 C 0006 titled Advanced Electromagnetic Modeling where the U.S. Government may have certain rights in this invention.

This invention relates to time domain simulation of the wave equation and in particular to a method and a system to compute an evolution of the wave equation.

In one dimension the derivative of a point on a line is the slope of that line at that point. The slope at any point on a line is the tangent line through a particular point which has the same direction as the line at that point. In other words the derivative of a point on a line is construed as a local statement about the local change in the direction of the line. The partial differential equation of a function with four variables is defined in much the same way by using a tangent to a three dimensional function in a way analogous to the way tangent line is used for a single variable function. Partial differential equations may be used to represent a particular point of a field in space and time. The slope derivative of a field at which any one point exists depends on the three variables for space in x y and z directions and one variable for time t. Therefore partial differential equations can be construed as local statements about local changes in a three dimensional entity such as a wave in space and time.

The wave Equation 1 is represented by a partial differential equation because it involves a function of four variables which are the three dimensions of space in the x y and z directions and one variable for time t as follows 

Wave fields are continuous entities in both space and time which means that they have a value at every point in space and time. This makes the use of partial differential equations for an exact representation of a field at every point in space and time impractical and difficult because an infinite number of points must be used to provide an exact representation of the total field at every point in space and time. Other analyzing techniques must therefore be used to avoid the use of partial differential equations for representing a continuous entity such as a wave.

Numerical Analysis is one method for computing a solution for partial differential equations. This is done by first discretizing a partial differential equation bringing it into a finite dimensional subspace then solving the resulting linear system in the finite dimensional subspace. One such technique for first discretizing the wave Equation 1 involves using a finite differencing method. This method approximates the solution of partial differential equations by using a finite collection of points to represent a wave. The approach taken for partial differential equations is to approximate differential operators such as u x by a difference operator such as u x h u x h for some small but finite h where h may represent a small rate of change . Doing this substitution for a sufficient number of points in the domain of definition for instance 0 h 2h . . . 1 in the case of the unit interval provides a system of equations that can be solved algebraically.

The process of representing a continuous entity by a finite collection of points is known as discretization. In other words discretization is a way of approximating a problem that has an infinite number of variables with a problem that has a finite number of variables. A discretization process divides geometry into smaller pieces finite elements to prepare for analysis. A discretized model of a continuous entity such as a wave can be manipulated using an analyzing technique such as a Finite Difference Time Domain FDTD in which all the simple geometric components of a model are evaluated simultaneously. To apply the FDTD the differential equation of the wave is replaced by a finite difference equation. This is done by replacing the partial derivatives by central difference quotients which replaces partial differential equations with algebraic expressions. In the next operations the interval to be computed is subdivided into a suitable number of equal subintervals and then the difference equation at each point where the value of the function is unknown is determined. At the final operation the system of equations created is solved to obtain approximation values for the solution of the differential equation at discrete points on the interval.

Using FDTD at a given position in space the field at each current step can be calculated from the previous values of the fields hence the difference in time . If time is considered discretized into discrete steps then fields are simply increased or decreased from their previously calculated values by adding or subtracting an amount given by the

calculations at current time. The partial differential equations which describe the infinitesimal local behavior of the field are replaced with algebraic equations having to do with differences in the field in nearby space and time points. This avoids the partial differential operations because the equations are transformed into algebraic expressions. Dividing a real problem into appropriately sized unit cells and then calculating the field equations iterated for as long as the response is of interest therefore solves a real problem.

To use FDTD a computational domain which is the space in which the simulation of a wave will be performed must be established. The field will be determined at every point within the computational domain requiring a cell or grid structuring of the domain. In addition since a computational domain must end at some point a boundary must be established. Once the computational domain is determined a source is then specified. The source can be an impinging plane wave or a current on a wire depending on the type of situation to be modeled.

Since FDTD requires that the entire computational domain be formed of grids and because these grids must be small compared to the smallest wavelength and smaller than the smallest feature model very large computational domains can be developed which result in very long solution times. Models with long thin features are difficult to model in FDTD because of the excessively large computational domain required. In addition although fields can be found directly everywhere in the computational domain when using FDTD if however calculations or models of fields at some distance are desired it is likely that the distance will force the computational domain to be excessively large. It should be noted that far field extensions are available for FDTD but require some amount of post processing.

As is described in the Published Patent Application 2002 0099510 to Namiki portions of which are repeated herein for completeness conventionally FDTD solutions are numerically obtained through explicit methods. For simplicity consider the following one dimensional parabolic partial differential equation 

The explicit difference method of the Equation 5 however must satisfy the following condition for stability to make sure that the solution will converge toward a final solution 

Detailed discussion on the CFL condition in FDTD is found in the literature as described by A. Taflove in Computational Electrodynamics MA Artech House Inc. 1995. The Equation 7 is known as the Courant condition for three dimensional wave analysis where v is the propagation rate of electromagnetic waves and x y and zare minimum values of spatial discretization intervals in the x y and z directions respectively. Because of the constraints discussed above the maximum time step size in explicit methods is dependent on the minimum cell size. That is the time step size must be reduced when analyzing an object having fine geometrical features resulting in an increased number of simulation steps to be iterated. This would cause a serious problem of long simulation time particularly when calculating a time response for an extended period.

Partial differential equations can be solved with explicit as well as implicit methods. For example a backward difference approximation to the one dimensional parabolic partial differential Equation 2 is as follows 

To analyze the transient behavior of electromagnetic waves it is required to solve a partial differential equation in the space of at least two dimensions. Special care must be taken when solving this kind of problem by use of implicit methods. Consider the following two dimensional partial differential equation 

The solution of Equation 12 can be reached by solving a set of simultaneous linear equations having as many unknowns as Nx 1 Ny 1 where Nx and Ny are the numbers of meshes in the x axis and y axis directions respectively. This computation makes extreme demands on the computer memory and processing power even when fine meshing is required. The result is that implicit methods are as time consuming as explicit methods even when the simulation model has a fine geometrical feature that needs a smaller cell size.

There are two main issues with respect to performance of a numerical solution of the wave equations stability and efficiency. The numerical stability of a method describes how that method responds to the differences between the calculation and the function being approximated. In a stable method the errors due to the approximations are damped out as the computation proceeds. In an unstable method any errors in processing are magnified as the calculation proceeds. Unstable methods quickly generate worthless data and are useless for numerical processing. Therefore any method used to compute the approximate solution of a wave equation must be stable.

The second issue is with respect to the efficiency in the numerical solutions of partial differential equations which relates to the precision of the approximated solution. Recall that numerical solutions are mere approximations of the partial differential equations and hence the error between the approximate solution and the true solution must somehow be accounted for to determine the precision of the approximation. For example is the approximation error small enough that it provides an acceptable solution for which the partial equations were modeled In general the error between the approximate solution and the true solution is determined by the truncation error that is made by going from a differential operator to a difference operator. The truncation error reflects the fact that a difference operator can be viewed as a finite part of the infinite series of the differential operator. Therefore in general a higher number of series an increased number of steps or values closer together in space and time can be used in the numerical solution to better approximate the partial differential equation to reduce the approximation error. In fact the approximation error should reduce to zero if enough points in space and time are used to approximate the solution to the partial differential equations which is the definition of convergence for an infinite series.

Assuming that the method is convergent then a determination must be made as to how rapidly the approximation error reduces to zero or the solution converges which is the measure of the efficiency of the method being used. Most of the methods that are used today are low order discretization methods which means that the approximation error is decreased by a very low factor despite an increased use of points numbers in space and time. Discretizations with approximation errors that reduce rapidly as more points are used are known as high order discretization methods.

The difficulty in changing a low order time domain simulation to a high order one is that in general the low order time domain simulations tend to be unstable high order solutions. Another difficulty is that in order to achieve a high order solution the algebraic equations that replace the partial differential equations would have to relate to the values of the field at many steps time and or space . One major problem with this is initialization. For example if the value of a previous four time steps are needed then initial conditions for the four time steps are required and not just one. On the other hand the more time steps that are required the greater the possibility of introducing extraneous and unstable solutions.

In light of the current state of the art and the drawbacks to current systems mentioned above a need exists for a system and a method that would allow for stable high order discretization for evolution of the wave equation.

The present invention provides a method for causing a processor to perform acts for numerical simulation of wave propagation in a media. For example the method includes an act of discretizing propagation operators Lby using an identity that is derived using central differencing in time. The method also includes an act of providing a high order discretization of a boundary projection operator that enforces boundary conditions independent of the discretization of the propagation operators L. Additionally the method includes an act of alternating an application of a discretization of an evolution formula having a spatial filtering operator Lwith a boundary projection operation for stepping forward in time to determine wave propagation in the media.

selecting a set of suitable functions for which discretization of the propagation operator Lis exact 

classifying the discretization points as either bulk points or border points with the bulk points being those for which each point on a stencil of the propagation operator corresponds to a discretization point on the lattice and border points are those points that remain 

computing a discretization of the propagation operator for each of the border points using the border point and its neighbor points 

selecting points on a boundary and using neighboring discretization points computing differentiators and extrapolators to the selected points on the boundary for a selected boundary condition and

decomposing an outer product of constraint vectors for efficient application of the projection operator.

Additionally the act of selecting a suitable function set for which discretization of the propagation operator Lis exact further comprises an act of selecting polynomials of degrees not exceeding a value d where d is a degree of the polynomial.

In another aspect the act of determining a minimum stencil size M for which a free space discretization is stable further comprises an act of setting M to a value greater than or equal to the number of linearly independent polynomials in spatial coordinates that are of degree not exceeding d 

In yet another aspect the act of selecting discretization points in a spatial domain S on a regular lattice further comprises an act of selecting points such that they are on a lattice selected from a group consisting of a square lattice and a triangular lattice.

The present invention further comprises an act of discretizing the propagation operator Lfor each bulk point according to the following 

Additionally the act of computing a discretization of the propagation operator for each of the border points further comprises an act of computing a discretization according to the following 

In another aspect the present invention further comprises an act of discretizing boundary conditions according to the following 

In yet another aspect the act of decomposing an outer product of constraint vectors for efficient application of the projection operator further comprises an act of decomposing the outer product according to the following B bb 

Additionally the act of decomposing an outer product of constraint vectors for efficient application of the projection operator further comprises an act of applying the projection operator to a particular vector by solving for coefficient according to the following 

In yet another aspect the act of discretizing propagation operators Lby using an identity further comprises an act of using the identity of

Finally the present invention also includes a computer program product and system configured to cause a processor to perform operations of the method described herein.

These and other features aspects and advantages of the invention will be apparent to those skilled in the art from the following detailed description of preferred non limiting exemplary embodiments taken together with the drawings and the claims that follow.

In general there are three known methods to handle the time evolution of the wave equation. The first uses discretization of the spatial derivatives along with an ordinary differential equation solver such as the well known Runge Kutta. The second method discretizes all the derivatives similarly which results in a system of equations that relate the field s at several times. The third uses the well known Lax Wendroff method based on the following identity Equation 13 and is usually implemented using some finite difference approximations to powers of 

The present invention constructs a stable high order explicit discretization for the wave equation i.e. one that has a discretization error that decreases rapidly with discretization density. The present invention provides an approximation of the fields in space for the exact representation of the fields in time. In other words using the Alpert et al. approach of equations that are exact in discrete time the present invention provides an approximation of those exact equations in space.

The present invention further provides a prescription for handling boundary conditions which separates the bulk the propagation region from the boundary independent of each other and includes the enforcement projection of solutions to obey the boundary conditions without compromising the stability or the high order convergence of the discretization. In other words the present invention separates the process of computing the evolution of the wave in space and time in a propagation region from that evolved at the boundary region. That is first the evolution of the wave in the propagation region is computed in some space s and time t and then computations are made to correct the solutions at the boundaries. Then at the next s s space and t t time the evolution of the wave in the propagation region is computed again and then computations are made to correct the solutions at the boundaries for the s s space and t t time. This process is iterated for the desired number of space and time steps . In addition the step size may be selected to be . This means that the approximation error will reduce very rapidly as finer resolutions of space and time are used. The present invention further provides an explicit prescription that handles evolution of a field near boundary regions independent of the boundary and boundary conditions for stable and high order discretization.

Before providing details regarding various methodologies of the invention first a glossary of terms is provided as a reference for the reader. Next a system overview is provided describing the interconnection and operation of various major components of a system in accordance with the present invention. After the system overview a data processing system overview is presented to acquaint the reader with the various components typically found in a data processing system that may be used in conjunction with the present invention. Next an explication section is provided in which the various major components presented in the system overview are described in detail. Finally a results section is provided which presents non limiting examples of the operation of the present invention in two space dimensions plus a time dimension in order to provide a more tangible understanding of the operation of the invention.

This section presents an exemplary glossary of some of the terms used in the description and claims. The glossary is intended to provide the reader with a general understanding of various terms as they are used in this disclosure and is not intended to limit the scope of these terms. Rather the scope of the terms is intended to be construed with reference to this disclosure as a whole and with respect to the claims below. Further the definitions provided should not be considered limiting to the extent that the terms are known in the art. These definitions are provided to assist in the understanding of the present invention.

Using the well known Lax Wendroff method which is based on the identity Equation 13 the present invention uses an exact relation that relates the fields at multiple times as taught by Alpert et al. but discretizes the linear propagation operator Lthat appears at each discrete time rather than an integral representation thereof. Hence the present invention discretizes the linear propagation operator L and not the integral representation from which the linear propagation operator Lis derived. In other words the present invention uses the Alpert et al. evolution formula to provide an exact representation of a wave equation at discrete times and then discretizes the space within each discretized time. This approach provides a hierarchy of discretizations that can be obtained by representing the linear operator Lto the desired order. The present invention recognizes that Equation 13 provides an explicit formula for t in terms of 0 and t meaning that no linear equations need be solved to compute t 2 0 . 15 Therefore the present invention provides a prescription for an explicit discretization of Equation 13 in multi space dimensions along with a projection operator that enforces the desired boundary conditions. An important feature of the present invention is the independent computation of three discretizations one for bulk away from boundaries propagation one for propagation near boundaries and a projection operator to enforce boundary conditions.

Features of the present invention include a straight forward discretization of the linear propagation operator L a high order discretization of a projection operator that enforces the desired boundary conditions independently of the discretization of the propagation operator L and a consistent discretization of the implicit identity operation on the first time slice t on the right hand side of Equation 15 . In other words the present invention applies a high order filter to the field t . This is essential to preserve stability. Another feature includes the applicability of the methodologies of the present invention to both structured and unstructured meshes. It should be noted that the efficiency of the method presented depends on a regular mesh being used in as much of the modeled volume as possible.

With the present invention the evolution of the field steps forward in time by alternating the application of the discretization of the evolution formula Equation 15 with the identity operator exhibited 2 16 with the boundary projection operation 17 where Pis the projection operator the boundary condition that enforces the desired boundary condition independently of the discretization of the linear propagation operator Lon the field . In other words portions of the field that do not obey the boundary conditions are removed filtered from the field by the application of the projection operator P. It should be noted that discretizing the implicit linear 0 time operator Lby the same prescription as is used for the linear propagation operator Lresults in a low pass spatial filter that facilitates stability. The notation for the 0 time propagation spatial filtering operator Lis not arbitrary because Lis exactly the t 0 limit of L and likewise for their discretizations. All the methods may be processed by the exemplary data processing systems described in details below. 4 Data Processing System Overview

A block diagram depicting the components of a computer system used in the present invention is provided in . The data processing system comprises an input for receiving data input signals from any inputting mechanism non limiting examples of which include an external computer connected to the system an Internet connection or any computer readable medium illustrated in such as a floppy disk Compact Disk CD a Digital Versatile Disk Digital Video Disk DVD and a removable hard drive. The input may also be configured for receiving user input from another input device such as keyboard a mouse or any other input device best suited for the current environment conditions. Note that the input may include multiple ports for receiving data and user input and may be configured to receive information from remote databases using wired or wireless connections. The output is connected with the processor for providing output to the user possibly through a video display. Output may also be provided to other devices or other programs e.g. to other software modules for use therein possibly serving as a wired or wireless gateway to external databases or other processing devices. The input and the output are both coupled with a processor which may be a general purpose computer processor or a specialized processor designed specifically for use with the present invention. The processor is coupled with a memory to permit storage of data and software to be manipulated by commands to the processor.

The discussion section is divided into two major sections with section I providing a description for a stable high order discretization for evolution of the wave equation in one space and one time dimension and a section II that extends the approach of section I to two or more space dimensions plus the time dimension.

The discussion for the stable high order discretization for evolution of the wave equation in one space and one time dimensions provides a description for A Field Propagation in the Bulk including stability B Field Propagation Near Boundaries C Enforcement of Boundary Conditions D Optional Modification for Unequally Spaced Points and E Numerical Examples for the Boundary Conditions.

As stated above Alpert et al. disclosed that the evolution scheme for the wave Equation 1 could be viewed as an integral form of the widely used Lax Wendroff method. This method uses central differencing in time to generate the following series 

Alpert et al. further used the wave Equation 1 that relates time derivatives to space derivatives to further modify Equation 18 . That is the wave Equation 1 may be re written as follows 

As further taught by Alpert et al. once a numerical approximation is selected for the Laplacian operator the Lax Wendroff scheme achieves arbitrary order accuracy in time by incorporating higher and higher powers of the Laplacian in a three time level scheme provided by the left side of Equations 18 20 and 21 which is represented by x t 2 x 0 x t . It is important to note that the order of time is t t then t 0 and finally t t. Therefore the right hand side of Equation 20 depends only on the field at a certain time e.g. t 0 .

It should be noted that the Equation 20 is the expanded version of the identity Equation 13 and 14 repeated below from which the well known Lax Wendroff method depends.

Using the well known Lax Wendroff method which is based on the identity Equation 13 the present invention uses an exact relation that relates the fields at multiple times but discretizes the propagation operator Lthat appears at each discrete time rather than an integral representation thereof. Note that Lis the operator defined by Equation 13 that acts on the operand 0 . That is 

This section will describe in detail i high order discretization of the field in the bulk ii stability analysis for the discretized solution of the field in the bulk and iii numerical examples for i and ii .

The bulk propagation may be defined as a field t propagating in a homogeneous regular lattice without boundaries. As was stated above the wave function is a field that varies continuously in space and time which means it has a value at every point in space and time. Therefore it would be impossible to store and process all the wave values at every point in space and at every time because there would be an infinite number of values. Accordingly an approximate representation is needed for the computation of the field which is done by Equation 23 which is the discretized representation of the wave field. In general the field t is discretized by tabulating its values on the space time lattice as follows 24 where is the discretized wave field the temporal steps are indexed by some integer n and related to the continuous time by the relation t n t and spatial steps are indexed by another integer m and related to continuous space e.g. in the x direction by the relation x m x. Therefore n is the number of time steps that have elapsed from the beginning of computation t is the temporal discretization interval i.e. time step size m is the grid coordinate number representing a specific point in the one dimensional space and x is the spatial discretization interval i.e. space increment or cell size .

From Equation 24 the present invention constructs a high order discretization of the propagation operator L defined by Equation 13 . This is accomplished by first requiring the discretization of the propagation operator Lto be exact for a suitable set of functions e.g. Equation 25 namely polynomials up to some degree d 

The discretization of the propagation operator Lis set to be 2M 1 numbers which are odd values of numbers to provide a symmetry with respect to any selected point m. The 2M 1 numbers are represented by the following equation circumflex over L t x 27 where circumflex over L is the discretized propagation operator that operates on the discretized representation of the wave function Equation 24 with t being the temporal discretization interval i.e. time step size and x being the spatial discretization interval i.e. space increment or cell size . The reason for the ratio t x in Equation 27 is described below. Please note that the discretized propagation operator circumflex over L should be written as circumflex over L but the subscript t is dropped for clarity and ease of reading. Placing Equation 27 within the context of Equations 13 and 14 results in the discretization of the propagation operator Lin Equation 13 which as stated above is a set of 2M 1 numbers represented by Equation 27 with the result that 

It should be noted that there are 2M 1 unknown numbers i.e. circumflex over L t x and d 1 equations according to Equation 31 . This implies that an equal number of equations and unknown numbers exist if 2M 1 d 1 or 2M d which represents a square system of equations. However in most cases one could and usually should allow M d 2 to achieve stability.

The stability of the time evolution is considered next before providing a detailed discussion regarding undetermined systems which are systems that have more unknowns than equations. As was stated above the numerical stability of a method describes how that method responds to the differences between the calculation and the function being approximated. In a stable method the errors due to the approximations are damped out as the computation proceeds. In an unstable method any errors in processing become magnified as the calculation proceeds. Because the discretized propagation is invariant to translations in both space and time the present invention uses the well known Von Neumann stability criteria to determine stability. In mathematical terms solutions for the well known equation 32 must be determined to find the dispersion relation 

Propagation is stable only if both circumflex over square root over circumflex over circumflex over 1. 36 The stability condition motivates the approach described by the present invention to solve undetermined equations for circumflex over L . The circumflex over L are the coefficients of a Fourier series for circumflex over . The requirement that the discretization be high order exact for polynomials up to degree d means that the first d 1 derivatives including the zeroth of the circumflex over at 0 match those of the true cos . 37 Trying to force too many derivatives of circumflex over to be correct at 0 will cause the stability condition Equation 36 to be violated at larger K. What is needed then is to have circumflex over be a good approximation for small and generally small for large enough that it is not a good approximation. Therefore the following minimization is done subject to the high order constraints of Equation 31 

This section provides some numerical examples of the discretization and stability for the bulk propagation using the methods of present invention. The numerical examples will provide examples of the stencil radii M required for a given discretization ratio t x and degree d and will show measures of discretization error. However before the examples a special aspect of the 1 1 dimensional wave equation should be reviewed. In one space dimension the propagation operator Lis as follows 

The discretization of the field is done by first constructing a high order discretization of the propagation operator L defined in Equation 13 . As stated above the present invention requires that the discretization to be exact for a suitable set of functions namely polynomials up to some degree d. Therefore the first act is to select the desired degree d of the polynomial. The next act in the discretization process is to select the lattice ratio t x i.e. the time steps versus the space steps. The third act is to find the minimum discretization radius M such that the stability conditions with respect to Equation 36 are satisfied that is M d 2.

Table 1 lists the minimum stencil radii M for 3 2 and 2 d 8. The size of the stencil is 2M 1. The actual equations used to obtain the minimum stencil radii M are Equation 39 to 41 which first calculate the discretized propagation operator circumflex over L . The results so obtained from Equations 39 to 41 are then used within Equation 35 and 36 to eventually determine the propagation stability. Of course if the result violates the conditions of Equation 36 a larger value of M must then be selected. For the stencil are of minimum size to achieve the discretization order. For 3 2and d 2 the stencil is of minimum size to cover the past light cone. In these cases the system of Equation 31 is square and a particular exemplary solution to the wave equation is circumflex over L which is the identity matrix which is to say that there is no filtering of the field at the earliest t t time step. For higher order the minimum stencil size grows not much faster than for .

The convergence of the discretization is examined by computing the deviation from the exemplary exact solution cos 2 . 44 Tabulations of the integral of the square of the error as a function of the number N of discretization points used are given for various orders of the discretization 3 2in Tables 2 and 3. All calculations were done in machine precision 64 bit reals . Numbers smaller than 10appear because of the squaring of the error. The domain of propagation is 0 x 1 and N time steps are used so that the solution is computed up to t . Recall that discretizations approximate exact functions and therefore will have an approximation error. In addition if more points N are used in the discretization to represent a continuous function the approximation error should decrease. The following simply determines as the number of points N is increased how quickly the error reduces. Therefore the convergence values given in the tables are p determined by the fit of cNin the integrated square error

The propagation formula Equation 13 is valid anywhere in the propagation region however if one tried to apply the bulk discretization near the boundaries one would have to evaluate the field outside of the propagation region the other side of the boundary . It seems as if the proper definition of the propagation operator Lfor field points less than t from the boundary might depend on the boundary conditions. Nevertheless the present invention discretizes the propagation operator Lwithout regard to any boundary conditions using again the formula for monomials Equation 25 . Near boundaries one might also select to have an irregular mesh. The present invention calls the points for which it uses an individually computed discretization of the propagation operator L border points. For each of these points 

In general the size of the discretization the number of points x for which the discretized propagation operator for the border points circumflex over L y x is nonzero need not be equal to that in the bulk 2M 1 or even to that for other border points y. Nevertheless the present invention has found that one can achieve stability by using the same number of neighboring points in the border as in the bulk for both completely regular meshes and those with points spaced more closely near the boundaries.

As stated above an essential feature of the present invention is independent discretization of the propagation operator Land the boundary conditions BCs . The present invention enforces the BCs by applying a projection operator after each use of the stepping formula Equation 16 . The BCs are expressed as linear constraints 

It should be noted that a homogeneous boundary condition is one where the propagation operator on the field is equal to zero or c 0. Therefore zero fields always obey homogeneous BCs. The differences between projection operator in Equation 17 and that of Equation 47 are cosmetic in nature. That is Equation 17 states that there is some projection operator Pthat operates on the field t whereas Equation 47 explicitly defines the projection operator Pof Equation 17 in terms of b which express the BCs.

The computations of the boundary condition coefficients are done exactly as for the propagation operator. That is 

The Dirichlet boundary condition states that the field vanishes at the boundary. If there is a field discretization point xexactly on the boundary the homogeneous Dirichlet BC is simply 0 and the part of the projection operation corresponding to that BC would seem to be simply set that field value to zero. If field discretization point xwere not on the boundary then bwould be the coefficients of a high order extrapolation operator from the field points xto the boundary points x. In order for the numerical evolution to be locally exact for polynomials up to degree d the following must be enforced for a homogeneous boundary condition solution 0 and

For nonzero l the coefficients of the discretized boundary condition bare thus usually extrapolative high order discretization as follows 

In all cases the present invention uses the same discretization criteria as before the coefficients are determined by the requirement that the discretization be exact for polynomial up to some degree d. The BCs for higher derivatives of the field should not be regarded as additional or extra. After all to obtain an error that is proportional to a high power of t one must make sure that the boundary condition is obeyed to that order.

Neumann boundary condition for one dimension states that the derivative of the field vanishes at the boundary. For more than one dimension it is the derivative of the normal perpendicular component of the field that vanishes at the boundary. Neumann BCs are handled analogously i.e. the coefficient bbeing the extrapolative high order discretization of 

The discretization criteria used for discretization of both the propagation operators and the BCs can be summarized as minimization of 

It should be noted that the quantity being minimized corresponds to a trapezoidal rule approximation to the integral of A x . Therefore it would seem natural in the case of unequally spaced points to generalize the criteria to minimized the weighted sum of squares using the trapezoidal rule approximation 

actually needs to approximate an integral. In the examples presented in the following section quadrature weights are used as described in the case of unequally spaced points. The answers were found to be somewhat better than using w 1 although both were stable and had the expected rate of convergence.

Recall that the wave equation was solved with mixed homogeneous BCs Dirichlet at one end x 0 and Neumann at the other x 1 . In addition the error was computed by deviation from the exact solution 

For equally spaced points the results for are shown in Table 4 and the results for 3 2are shown in Table 5. These examples were run from t 0 to 1 so that the number of time steps were N . Both sets of data demonstrate good convergence p 2d. The superior efficiency of high order discretization is again apparent in both cases the coarsest discretization with d 8 are more accurate than the finest discretization with d 2 see Table 6 .

The test for unequally spaced points near the boundaries used abscissae derived from Gauss Legendre quadrature rules. The unequally spaced points and the associated weights are tabulated in Table 6 assuming the last equally spaced point is x 0. The equally spaced points are separated by a unit length with unit weights. The first point in the tapered set is placed at 1. The same point spacing and weights are used on both ends that have different BCs . As shown in Table 6 the BCs are enforced at locations tabulated in the column labeled Endpoint. The resulting abscissae are mapped into the interval 0

For the case d 8 3 2 N 18 the ratio of t to minimum point spacing is 7.58. The degree to which this apparently violates the Courant Friedrichs Lewy CFL constraint t x 1 without losing stability demonstrates its utility because it allows fine discretization near boundaries. Of course more generally one could regard the discretization as consistent with CFL constraint in the sense that there are always points in the stencil outside the past light cone. The use of a tapered mesh near the boundaries only results in less error for high discretization orders and fine discretization. This does not mean that tapered meshes in higher dimensions will not be useful in one space dimension there is no need to resolve more detail at the boundaries.

With inhomogeneous BCs the cof Equations 46 48 do not vanish. For a numerical example the present invention again selects the exemplary solution cos 2 62 without using a cyclic mesh to establish periodic BCs. Instead the present invention uses the general BC projection technique of enforcing the correct values x t at x 0 1 with k 0 . . . d 2 where d is the degree of the discretization. This is an inhomogeneous Dirichlet BC . Results are stable with the same parameter values and tapered mesh as those for unequally spaced points. Results are tabulated in Tables 9 and 10. Errors are somewhat larger than the results with homogeneous BCs but the convergence rates are comparable.

The results presented in section I show high order convergence with stability that is not spoiled by the presence of small cells near the boundary. The results also exhibit the dramatic superiority in efficiency of high order discretization. The present invention has taken the Lax Wendroff approach that relates the fields at three time slices and uses only the field as the dynamic variable. It should be clear to one of ordinary skill in the art that the same approach can be used to generalize the formulation that relates the field and its first time derivative at two time slices 

With respect to parameter selections in general for the solution to a given problem with a desired accuracy it would be better to have justifiable procedure for selection of the many numerical parameters including discretization density degree of approximation and time step. Regarding balance of pre computation with propagation computation as in frequency domain computations there will be some tradeoffs between pre computation and solution. For large problems pre computation will be dominated by the discretization of the boarder propagation the boundary constraints and the decomposition of the coefficient matrix B bb which appears in Equation 48 . Because of its local structure this decomposition can be accelerated by employing nested dissection. Nested dissection is disclosed in a publication by A. George J. W. H. Liu entitled Computer Solution of Large Sparse Positive Definite Systems published by Prentice Hall Englewood Cliffs N.J. 1981.

For the frequency problems the use of wave discretizations that are specified by minimization of RMS error over some spectrum of sine waves rather than exactitude for low order polynomials results in more efficient calculation for a given accuracy. The present invention has shown that use of a tapered mesh near the boundary does not prevent stability and can result in smaller discretization error even in one dimension which might be thought to be marginal utility. The methods provided in this section I are formulated in a manner that are extendable to implement in any number of dimensions. In the following section II the methods in section I are extended to two or more space dimensions plus the time dimension.

In the previous section I it was described that consistent high order discretization can make Lax Wendroff method stable in the presence of small cells near the boundary in one space and one time dimension. Section I was a prescription of an explicit discretization of Equation 13 in one space dimension along with a projection operator that enforces the desired boundary conditions. Numerical examples were illustrated that alternated the use of the resultant propagation and projection operators that provided stable results with discretization error that decreased as a high power of the discretization scale. An essential ingredient of that approach was recognizing the implicit identity operator L when Equation 13 was solved for t which resulted in Equation 16 . Discretizing Lby the same prescription as was used for Lresulted in a low pass filter that facilitated stability. In this section II the present invention describes an extension of the approach in section I to two space dimensions. Section II describes a generalized discretization prescription which is then followed by b Propagation Operator in Bulk Region c Propagation Operator In Border Region and d Boundary Condition Projection Operator.

The generalized discretization prescription discretizes all the linear operators which include the propagation operator L interpolation extrapolation and differentiation operators. The field is assumed to be tabulated at a collection of points which need not be but mostly are on a regular lattice. All operators acting on a field are discretized as follows. The result of a linear function a on some known fields taken here to be polynomials are denoted as r . 65 Linear functions are approximated by circumflex over . 66 The coefficients circumflex over are computed by minimizing the weighted sum of squares 

In non mathematical terms suppose the time evolution in a spatial domain S is to be computed with suitable initial conditions and boundary conditions on the boundary S. The acts of the pre computation may be summarized as follows 

For efficiency in pre computation and convolution most of the propagation domain is discretized by tabulation of the field on a non limiting exemplary square lattice . 71 The propagation operator cos square root over 72 is discretized according to the general procedure above. The result of applying Lto polynomial testing functions is evaluated at the origin 

In the border region the propagation operator is discretized differently than in the bulk because by definition a bulk stencil centered on a border point will not entirely overlay discretization points. However the requirement that the discretization operator provide a correct answer Equation 73 for polynomials up to the selected degree remains the same. The general discretization method described above within this section II is used selecting the near neighbor discretization points to each border point these will usually include both border and bulk points . In general this must be done independently for each border point but symmetries of the problem and the discretization point set could be used to reduce the necessary pre computations. The number of points used can be the same as that M in the bulk region but in some cases it has been found empirically that more points are necessary to avoid instability. If a finer discretization were used near the boundary one would expect this necessity to have a greater tendency to occur.

The boundary condition projection operator computations for two or more dimensions exhibit the biggest change from one dimensional space because in one dimension there are only two boundary points. In two dimensions there is a need to select a set of points on the boundary S at which to impose the boundary conditions. A reasonable approach is to take their separation to be commensurate with the spacing of discretization points near the boundary. For example with the discretization points all on a square lattice the present invention uses boundary points along aS separated by the distance nearly equal to the lattice constant. In the case of a non uniform mesh points separated on the boundary by a distance commensurate with the smallest spacing in the nearby propagation region would be appropriate. For each boundary point extrapolation differentiation estimators are computed for the quantities constrained by desired boundary condition and powers of the Laplacian operating on these. For example for Dirichlet conditions one computes estimators for

In this section the results are provided for the present invention in the context of four examples of the methods for two space dimensions and one time dimension exhibiting discretizations of various degrees 2 8 that give stable results and the convergence of discretization error with density of sample points. The bulk propagation is studied first on a square region with periodic boundary conditions BCs . Next the two examples are provided with homogeneous BCs a square with Dirichlet BCs on two opposite sides and Neumann BCs on the other two and a disk with Neumann BCs. Finally an example of inhomogeneous BCs is provided a plane wave solution with Dirichlet BCs on a circle.

In Table 11 the stencil sizes for 1 and 2 d 8 are listed. The convergence of the discretization is examined by computing the deviation from the exact solution cos 2 sin 4 cos 2 square root over 5 . 90 A tabulation of the integral of the square of the error as a function of the number N of discretization points in each direction is given in Table 12 for various orders of discretization and t x 1. Periodic boundary conditions were enforced in the usual manner. All calculations were done in machine precision 64 bit reals . Numbers smaller than 10appear because of the squaring of the error. The domain of propagation is 0 x y 1 and N 2 time steps are used so that the solution is computed up to t . The convergence values given in the Tables are p determined by the fit of the integrated square error cNfor the range of N. The same data are plotted in . All discretizations were verified to be stable by running for thousands of time steps from white noise initial conditions and monitoring x y t dxdy.

In this section numerical results are provided for the wave equation in a square domain with homogeneous Dirichlet BCs on two opposing sides x 0 and x 1 and homogeneous Neumann conditions on the other two sides y 0 and y 1 . In the context of the present invention the error is computed by deviation from the exact solution x y t sin cos cos square root over 2 91 In order to achieve stability it was necessary to use more points for the discretization of the border propagation and boundary condition operators for all degrees of discretization. For degrees 6 and 8 more points in the bulk region were also required. The same number of points was used for all these discretizations. The number of points used is tabulated in Table 13. Tabulations of the integral of the square of the error as a function of the number N of discretization points in each direction are given in Table 14 for various orders of discretization and 1. The convergence values given in the Table are p determined by the fit of the integrated square error cNfor the range of N. The same data are plotted in . All discretizations were verified to be stable by running for hundreds of time steps from white noise initial conditions and monitoring x y t dxdy.

In this section numerical results are provided for the wave equation in a circular domain with homogeneous Neumann conditions at a 1.84118 the first root of J r . The present invention computed the error as the deviation from the exact solution cos 92 The circular region of propagation is inscribed in an N N square grid. The range of time was 0 t 2 . The value of changed somewhat so that t 2 was reached in an integral number of time steps. For sparse discretization values of were somewhat less than 1 approaching one as more points were used. Again it was necessary to use more points than those used for periodic BCs for the discretization of the operators. The same number of points M were used for all these discretization of border propagation operators and boundary projection operators. The number of points used is tabulated in Table 15. For computation of the degree 8 discretization coefficients extended precision arithmetic was used. All time stepping was done in normal double precision. Tabulations of the integral of the square of the error as a function of the number N of discretization points in each direction are given in Table 16 for various orders of discretization and 1. They are plotted in . The convergence values given in the Tables are p determined by the fit of the integrated square error cNfor the range of N.

Finally the present invention provides results for a plane wave cos 93 using inhomogeneous Dirichlet BCs on a circle of radius . As in the previous example the range of time was 0 t 2 and value of c changed somewhat so that t 2 was reached in an integral number of time steps. The number of points used is tabulated in Table 17. For computation of the degrees 6 and 8 discretization coefficients extended precision arithmetic was used. All time stepping was done in normal double precision. Note that for degree 8 fewer points were required than for homogeneous Neumann conditions above section iii . This is significant because one might think it harder to achieve stability with inhomogeneous BCs. Instead it seems that inhomogeneous BCs are no harder than homogeneous ones but that Dirichlet BCs are easier than Neumann BCs. Tabulations of the integral of the square of the error as a function of the number N of discretization points in each direction are given in Table 18 for various orders of discretization and 1. They are plotted in . The convergence values given in the tables are p determined by the fit of the integrated square error cN.

Although the invention has been described in language specific to structural features and or methodological steps it is to be understood that the invention defined in the appended claims is not necessarily limited to the specific features or steps described. Rather the specific features and steps are disclosed as desirable implementations of the claimed invention. Accordingly while exemplary illustrative embodiments of the invention have been described numerous variations and alternative embodiments will occur to those skilled in the art. For example although the present invention has not used a tapered mesh small cells are implicit because of the proximity of the boundary points to the border points. In addition it should be noted that the method presented is formulated in a manner that is straightforward to implement in any number of dimensions. Further it should be noted that the tapering of the mesh was not indicated because the examples provided by the present invention all have fields without singularities at the boundaries. For boundaries that induce singularities efficiency and accuracy will depend on the choice of the border mesh. Such variations and alternate embodiments are contemplated and can be made without departing from the spirit and scope of the invention.

