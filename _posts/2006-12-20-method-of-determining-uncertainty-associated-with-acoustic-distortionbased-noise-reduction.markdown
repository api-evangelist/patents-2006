---

title: Method of determining uncertainty associated with acoustic distortion-based noise reduction
abstract: A method and apparatus are provided for determining uncertainty in noise reduction based on a parametric model of speech distortion. The method is first used to reduce noise in a noisy signal. In particular, noise is reduced from a representation of a portion of a noisy signal to produce a representation of a cleaned signal by utilizing an acoustic environment model. The uncertainty associated with the noise reduction process is then computed. In one embodiment, the uncertainty of the noise reduction process is used, in conjunction with the noise-reduced signal, to decode a pattern state.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07289955&OS=07289955&RS=07289955
owner: Microsoft Corporation
number: 07289955
owner_city: Redmond
owner_country: US
publication_date: 20061220
---
This application is a divisional of and claims priority from U.S. patent application Ser. No. 10 236 042 filed on Sep. 5 2002 now U.S. Pat. No. 7 142 292 issued 6 Feb. 2007 which was a continuation in part of U.S. patent application Ser. No. 10 152 127 filed May 20 2002 now U.S. Pat. No. 7 103 540 issued 5 Sep. 2006 and entitled METHOD OF PATTERN RECOGNITION USING NOISE REDUCTION UNCERTAINTY and was a continuation in part of U.S. patent application Ser. No. 10 152 143 filed May 20 2002 now U.S. Pat. No. 7 107 210 and entitled METHOD OF NOISE REDUCTION BASED ON DYNAMIC ASPECTS OF SPEECH.

The present invention relates to pattern recognition. In particular the present invention relates to performing pattern recognition after noise reduction.

A pattern recognition system such as a speech recognition system takes an input signal and attempts to decode the signal to find a pattern represented by the signal. For example in a speech recognition system a speech signal often referred to as a test signal is received by the recognition system and is decoded to identify a string of words represented by the speech signal.

To decode the incoming test signal most recognition systems utilize one or more models that describe the likelihood that a portion of the test signal represents a particular pattern. Examples of such models include Neural Nets Dynamic Time Warping segment models and Hidden Markov Models.

Before a model can be used to decode an incoming signal it must be trained. This is typically done by measuring input training signals generated from a known training pattern. For example in speech recognition a collection of speech signals is generated by speakers reading from a known text. These speech signals are then used to train the models.

In order for a model to work optimally the signals used to train the model should be similar to the eventual test signals that are decoded. In particular it is desirable that the training signals contain the same amount and type of noise as the test signals that are decoded.

Typically the training signal is collected under clean conditions and is considered to be relatively noise free. To achieve this same low level of noise in the test signal many prior art systems apply noise reduction techniques to the testing data. These noise reduction techniques result in a cleaned test signal that is then used during pattern recognition. In most systems the noise reduction technique produces a sequence of multi dimensional feature vectors with each feature vector representing a frame of a noise reduced signal.

Unfortunately noise reduction techniques do not work perfectly and as a result there is some inherent uncertainty in the cleaned signal. In the past there have been two general techniques for dealing with such uncertainty. The first has been to ignore the uncertainty and treat the noise reduction process as being perfect. Since this ignores the true state of the recognition system it results in recognition errors that could be avoided.

The other prior art technique for dealing with uncertainty in noise reduction is to identify frames of the input signal where the noise reduction technique is likely to have performed poorly. In these frames dimensions of the feature vectors that are likely in error are marked by the noise reduction system so that they are not used during recognition. Thus the feature vector components that have more than a predetermined amount of uncertainty are completely ignored during decoding. Although such systems acknowledge uncertainty in noise reduction the technique of completely ignoring a component treats the component as providing no information that would be helpful during recognition. This is highly unlikely because even with a significant amount of uncertainty the noise reduced component still provides some information that would be helpful during recognition.

In addition the prior art has not provided a means for determining the uncertainty of some noise removal processes. As a result it has not been possible to determine the uncertainty associated with those processes.

In light of this techniques are needed to identify the uncertainty in noise reduction and use that uncertainty during pattern recognition.

A method and apparatus are provided for reducing noise in a noisy signal. In particular noise is reduced from a representation of a portion of a noisy signal to produce a representation of a cleaned signal by utilizing an acoustic environment model. The uncertainty associated with the noise reduction process is then computed. In one embodiment the uncertainty of the noise reduction process is used to decode a pattern state from the cleaned signal.

The invention is operational with numerous other general purpose or special purpose computing system environments or configurations. Examples of well known computing systems environments and or configurations that may be suitable for use with the invention include but are not limited to personal computers server computers hand held or laptop devices multiprocessor systems microprocessor based systems set top boxes programmable consumer electronics network PCs minicomputers mainframe computers telephony systems distributed computing environments that include any of the above systems or devices and the like.

The invention may be described in the general context of computer executable instructions such as program modules being executed by a computer. Generally program modules include routines programs objects components data structures etc. that perform particular tasks or implement particular abstract data types. The invention may also be practiced in distributed computing environments where tasks are performed by remote processing devices that are linked through a communications network. In a distributed computing environment program modules may be located in both local and remote computer storage media including memory storage devices.

With reference to an exemplary system for implementing the invention includes a general purpose computing device in the form of a computer . Components of computer may include but are not limited to a processing unit a system memory and a system bus that couples various system components including the system memory to the processing unit . The system bus may be any of several types of bus structures including a memory bus or memory controller a peripheral bus and a local bus using any of a variety of bus architectures. By way of example and not limitation such architectures include Industry Standard Architecture ISA bus Micro Channel Architecture MCA bus Enhanced ISA EISA bus Video Electronics Standards Association VESA local bus and Peripheral Component Interconnect PCI bus also known as Mezzanine bus.

Computer typically includes a variety of computer readable media. Computer readable media can be any available media that can be accessed by computer and includes both volatile and nonvolatile media removable and non removable media. By way of example and not limitation computer readable media may comprise computer storage media and communication media. Computer storage media includes both volatile and nonvolatile removable and non removable media implemented in any method or technology for storage of information such as computer readable instructions data structures program modules or other data. Computer storage media includes but is not limited to RAM ROM EEPROM flash memory or other memory technology CD ROM digital versatile disks DVD or other optical disk storage magnetic cassettes magnetic tape magnetic disk storage or other magnetic storage devices or any other medium which can be used to store the desired information and which can be accessed by computer . Communication media typically embodies computer readable instructions data structures program modules or other data in a modulated data signal such as a carrier wave or other transport mechanism and includes any information delivery media. The term modulated data signal means a signal that has one or more of its characteristics set or changed in such a manner as to encode information in the signal. By way of example and not limitation communication media includes wired media such as a wired network or direct wired connection and wireless media such as acoustic RF infrared and other wireless media. Combinations of any of the above should also be included within the scope of computer readable media.

The system memory includes computer storage media in the form of volatile and or nonvolatile memory such as read only memory ROM and random access memory RAM . A basic input output system BIOS containing the basic routines that help to transfer information between elements within computer such as during start up is typically stored in ROM . RAM typically contains data and or program modules that are immediately accessible to and or presently being operated on by processing unit . By way of example and not limitation illustrates operating system application programs other program modules and program data .

The computer may also include other removable non removable volatile nonvolatile computer storage media. By way of example only illustrates a hard disk drive that reads from or writes to non removable nonvolatile magnetic media a magnetic disk drive that reads from or writes to a removable nonvolatile magnetic disk and an optical disk drive that reads from or writes to a removable nonvolatile optical disk such as a CD ROM or other optical media. Other removable non removable volatile nonvolatile computer storage media that can be used in the exemplary operating environment include but are not limited to magnetic tape cassettes flash memory cards digital versatile disks digital video tape solid state RAM solid state ROM and the like. The hard disk drive is typically connected to the system bus through a non removable memory interface such as interface and magnetic disk drive and optical disk drive are typically connected to the system bus by a removable memory interface such as interface .

The drives and their associated computer storage media discussed above and illustrated in provide storage of computer readable instructions data structures program modules and other data for the computer . In for example hard disk drive is illustrated as storing operating system application programs other program modules and program data . Note that these components can either be the same as or different from operating system application programs other program modules and program data . Operating system application programs other program modules and program data are given different numbers here to illustrate that at a minimum they are different copies.

A user may enter commands and information into the computer through input devices such as a keyboard a microphone and a pointing device such as a mouse trackball or touch pad. Other input devices not shown may include a joystick game pad satellite dish scanner or the like. These and other input devices are often connected to the processing unit through a user input interface that is coupled to the system bus but may be connected by other interface and bus structures such as a parallel port game port or a universal serial bus USB . A monitor or other type of display device is also connected to the system bus via an interface such as a video interface . In addition to the monitor computers may also include other peripheral output devices such as speakers and printer which may be connected through an output peripheral interface .

The computer may operate in a networked environment using logical connections to one or more remote computers such as a remote computer . The remote computer may be a personal computer a hand held device a server a router a network PC a peer device or other common network node and typically includes many or all of the elements described above relative to the computer . The logical connections depicted in include a local area network LAN and a wide area network WAN but may also include other networks. Such networking environments are commonplace in offices enterprise wide computer networks intranets and the Internet.

When used in a LAN networking environment the computer is connected to the LAN through a network interface or adapter . When used in a WAN networking environment the computer typically includes a modem or other means for establishing communications over the WAN such as the Internet. The modem which may be internal or external may be connected to the system bus via the user input interface or other appropriate mechanism. In a networked environment program modules depicted relative to the computer or portions thereof may be stored in the remote memory storage device. By way of example and not limitation illustrates remote application programs as residing on remote computer . It will be appreciated that the network connections shown are exemplary and other means of establishing a communications link between the computers may be used.

Memory is implemented as non volatile electronic memory such as random access memory RAM with a battery back up module not shown such that information stored in memory is not lost when the general power to mobile device is shut down. A portion of memory is preferably allocated as addressable memory for program execution while another portion of memory is preferably used for storage such as to simulate storage on a disk drive.

Memory includes an operating system application programs as well as an object store . During operation operating system is preferably executed by processor from memory . Operating system in one preferred embodiment is a WINDOWS CE brand operating system commercially available from Microsoft Corporation. Operating system is preferably designed for mobile devices and implements database features that can be utilized by applications through a set of exposed application programming interfaces and methods. The objects in object store are maintained by applications and operating system at least partially in response to calls to the exposed application programming interfaces and methods.

Communication interface represents numerous devices and technologies that allow mobile device to send and receive information. The devices include wired and wireless modems satellite receivers and broadcast tuners to name a few. Mobile device can also be directly connected to a computer to exchange data therewith. In such cases communication interface can be an infrared transceiver or a serial or parallel communication connection all of which are capable of transmitting streaming information.

Input output components include a variety of input devices such as a touch sensitive screen buttons rollers and a microphone as well as a variety of output devices including an audio generator a vibrating device and a display. The devices listed above are by way of example and need not all be present on mobile device . In addition other input output devices may be attached to or found with mobile device within the scope of the present invention.

In the discussion below the present invention is described with reference to speech recognition to facilitate understanding of the invention. However those skilled in the art will recognize that the present invention is not limited to speech recognition and may be used in any pattern recognition system.

The goal of speech recognition is to convert a speech signal into a sequence of words. To do this the speech signal is typically divided into overlapping frames of speech and each frame is converted into a feature vector y which describes the content of the frame. During recognition also referred to as decoding an acoustic model is used to identify a most likely sequence of phonetic states that could be represented by the feature vectors. The resulting sequence of phonetic states represents the decoded sequence of words.

Many acoustic models evaluate a mixture of Gaussians to determine the probability of any one phonetic state. Thus at each frame a mixture of Gaussians is evaluated for each phonetic state to identify the most likely phonetic state for the frame. The evaluation of each Gaussian can be viewed as determining p y m which is the probability of the feature vector y given the mixture component m for the phonetic state.

When using noise reduction in combination with speech recognition a noisy input feature vector y is converted into a cleaned feature vector circumflex over x by the noise reduction system. The cleaned feature vector represents an estimate of an actual clean feature vector x. The cleaned feature vector circumflex over x is then applied as an input signal to the speech recognition system which attempts to identify a most likely phonetic state given the cleaned feature vector.

Without noise corruption the observation vector y is the same as the clean vector x. As such evaluating a Gaussian for a mixture component for a clean observation vector p y m is the same as evaluating the probability of clean vector x given mixture component m p x m .

However when the observation vector is corrupted by noise and a noise reduction system is used the input to the recognizer is no longer the ideal clean vector x but instead is the cleaned feature vector circumflex over x which is only an estimate of x. In the past it has been common to simply treat the cleaned feature vector circumflex over x as if it were equal to the ideal clean feature vector x. In such cases evaluating a Gaussian for a mixture component p y m has been approximated by determining the probability p circumflex over x m .

Under the present invention a more rigorous approach is used in which the probability p y m is determined by marginalizing a joint conditional probability density function p y x m over all possible unseen clean speech vectors. In terms of an equation 

To make the computations associated with EQ. 2 easier to implement the probability p y x m is assumed to be independent of m so that it becomes p y x . This probability is then modeled as a Gaussian distribution that describes the certainty of the noise reduction process. In particular EQ. 3 where the distribution is defined across the cleaned feature vectors circumflex over x and has a mean equal to the ideal clean feature vector x and a variance that represents the variance associated with the noise reduction process. Note that in EQ. 3 a simplified notation has been used to represent the Gaussian distribution as a single Gaussian across the entire vector. In fact there is a separate Gaussian with its own mean and variance for each dimension of the feature vector. For example EQ. 4 where yis component l of the noisy feature vector xis component l of the clean feature vector circumflex over x is component l of the cleaned feature vector and is the variance also referred to as uncertainty associated with the noise reduction process for component l of the feature vectors.

The prior probability p x m is also modeled as a collection of Gaussian distributions one for each component of the vector such that EQ. 5 where is the mean of the prior distribution and is the variance of the distribution for component l of the feature vectors.

Thus under the framework of the present invention the variance of the distribution used in the acoustic model is a combination of the variance associated with the prior model and the variance or uncertainty associated with the noise reduction process . As a result if the uncertainty associated with the noise reduction process is high for a component there will be little difference between the probabilities generated for each phonetic state. As a result the component will have little effect on the decoding of the phonetic state sequence. However if the uncertainty of the noise reduction process is small the acoustic models for the various phonetic states will generate distinctive probabilities for the component and the component will thereby strongly influence the selection of the phonetic state.

Under one embodiment of the present invention the noise reduction process utilizes a prior model of dynamic aspects of clean speech a prior model of static aspects of clean speech and an acoustic distortion or acoustic environmental model that describes the relationship between clean speech noisy speech and noise. The invention thus provides a technique for determining the uncertainty in this parametric based noise reduction process.

In the discussion below the noise reduction method is performed in the cepstral domain. In particular each frame of clean speech noisy speech and noise is represented by a cepstral feature vector that is formed by taking the logarithm and discrete cosine transform of the frequency domain representation of the signal within the frame. Thus in the discussion below the method attempts to identify a noise reduced feature vector from a noisy speech feature vector. As with Equation 3 above a simplified notation is used below that treats each vector as being represented by a single distribution. In implementation there is a separate distribution for each component of the vector.

To reduce the noise from the noisy vector the minimum mean square estimate of the noise reduced vector is determined using the conditional expectation EQ. 7 where circumflex over x is the estimate for the noise reduced feature vector of the current frame circumflex over x is the estimate for the noise reduced feature vector determined for a previous frame yis a noisy speech feature vector for the current frame and xis a clean speech feature vector for the current frame.

Under one embodiment of the present invention a mixture model is used to describe the conditional probability p x circumflex over x . In terms of an equation 

Under one embodiment noisy speech is considered to be the result of noise being added to clean speech. This provides an acoustic environment model otherwise known as a distortion model for the noisy speech. In the time domain this addition is linear. However in the cepstral feature domain this addition becomes non linear resulting in a feature vector relationship of EQ. 10 where log 1 EQ. 11 and r is a residual.

To make the expression of Equation 10 easier to use the non linearity is linearized using a truncated Taylor series approximation. In particular a zero th order Taylor series expansion on g n x at x xis used to form the approximation EQ. 12 where g x is the zero th order Taylor series expansion at expansion point x and is an estimate of the noise in the current frame. In most embodiments the expansion point x is selected as the estimate of the clean speech signal determined during a previous iteration of the noise reduction process and is determined using a recursive technique such as the one disclosed in a pending U.S. Patent Application entitled METHOD OF ITERATIVE NOISE ESTIMATION IN A RECURSIVE FRAMEWORK filed on Apr. 5 2002 and having Ser. No. 10 116 792 now U.S. Pat. No. 6 944 590 issued 13 Sep. 2005. Those skilled in the art will recognize that the recursive technique for noise estimation is one example of a number of different noise estimation techniques that may be utilized with the present invention.

Based on the relationship shown in Equation 12 the conditional probability p y x of Equation 8 becomes an acoustic environment probability p y x . Using this acoustic environment probability and Equation 9 above Equation 8 can be re written as 

To compute the integral of Equation 13 the conditional prior p x m is first evaluated. To make this evaluation easier it is recognized that EQ. 14 where EQ. 15

Thus in Equation 14 xrepresents the static aspects of clean speech and xrepresents the dynamic aspects of clean speech.

To further simplify the evaluation of the conditional prior it is assumed that the static aspects of clean speech are uncorrelated to the dynamic aspects of clean speech. As a result EQ. 16

Under one embodiment the prior probability for the static aspects of clean speech and the prior probability for the dynamic aspects of clean speech are each modeled as Gaussian distributions such that EQ. 17 where and are the mean and variance of the prior model for the static aspects of clean speech and and are the mean and variance of the prior model for the dynamic aspects of clean speech.

Fitting the exponent in the product of the above two Gaussian distributions into the standard quadratic form in x and using Equation 14 above produces EQ. 18 where

In many embodiments the acoustic environment probability p y x is also modeled as a Gaussian distribution producing an acoustic model of the form EQ. 21 where is a fixed diagonal covariance matrix that is an approximation to the covariance matrix for the residual r.

The Gaussian distribution in Equation 25 can be shown to be the likelihood of observation ygiven the m th component in the clean speech model under the zero th order approximation made in Equation 15. That is EQ. 28

Each summand in Equation 30 is a mixture component contribution to the final reduced noise vector. Each summand is formed by multiplying the weighted sum of three terms by the relative probability of the noisy feature vector y occurring given the mixture component. The first term is the prediction of the reduced noise vector taken from the mean of the static aspects of the prior clean speech model . The second term is the prediction for the reduced noise vector based on the estimate of the reduced noise vector for the preceding frame and the mean of the dynamic aspects of the prior clean speech model x . The last term y g x is the prediction for the noise reduced clean speech vector based on the acoustic distortion model in absence of any prior information.

Thus the estimator of Equation 30 utilizes a prior model of static aspects of clean speech a prior model of dynamic aspects of clean speech and an acoustic distortion model. As a result the sequence of noise reduced vectors produced using the estimator of Equation 30 contain fewer discontinuities and appear more natural.

In addition the weighting values applied to each of the terms in each summand are such that as the variance of one of the terms increases its relative weighting decreases. Thus as a term becomes more accurate in its description of the noise reduced value its weighting increases relative to the weighting of the other terms.

For example the weighting value applied to the value predicted by the prior model for static aspects of clean speech is a function of the variance of the prior model for dynamic aspects of clean speech. As a result when the variance of the model for the dynamic aspects of cleans speech increases relative to the variance of the model for the static aspects of clean speech the relative weighting of the value predicted by the prior model for static aspects increases.

A similar effect occurs for the weighting of the value predicted by the prior model for the dynamic aspects of clean speech since this weighting value is a function of the variance of the prior model for the static aspects of clean speech.

Before the estimator of Equation 31 can be used the parameters for the various models must be trained. Under one embodiment an EM algorithm is used to train the mean and covariance parameters and in the cepstral domain. During this training process the mixture component weights c are also trained. Techniques for performing such training are well known in the art. The fixed covariance matrix is estimated by pooling the training data with all available signal to noise ratios.

Under one embodiment the noise reduced vector x is determined in an iterative fashion such that the value of the noise reduced vector in a current iteration is used as the expansion point x of the Taylor Series approximation g x in the next iteration. For the first iteration the expansion point for the Taylor Series approximation is the mixture component mean that provides the highest probability for the noisy vector using the normal distribution EQ. 32

Thus the expectation for the noise reduced vector is EQ. 35 where J is the total number of iterations.

Under the present invention the uncertainty associated with the noise reduction process represented by the iteration of equation 33 is also calculated so that it can be used during recognition. The uncertainty is the variance in which is defined as EQ. 36 where

The value calculated in Equation 43 is then used together with the square of the expectation for the noise reduced vector calculated in equations 33 35 to determine the uncertainty of the noise reduction process using equation 36 above. Note that in Equation 36 is a vector representation of the uncertainty and that it represents a separate uncertainty for each component of the static noise reduced vector .

Equations 33 35 above determine the static components of the noise reduced vector. Under embodiments of the present invention differentials of these static components that describe how the components change between frames can also be determined. These differentials are referred to generically as dynamic features. Under the present invention two types of dynamic features are determined. One is the delta feature that indicates changes between frames and the other is the acceleration feature that indicates the rate of change of the delta features. Under one embodiment the delta features are calculated as 

Acceleration features can also be determined based on the delta features calculated in Equation 45. Specifically 

The delta and acceleration features are provided to the decoder along with the static noise reduced features. In addition the uncertainty of the delta and acceleration features are calculated and provided to the decoder. Specifically the uncertainty of the delta and acceleration features are calculated as 

The uncertainty of the static features the delta features and the acceleration features are each used in Equation 6 to determine the probability of corresponding features of the noisy feature vector during decoding. In particular each component of the delta feature and acceleration feature calculated in Equations 45 and 46 is treated as a separate component of the noise reduced vector and the corresponding uncertainty associated with each component of the delta vector and each acceleration vector is used as an uncertainty in Equation 6.

A method and system for using the present invention in speech recognition is shown in the flow diagram of and the block diagram of . The method begins in step of where a noisy speech signal is converted into a sequence of feature vectors. To do this a microphone of converts audio waves from a speaker and one or more additive noise sources into electrical signals. The electrical signals are then sampled by an analog to digital converter to generate a sequence of digital values which are grouped into frames of values by a frame constructor . In one embodiment A to D converter samples the analog signal at 16 kHz and 16 bits per sample thereby creating 32 kilobytes of speech data per second and frame constructor creates a new frame every 10 milliseconds that includes 25 milliseconds worth of data.

Each frame of data provided by frame constructor is converted into a feature vector by a feature extractor . Methods for identifying such feature vectors are well known in the art and include 13 dimensional Mel Frequency Cepstrum Coefficients MFCC extraction.

In step of the feature vectors for the noisy speech signal are provided to a noise estimation module in . Noise estimation module estimates the noise in the current frame and provides a feature vector representing the noise estimate together with the noisy speech signal to a noise reduction module .

In step of noise reduction module uses Equations 33 35 45 and 46 above and the model parameters of those equations which are stored in noise reduction parameter storage to produce a sequence of noise reduced feature vectors from the sequence of noisy feature vectors. In particular noise reduction module uses an acoustic distortion model as described above. In addition noise reduction module uses equations 36 44 47 and 48 to determine an uncertainty associated with forming the noise reduced feature vectors.

The output of noise reduction module is a series of noise reduced feature vectors and a corresponding series of uncertainties associated with those noise reduced feature vectors. If the input signal is a training signal the series of noise reduced feature vectors are provided to a trainer which uses the noise reduced feature vectors and a training text to train an acoustic model . Techniques for training such models are known in the art and a description of them is not required for an understanding of the present invention.

If the input signal is a test signal the noise reduced feature vectors and the corresponding uncertainties are provided to a decoder which identifies a most likely sequence of words based on the stream of feature vectors the stream of uncertainties a lexicon a language model and the acoustic model as shown by step of . Specifically the decoding utilizes equation 6 above.

The most probable sequence of hypothesis words is provided to a confidence measure module . Confidence measure module identifies which words are most likely to have been improperly identified by the speech recognizer based in part on a secondary acoustic model not shown . Confidence measure module then provides the sequence of hypothesis words to an output module along with identifiers indicating which words may have been improperly identified. Those skilled in the art will recognize that confidence measure module is not necessary for the practice of the present invention.

Although depicts a speech recognition system the present invention may be used in any pattern recognition system and is not limited to speech.

Although the present invention has been described with reference to particular embodiments workers skilled in the art will recognize that changes may be made in form and detail without departing from the spirit and scope of the invention.

