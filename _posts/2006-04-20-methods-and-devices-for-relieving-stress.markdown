---

title: Methods and devices for relieving stress
abstract: Easy to use, cost-effective methods and devices for evaluating and treating stress and thereby disorders caused or exacerbated by stress are provided. More particularly methods and devices for identifying RSA waves during respiration which provide a subject with real-time RSA wave information are provided. These methods and devices also can be used to identify drop points in RSA waves. Such methods and devices provide subjects with the ability to maintain parasympathetic outflow and thereby prevent and/or reduce levels of stress.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08002711&OS=08002711&RS=08002711
owner: Respironics, Inc.
number: 08002711
owner_city: Murrsyville
owner_country: US
publication_date: 20060420
---
This application is a continuation in part of and claims priority to and benefit from U.S. application Ser. No. 11 084 456 filed Mar. 18 2005 now U.S. Pat. No. 7 691 049. This application also claims priority to and benefit from U.S. Provisional Application No. 60 673 148 filed Apr. 20 2005 U.S. Provisional Application No. 60 673 627 filed Apr. 21 2005 and U.S. Provisional Application No. 60 705 883 filed Aug. 4 2005. The contents of each of the above referenced applications are hereby incorporated by reference in their entireties.

The present invention relates to methods and devices for evaluating and treating stress and stress related disorders. More particularly the present invention relates to biofeedback devices and methods for increasing parasympathetic nerve activity by providing information on respiratory sinus arrhythmia patterns.

Despite the existence of many stress reduction products and services stress and stress related disorders still result in staggering economic and non economic costs. It has been estimated that in the United States alone job stress accounts for nearly 300 billion annually in terms of productivity absenteeism and turnover. Over and above the direct work related costs attempts at treating stress and stress related disorders accounted for over 17 billion in anti depression and anti anxiety drugs in 2002. An ever upward trend in annual costs of such pharmacological treatments continues.

In addition stress results in significant but incalculable costs due to concomitant health problems stemming directly or indirectly from underlying stress disorders. For example studies have shown that people experiencing stress are more susceptible to viral and non viral diseases. A common and well known example of this is the relationship between stress and respiratory infections. Moreover those suffering from an illness take longer to recover if suffering from stress as well.

Chronic stress can impair both the balance of the autonomic nervous system ANS and the efficacy of the ANS resulting in a myriad of stress related disorders. Impairment of the ANS results in degenerative disease and premature death. For example a clinical study examined a single two minute measurement of the ANS from 14 025 healthy men and women between the ages of 45 and 64. After eight years those with a lower parasympathetic measurement had a much greater incidence of disease and death. Three other studies US Denmark and Finland have also examined ANS function as it relates to all cause mortality . In each study low parasympathetic ANS function preceded and predicted illness and death. Literally hundreds of other studies have examined ANS function as it relates to individual illnesses such as heart disease diabetes and stroke. For example the British government commissioned a study on the ANS function and heart disease. Those with the lowest parasympathetic ANS function had more than a 1 000 increase in mortality rate from heart attacks. Non economic costs of stress are also significant and include the harmful effects on relationships with family friends neighbors and co workers.

The stress response involves two basic systems the autonomic nervous system and the endocrine system. The ANS generally innervates smooth muscles of internal organs and consists of sympathetic and parasympathetic divisions. In simple terms the sympathetic division is responsible for mobilizing energy to respond to emergencies fight or flight express emotions or perform strenuous activities while the parasympathetic division acts to exert a calming influence and thereby balance the sympathetic system. As sympathetic nerves become increasingly active they increase heart rate blood pressure breathing rates mental activity thereby agitating the brain and other bodily functions. Thus stress is maintained by high activity of the sympathetic nerves.

The endocrine system is also involved in stress related processes. In particular the hypothalamic pituitary adrenal HPA axis plays a major role in the endocrine system s stress response. The hypothalamus secretes peptide hormones to stimulate the pituitary glands which in turn secrete its own hormones to stimulate other endocrine glands. The adrenal glands secrete cortisol which regulates metabolism and the production of energy and regulates responses in the sympathetic and parasympathetic branches of the autonomic nervous system. Cortisol levels are directly related to the degree of an individual s stress response.

In the early 1970 s Dr. Herbert Benson documented the existence of a neurological and physiological state opposite of the stress response. This state called the relaxation response has been verified by other clinical investigators. From an autonomic nervous system perspective the stress response is characterized by high activity of the sympathetic branch while the relaxation response is characterized by high activity of the parasympathetic branch. Inducing the relaxation response by definition interrupts an activated stress response. Therefore frequent activation of the relaxation response can prevent stressors from creating on going i.e. chronic stress. Also frequent activation of the relaxation response has been shown to reverse much of the damage including hypertension caused by previously encountered chronic stress.

The interaction of the two branches of the autonomic nervous system sympathetic and parasympathetic can be characterized by examining the small changes in the time occurring between each consecutive heart beat. When an individual is at rest variation in the beat to beat time is caused by the parasympathetic branch. This variation will increase and decrease according to an individual s respiratory pattern. During inspiration the parasympathetic branch is inhibited and the heart rate will begin to rise. During expiration the parasympathetic branch engages and lowers the heart rate. This relationship between the changing heart rate and breathing is called respiratory sinus arrhythmia RSA . RSA measurements are mathematical calculations of the degree to which the heart rate rises and falls. When the rise and fall are greater then the activity of the parasympathetic nervous system is greater. In other words greater RSA indicates greater parasympathetic activity. As stated previously a sufficient increase in parasympathetic activity shifts the body into the relaxation response thereby interrupting any pre existing stress response.

Many attempts have been made to activate the relaxation response to treat or control stress including both invasive and non invasive techniques and procedures. For example acupuncture prescription and non prescription pharmacological treatments and psychotherapy have all been used in attempts to relieve or control stress. However each of these therapies involves significant costs in money and time. Moreover the effectiveness of these treatments is often less than complete and is sometimes nearly non existent. Effectiveness often is difficult to evaluate and is many times only temporary. In addition pharmacological treatments frequently have undesirable side effects and some may even have addiction risks. Also even with all the available alternatives stress still is responsible either directly or indirectly for more than 80 of visits to doctors.

Accordingly a clear need exists for methods and devices for evaluating and treating stress wherein such methods and devices are effective non invasive simple to use and inexpensive. In addition a clear need exists for methods and devices which do not have unwanted side effects or create addiction risks. In particular a clear need exists for methods and devices which promote the reduction of stress by providing high levels of uninterrupted parasympathetic activity and which are capable of immediately halting the stress response.

The present invention provides easy to use cost effective methods and devices for evaluating and treating stress and thereby disorders caused or exacerbated by stress. More particularly the present invention provides methods and devices for identifying individual RSA waves and providing a subject with RSA wave information. This information can be used for example in biofeedback settings to assist subjects in reducing levels of stress and achieving rhythmic breathing.

The present invention also provides methods and devices which allow for the immediate cessation of the physiological stress response which prevents the stress response from harming the body and mind. Regular use of methods and devices according to the present invention allows for the reversal of physiological damage caused by prior exposures to stress including the accumulated effects of chronic stress.

Accordingly one exemplary embodiment of the present invention provides portable handheld biofeedback devices for preventing reducing or eliminating stress in human subjects.

Another exemplary embodiment of the present invention provides methods and devices for maintaining a substantially continual state of high parasympathetic activity for a sustained period of time.

Another exemplary embodiment of the present invention provides portable handheld biofeedback devices which contain a photoplethysmograph PPG sensor and a display screen to provide subjects with information on their RSA waves.

A further exemplary embodiment of the present invention provides methods and devices for training subjects to reduce levels of stress by achieving a respiration frequency of close to 6 breaths per minute.

Another exemplary embodiment of the present invention provides methods and devices which promote the reduction of stress by providing high levels of uninterrupted parasympathetic activity along with real time feedback on such activity.

A further exemplary embodiment of the present invention provides methods and devices which give the user information about the transition in RSA waves from ascending points to descending points wherein such information can be used to guide the respiration of the user.

Yet another exemplary embodiment of the present invention provides methods for detecting and correcting erroneous data relating to RSA waves and devices which utilize such methods.

Another exemplary embodiment of the present invention provides methods for adjusting scaling on a display screen of portable biofeedback devices and devices which utilize such methods.

Still another embodiment of the present invention identifies respiration patterns including depth rate and volume by analyzing RSA waves and provides a display of same.

Studies have shown that controlled respiration can shift the balance between the sympathetic and parasympathetic branches. Three specific respiratory components interactively determine the amount of parasympathetic innervation. These three components include frequency tidal volume and expiration inspiration ratio. In general parasympathetic activity can be increased by reducing breath frequency increasing tidal volume and or increasing the expiration inspiration ratio. Thus altering these three variables has the potential to increase parasympathetic activity enough to effectively elicit the relaxation response non invasively simply inexpensively and without negative side effects.

Generally speaking biofeedback methods and devices involve training processes which allow subjects to facilitate changes in behavior or activity in order to improve or maintain one or more physiological functions. Over time a subject can be trained with biofeedback methods and devices to exercise greater control over these functions. In contrast to other forms of therapy in which treatment is imposed upon the subject biofeedback methods and devices allow the subject to gradually integrate the training processes into almost automatic responses.

The present invention relates to methods and devices which can provide biofeedback information and training for subjects suffering from stress and stress related disorders. Such biofeedback information and training may be based on an analysis of respiratory sinus arrhythmia patterns and breathing that can affect such patterns.

There are no known methods for identifying individual RSA waves during spontaneous breathing using only the RSA data set. In order to correlate RSA waves with respiration usually heart rate and respiration rate information is collected and mapped separately. One aspect of the present invention includes the identification of the individual waves within a RSA data set. Further aspects of the present invention include the use of RSA wave patterns to provide subjects with real time respiratory feedback information based on heart rate data. Means for decreasing or adequately controlling stress levels are also provided based on wave pattern analysis and respiratory feedback.

In addition there are no known methods for identifying individual RSA waves in real time during spontaneous breathing using only the RSA data set. An additional aspect of the present invention allows for such real time identification and uses this information to promote the production of high levels of uninterrupted parasympathetic activity.

In one exemplary embodiment of the present invention identification and analysis of respiratory sinus arrhythmia wave patterns begins by measuring a subject s pulse rate on a beat to beat basis. It is well established in medical literature that human heart rates and therefore pulse rates continually fluctuate up and down in a wave like manner . These waves are known as heart rate variability HRV waves. When a person is physically still and resting the HRV waves are related to a person s respiration. These resting HRV waves are medically known as respiratory sinus arrhythmia or RSA waves as the size and shape of these waves is related to the rate rhythm and depth of a person s breathing. As long as a person is breathing between 4 to 15 breaths per minute the frequency of the waves will essentially match the frequency of respiration. Most individuals breathe within this range but even when a person is breathing outside this range the wave frequency still provides a close approximation to the respiration frequency.

While the correlation between waves and breathing has been well established in the medical literature by visual analysis no automated method exists to identify individual waves within a heart beat data set. An exemplary embodiment of the present invention includes a novel method of identifying each individual wave for a heart beat data set.

For example the amount of time in milliseconds between two consecutive pulse peaks the peak to peak time is called the pp interval pp . In an exemplary embodiment of the present invention a device records successive pp intervals. The description of pp interval points also applies to rr intervals the interval between consecutive R waves in an electrocardiograph or ECG any derivative of pp intervals such as the pulse rate points and any derivative of rr intervals such as heart rate. Collectively these intervals may be referred to as heart rate related intervals. Furthermore the same method of extracting RSA waves from pp intervals can be directly applied to these other points as well. Certain preferred embodiments of the present invention however parse waves within pp interval data sets.

The pulse rate of each recorded pp interval 60 000 pp may be displayed on the screen each time a new pulse peak is encountered. The absolute time difference between successive pp intervals absolute pp n pp n 1 is called the interbeat interval time IBI . An aspect of the present invention uses the pp interval times to identify individual RSA waves. The methods described herein may be used for both spontaneous and guided breathing.

Each p p may be categorized by examining its relationship to the p p immediately before it the previous pp and the p p immediately after it the next p p . A p p may be considered a top point tp if the previous p p is equal to or less than it and the next p p is equal to or less than it as well . A p p may be considered a bottom point bp if the previous p p is equal to or greater then it and the next p p is equal to or greater than it as well . A p p may be considered an ascending transition point at if the previous p p is less than it and the next p p is greater than it . A p p may be considered a descending transition point dt if the previous p p is greater than it and the next p p is less than it . Thus a p p may be categorized as either a top point tp bottom point bp ascending transition point at or descending transition point dt . The term transition point can be used to refer to both ascending and descending transition points when it is not qualified with the words ascending or descending . Consecutive transition points refers to a series of consecutive ascending transition points or descending transition points .

The term top level may be used to refer to the relative height of the top point. The level of a top point may be computed as follows. L the number of consecutive points immediately to the left of the top point that are less than or equal to the top point. R the number of consecutive points immediately to the right of the top point that are less than or equal to the top point. If L

The term bottom level may be used to refer to the relative height of the bottom point. The level of a bottom point may be computed as follows. L the number of consecutive points immediately to the left of the bottom point that are greater than or equal to the bottom point. R the number of consecutive points immediately to the right of the bottom point that are greater than or equal to the bottom point. If L

The next step is to locate the bottom point to the right of the consecutive transition points where the bottom level is equal to or greater than the wave depth. This is the right valley point v of the RSA wave. In the example in bottom point no. has a level of 3 which is greater than the wave depth. The next step is to locate the bottom point to the right of the consecutive transition points where the bottom level is equal to or greater than the wave depth. This is the left valley point v of the RSA wave. In the example provided in bottom point no. has a level which is greater than the wave length. The next step is to find the highest point between the left valley point and the right valley point. This is the peak p of the RSA wave. In the example in point is the highest point between the two valley points. All data from the left valley point v to the right valley point v is considered processed data. The same procedure is repeated on the remaining unprocessed data until all possible waves have been identified.

There are a number of variations in the method described above which should be considered within the scope of the present invention. For example a similar method could be used to find peaks on each side of a transition point series. The valley between two peak points would therefore be the lowest point between the two peaks. Also wave depth may be based on the absolute number of transition points or a derived number based upon the number of transition points e.g. number of transition points 75 . Also the v point could be identified before the v point.

In preferred embodiments the wave parsing method discussed above is used each time a new bottom level 4 point is identified. Thus devices according to exemplary embodiments of the present invention look for RSA waves between bottom level 4 points. In other exemplary embodiments devices may be configured to look for RSA waves after each point or after a certain period of time elapses every 30 seconds for example etc. Exemplary embodiments use bottom level 4 points because they have a very high probability of delineating RSA waves. That is they have a high probability of being valley points v v of RSA waves.

There are two instances where the basic RSA wave parsing methods described above may inaccurately describe an RSA wave. One may occur when a double top wave is encountered. Double top waves may be formed when a person waits a long time to inhale after he or she has already exhaled. Another may occur when double bottom waves are formed. Double bottom waves may be formed when a person holds his breath for a long time after inhaling. Double tops are easily identified by examining the ratios of lengths of the two waves . When p v is much smaller than p v and p v is much smaller than p v and p v is very close to p v then a double top has occurred. In preferred embodiments double tops may be defined as situations where p v p v 

Whenever double tops or double bottoms are produced from the basic parsing method the two waves forming the pattern may be merged together into one wave. Point v is the v of the new wave. Point v becomes the v of the new wave. The highest value between v and v is the peak point of the new wave. This is illustrated by

Exemplary embodiments of the present invention can use the RSA wave information described above to assess the user s level of mental stress. This mental stress measurement may be presented in devices as a stress meter FIG. . For example when a person is stressed breathing usually becomes rapid and irregular relative to a non stressed state. This rapid irregular breathing can cause the formation of short choppy RSA waves. Methods and devices according to the present invention can be used to determine the user s stress level by determining how far the user s average wavelengths deviate from a level that represents a relaxed state. Such methods and devices also may compute how irregular arrhythmic the user s waves are. These two assessments may be used individually or combined into a single value to indicate the overall stress level.

Studies have demonstrated that when people are profoundly relaxed such as in a state of deep meditation they tend to breathe in a steady rhythm at approximately 6 breaths per minute. Such rhythmic breathing causes the RSA wavelengths to become entrained on the breathing frequency. Thus rhythmic breathing at 6 breaths per minute will result in a series of RSA waves having wavelengths of 10 seconds. Thus exemplary embodiments of the present invention use wavelengths of 10 seconds as the relaxation threshold when assessing the user s stress level. Exemplary embodiments also include methods and devices which compute the average wavelength of the last five waves to determine how far the average is proportionally from 10 seconds. This is one example of a wavelength score .

Arrhythmic waves may be quantified using a number of standard variance formulas. Exemplary embodiments of the present invention use the sum of the differences of each consecutive wavelength in the last five waves to compute a variance score . Exemplary embodiments also can use the sum of the differences between successive wavelengths and may use a rank order weighted averaging so that the variance of the most recent waves count more. The stress level in an exemplary embodiment of the present invention uses 70 of the wavelength score 30 of the variance score . The user s stress level can be recalculated each time a new RSA wave is identified.

Stress can cause a variety of RSA wave behaviors decreased peak to peak times increased peak to peak frequency decreased wavelength increased wave frequency decreased amplitude irregular wavelengths irregular wave frequencies irregular amplitudes irregular peak to peak times irregular peak to peak frequencies irregular peak placements or decreased variation. Any one of the preceding variables or any combinations thereof can be applied to RSA waves and used as an indicator of the level of stress. Identifying individual RSA waves and using any of the preceding variables alone in combination with each other and or in combination with other variables to evaluate stress is within the scope of the present invention and has not been described in the prior art.

In addition to using the identified RSA waves for determining stress levels devices and methods according to exemplary embodiments of the present invention can also use RSA wave information to determine and display both average heart rate and wave frequency. The average of all the pulse rates in the last wave may be used to assess average heart rate. For example each time a new RSA wave is identified the average of the pulse rates may be computed and the heart rate may be updated. The wave frequency display also may be updated every time that a new RSA wave is identified. Exemplary embodiments can express frequency relative to waves breaths per minute. In exemplary embodiments the wave frequency and heart rate may be rounded to the nearest integer.

The present invention provides also provides methods of real time RSA wave pattern identification. In certain embodiments such methods involve two primary interrupt driven processes.

The first process may be triggered each time a new pulse is detected by a PPG sensor. This process may provide for 1 converting received pulses into a pulse rate values prv 2 updating the wave display with the new prv 3 confirming whether a new prv marks the beginning of a new wave indicating that the previous wave has just been completed 4 delineating the boundaries of the last wave identifying the valley peak valley points 5 assessing parasympathetic activity of the wave 6 displaying an appropriate symbol under the wave 7 updating the wave history and 8 updating the score.

A second process may be responsible for detecting and marking drop points in real time. This process may be driven by a clock interrupt. In preferred embodiments this process may occur for example every 250 milliseconds. When the process detects the occurrence of a drop point it may be marked with a drop point indicator such as a triangle for example.

Either of these processes may be implemented using standard polling methods. Alternatively the second process may occur each time a pulse is detected. Exemplary embodiments use clock interrupts so that the drop point is detected more quickly. Reasonable results may be provided however by marking the drop point based on received pulse beats.

Preferred embodiments of the present invention also provide various methods for the precise characterization of RSA wave patterns in real time. Such methods include those that may be conveniently referred to as wave phase methods and wave side methods.

The present invention also provides methods of determining wave phase and devices which utilize such methods. In exemplary embodiments of the present invention each time that a new pulse comes in a long term wave direction can be assessed. This process is illustrated in . For example the slope of the last six 6 pulse rate points can be used. The resulting value can for example be termed the long slope . Alternatively the slope of a time based sliding window of points for example can be used such as for example the last 12 seconds the last 5 seconds etc. or for example another general indicator of direction could be used.

Next for example the absolute amount of long term change can then be computed. This provides a degree of change value. In exemplary embodiments of the present invention the absolute value of the long slope can be used which can be termed for example the absolute long slope . Alternatively for example the absolute value or similar conversion of any of the long term wave assessments can be used.

Next for example the short term direction of the wave can be determined. In exemplary embodiments of the present invention the slope of the last three 3 pulse rate points can for example be used. This can be termed for example the short slope . Alternatively for example any directional indicator on a smaller subset of points than the points chosen for the long term direction assessment can be used.

Then for example the short term direction indicator and the absolute long term indicator can be used to assess the actual direction of the wave itself. In exemplary embodiments of the present invention the short slope can be compared to the absolute long slope for example. If the short slope is greater than for example 30 of the absolute long slope then the wave direction can for example be considered as UP. If the short slope is less than 1 30 of the absolute long slope then for example the direction can be considered as DOWN. If it fails both tests then the direction can for example be considered to be FLAT.

In alternate exemplary embodiments of the present invention a different percentage can be chosen for these determinations. Percentages may be based on the degree of desired parasympathetic sensitivity. Higher percentages may be less sensitive to parasympathetic interruption while lower percentages may be more sensitive. Around 30 is generally sensitive enough to detect major interruptions yet forgiving enough to put the behavior within the control of the user.

In addition in exemplary embodiments of the present invention the percentage for determining an UP direction can be different from the percentage determining a DOWN direction. Alternatively other mathematical comparisons of the short slope to absolute long slope can be used for example to determine the relative relationship between the two and thereby determine wave direction. Alternatively other mathematical functions may be used in place of short slope and absolute long slope to assess for example the short term direction and the long term degree of change.

Next the wave direction and the long term direction can be used for example to determine the phase of the wave. In exemplary embodiments of the present invention the wave direction and the long slope can be examined in order to make this assessment as is illustrated for example in the exemplary process flow diagram of . Process flow begins at where the query Long Slope is Positive is evaluated. If for example at the long slope is positive process flow moves to where the query Direction is Up is evaluated. If at the direction is UP then process flow proceeds to and the phase is determined to be RISING. If for example at the long slope is positive but at the direction is not UP then process flow proceeds to and the phase is determined as CRESTING. If for example at the long slope is negative i.e. a No is returned at to the query Long Slope is Positive which moves process flow to and then at a Yes is returned to the query Direction is Up then process flow proceeds to . If at the direction is DOWN then process flow moves to and the phase is determined to be FALLING. Alternatively if at the long slope is negative but at the direction is not DOWN then process flow moves to and the phase is determined to be TROUGHING. At each of and the result is passed to where the phase as determined can be returned to another process for further processing or output.

The present invention also provides methods of determining wave side and devices which utilize such methods. Thus in exemplary embodiments of the present invention an alternative to determining all four phases of the wave can be implemented. This alternative method can for example just detect the RISING and FALLING phases of a wave using a combination of range and direction. An exemplary process flow for this method is illustrated in . Process flow begins at where High highest prv in a given interval Low lowest prv in a given interval and Range High Low values can for example be obtained. High Low and Range refer to assessing prv values in a sliding window such as for example the last 12 points the last 12 seconds etc. . In exemplary embodiments of the present invention the prv range of the last 12 seconds can be used. At Direction can be assessed as described above.

Once Range and Direction are computed Phase can be assessed. This can be done by looking at wave direction and current prv in relation to the range. If wave direction is up at the bottom of the range then wave phase has shifted to rising. Alternatively if wave direction is down at the top of the range then wave phase has shifted to falling. Whether a wave is in the top or bottom of its range can be determined for example by choosing a fraction or percentage of total range as shown in where being within 25 of the top of the range is considered as near the top and being no more than 25 above the bottom of the range is considered as near the bottom. In alternate exemplary embodiments other thresholding values can be used.

With reference to for example at the current prv can be tested for being in the top 25 of the Range. If at the last point is near the top of the range i.e. Yes at then process flow can proceed to where wave direction is analyzed. If at wave direction is DOWN then process flow moves to and the wave phase is determined to have shifted to FALLING and the process is exited at .

However if at the current prv is not in the upper 25 of the range then process flow moves to . At the wave is tested for being in the bottom 25 of the range. If Yes process flow moves to where for example wave direction can be assessed. If for example at wave direction is UP then process flow moves to where wave phase is determined to have shifted to RISING and the process is exited at .

If at the wave is not in the upper 25 of its range and at the wave is not in the bottom 25 of its range then process flow moves to and the process is exited. The process is also exited if at the wave direction is not UP or if at the wave direction is not DOWN.

Thus in exemplary embodiments of the present invention either method Wave Phase or Wave Side can be used to determine current phase. In many contexts Wave Side for example can be used inasmuch as the use of the range adds a degree of precision. However in other embodiments where it is desirable to track all four phases Wave Phase for example may be used inasmuch as it also identifies TROUGHING and CRESTING.

The present invention also provides methods of determining wave completion and devices which utilize such methods. In exemplary embodiments of the present invention to determine when a new wave has been completed the current phase can be tracked on a beat to beat basis using for example the phase determination method as described above. When the current phase shifts to RISING it is known that a wave has recently finished as shown for example in . Alternatively for example the wave side can be tracked on a beat to beat basis. When the wave side shifts to LEFT then it is known that a new wave has been completed as shown for example in

The present invention also provides methods of delineating wave boundaries and devices utilizing such methods. Thus once it has been determined that a new wave has finished the points between the beginning of the previous wave trough and the point where the new wave is rising may be obtained as shown for example in . The lowest point in the previous wave trough may be referred to as the left valley point. The lowest point between the left valley and the new rising point may be referred to as the right valley point. The highest point between the left valley point and the right valley point may be referred to as the peak.

Alternatively a wave side analysis could be performed using for example the points from the previous wave s right side up to the end of the newly formed wave s right side. The lowest point in the previous wave s right side may be referred to as the left valley point. The lowest point between the left valley point and the new waves right side may be referred to as the right valley point. The highest point between the left valley point and the right valley point may be referred to as the peak.

The present invention also provides methods of assessing parasympathetic activity and devices which utilize such methods. In exemplary embodiments wave boundaries may be used in the assessment of parasympathetic activity. In certain embodiments of the present invention two parasympathetic parameters may be measured for the resulting wave the intensity of the parasympathetic response and the continuity of parasympathetic activity.

In one embodiment the intensity of parasympathetic response may be determined for example by the wavelength timestamp of the right valley point minus the timestamp of the left valley point . If the wavelength is less than for example 6 seconds the intensity may be considered LOW. If the wavelength is greater than for example 6 seconds and less than for example 9.5 seconds the intensity may be considered MEDIUM. If the wavelength is greater than or equal to for example 9.5 seconds the wavelength may be considered HIGH.

In alternative embodiments the parasympathetic activity level also may be assessed using traditional RSA measurements such as for example consecutive heart period standard deviation mean deviation and the like.

The continuity of parasympathetic response may be assessed in two parts. First the slope of every three consecutive points may be computed for example by starting from the left valley point to the peak. If any of the slopes approach zero or become negative for example then the parasympathetic outflow was interrupted during the rising of the wave . Likewise the slope of every three consecutive points may be computed for example by starting from the peak to the right valley point. If any of the slopes approach zero or become positive for example then the parasympathetic outflow was interrupted during the falling of the wave. If the short term slope on the left side of the wave remains high and positive for example and the short term slope on the right side of the wave remains high and negative for example then parasympathetic outflow is deemed to have been continuous without interruption .

In exemplary embodiments the threshold for the short term slopes may be variable. Exemplary devices may keep track of the highest positive slope over the last 5 seconds for example. Such devices may keep track of the absolute value of the highest negative slope of the last 5 seconds for example. If the absolute value of the highest negative slope is greater than the highest positive slope for example that value may be used to represent the fastest change . Otherwise the highest positive slope may be used to represent the fastest change .

In certain embodiments when examining the rising of the wave if any of the three point slopes are less than 30 for example of the fastest change then parasympathetic interruption is presumed. Likewise during the falling of the wave if any of the three point slopes is greater than 30 of 1 fastest change for example then parasympathetic interruption is presumed.

It should be appreciated that other algorithms may be used in accordance with the present invention to assess whether the short term slope was interrupted during the rise or fall of the wave.

The present invention also provides methods of detecting drop points and devices which utilize such methods. In exemplary embodiments the drop point detection routine may run for example every 250 ms. Each time the for example 250 ms clock interrupt triggers the device may insert a phantom value into a set of received pulse beats. In exemplary devices phantom values are perceived for example as a newly received pulse the moment the interrupt was triggered. The routine then may apply a phase determination method with this phantom value in the data set. If such phase determination method assesses that the phase shifts to FALLING with this phantom value then the drop point has been detected because the next actual pulse will occur after the drop point. When the drop point is detected a symbol such as a triangle may be displayed immediately by the interrupt routine. If the test is false no symbol is displayed. Methods utilizing such interrupt routines allow the detection and marking of drop points in real time.

The description below relates to exemplary embodiments of the present invention in the form of devices which may be used to evaluate and treat stress in humans. In these embodiments RSA waves may be identified and characterized in any of the ways described above and may be used to provide biofeedback to a user. Such exemplary devices include those that provide information to users in real time to promote the production of uninterrupted high parasympathetic output over a substantial period of time. In addition to the particular embodiments described below it should be appreciated that other methods and devices are intended to be within the scope of the present invention. Where alternative embodiments are not explicitly described it is not the intention of applicants to limit the present invention to the exact description provided in this section. In particular it should be appreciated that various combinations of features described below may be incorporated into a single device and that such device will fall within the scope of the invention disclosed herein. Naturally the full scope of the invention is based on the disclosure in the specification as a whole.

The present invention provides for example battery powered handheld portable devices which may include a PPG sensor a display screen control buttons and a power button . The user may turn on such devices by pressing a power button. If the devices are used in a dark room the user may turn on backlighting by pressing the power button a second time and keeping it pressed for a few seconds. Soon after the device is powered on it may prompt the user to insert a finger into the finger sensor . The user then may gently hold the device with a finger resting on top of the sensor throughout the entire session. The device may be comfortably held vertically resting on the thumb or at an angle resting on the curled fingers of the hand holding it .

Once the finger has been inserted into the finger sensor the device may then begin to calibrate the PPG sensor. A countdown meter may mark the amount of time required for the calibration . After the PPG sensor is calibrated the device may use the PPG sensor to detect each pulse of blood in the finger. The resulting pulse rate 60 000 number of milliseconds between two consecutive pulse peaks then may be plotted on the screen on a pulse by pulse basis FIG. . The display also shows the user his average pulse rate FIG. .

PPG sensors can be very sensitive to finger pressure. That is if the user squeezes the device the resulting finger pressure may prevent the device from gathering accurate pulse rate information. Whenever the user applies too much pressure the device may display an error message alerting the user to stop squeezing the device and start to relax his or her finger . As soon as the user has successfully relaxed his finger he or she then may return attention to the pulse rate display screen.

When the device identifies a new RSA wave it may use the wave information to determine and display one or more of the following the frequency of the last wave the average pulse rate of all the pulse points in the wave the session score the remaining session time and the stress index how much mental stress the user is currently experiencing.

The device may update the session countdown clock after every RSA wave has been identified. Devices may include a session countdown clock that decrements on a regular basis e.g. once per second once every fifteen seconds etc. . In such embodiments the device may update after each RSA wave to avoid unconscious associations being made between the clock and the desired behavior. In other words if the clock counts down on a per second basis the user could consciously or unconsciously use the seconds as a guide to breathing at the rate of 6 breaths per minute. Such an association may prevent the user from unconsciously learning how to breathe at 6 breaths per minute whenever becoming stressed. If the user consciously or even unconsciously uses the clock he or she may always be dependent on the device. However by updating the clock based upon every wave such a potential situation is not only avoided but the clock can reinforce the learning. The user will see the exact number of seconds of each breath by the amount that the clock decrements. If the clock were to decrement more slowly e.g. once every 30 seconds the potential for unconscious associations between time and desired behavior would be avoided. However in such an alternative implementation the clock would not be reinforcing the learning.

In exemplary embodiments the session countdown timer may begin to decrement once the first wave is identified and data is displayed . However other embodiments may begin decrementing the counter when the user begins to breathe rhythmically or only when good waves are achieved e.g. waves with a frequency less than six or only while the user is practicing rhythmic breathing. Another alternative is to not decrement the counter when the breathe button is being used and guidance is being provided.

Users may alter the behavior of the waves and therefore their calculated stress level by changing their breathing pattern. As the user slows down his or her rate of breathing the wavelengths increase and the amplitude of the waves increases as well . When a person breathes more deeply the amplitude of the waves becomes even larger . When a person breathes rhythmically at a steady rate the wavelengths entrain on the breathing rate .

To initiate relaxation the user may begin by inhaling deeply and then slowly letting the air out and extending exhalation. This will cause the wave lengths to become longer and therefore the frequency of the waves to decrease. The user may continue to inhale deeply and to slow exhalation even more until the wave frequency drops to about 6 . If the wave frequency drops below six then the user may breathe a little faster that is not exhale quite as long next time.

In certain embodiments once the user has reduced the wave frequency to about 6 he or she may continue breathing at the same rate and rhythm that produced a frequency of about 6. If the user s breathing rate increases the frequency will increase indicating that the next breath should have a longer exhalation. If the user s breathing rate becomes too slow the frequency will drop below about 6 indicating that the exhalation of the next breath should be a little faster. By paying attention to the wave frequency number a user may quickly fill the screen with rhythmic waves that are about 10 seconds in length corresponding to a frequency of about 6 respiration cycles per minute.

The session score may be calculated and displayed after each RSA wave is identified. The score may be based upon how close the user is to achieving the desired behavior. The user may accumulate score points and various methods for scoring the session may be used. In certain embodiments the user may receive for example 3 points if the waves have a frequency of 6 or less. The user may receive two points for wave frequencies of 7 or 8 one point for wave frequencies of 9 or 10 and no points for frequencies greater than 10. The accumulated session score may be displayed numerically. Alternatively each individual score may be displayed. Yet another alternative is to show the current score along side a set of the previous scores either numerically or graphically . Certain preferred embodiments may display graphically the current score and a set of the previous scores . In this way the user can tell when he or she is breathing rhythmically. When the score display is uniform the user is breathing rhythmically.

Once the user has filled the screen with rhythmic waves he or she may focus on inhaling a little more deeply and exhaling a little more fully. That is the user may attempt to inhale and exhale a greater volume of air called tidal volume . As the user gently increases the depth of his or her breathing the size of the waves will increase . The user may continue to fill the screen with large waves having wavelengths of about 10 seconds each until the session timer runs out. The user then may find that he or she has achieved a very deep and profound state of relaxation.

In certain embodiments if a user has difficulty breathing deeply and rhythmically at a rate of about 6 breaths per minute he or she may obtain guidance by activating a breathing guide function. . In such embodiments as soon as a user presses the breathe button a breathing guide may appear on the display. The user may be instructed to inhale as the breathing bar rises and to exhale as the breathing bar descends . In exemplary embodiments the breathing guide paces the user s breathing to about 6 breaths per minute with for example a 1 2 inhale to exhale ration. In alternative embodiments the breathing guide may be programmed to provide other ratios e.g. 1 3 at a rate of about 6 breaths per minute e.g. 4 8 minute . The breathing guide may remain active for example for about one minute and then automatically shut off thereafter. By having a temporary rather than constant breathing guide the user is encouraged to use the biofeedback protocol to achieve a respiration pattern of about 6 breaths per minute. If the user were to rely solely on the breathing guide it may be more difficult to learn how to achieve the pattern on his or her own. Thus by weaning the user off the breathing guide the user is able to use biofeedback to create unconscious learning. Alternative embodiments prompt the user to turn off the breathing pattern after a period of time has occurred. Other breathing rates and rhythms may be used as well.

Devices according to the present invention may return the user to the regular display after the breathing guide has been completed. The user then may adjust his or her breathing in the manner previously described to reduce the wave frequency to about 6 maintain rhythmic breathing and increase the size of the waves by breathing more deeply. The user may continue this process until the session timer reaches 0 00 at which time the session summary screen may be displayed .

Exemplary embodiments also include devices which allow the user to use up down arrows to select the number of large waves he or she wishes to produce during a session. For example a user may choose to generate 10 large waves during a session. The credit area may increase or decrease to accommodate the number of selected session waves.

Devices according to the present invention may continually identify individual RSA waves one at a time. The moment a new wave is identified it may be categorized for example as small medium or large. If the wave is small a single dot may be displayed for example to mark it as a small wave. If the wave is of medium size then two dots may be displayed for example to mark it as a medium sized wave. If the wave is large then three dots may be displayed for example to mark it as a large wave. A user may be given one credit for example in the credit area each time a large wave is identified and half a credit for example in the credit area each time a medium sized wave is identified. Of course other values may be assigned for waves of different sizes as long as the user is provided with information about the nature of the waves he or she is producing.

In certain exemplary embodiments at the beginning of the crest peak of each wave a sound beep may indicate the size of the previous waves. If the previous wave was small a high pitch beep may be generated for example. If the previous wave was of medium size then a mid level pitch tone may be generated for example. Otherwise a low pitch tone may be generated for example. The sound may be controlled by a switch such as an o button. Such a button may toggle the sound from for example low volume high volume and off. A breathe feature may temporarily activate a breathing metronome to show the user one way in which he or he may breathe to generate large waves.

In some embodiments once the user has accumulated enough credit points the session may be considered complete and the session summary screen may be displayed. Also a new tracking entry may be added into a tracking system.

In a certain embodiments of the present invention described below biofeedback credit is based upon achieving two equally important objectives a high level of parasympathetic intensity and a sustained parasympathetic outflow. The present invention may detect each wave of parasympathetic activity in real time. When a new wave is complete the device may assess both the intensity and continuity of the parasympathetic output that produced that wave. As shown in if the wave was produced by a continual level of moderately strong parasympathetic activity a two dot symbol for example may be placed underneath the wave. If the wave was produced by a continual very strong level of parasympathetic activity then a three dot symbol for example may be placed underneath the wave. If the wave was either interrupted and or weak a one dot symbol for example may be placed underneath the wave. Two squares side by side may represent for example a broken wave . These symbols may reflect the activity of the person s parasympathetic nervous system the stress recovery system at the time the wave was made very active long wave active medium wave not active short wave and interrupted broken wave . These representations may be displayed in real time and provide information on the last several preceding waves . For example the display may show representations of the last twenty waves or a number much greater or significantly less. Exemplary embodiments also may recall and display representations of waves from much earlier in the breathing session or from previous sessions.

The display also may show a cumulative total score for a specific amount of time e.g. 24 hours . A cumulative total score may be generated for example by assigning a single point for a long wave a half point for a medium wave and no points for a short wave. The display may continue to update the cumulative total until for example a predetermined goal is reached a preset time period elapses or the cumulative total score is reset. A subject may try to achieve a goal of reaching for example 100 points per day.

Particularly preferred embodiments of the present invention also provide novel forms of biofeedback information that can be used to induce the desired physiological state through unique breathing exercises. Such embodiments avoid drawbacks of techniques which create one or more interruptions of the parasympathetic branch on a per breath basis. For example such breathing techniques involve extending exhalation for a very long time. In general a longer exhale is beneficial but when it is extended for a long period of time long exhalations can interrupt the parasympathetic response immediately after the trough of the wave. Waiting to inhale for too long may cause an interruption right before the crest of the wave. Likewise holding the breath for too long or inhalation that is either too long or too short for example can each strain the parasympathetic nervous system causing a temporary inhibition of parasympathetic outflow.

Embodiments of the present invention overcome the above described shortcomings by for example guiding the user in finding a breathing rate and rhythm that produces an intense level of sustained parasympathetic outflow. Feedback provided by methods and devices according to the present invention allows a user to maintain a substantially continual state of parasympathetic outflow thereby suppressing sympathetic activity.

Preferred embodiments of the present invention also may indicate to the user the point at which an RSA wave transitions from cresting to descending. Such drop points may be identified for example by marking such point with a marker that is easily visible by a user. Such visible indicators may be in the form of a triangle for example . Visible indicators also may be other shapes. The drop point is an ideal time to begin an extended exhale. Indicators alternatively may be audible.

By combining the feedback of the drop point with the composite parasympathetic measurement a user may quickly learn to extend the exhale to an appropriate length to create the highest scoring waves e.g. a three dot wave . The user may also receive guidance to indicate when exhalation has extended too long as the wave will break resulting in a low scoring wave e.g. a one dot wave . Thus methods and devices according to certain embodiments of the invention enable users to find their unique window of exhale lengths which produce a sustained outflow of intense parasympathetic activity. In use a person simply exhales each time a new indicator appears such as a visible triangle and then inhales until the next indicator appears. By adjusting the length of the exhale users learn to generate perfects waves which appear during a physiological state of sustained intense parasympathetic activity.

In another exemplary embodiment the display may provide Exhale Numbers corresponding to a number that the user may count to while exhaling. Once a breathing session begins the subject may inhale until for example a drop point is indicated and then exhale while counting preferably calmly and silently to the Exhale Number. A timer bar may descend in an Exhale Number column for a fixed amount of time e.g. 30 seconds 60 seconds etc. . The Exhale Number column may display a score from for example 1 to 9 corresponding to the effectiveness of the subject s breathing at that Exhale Number for the fixed length of time. A longer wave indicates more effective breathing than a shorter wave and thus may receive a higher score. The score may be based on a single wave from all waves or a subset of the waves. The display also may allow for the selection of alternate Exhale Numbers allowing the subject to experiment with different Exhale Numbers to find one or more which provides the best scores. As discussed above in an exemplary embodiment the best scores are produced by the longest waves.

In certain embodiments handheld portable devices according to the present invention may be used as follows a subject turns a device on by pressing a power button when prompted a subject inserts for example his or her left index finger into a pulse detection portion of the device while the subject gets comfortable e.g. subject sits upright with feet flat on floor the sensor adjusts to the pulse rate of the user the subject selects a target number of large waves e.g. 5 to 100 depending on the level of stress perceived by the subject the subject observes the pulse rate wave on the device s display as he or she breathes at a pace that is natural and effortless while breathing slowly and deeply preferably through the nose the subject may observe the affect of respiration depth and frequency on the wave patterns the subject creates long waves by exhaling slowly and for a duration approximately twice that of inhalation long waves are tallied on the device s display while waves that are not long are not tallied beginners may press a breathe button on the device to help pace the subject to create long waves e.g. a pacer can appear for a certain number of breathes which may or may not be tallied an intermediate user may view the drop point indicator in the monitor and exhale at the drop point and inhale during the rise of the next wave advanced users may press a sound button and use the device with eyes closed exhaling each time the device makes a certain sound at the drop point while the pitch of the sound may further indicate whether the previous wave was credited an added to the tally.

Several aspects of the present invention can be combined together to create a number of alternative exemplary embodiments. For example the device can feature a meter that could be used as an amplitude feedback meter rather than a stress meter. The meter could further have a target bar. Thus the device could graphically display how deeply a person is breathing so he could learn to take deeper breaths. If a target bar is used users could try to breathe deeply enough with each breath to cause the meter to rise above the target bar. Any numerical or graphical feedback visual or otherwise of amplitude would be within the scope of this alternative embodiment.

Other alternative embodiments may use wave information e.g. wavelength amplitude and peak placement to determine and provide feedback regarding the degree to which a user is following a prescribed breathing protocol e.g. 6 breaths per minute with an inhale exhale ratio of 1 3 . Alternatively the user could be given a breathing guide while being provided simultaneous auditory or visual feedback on how closely they are conforming to the guided breathing pattern. Furthermore a target level could be displayed such that a user would be considered compliant if he were above the target level and non compliant with the breathing protocol if he or she were below the level.

Alternative embodiments also may use the variance of one or more wave parameters to detect rhythmic breathing. Then the degree of rhythmic breathing may be visually displayed numerically graphically or in some other manner. Optionally audible feedback may be provided. For example in an exemplary embodiment a tone can increase as the breathing becomes more arrhythmic and decrease as it became more rhythmic. Alternatively a single beep can indicate rhythmic breathing a double beep can indicate near rhythmic breathing and a triple beep could indicate arrhythmic breathing. Naturally any of the previously mentioned feedback techniques or derivatives of these techniques could be used independently in combination with each other in combination with other techniques or in combination with both each other and other techniques. Such an implementation may be used for example to practice yoga style rhythmic breathing patterns. For example if the yoga student were practicing rhythmic breathing at an inhale hold exhale ratio of 1 1 1 he or she could use the device to ensure that rhythmic breathing was being maintained.

In other embodiments of the present invention a pre programmed breathing guide can be provided on the device so the user could follow the breathing guide while receiving visual and or auditory feedback on the rhythmicity of his breathing. Furthermore the breathing guide could be programmable. Optionally feedback can be provided not only on the rhythm of the breathing but rate as well. For example if the user wanted to practice breathing at a 1 1 1 ratio at 5 breaths per second visual and or auditory feedback can indicate the degree to which a user is breathing rhythmically at five breaths per minute. Breathing at another frequency and or arrhythmically would reduce the score.

Another exemplary embodiment provides feedback on the depth of breathing. During rhythmic breathing a measurable phenomenon using aforementioned methods the primary difference in wave amplitudes is the tidal volume the depth of breathing . Thus amplitude measurements could be used for visual and or auditory feedback to indicate the depth of a person s breathing. As stated previously deep breathing is a useful way of relieving stress. Exemplary embodiments can provide feedback on a user s depth of breathing to assist teaching the user how to breathe deeply and to thereby relieve stress.

In short exemplary embodiments of the present invention can provide auditory and or visual feedback for the following rate of breathing rhythmicity of breathing depth of breathing breathing conformance to a prescribed rate rhythm transition points from cresting to descending e.g. drop points and the like. An assessment can be made of each of these alone or in any combination. Feedback can be provided on one or more of such assessments. Any implementation that identifies two or more RSA waves and derives rate rhythm depth and or conformance is within the scope of the present invention.

Exemplary embodiments of the present invention incorporate a number of features in addition to those described above. One such feature is the design of the device form factor. Prior to the present invention biofeedback programs used finger PPG sensors ear PPG sensors and or heart rate ECG sensors that attached to a computer via a wire. Although PPG sensors are sensitive to movement and finger pressure prior devices did not have to deal with the many artifacts created by movement or excessive pressure because they used finger PPG sensors which were often placed on tables or desks. In this situation users could rest their hands and fingers on the desk which stabilized the hand and finger thereby preventing excessive movement and finger pressure.

Since external wires are generally socially and otherwise unacceptable exemplary embodiments of the present invention integrate a PPG sensor directly into portable devices and eliminates external wires. As a result devices according to exemplary embodiments of the present invention may be used comfortably in a public setting. Integrating a PPG sensor into a portable device however requires innovative form factors. For example since session times may range from 5 15 minutes or may users of the device will be holding the device without a stabilizing structure like a desk for an extended period of time. Accordingly the present invention provides devices which may be gripped comfortably while simultaneously allowing the user to gently rest his finger on the finger sensor.

The present invention also provides form factors that provide comfort while minimizing artifacts caused by movement and pressure over extended periods of time e.g. 10 15 minutes . Two exemplary form factors accomplish these objectives. In the first the finger sensor may be on the top of the device near one of the edges. Ergonomically the height from the bottom of the device to the top may be between about 1.5 inches and about 3.5 inches and is preferably around 2.5 inches. This allows the device to be supported either by the thumb when held vertically or supported by the curled fingers when tilted . In the second the finger sensor is located on the rounded back of the device with the display on the front allowing the device to rest for example in the palm of the hand during use . The particularly preferred form factor is the first described above which allows for the design of products with a scientific and medical look and feel.

The present invention also provides methods for detecting and correcting errors in devices described above and devices which utilize such methods. While either of the above described form factors minimizes artifacts the hardware form factor may not eliminate every possible artifact. Because there is no supporting structure such as a table or desk the hand and finger will move at different times throughout the session. Remaining artifacts may be addressed by software in exemplary embodiments of the present invention which may not only detect when an error has occurred but may correct it as well.

In general displays on small portable devices are much more sensitive to errors because such displays are very small compared to that of a desktop computer for example. When an error occurs on a desktop computer the display has enough resolution to show both the accurate data and the error . On a small portable device however one error can cause all the correct data to become indiscernible due to its low resolution .

Numerous statistical methods for detecting errors in a data stream exist in the state of the art. However these methods require a large sampling of data before they provide a high degree of accuracy. As mentioned above devices having small displays can be adversely affected by even a single error. Thus errors should be detected quickly and accurately and then corrected. Devices according to an exemplary embodiment of the present invention implement a novel method of error detection and correction that requires only a small amount of data approximately 10 seconds before it becomes highly accurate.

To facilitate further understanding of the error detection and correction methods of the present invention a brief explanation of how PPG sensors are used to obtain pulse information in ideal error free conditions is provided. PPG sensors detect the amount of blood pressure in the finger on a continual basis. Each time the heart beats the corresponding pulse of blood results in a rapid increase in blood pressure in the finger which then quickly subsides. The PPG sensor continually seeks to identify the time when the blood pressure peaks . This is the pulse peak. As discussed previously the amount of time in milliseconds between two consecutive pulse peaks is called the pp interval pp . Devices according to the present invention can record each successive pp interval. The pulse rate of each recorded pp interval 60 000 pp can be displayed on the screen each time a new pulse peak is encountered. The absolute time difference between successive pp intervals absolute pp n pp n 1 is called the interbeat interval time or IBI.

Two types of errors occur when the PPG sensor is attempting to correctly identify the next pulse peak. One type of error can occur when the PPG sensor incorrectly identifies an artifact as a pulse peak. That is the PPG sensor determines that a pulse peak occurs where one does not actually exist . This type of error is called a false positive error. The second type of error occurs when the PPG sensor does not identify a pulse peak that does exist . This is called a false negative error. Both false negatives and false positives result in large IBIs. Error free data may or may not result in large IBIs. However erroneous data always produces a large IBI. Thus wherever there is an extended amount of consecutive data that does not contain a large IBI one can safely assume that this data is free of errors. Where large IBIs occur it may be due to an error or may be good data the device will need to determine which is the case.

According to preferred exemplary embodiments of the present invention the first step in the error detection strategy is to wait for a certain number of heart rate related intervals e.g. 10 pp intervals where every IBI time is less than 200 ms. These data points are considered to be error free. The number of consecutive intervals can be less than 10 but needs to be at least 2 preferably at least 3 and even more preferably at least 5. Another alternative is to wait for a set of consecutive data points where every IBI time is less than of the lowest heart rate related interval such as a pp interval in the consecutive data set e.g. 5 consecutive pp intervals . The range of these data points can be computed. As used herein range can refer to the absolute range i.e. min pp to max pp a derivation of the range e.g. min pp 10 max pp 10 or as a computed variation e.g. mean deviation standard deviation etc. . Any appropriate mathematical description of the range can be used. Preferred embodiments according to the present invention use min pp max pp min pp 25 as the bottom of the range. The preferred embodiment uses max pp max pp min pp 25 as the top of the range. The range may be derived from the entire data set or a subset of the data set.

Once the range has been established each new p p is tested to determine if it is in range . In exemplary embodiments a new pp value is considered in range if it is greater than the bottom value and less than the top value. However in range also can refer to any mathematical determination of close proximity of the current p p to the range as determined by the selected range calculation. For example if the range was calculated using the standard deviation in range could refer to the statistical determination that the current p p has an 80 or higher probability of being within the computed variation.

As new pp intervals arrive the new IBI also may be computed absolute new pp previous pp . The new IBI may be tested to determine if it is large . In preferred embodiments the device tests whether the IBI is greater than one half the bottom value of the range. If it is greater the IBI is considered to be large. In other exemplary embodiments the IBI time of the new pp interval minus the previous interval can be computed. Other IBI times could be used instead such as the IBI of the new p p compared to the average p p of the last n number of pp intervals. Also different implementations can use a different threshold for distinguishing large IBIs from non large IBIs. According to embodiments of the present invention any implementation can be used that uses the difference of pp intervals or the difference of a derivative of pp intervals such as the average in order to detect an error.

To summarize the above when the device according to exemplary embodiments of the present invention begins it may not enter error detection mode until 10 consecutive pp intervals are located where all the IBI times are less than 200 ms. Then the device can calculate the range of these pp intervals and initiates an error detection mode. In the error detection mode the device can test each new pp to determine if it is in range and the device tests each new IBI to determine if it is large . Any other suitable method of determining either or both of these two properties for use in error detection also is within the scope of the present invention.

If the next p p is in range and the IBI is not large then the new p p can be considered to be error free. If the p p is not in range and the IBI is not large the new p p can be considered to be error free and the range is recalculated to include the newly found pp value. If the new p p is in range but the IBI is large the new p p can be considered to be error free. However when the new p p is out of range and the IBI is large then the new p p can be considered to be the result of an error. Once an error has been detected it should be corrected. Therefore each time that an error is detected in error detection mode the device changes to error correction mode. The device can remain in error correction mode until erroneous condition has been resolved.

The following discussion provides examples of how errors may be corrected according to an exemplary embodiment of the present invention. For example if the range is 600 ms 1 000 ms and the erroneous pp interval time is 200 ms. The next pp interval is 100 ms. The sum is now 300 ms. It is not in range . The next pp interval is 400 ms. Therefore the sum is now 700 ms. It is in range and therefore 700 ms is the corrected value. The three pp intervals 200 ms 100 ms and 400 ms will be combined into one value of 700 ms. The device then returns to error detection mode.

As another example if the range is 700 ms 1 000 ms and the erroneous pp interval is 1 300 ms. There are no integers which one can divide 1 300 ms by that will result in a value in range . Therefore the next pp interval 300 ms is summed together to produce 1 600 ms. At this time there is an integer which can be used in a division to produce a value in range . The integer results in a value that is in range 1600 2 800 ms . Therefore the two erroneous values 1 300 ms and 300 ms will be replaced with two the integer number values of 800 ms the result of the division .

In exemplary embodiments devices according to the present invention will be able to generate corrected values within one or two additional pp intervals. However it is possible that a device may enter error correction mode indefinitely. Therefore the present invention can include a safety mechanism to resolve this situation if it should occur. For example if the device remains in error correction mode for too long then the device recalculates the range by applying a statistical method to all original data points encountered. That is every unprocessed pp interval received from the PPG sensor is used. The range is then computed with a statistical based range calculation for example a standard deviation formula. In exemplary embodiments the median pp interval is determined from all unprocessed pp intervals encountered whether authentic or erroneous . The range is defined as 15 beats per minute below the median up to 15 beats per minute above the median. The pp intervals in the error queue are reprocessed according to the new range. Note that the range could also be computed with a subset of the unprocessed data points e.g. the last 50 data points . The present invention also can include any method of recalculating the range to resolve an extended error condition.

As stated previously PPG sensors are sensitive to movement and finger pressure. They are also sensitive to bright light and cold fingers. Therefore there are a number of factors that can cause multiple errors. In certain embodiments of the present invention whenever the signal to noise ratio over ten seconds drops below 25 the device may cycle a display of error messages such as that shown in until the device exits from error correction mode. Thus the user will be provided information on changes can be made to assist the device in gathering accurate pulse information.

The present invention also provides alternative methods for detecting and correcting errors in a heart rate interval data set. For example there are a number of implementations that would permit the range and or IBI thresholds to dynamically change as new heart rate interval values were detected. Such implementations may provide a marginal increase in accuracy in certain circumstances.

For example the range may be continually assessed using a rolling window. The range may be initialized after receiving the first 10 seconds of pp intervals such that each consecutive IBI is less than 200 ms. After this point the range could be continually reassessed using a rolling window of the last 10 seconds of reliable data. The last 10 seconds of reliable data may or may not be consecutive. For example the top of the range r top could be the highest p p in the last 10 seconds of reliable data and the bottom of the range r bottom could be the lowest p p in the last 10 seconds of reliable data.

Another alternative is to dampen the rate in which the range can dynamically expand and contract. For example each time a new pp value is detected the range could be updated in three steps. First the data set top ds top and the data set bottom ds bottom are identified from the last 10 seconds of reliable data. Second the ds top and dsbottom are adjusted in a manner such that they do not change significantly from the previous ds top p ds top and the previous ds bottom p ds bottom . For example if the p ds top is greater than ds top then ds top could be reset to p ds top p ds top ds top 25 1 . If p ds top less than ds top then ds top could be reset to p ds top ds top p ds top 4 1 . If p ds bottom is greater than ds bottom then ds bottom could be reset to p ds bottom p ds bottom ds bottom 2 1 . If p ds bottom is less than ds bottom then ds bottom can be reset to ds bottom p ds bottom 25 1 . Thus r top would be equal to the adjusted ds top and r bottom would be equal to the adjusted ds bottom. A p p would be considered in range if it is between r bottom and r top.

The above described methodology can accomplish three objectives. First it allows the range to dynamically increase and decrease. Secondly the range can expand faster than it contracts. Third the bottom of the range can expand faster than the top of the range. There are a number of ways to implement these methods and any implementation that accomplishes any of these three objectives is intended to be within the scope of the present invention.

Yet another alternative includes converting the computed pp range to a range of pulse rate values prv and comparing each newly detected prv 60 000 pp to the pulse rate range. In range could be determined by whether or not the new prv was less than the maximum prv max prv and greater than the minimum prv min prv . Or in range could refer to whether or not the new prv was sufficiently close to the range of prv values. For example the range top and range bottom could be expanded by a determined number of beats i.e. max prv max prv 9 and min prv min prv 9 . Thus any new prv that is within 9 bpm of the data set range could be considered in range .

As with pp ranges prv range calculations can also be dynamic. That is as new prv s arrive the range could be recalculated if the new prv is considered to be reliable e.g. IBI is not too large .

Another method for increasing error detection capabilities is to use two threshold values for determining how close a new IBI is from the previous IBI. For example if the new IBI is less than the low threshold it can be considered a small jump . If the new IBI is between the two thresholds it can be considered a significant jump . And if the new IBI is higher then the second threshold it can be considered a large jump . Thus as new values come in they could be assessed as to whether the new value is in range or out of range and whether the new IBI is a small jump significant jump or large jump. Decisions on whether to display the value use the value for updating the range and or whether to correct the value may be based upon such assessments.

Any heart rate related interval may be used for determining the significance of IBI levels. For example the inter beat interval difference of two prv s the prv IBI could be used when assessing the proximity of the new pulse value to the previous pulse values. Thus IBI s can be computed and assessed for pp intervals prv values rr intervals hr values and the like.

Still another alternative includes using the direction of the IBI change to determine whether the jump is small significant or large. When a person is physically still pulse rates can rise or fall at different rates. Thus different thresholds could be used depending on the direction of the change. For example a prv IBI that s greater than the previous prv IBI could be considered to be a small jump up if it is less than 8 bpm a significant jump up if it is between 8 15 bpm and a large jump up if it is greater than 15 bpm. And a prv IBI that s smaller than the previous prv IBI could be considered a small jump if it is less than 8 bpm a significant jump if it is between 8 12 bpm and a large jump if it is greater than 12 bpm.

Yet another exemplary embodiment includes basing the prv IBI thresholds on the location of the previous prv in the range. If the previous prv is already toward the top of the range the threshold could be set smaller since in theory one would not want the next prv to jump too far outside the range. Likewise if the previous prv is already toward the bottom of the range the prv thresholds for jumping down could be decreased. Thus examples of prv IBI thresholds based on the location of the previous prv in the range could include r top prev  prv 10 for a small jump up r top prev pr 15 for a large jump up prev prv r bottom 10 for a small jump down and prev prv r bottom 15 for a large jump down.

Yet another exemplary embodiment is to add a third test such as direction when determining if a new heart rate interval point needs to be corrected. For example if the point fails the IBI and the range tests but is closer to the range then the previous heart rate interval point then it could still be considered acceptable.

In certain circumstances and implementations a marginal improvement may be obtainable by combining the dynamic range method the double IBI threshold method with different thresholds based upon direction and the heart rate interval direction method. An example of such a combination is as follows. As each new prv is calculated 60 000 pp it can first be assessed whether or not it is immediately displayable . If the prv is a small jump up or small jump down using appropriate thresholds it is immediately displayable and therefore is immediately displayed. If it is a significant jump but is in range then it is immediately displayable and therefore is immediately displayed. Otherwise it could be re evaluated by direction to see if it is displayable. If the current prv is closer to the range than the previous prv then it is still displayed. Otherwise it is not displayed and must be corrected.

Combinations of the above described methods also may be used to determine when a value was reliable or not. That is these methods may be used to determine whether a new prv should be used in recalculating the dynamic range. For example if the new prv is a small jump it could be considered reliable . If the new prv is a significant jump but is in range then it could be considered reliable . And if the new prv is a significant jump and out of range but is closer to the range than the previous prv then it can be considered reliable .

In deciding which methods to employ to detect and correct errors in a data set one should consider the hardware stability use environment and other factors to determine if the degree of potential statistical advantage of complex combinatorial methods offers a greater practical utility over the basic IBI range methodology. In most situations the basic IBI range strategy is quite sufficient. If however significant movement sunlight pressure and similar factors are expected to be present the additional statistical methodology described above may be implemented to provide even greater accuracy in detection and correction of errors in a data set.

Methods and devices described above also may use RSA wave information to innovatively scale the area of the display where the waves are shown.

The amplitude of RSA waves can vary significantly from person to person. As described earlier RSA amplitude depends on the individual age sex fitness level breathing pattern and more. While large display screens can accommodate large waves or small waves small display screens on portable devices require sophisticated scaling. Thus if the scale on a small display is too small then large waves will not fit on the display. If the scale is too large then the shape and size of small waves will become indiscernible. And if the scale is too dynamic and adjusts too frequently then large waves and small waves will appear to be the same size and the user will not be able to discern whether or when his breathing pattern has changed.

Devices according to the exemplary embodiments of the present invention can solve the scaling issue by adjusting the display scaling differently during two stages. The first stage lasts from the time the device is powered on until the user begins to breathe rhythmically. The second stage lasts from the time the device detects rhythmic breathing until the device is turned off. During stage a very basic scaling technique can be implemented. During stage an innovative approach can be employed so the user can accurately assess when his breathing has become more shallow less deep .

For example when the device is first turned on the scaling is preferably zoomed in to a small preset value. Then the device zooms out whenever a pulse rate point is encountered that is greater than highest value or lesser than the lowest value that can be plotted using the current zoom level. The scale is zoomed out such that the new pulse point is plotted at the edge of the device display area. To give the user an idea of scale the device only zooms out not in at the beginning. The display also zooms back in after large waves have exited the screen so that the full height of the display is used from top to bottom. The display continually zooms in and out such that the data points being shown consume the full range of the display at all times until the user begins rhythmic breathing.

Once the user begins to breathe rhythmically the device seeks to encourage him to breathe deeply. If the device continued to automatically zoom in when small waves appear then the small waves produced by shallow breathing will appear the same size as the large waves produced by deep breathing. This will not allow a user to visually discern his depth of breathing from the size of the waves.

Devices according to exemplary embodiments of the present invention use the wave information to detect rhythmic breathing. Rhythmic breaths produce waves with uniform wavelengths frequencies amplitudes peak to peak times and peak placement times . By measuring the variance of one or more of these wave feature parameters rhythmic breathing can be identified. Exemplary embodiments calculate the variation of the wavelengths and amplitudes of the last three waves. When both of these variations are low then rhythmic breathing is considered to have begun.

One method of determining variance and thus establishing when a variance is small can be based on the percent relative deviation. This method is useful when comparing the variation of two or more values e.g. peak to peak times wavelengths frequencies etc. . This may be done as described below. First the mean average of the values can be determined. Then the sum of the difference sum dif of each value from the average can be computed. The sum can be divided by the average x number of values. For example consider four wavelengths 10 8 10 8 seconds. The average is 9. The sum of the differences from the mean is 4 10 is 1 away plus 8 is 1 away plus 10 is 1 away plus 8 is 1 away . Thus 4 is divided by the mean x number of values 4 9 4 . Thus the percent relative mean deviation is 11.1 . Consider four amplitudes 30 28 30 28 bpm. Although the deviation is also 4 as in the previous example the percent relative mean deviation is only 3.4 . Thus percent relative mean deviation automatically scales itself to the range of the values being analyzed.

The variance of any of the wave features can be analyzed alone or in combination using numerous methods. The preferred embodiment employees percent relative mean deviation. The greater the resulting percentage the greater the variance. A variance threshold could be set to determine if rhythmic breathing has commenced. For example if three or more waves have a variation in a wave feature less than 20 one may conclude that rhythmic breathing has commenced. In a preferred embodiment rhythmic breathing is considered to have commenced when the variation of the wavelength and amplitude of the last three waves is less than 10 each.

Once rhythmic breathing has begun the can keep track of the largest amplitude maximum amplitude formed by the resulting rhythmic waves. The device continues to determine if the user is still breathing rhythmically with for example each and every wave. As long as the user continues to breathe rhythmically the device will continue to look for the largest amplitude maximum amplitude . If a newly formed rhythmic wave has a higher amplitude than the current maximum amplitude then the maximum amplitude can be readjusted to be equal to the new amplitude. In general the display does not zoom in more than the maximum amplitude. That is the display scale can be set such that a wave with an amplitude equal to the max amplitude would fully consume the screen from top to bottom. The zoom level can be set to not exceed this set point. As a result the device can zoom out but it may not zoom in beyond the set point determined by the maximum amplitude. In this way users will notice when they are breathing shallowly because they will see the relatively smaller waves relative to the maximum amplitude on the screen.

Sometimes an erroneous wave a wave with corrected errors that is incorrectly reconstructed can have the largest amplitude. This large amplitude may be erroneously high. Also a person s largest possible amplitude can degrade with time until their lungs become used to rhythmic breathing. That is as their lungs become tired they will not be able to reproduce waves with amplitudes equal to the maximum amplitude. Since the device should not frustrate the user but rather encourage him to produce the largest waves that he comfortably can the device can decrease the maximum amplitude value over time if a successive series of waves do not come sufficiently close to the maximum amplitude. In preferred embodiments if three consecutive rhythmic waves have amplitudes less than 80 of the max amplitude the maximum amplitude may be readjusted using the following formula largest amplitude of the last three waves 100 85 . Another alternative is to continually decrease the maximum amplitude until the waves are sufficiently close to occupying the display from top to bottom. For example the maximum amplitude could be decremented by 5 every time a newly formed rhythmic wave has an amplitude less than 80 of the current max amplitude. Another way to use amplitudes would be to take the highest average amplitude. For example the average amplitude of the last three waves could be calculated every time a new wave is encountered. The highest average amplitude can be used as the minimum set point.

The use of high amplitudes which occur in rhythmic breathing to establish set points is a novel and useful component of the disclosed invention. Any scaling based upon amplitude range variance or deviation is intended to be within the scope of this invention. For example the standard deviation of the data set or subset of the data could be determined. The maximum zoom level could be set such that values with a certain probability relative to the deviation consume the screen. For example all values that have an 80 probability of being within the standard deviation would fill the screen from top to bottom.

Methods and devices described above may be implemented for example as a process stored in a memory of a data processing device such as for example a computer. Such a process can for example be in the form of software and can for example be executed by a data processor or CPU and the results displayed on a display such as for example a CRT plasma or other computer display as is known in the art. Thus for example such software can be implemented on a system comprising a CPU a memory and a display all connected by one or more busses or data pathways. depicts such an exemplary system.

With reference thereto there is provided an I O or input output interface a CPU and a memory . The three components of the exemplary system are communicably connected via a system bus . As noted system bus is a logical component and in any given embodiment can comprise a plurality of interconnections between system elements. Given such an exemplary system a software process can be loaded in memory and executed in CPU . Moreover a user can provide input to the process via the I O and output to user by way of visual auditory tactile or other means can be provided to a user also using the I O. Such I O can comprise a physical interface device comprising one or more sensors or can for example comprise one or more of a microphone and one or more speakers a keyboard mouse and visual display and a tactile input and output mechanism.

Additionally such a software process can for example be expressed using any appropriate computer language or combination of languages using known techniques and can be for example implemented as an embedded system or a conventionally stored program of instructions using known techniques. Such a software process can be implemented for example on a device which can be used to evaluate stress in humans as described above.

Such an exemplary software process can have for example a top level process that interacts with a user by displaying messages to a user and by for example continually looking for and responding to various user actions such as for example a user pressing a breathing guidance button or a pulse emanating from a user s finger. Such an exemplary software process is depicted in as next described. It is noted that described above integrate with this exemplary software process and thus the process waves subroutine described below in connection with calls the subroutine get waves depicted in .

Continuing with reference to at 3602 for example an Insert Finger message can be displayed to a user. At the process waits for an interrupt taking no further action until one occurs. At if a finger is inserted by a user then at for example the device begins calibration the display message is updated and the interrupt cleared returning to .

Process flow for this exemplary top level process continues as depicted in . With reference to at if a user presses the breathe button as described above this can trigger a Breathe Button Pressed Interrupt. Process flow then moves to for example where the device mode is set to Guided the variable Start set to be the current time and the interrupt cleared. Process flow can then move to where a clock interrupt can be for example set to 100 milliseconds. Process flow can then move to where the Guided Mode display can be presented to the user. Process flow then returns through breakpoint in back to of where the top level process again waits for another interrupt to occur. This brings process flow back to through breakpoint where at for example if a clock interrupt occurs process flow moves to and tests whether less than two minutes have elapsed from the time the user pressed the Breathe Button at and entered Guided Mode. If it is still less than two minutes process flow can move through to where the Guided Mode display can be for example updated. If at for example it has been longer than two minutes since the user pressed the Breathe Button then process flow can move to the Mode variable is reset to Spontaneous and process flow moves to where for example the Spontaneous Mode display is restored.

Finally with respect to at if a pulse is detected a Pulse Detected Interrupt occurs and process flow moves for example to where the Process Pulse subroutine is called. This ends the exemplary top level process depicted in . depict process flow of an exemplary main routine according to an exemplary embodiment of the present invention entitled Process Pulse. Process Pulse calls the subroutines error correction error detection initialize range and process waves . In turn process waves calls subroutines get waves and determine stress . Thus all of the subroutines are called directly or indirectly by Process Pulse.

With reference to at the raw timestep rt n rt which is rt given the initialization at of is set to the current time in milliseconds and n rt or the number of raw timesteps is pre incremented. Then for example at and the variable state can be tested for being RAW DETECTION or CORRECTION to determine whether the data is assumed to be error free suspect or erroneous and accordingly along which path process flow will continue. If state CORRECTION the data path beginning at will be taken calling an error correction subroutine at . If state DETECTION the data path beginning at will be taken ultimately calling an error detection subroutine at of . These two data pathways ultimately arrive at of . If state RAW process flow can continue directly to of where timing variables are initialized including pre incrementing n ts a variable that tracks the number of timesteps and through where n ts is verified to be greater than one. If that is the case at for example n val the number of pp intervals to be assigned can for example be set equal to 1 and process flow can continue through breakpoint to of and through to . When process flow reaches there are one or more pp values needing to be assigned. Thus at each pp value is assigned a value and if there are more than one pp values i.e. n val 1 then the actual time steps can be generated and the instantaneous pulse rate is displayed which is the frequency of the current pp interval determined by 60000 pp n pp 1 . From process flow continues to where if there are more than one pp values calculation of interbeat intervals IBI s is possible. This at the process tests for this condition and if yes IBI values can for example be calculated at . If not process flow can loop back to . At once IBI values are calculated process flow moves to to test how many pp values there are. If there are more than 8 i.e. at least 9 then there is sufficient data to identify a level 4 valley. Once there is are at least two level 4 valley points i.e. num val 1 at the exemplary process can look for RSA waves as described above. Thus a yes at can for example cause the process flow to call a process waves subroutine at .

There test integer 2 is set as a test divisor and process flow can move for example to where a temporary variable tmp val is set up to hold the quotient of err sum test integer representing a possible actual corrected pp interval. Process flow can then move to where for example tmp val is tested for being above the range. If yes then at for example the test integer variable is incremented and the proposed division occurs one more time at . On the other hand if at tmp val is not above the range than at for example tmp val can again be tested for being within the range and if yes process flow can move through breakpoint to of .

At of a count variable can be set to 1 and at for example the subroutine can query whether count is less than the current value of test integer. If no then process flow can move for example to and the variable n val can be set equal to test integer and at for example return to Process Pulse at breakpoint of . On the other hand if count is less than test integer at then process flow can for example loop through and incrementing the value of count each loop at until count equals test integer at which time process flow can return to Process Pulse. Next described is an exemplary error detection subroutine with reference to .

With reference to process flow begins at and continues to where a current pp interval is loaded into temporary in the sense of tentatively correct pp interval tmp pp. At the tmp pp is tested for being within range. If yes then n val is set to and val is set equal to tmp pp at and at process flow returns to the calling program Process Pulse in particular to in . However if at tmp pp is found to be out of range then at temporary interbeat interval variable tmp ibi is generated to use in detecting any errors as described above. Process flow can then continue through breakpoint to of where tmp ibi is tested for being greater than half the lower end of the range which is a test for being too large as described above. If yes there is assumed to be an error and flow continues to where the variable err sum is set equal to tmp pp err sum is an input to the error correction subroutine described above state is set to be CORRECTION and process flow can move for example to where n val is set to and process flow returns to Process Pulse which can then based on n val 0 and state CORRECTION return at of of and ultimately flow to an error correction subroutine at .

If at tmp ibi is not greater than half of the lower end of the range in which case it is not considered to be large and thus no error present in the pp interval data process flow can continue to and for example test whether the tmp pp is greater than the top of the range. Because tmp ibi was not found to be large at and thus no error is assumed present if at the tmp pp interval is still larger than the existing top of the range the range needs to be recalculated using the new pp interval as max pp which holds the value for the maximum possible pp interval which is not the result of an error in the data. At for example max pp can be set equal to tmp pp and using this new value at for example the upper and lower ends of the range are recalculated. Flow can then continue for example to where the n val is set equal to 1 and val is set equal to the current pp interval tmp pp. At for example process flow can return to the calling routine Process Pulse. If at the current pp interval is not greater than the existing upper end of the range then for example at the minimum possible pp interval is set equal to the current pp interval. Then process flow continues as described above through and where process flow returns to the calling program.

With reference to process flow for the subroutine initialize range is next described. This subroutine can be used in exemplary embodiments of the present invention to calculate the range for pp intervals within which the data is assumed to be error free for use in the error detection and correction routines. Beginning at at the subroutine call process flow moves for example to where the variables min pp and max pp are set using the following pseudocode min pp lowest pp in data set max pp highest pp in data set. Then for example at the upper and lower ends of the range of data points used for error detection and correction as described above. This can for example be implemented using the following pseudocode range high max pp max pp min pp 0.25 range low min pp max pp min pp 0.25 . Using these exemplary values the range is now set and at process flow returns to the calling routine i.e. Process Pulse. In particular process flow returns to in .

With reference to an exemplary subroutine for assigning wavelengths to acquired waves is depicted. This subroutine can be used for example in the exemplary determine stress routine depicted in as described above which takes wavelengths as inputs. In an exemplary embodiment of the present invention process flow can begin at with a call to the subroutine. At a counter variable n is set equal to zero and at for example a current wavelength wl is calculated by subtracting the timestamp of the current v from that of the current v using the expression wl ts v n ts v n . At and for example the value of wl is compared with that of wl lo and wl high which can be set in the calling subroutine as seen at of where for example they are set as and respectively . If wl is less than wl lo or higher than wl high a wl n is truncated at either wl lo or wl high as the case may be and flow continues at where the value of n is pre incremented. If however wl has a value between wl low and wl high then for example at a wl n is set to wl and process flow continues to . At the value of n is compared with that of n waves to insure that each acquired wave has been assigned a wavelength. If they are equal at for example process flow ends for this subroutine and returns to n . If they are not equal then flow loops through for each acquired wave until all acquired waves have been assigned wavelengths.

Exemplary embodiments of the present invention also provide for example methods and devices which can determine the phase of RSA waves in real time using the phase changes to detect the drop point using the phase changes to detect the completion of a wave and determining parasympathetic intensity of the newly formed wave.

The exemplary processes and process flows illustrated in as well as any exemplary functions implementing such processes including any auxilliary functions and or processes called or utilized by such exemplary flow processes are presented for illustrative purposes. Those skilled in the art will recognize that each exemplary process or function whether at a called function or process level or at an overall level for an entire top level process can be implemented in a variety of functionally equivalent ways and the description of which follows is in no way to be construed as limiting the wide variety of possible implementations in actual systems or devices or requiring that the illustrative exemplary process flow be literally followed.

Bearing this in mind for economy of expression as well as for elegance of illustration the process flow in each of will next be described without continual reference to the exemplary nature of each stage or step in process flow it being understood that in exemplary embodiments of the present invention functionally equivalent implementations can for example use different processes as well as different sequences of processes and organizations of process flow from that which is illustrated in to achieve equivalent functionalities. All of such alternate embodiments and equivalent functional implementations are understood to be within the methods and techniques of the present invention.

This exemplary process begins at . The first step in the process is to clear all counters num points tracks the number of pulses received num valley tracks the number of wave valleys identified num peaks tracks the number of wave peaks identified prev phase keeps track of the previous wave phase prev direction keeps track of the previous wave direction prev side keeps track of the previous wave side and wave size tracks the length of the last wave .

The process then flows to where it waits for the next pulse beat to arrive. When a new pulse is detected the process flows to where the pulse is processed. After the pulse is processed the flow returns to where it waits for another pulse to arrive.

At the peak to peak pp time of the last two points is computed and recorded as point num points .pp. Also the pulse rate value represented by the pp time is computed and recorded as point num points .prv. Then the flow continues to .

At the process assesses whether there are at least 8 points in the record. If not the flow continues to and the num points counter is incremented. The process further continues to and returns. However if there are at least 8 points in the record the process flows to which calls the Process Wave process. After the Process Wave process returns the process in flows to and returns.

At the process determines whether or not there has been a change in sides. If the wave has not changed sides the process flows to . Otherwise the process flows to where the peaks and valleys are assessed by the Get Peaks and Valleys process. After this process returns the flow continues to .

At the process sets a flag indicating whether a wave has just completed or not via the Check to See if Wave has Completed process. After this process returns the flow continues to where the Wave Completed flag is checked. If a wave has not just completed the flow continues to . Otherwise the flow continues to . At the Mark Parasympathetic Strength of Wave process delineates the newly formed wave assesses its parasympathetic activity and marks the activity under the wave using visual symbols. After this process returns the flow continues to .

At a flag is set indicating whether the drop point has just been crossed or not. The Check to See if Drop Point is Occurring process makes this determination and sets the flag accordingly. After this process has returned the flow continues to where the flag is analyzed. If the drop point flag has not been set the flow continues to . Otherwise the flow continues to . At the process Mark Drop Point places a visual symbol above the wave at the drop point and provides an auditory cue of the drop point. After this process returns the flow continues to .

At the prev phase prev side and prev direction markers are assigned. Then the flow continues to where the Process Wave functions returns.

At the process checks to see if the short slope is less than 30 of 1 absolute long slope. If it is the flow continues to . If not the flow continues to .

At the process checks to see if the prev direction has never been set yet. If it has not been set the flow continues to . Otherwise the flow continues to where the process returns.

At prev direction gets recorded as the current direction direction . The flow continues to where the process returns.

At the process checks to see if the direction is UP. If it is the flow continues to . If it is not the flow continues to .

At the process checks to see if the direction is DOWN. If it is the flow continues to . Otherwise the flow continues to .

At the process checks to the see if the prev phase has not yet been recorded. If it has not the flow continues to . If it has the flow continues to .

At the process checks to see if the phase is RISING. If it is the flow continues to . Otherwise the flow continues to .

At the process checks to see if the prev side has yet been recorded. If it has not then the flow continues to . Otherwise the flow continues to .

At the prev side is recorded as the current side side . The flow then continues to . At the Get Side process returns.

At the peak is identified as the highest prv value during the previous RISING and CRESTING phases. This value is recorded as peak num peaks . Then the flow continues to . At the num peaks counter is incremented. Then the flow continues to .

At the valley is identified as the lowest prv value during the previous FALLING and TROUGHING phases. This value is recorded as valley num valleys . Then the flow continues to . At the num valleys counter is incremented. Then the flow continues to . At the Get Peaks and Valleys process returns.

At the process checks to see if the previous phase was TROUGHING. If so the flow continues to . Otherwise the flow continues to .

At the process checks to see if the previous phase was FALLING. If so the flow continues to . Otherwise the flow continues to . At the Check to See if a Wave has Completed process returns.

At the wave length is computed and recorded as wave length. Then the flow continues to . At the process checks to see if the wave length is less than 6 seconds. If it is the flow continues to . If it is not the flow continues to .

At the wave size is determined to be SMALL. This indicates very little parasympathetic activity when the wave was formed. The process can then visually mark the wave with an appropriate symbol indicating the parasympathetic activity. In the preferred embodiment a one dot symbol is placed below the wave. The flow then continues to .

At the wave length is checked to see if it is less than 9 seconds in length. If it is the flow continues to . Otherwise the flow continues to .

At the wave size is marked as MEDIUM. A medium level of parasympathetic activity likely formed the wave. The process can then visually mark the wave with an appropriate symbol indicating the parasympathetic activity. In the preferred embodiment a two dot symbol is placed below the wave. The flow continues to .

At the wave size is marked as LARGE. A high amount of parasympathetic activity is represented by such waves. The process can then visually mark the wave with an appropriate symbol indicating the parasympathetic activity. In the preferred embodiment a three dot symbol is placed below the wave. The flow continues to .

At the process checks to see if the previous phase was RISING. If it was the flow continues to . Otherwise the flow continues to .

At the drop point flag is set to true. Then the flow continues to . At the Check to See if Drop Point is Occurring process returns.

At the process checks to see if the wave size is SMALL. If yes the flow continues to . If not the flow continues to .

At the device generates a high pitch beep. This auditorily indicates that the drop point has been encountered as well as auditorily indicating that the previous wave was formed by a low level of parasympathetic activity. The flow then continues to .

At the process checks to see if the wave size is MEDIUM. If it is the flow continues to . If it is not the flow continues to .

At the device generates a middle pitch beep. This auditorily indicates that the drop point has been encountered as well as auditorily indicating that the previous wave was formed by a medium level of parasympathetic activity. The flow then continues to .

At the device generates a low pitch beep. This auditorily indicates that the drop point has been encountered as well as auditorily indicating that the previous wave was formed by a high level of parasympathetic activity. The flow then continues to . At the Mark Drop Point process returns.

Exemplary procedures for determining for example the phase of RSA waves in real time using the phase changes to detect the drop point using the phase changes to detect the completion of a wave and determining parasympathetic intensity of the newly formed wave also may be implemented using the following pseudocode corresponding substantially to the flow processes depicted in .

Exemplary embodiments of the present invention also provide for the identification of peaks and valleys in real time without first identifying TD4 segments. Thus values may be processed sequentially e.g. one by one .

The exemplary processes and process flows illustrated in as well as any exemplary functions implementing such processes including any auxilliary functions and or processes called or utilized by such exemplary flow processes are presented for illustrative purposes. Those skilled in the art will recognize that each exemplary process or function whether at a called function or process level or at an overall level for an entire top level process can be implemented in a variety of functionally equivalent ways and the description of which follows is in no way to be construed as limiting the wide variety of possible implementations in actual systems or devices or requiring that the illustrative exemplary process flow be literally followed.

Bearing this in mind for economy of expression as well as for elegance of illustration the process flow in each of will next be described without continual reference to the exemplary nature of each stage or step in process flow it being understood that in exemplary embodiments of the present invention functionally equivalent implementations can for example use different processes as well as different sequences of processes and organizations of process flow from that which is illustrated in to achieve equivalent functionalities. All of such alternate embodiments and equivalent functional implementations are understood to be within the methods and techniques of the present invention.

As shown in the process begins at . The first step is . At the process sets the UP PERCENT to and the DOWN PERCENT to 15. Then the flow continues to where the counters and markers are initialized. Then the flow continues to where the process waits for 15 seconds worth of pulse information to arrive. Then the flow continues to where the process waits for the next pulse beat. After the next pulse beat is receive the flow continues to where the global directional indicators are determined by the Get Fast Information process.

When that process returns the flow continues to where the current slope is computed and recorded. Then the flow continues to where the lowest prv of the last 12 seconds and the highest prv of the last twelve seconds are computed and recorded. This provides us with the range of prv values over last 12 seconds.

The flow then continues to . At the Determine Direction process determines the direction of the wave. When this process returns the flow continues to where the current points peak to peak pp value pulse rate value prv timestamp ts direction and point index are computed and recorded.

Then the flow continues to where the Get Point Position process determines what part of the range the current point is within. A position of 100 means the point is at the very top or is above the range. A position of 0 means the point is at the very bottom or below the range. A value between 0 and 100 indicates the percent height of the point within the range.

When the Get Point Position process returns the flow continues to . At the wave plotting is update on the display. That is the recently received prv value is plotted on the display. Then the flow continues to .

At the process checks to see if the direction had changed when the last prv was received. If the direction did not change the flow continues to where the process waits for the next pulse. If the direction did change the flow continues to where the change of direction is handled by the Process Direction Change process. When this process returns the flow continues to where the process waits for the next pulse to arrive.

At the process checks to see if the fast rise is greater than the absolute value of the fast drop. If it is then the flow continues to . If it is not then the flow continues to .

At the absolute value of fast drop is recorded as the fastest change. Then the flow continues to . At the Get Fast Information process returns.

At the process checks to see if the current slope is less than 1 DOWN PERCENT of the fastest change. If it is then the flow continues to . If it is not then the flow continues to .

At the process checks to see if the current direction is UP. If it is then the flow continues to . If it is not then the flow continues to .

At the current direction is recorded as PEAK PLATEAU also known as CREST. Then the flow continues to .

At the process checks to see if the current direction is DOWN. If it is then the flow continues to . If it is not then the flow continues to .

At the current direction is recorded as VALLEY PLATEAU also known as TROUGH. Then the flow continues to . At the Determine Direction process returns.

At the process checks to see if the current point s prv is greater than the highest prv in the range. If it is then the flow continues to . If it is not then the flow continues to .

At the point s relative position in the range is computed and recorded. Then the flow continues to . At the Determine Point Position process returns.

At the process checks to see if the previous direction was DOWN. If it was then the flow continues to . If it was not then the flow continues to .

At the process checks to see if the previous direction had ever been recorded. If it had not the flow continues to . If it had the flow continues to .

At the up swing of the wave is handled by the Process Null Up Swing process. After this process returns the flow continues to .

At the process checks to see if the current point position is in the bottom 25 of the range. If it is then the flow continues to . If it is not then the flow continues to .

At the up swing of the wave is handled by the Process Regular Up Swing process. After this process returns the flow continues to .

At the process checks to see if the current direction is DOWN. If it is then the flow continues to . If it is not then the flow continues to .

At the process checks to see if the previous direction was UP. If it was then the flow continues to . If it was not then the flow continues to .

At the process checks to see if the current point s position is in the top 75 of the range. If it is then the flow continues to . If it is not then the flow continues to .

At the wave s down swing is handled by the Process Regular Down Swing process. After this process returns the flow continues to .

At the process checks to see if the previous direction has ever yet been recorded. If it has not then the flow continues to . If it has then the flow continues to .

At the wave s down swing is handled by the Process Null Down Swing process. When this process returns the flow continues to . At the Process Change Direction process returns.

At the process checks to see if there are at least two valley points on record. If there are the flow continues to . If there are not then the flow continues to .

At the wavelength of the last wave is computed and recorded. Then the flow continues to . At the stress index is computed and the score is computed. Also the stress index wavelength history score and other wave based metrics are displayed on the screen. Then the flow continues to .

At the previous direction is recorded as being UP. Then the flow continues to . At the previous direction index is recorded as having occurred two points ago. Then the flow continues to where the Process Regular Up Swing process returns.

At the process checks to see if there are at least two peaks recorded. If there are then the flow continues to . If there are not then the flow continues to .

At the timestamps of the last two peaks are subtracted to compute and record the last peak to peak time. Then the flow continues to .

At the previous direction indicator is set to DOWN. Then the flow continues to where the previous direction index is set to two points ago. Then the flow continues to where the Process Regular Up Swing Process returns.

Exemplary procedures for determining for example wave phase and delineating waves on a pulse by pulse basis also may be implemented using the following pseudocode corresponding substantially to the flow processes depicted in .

The present invention also provides processes for determining both the drop point and the completion of RSA waves in real time rather than on a pulse by pulse basis. describe two exemplary processes that run simultaneously. The first process Realtime Process at is executed on a pulse by pulse basis. The second process Realtime Process at is executed every 250 ms. The two processes work together to allow for the real time detection of the drop point and the real time detection of the termination of the current wave.

The exemplary processes and process flows illustrated in as well as any exemplary functions implementing such processes including any auxilliary functions and or processes called or utilized by such exemplary flow processes are presented for illustrative purposes. Those skilled in the art will recognize that each exemplary process or function whether at a called function or process level or at an overall level for an entire top level process can be implemented in a variety of functionally equivalent ways and the description of which follows is in no way to be construed as limiting the wide variety of possible implementations in actual systems or devices or requiring that the illustrative exemplary process flow be literally followed.

Bearing this in mind for economy of expression as well as for elegance of illustration the process flow in each of will next be described without continual reference to the exemplary nature of each stage or step in process flow it being understood that in exemplary embodiments of the present invention functionally equivalent implementations can for example use different processes as well as different sequences of processes and organizations of process flow from that which is illustrated in to achieve equivalent functionalities. All of such alternate embodiments and equivalent functional implementations are understood to be within the methods and techniques of the present invention.

Meanwhile Realtime Process which begins at operates simultaneously. The first step in this process at is to set the clock interrupt to ms so that this process is called every 250 ms. Then the flow continues to where the process sleeps until the clock interrupt occurs. When the clock interrupt occurs the interrupt is handled by the Handle Clock Interrupt process. When this process returns the flow continues to where the clock interrupt is set again.

At the process checks to see if the direction is UP. If it is then the flow continues to . If it is not then the flow continues to .

At the process checks to see if the direction is PEAK PLATEAU. If it is then the flow continues to . If it is not then the flow continues to .

At the process checks to see if the direction is DOWN. If it is then the flow continues to . If it is not then the flow continues to .

At the process Handle VALLEY PLATEAU handles the case where the wave is currently TROUGHING. When this process returns the flow continues to .

At the valley plateau flag is set to false. Then the flow continues to where the up flag is set to true. Then the flow continues to .

At the valley plateau flag is set to false. Then the flow continues to where the up flag is set to true. Then the flow continues to .

At the valley plateau flag is set to false. Then the flow continues to where the up flag is set to false. Then the flow continues to . At the Handle Pulse Peak process returns.

At the process checks to see if the up flag is true. If it is then the flow continues to . If it is not then the flow continues to .

At the process checks to see if the current time is past the computed plateau end. If it is then the flow continues to . If it is not then the flow continues to .

At the current direction is recorded as being UP. The UP swing was therefore detected in real time. Therefore the completion of the previous wave was detected in real time. Wave delineation stress metrics parasympathetic metrics and the like can therefore be computed recorded displayed and more at this point if desired.

The flow then continues to . At the process checks to see if the up flag is set to true. If it is then the flow continues to . If it is not then the flow continues to .

At a phantom prv value is computed called tmp prv. Then the flow continues to where the current slope is computed based upon the two previous real prv s and the phantom prv. Then the flow continues to .

At the process checks to see if the current slope is less than 1 DOWN PERCENT of the fastest change. The computation of fastest change has been described in prior examples. If the current slope is less then the flow continues to . If it is not less then the flow continues to .

At the current direction is recorded as DOWN. In other words the transition to DOWN was detected in real time. The process did not need to wait for the next pulse beat. The next pulse beat will be occurring after the drop point.

The flow continues to where the up flag is set to false. Then the flow continues to where the drop point can be processed. The drop point can be indicated visually auditorily or both. After the drop point information is used the flow continues to . At the process Handle Clock Interrupt returns.

At the process checks to see if the valley plateau flag is false. If it is false then the flow continues to . If it is not false then the flow continues to .

At the process checks to see if the previous point is a bottom point. If it is then the flow continues to . If it is not then the flow continues to .

At the process checks to see if the previous point is an ascending transition point. If it is then the flow continues to . If it is not then the flow continues to .

At the process checks to see if the timestamp of the last known valley is less than the timestamp of the last known peak. If it is then the flow continues to . If it is not then the flow continues to .

At one third of the time between the last peak and the last valley is added to the plateau end. Then the flow continues to .

At one third of the time between the last peak and the second to last valley is added to the plateau end. Then the flow continues to .

At the valley plateau flag is set to true. Then the flow continues to . At the process Handle VALLEY PLATEAU returns.

Exemplary procedures for determining for example both the drop point and the completion of RSA waves in real time also may be implemented using the following pseudocode corresponding substantially to the flow processes depicted in .

The present invention has been described with reference to particular embodiments. It should be noted however that variations and modifications may be made without departing from the spirit and scope of the invention. In particular it should be appreciated that the various flow processess described herein may be modified to provide substantially equivalent functional implementations and as such are understood to be within the spirit and scope of the invention.

