---

title: Methods and systems for evaluating interaction of medical products and dependence on demographic variables
abstract: A computer implemented method of evaluating interaction two or more medical products or conditions, in the context of a reference condition, based on a dataset of patient records includes developing a reference contingency lattice of lattice subsets from a subset of the patient records containing the reference condition, wherein the lattice subsets correspond to the number of patient records that contain each of the two or more medical products or conditions and combinations thereof. A plurality of comparison contingency lattices are developed, each of the comparison contingency lattices developed from a respective random subset of patient records not containing the reference condition, where each of the comparison contingency lattices include lattice subsets that correspond to the number of patient records that contain each of the two or more medical products or conditions and combinations thereof. The lattice subsets of the reference contingency lattice are compared to the corresponding lattice subsets of the comparison contingency lattices to determine whether a lattice subset is indicative of an interaction between the medical products or conditions with respect to the reference condition.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08170889&OS=08170889&RS=08170889
owner: UBC Late Stage, Inc.
number: 08170889
owner_city: Kansas City
owner_country: US
publication_date: 20060922
---
This application claims the benefit of priority to U.S. provisional application No. 60 719 173 filed on Sep. 22 2005.

Analysis of pharmacovigilance data for drug interactions or other causes of adverse events has been an important endeavor in order to maximize the safety of patients and discovery of such interactions and other causes of adverse events as quickly and efficiently as possible is of utmost importance. While statistical methods to analyze pharmacovigilance data have been used extensively many suffer from several deficiencies. For example many of the statistical techniques used do not adequately account for the bystander effect in which interactions that appear to be caused by the presence of one drug or cause is really the result of the simultaneous presence of another drug or cause.

Furthermore the known techniques of analysis of pharmacovigilance data also often suffer from the problem that the drug or other interactions or information that are present in the data stored for example in a table in a database are not intuitively or conveniently visualized in a display.

In certain embodiments the present invention provides a computer implemented method of evaluating interaction of two or more medical products or conditions in the context of a reference condition based on a dataset of patient records. The method includes developing a reference contingency lattice of lattice subsets from a subset of the patient records containing the reference condition wherein the lattice subsets correspond to the number of patient records that contain each of the two or more medical products or conditions and combinations thereof developing a plurality of comparison contingency lattices each of the comparison contingency lattices developed from a respective random subset of patient records not containing the reference condition wherein each of the respective random subsets is of the same size as the subset of patient records containing the references condition and wherein each of the comparison contingency lattices include lattice subsets that correspond to the number of patient records that contain each of the two or more medical products or conditions and combinations thereof and comparing the lattice subsets of the reference contingency lattice to the corresponding lattice subsets of the comparison contingency lattices to determine whether a lattice subset is indicative of an interaction between the medical products or conditions with respect to the reference condition.

In certain embodiments the present invention provides a computer implemented method of evaluating interaction two or more medical products or conditions in the context of a reference condition based on a dataset of patient records. The method includes developing a reference orthogonal contingency lattice of lattice subsets from a subset of the patient records containing the reference condition wherein the lattice subsets correspond to the number of patient records that contain each of the two or more medical products or conditions and combinations thereof but that exclude all the other medical products or conditions and combinations thereof respectively developing a plurality of comparison contingency lattices each of the comparison contingency lattices developed from a respective random subset of patient records not containing the reference condition wherein each of the respective random subsets is of the same size as the subset of patient records containing the references condition and wherein each of the comparison contingency lattices includes lattice subsets that correspond to the number of patient records that contain each of the two or more medical products or conditions and combinations thereof but that exclude all the other medical products or combinations thereof respectively and comparing the lattice subsets of the reference contingency lattice to the corresponding lattice subsets of the comparison contingency lattices to determine whether a lattice subset is indicative of an interaction between the medical products or conditions with reference to the reference condition.

In certain embodiments the present invention provides a computer implemented method of evaluating interaction of two or more medical products in the context of a reference condition based on a dataset of patient records. The method includes determining a number N of patient records in the dataset containing indications of medical product A and medical product B of patient records in the dataset containing indications of medical product A and medical product B determining a number Nx of patient records containing indications of the reference condition among patient records of a first random sample of size N of patient records of the dataset the patient records of the first random sample containing medical product A and not medical product B comparing a number of such patient records containing the reference condition to Nx among patient records of a second random sample of size N of patient records of the dataset the patient records of the second random sample containing medical product B and not medical product A comparing a number of such patient records containing the reference condition to Nx among patient records of a third random sample of size N of patient records of the dataset the patient records of the third random sample containing neither medical product A or medical product B comparing a number of such patient records containing the reference condition to Nx and determining whether a second order bystander effect exists between the reference condition and either of medical product A and medical product B.

In certain embodiments the present invention provides a computer implemented method of evaluating dependence on demographic variables in the context of a medical product and a reference condition based on a dataset of patient records. The method includes determining a number N of patient records in the dataset containing indications of both the medical product and the reference condition for a continuous demographic variable determine an average of the demographic variable of patient records in a first random sample of size N the patient records of the first random sample containing an indication of the medical product and not containing an indication of the reference condition for the continuous demographic variable determine an average of the demographic variable of patient records in a second random sample of size N the patient records of the second random sample containing an indication of the reference condition and not containing an indication of the medical product for the continuous demographic variable determine an average of the demographic variable of patient records in a third random sample of size N the patient records of the third random sample containing neither an indication of the medical product or an indication of the reference condition for a categorical demographic variable among patient records in a fourth random sample of size N determine a fraction of patient records for which the categorical demographic variable has a specified value the patient records of the fourth random sample containing an indication of the medical product and not containing an indication of the reference condition for the categorical demographic variable among patient records in a fifth random sample of size N determine a fraction of patient records for which the categorical demographic variable has a specified value the patient records of the fifth random sample containing an indication of the reference condition and not containing an indication of the medical product for the categorical demographic variable among patient records in a sixth random sample of size N determine a fraction of patient records for which the categorical demographic variable has a specified value the patient records of the sixth random sample containing neither an indication of the medical product or an indication of the reference condition and determining whether a relationship exists between the continuous demographic variable or categorical demographic variable the reference condition and the medical product.

In accordance with other of its aspects the present invention provides a computer readable data storage means containing program code recorded thereon for implementing the method steps described herein.

The present invention further provides a computing system having a system memory containing computer readable data storage means containing program code recorded thereon for implementing the method steps described here.

In certain embodiments the present invention provides an approach to assessing multi way interactions in pharmacovigilance data. This approach uses a lattice based comparison of datasets which is also described further herein. In certain embodiments the following two things are specified 

The specific example discussed here takes rhabdomyolysis as the reference condition comparing results obtained from the Adverse Event Reporting System AERS database maintained by the Food and Drug Administration among patients reporting this reference condition against random samples of patients not reporting rhabdomyolysis i.e. the reference condition . The criteria of primary interest in this example are the three drugs Baycol Lopid and Plavix and the objective of the analysis is to assess the evidence in support of associations between rhabdomyolysis and either individual drugs or drug combinations. It should be noted that the particular reference condition described herein as well as the particular drugs as criteria of primary interest referenced herein are exemplary only. One skilled in the art would recognize various other alternatives and modification all of which are considered to be a part of the present invention.

The first construction described here is the contingency lattice which characterizes all possible combinations of the criteria of primary interest in a way that it displays information that may be stored in a multi way contingency table. The random permutation based reference strategy proposed herein basically asks whether the multi way contingency table generated from the dataset under the reference condition is consistent with those generated from datasets of the same size or a similar size that do not satisfy the reference condition. It should be noted that in certain embodiments the generated datasets could be a multiple or a fraction of the size of the dataset under the reference condition provided the results are scaled to account for the different sizes of the datasets.

The second construction described is the orthogonalized contingency lattice an extension of the contingency lattice just described that is designed to reduce bystander effects where the presence of one condition e.g. the drug Baycol appearing in an adverse event report induces a spurious association between other conditions e.g. the presence of the drug Plavix and the occurrence of rhabdomyolysis .

A 2 2 contingency table can be used to summarize records that do or do not satisfy two different binary conditions. That is suppose that Conditions A and B are characterizations of records in a dataset D that can either be satisfied or not satisfied. In pharmacovigilance problems for example these conditions would typically be the presence of a specified drug or adverse event in a spontaneous reporting database or other similar database like the FDA s AERS database. For example Condition A might be the presence of the adverse reaction rhabdomyolysis in an Individual Safety Report ISR and Condition B might be the presence of the drug Baycol cerivastatin sodium in the report. Much of what is now done in pharmacovigilance is very closely related to 2 2 contingency tables constructed from such drug adverse event pairs. These tables are characterized by the following four numbers 

In particular commonly used measures of association between conditions e.g. the odds ratio can be computed from these four numbers. See for example A. A CDA2ed. Wiley 2002 . A key observation is that each of the four numbers listed above represents the size of a well defined set of records satisfying the following inclusion conditions 

These inclusion conditions represent an important example of a partial order. B. A. DH. A. P ILO Cambridge University Press 1990. Therefore set S precedes set T written S

More generally a lattice is a special case of a partially ordered set or poset in which it may not be possible to compare all elements of the set directly but every pair of elements does have both a greatest lower bound GLB and a least upper bound LUB . That is given two elements x and y and some ordering criterion 

where denotes the empty set. By definition the empty set is a subset of all other sets and it is clear that all one and two element sets in this list are subsets of the original set S but some of these sets are not comparable under the inclusion ordering. For example since x y neither contains nor is contained in x z these two sets are not comparable under this order. However both of these sets contain x as a subset and both are contained in the complete set S. These two sets represent the greatest lower bound i.e. the largest subset common to both and the least upper bound i.e. the smallest set containing both respectively for the pair of sets x y and x z.

Lattices provide the basis for formal concept analysis FCA an area of active research in the data mining community. U. Priss ARIS V40 to be published . Roughly speaking FCA is based on lattices defined by mutually reinforcing sets of data records and attributes. A practical disadvantage of formal concept analysis is that the resulting lattices are often huge. For example Stumme et al. cited further herein note that the total number of formal concepts required to fully characterize the mushroom dataset from the UCI Machine Learning Archive is 32 086 for a dataset containing 23 characterizations of 8 416 mushrooms. G. Stumme R. Taouil Y. Bastide N. Pasquier and L. Lakhal DKE V42 189 222 2002 . Examples like this one motivate their development of approximate descriptions in terms of much smaller lattices of concepts with large support. 

Alternatively any finite collection of binary conditions i.e. conditions that each individual record either satisfies or does not satisfy defines a subset lattice consisting of the subsets satisfying each individual condition and all possible combinations of these conditions. For N conditions this lattice consists of 2sets and it corresponds to a multi way contingency table analogous to the 2 2 contingency table suitably expanded discussed above. Typically multi way contingency tables involving three or more conditions are analyzed using loglinear models See A. Agresti at Section 8.4 but the asymmetric nature of these models i.e. they predict a single response variable from all others taken as independent stimuli has been raised as an objection in some applications where it is not natural to separate variables into a single response and N 1 independent stimuli. See J. R. Vokey C. J. E. P v. 57 257 264 2003 . In certain embodiments the present invention proposes the use of the lattice of these sets as an alternative approach to analyzing these multiway tables.

As a specific example shows a lattice generated by the subsets of ISR s from the AERS database listing the following three drugs B Baycol cerivastatin sodium L Lopid gemfibrozil P Plavix clopidogrel bisulfate .

These criteria define three subsets of the patient records in the dataset D and these subsets in turn generate the subset inclusion lattice shown in . That is each box in this figure represents a subset of patient records from D with the top box representing all records in the dataset. The three boxes in the second row from the top in this figure correspond to the sets of patient records satisfying each of the three conditions defined above and the three boxes in the third row correspond to the subsets of patients satisfying each pair of these conditions. Finally the single box at the bottom corresponds to the subset of patients exhibiting all three of these characteristics. The arrows in this figure point from each set to all of its immediate subsets i.e. all subsets obtained by imposing one additional condition .

In the basic analysis approach proposed here given a set of conditions of interest e.g. the three drugs Baycol Lopid and Plavix in the example just described a corresponding contingency lattice is first constructed as in . We then characterize all of the sets defined by this lattice in terms of their size giving a vector of 2integer valued components. Finally we determine whether these numbers are associated with the reference condition by using the random subset based significance analysis described in the next section. The basic question of interest is whether any of the subsets defining the contingency lattice are larger or smaller than we would expect due to random sampling alone in the absence of any association between the reference condition that defines dataset D and the conditions of interest defining the lattice of subsets.

To interpret contingency lattice results the contingency lattice as described in the preceding discussion is first constructed using the records from a dataset Dthat satisfies a specified reference condition R. In the specific example considered in this note this reference condition is the occurrence of the adverse event rhabdomyolysis in each adverse event report i.e. Dcontains all records for patients reporting rhabdomyolysis . A key assumption is that the reference set Dis a proper subset of the original dataset D such that the difference set D D D contains a relatively large number of records compared with D. Note that this condition is automatically satisfied if N

The measures of difference considered here are the sizes of the subsets defined by the contingency lattices. It should be recognized that using the sizes as a measure of difference is exemplary only and one skilled in the art would recognize various alternatives and modifications all of which are considered a part of the present invention. Examples of which can include the use of alternative characterizations such as age or gender. In certain embodiments each of the randomly generated comparison datasets D is of fixed size N and the sizes of the 2 1 other lattice subsets will be denoted Nwhere j 1 2 . . . 2 1 designates the sub set and i 1 2 . . . M designates the dataset Dconsidered. The sizes of the corresponding subsets constructed from the reference dataset Dare denoted Nfor j 1 2 . . . 2 1. Differences between the results obtained for the reference dataset Dand the random comparison datasets Dare assessed using the difference between the subset sizes Nand N for i 1 2 . . . M for all subsets j. Unusually large values of Nrelative to N suggest a possible association between the reference condition R and the conditions of interest that define the subset j.

Boxplot summaries provide a convenient graphical way of representing these results highlighting the subsets for which the differences between the primary reference dataset and the randomized comparison datasets are most pronounced. This point is illustrated in which shows the results obtained for the reference condition rhabdomyolysis which defines a reference dataset Dof size N 11 773. The solid points shown in represent the sizes of each of the seven subsets of Ddefined by the three conditions of interest i.e. patient was taking Baycol Lopid Plavix or a combination of these drugs . The boxplots shown in summarize the subset sizes obtained for M 200 comparison sets D each obtained by randomly selecting N 11 773 patient records from among those not reporting the reference condition rhabdomyolysis. The fact that some of the reference results most prominently those for Baycol Case B or Lopid Case L or and Baycol with Lopid Case BL or fall well outside the range of the randomized comparison results suggests a significant association between the condition rhabdomyolysis and these drugs. also lists the z scores associated with each comparison i.e. between the size of primary reference dataset and the sizes of the randomized comparison subsets . These numbers provide quantitative characterizations of these comparisons and are described in the next section.

In classical statistics random variables are frequently assumed to exhibit a Gaussian distribution which is completely characterized by the population mean and standard deviation . In fact if and are known the probability of observing a sample from this distribution with the value X is completely determined by the value Z X . In cases where the Gaussian assumption is reasonable but and are unknown these quantities are usually estimated from a sequence of N data samples x as 

It follows from this result that the probability of observing a specific data value x in an approximately Gaussian data sequence can be reliably estimated from the z score the sample analog of Z defined above 

Despite its popularity the Gaussian assumption often fails to hold even so the z scores can still be used to derive probability bounds that are quite conservative but almost universal. Specifically so long as the mean and variance of the underlying distribution are finite a condition that can be violated but generally holds it follows from Chebyshev s inequality that 

In the problems considered here z scores are computed for the size of each contingency lattice subset constructed under the primary reference condition relative to the mean circumflex over and standard deviation circumflex over of the sizes of the corresponding M random comparison subsets. It follows from the above arguments that if the magnitude of the resulting z score is large the result obtained under the primary reference condition is not consistent with the randomized comparison results. Such an inconsistency represents evidence that the reference condition significantly influences the size of the corresponding contingency lattice subset. If there is insufficient data regarding a given set of conditions however the standard deviation of the numbers in the comparison contingency lattice will increase. This may be taken as an indication that because of insufficient data the proposed method has inadequate power to draw conclusions.

As a specific example the very large z scores listed in for Cases B L and BL and provide evidence that the drugs Baycol Lopid and the two together are strongly associated with the adverse event rhabdomyolysis. These results are summarized in Table 1 further herein which gives the size of each of the seven subsets defined by the three way contingency lattice for Baycol Lopid and Plavix based on the reference condition rhabdomyolysis. Specifically this table gives the size of each of the seven subsets for patients reporting rhabdomyolysis the range of the corresponding subset sizes for M 200 randomly selected samples of patients not reporting rhabdomyolysis the associated z scores and their probability bounds as determined by the Chebyshev inequality 4 . The very large z scores for Baycol and the combination of Baycol and Lopid are consistent with the fact that Baycol was withdrawn from the market because of its associated rhabdomyolysis risk particularly when taken in combination with Lopid.

In deciding whether an individual contingency lattice subset result is significant or not it is important to account for the fact that we are not making a single comparison but rather p 2 1 comparisons. Hence if the probability of declaring a result significant when it is not i.e. the false positive rate is fixed at and all tests are independent it follows that the probability of erroneously declaring one of p results significant when it is not increases to approximately p . The simplest way of correcting for this effect is to use the Bonferroni correction which replaces the single test significance level with the more conservative p test significance level p. See P. WS. Y RBMT Wiley 1993.

Combining the Bonferroni correction with the Chebyshev inequality we obtain the following conservative but simple distribution free significance threshold a contingency lattice result is declared significant at the level if the corresponding Chebyshev inequality result gives a probability less than p. This approach gives the following bound on the magnitude of the z scores 

Note that all of the contingency lattice results summarized in Table 1 exceed this critical z score which indicates a significant association between rhabdomyolysis and all of the individual drugs their pairs and their three way combinations. Subsequent investigation shows that the cause of these apparent associations is the large number of cases involving the drug Baycol present in each of these individual subsets. This effect the spurious generation of association signals between a drug and an unrelated adverse event is called a bystander effect and is a significant concern in the pharmacovigilance literature. See for example D. M. Coulter A. Bate E. H. B. Meyboom M. Lindquist and I. R. Edwards BMJ322 1207 09 2001 .

A difficulty with the analysis described above is that subsets listing a particular drug or drug combination may also list other drugs or drug combinations with unknown frequencies. For example the subset labeled Plavix in contains all patient records that list the drug Plavix regardless of whether they also list the drugs Baycol Lopid or both. Consequently if there is a strong association between the drug Baycol and the condition rhabdomyolysis which is known to be the case and if there is a significant overlap between patient records listing Plavix and Baycol then the apparent association between Plavix and rhabdomyolysis can be significantly inflated in the contingency lattice analysis just described. Note also that even when using the multiway contingency tables these bystander effects can be expected in traditional analyses based on contingency tables.

To overcome these bystander effects in certain embodiments the present invention provides orthogonalized contingency lattices as a basis for pharmacovigilance analysis. The basic idea is to replace subsets like all patients taking Plavix in the example considered earlier with non overlapping subsets like all patients taking Plavix but not taking either Baycol or Lopid. To illustrate this idea more completely shows the orthogonalized version of the contingency lattice shown in . As before the three drugs considered are designated as B Baycol L Lopid and P Plavix but in an overbar is used to indicate that a certain condition is excluded in constructing the corresponding patient subset. For example the left most block in the second row in is designated B defining the set of AERS ISR s listing the drug Baycol but not listing the drugs Lopid or Plavix. More generally note that each of the seven subset blocks appearing in lists all three symbols B L and P either without an overbar to indicate it is included in forming the subset or with an overbar to indicate that it is excluded. As a consequence it should be noted that all of these subsets are mutually exclusive with no patient appearing in more than one subset.

The results obtained from the orthogonalized contingency lattice just described are analyzed exactly as in the case of the basic contingency lattice described previously. That is the sizes of the subsets defined by the combinations of conditions of interest in the orthogonalized lattice are compared between records satisfying the reference condition R and M randomly selected subsets of the same size that do not satisfy this reference condition. As discussed earlier herein the comparison record set may also be a multiple or fraction of the size of the record set satisfying the reference condition provided the results from the comparison record set are suitably scaled so that comparisons effectively made between record sets of the same size.

Significant differences in subset size between those based on the reference condition and those based on the random comparison datasets give evidence of an association between the reference condition and the conditions of interest defining each subset in which the significant size difference has been observed. As before significance is assessed using the Bonferroni corrected z score analysis described earlier herein. The primary difference between the results obtained with the original contingency lattice construction and those obtained with the orthogonalized construction lies in the fact that the orthogonalized patient subsets are mutually exclusive. Consequently associations observed between the reference condition and the conditions of interest defining a subset cannot be a spurious consequence of associations between the reference condition and other conditions of interest provided they are included in the orthogonalized contingency lattice. That is spurious associations due to conditions not included in the analysis are still possible. For example if Baycol were replaced with Lipitor in this example the fact that many records listing Lopid also list Baycol would not enter into the analysis so unrecognized Baycol induced bystander effects would inflate the Lopid rhabdomyolysis association just as in the non orthogonalized results presented in the preceding discussion.

The orthogonalized contingency lattice results obtained for the example considered here are summarized in a boxplot shown in which should be compared with the boxplot shown in . First note the difference in horizontal scales between these two figures reflecting the fact that the subsets defining the orthogonalized lattice are generally smaller than the respective subsets defining the original lattice. In particular note that each of the subsets indicated in is contained in the corresponding subset indicated in . For example the subset designated B in is contained in the Baycol subset Case B or in . Second and more significantly note that the apparently strong association between Lopid and rhabdomyolysis implied by the results for Case L in is much weaker in the orthogonalized results presented in . The magnitude of this difference is even more apparent from the z scores presented in Table 2 below for the orthogonalized results when compared with those presented in Table 1 for the original results. For the case of Lopid it should be noted that removal of Baycol and Plavix records in the orthogonalized result decreases the z score by an order of magnitude from z 403 to z 43 increasing its associated probability by two orders of magnitude. Finally the third major difference between these two figures is that the rhabdomyolysis result for Plavix Case P which falls clearly outside the range of the non rhabdomyolysis results in the original analysis falls within this range in the orthogonalized analysis. This difference is also reflected in the z scores listed in Table 2 whereas in the original results the association seen between Plavix and rhabdomyolysis was significant at the Bonferroni corrected 5 level this is no longer true for the orthogonalized results.

Comparing Tables 1 and 2 it should be noted that the z scores associated with the orthogonalized results Table 2 are at least for this example never larger in magnitude for the orthogonalized result with the corresponding non orthogonalized original result Table 1 . In two cases they are the same one is the three way interaction BLP where the subsets and are identical in the two contingency lattices and the other is the interaction between Baycol and Lopid where the subsets and differ in size and content by about 1 . Conversely there are cases where the differences between these results are quite pronounced most prominently in the case of Lopid Case L or vs. orthogonalized Case L or where the z score declines from 403 to 43. While the orthogonalized result remains significant it is substantially less so reflecting the fact that the orthogonalized Lopid subset is substantially smaller than the non orthogonalized one 306 records vs. 2982 records . Finally two other cases where the orthogonalization makes an important difference are those of Plavix alone and Plavix with Lopid both original results are significant at the Bonferroni corrected 5 while the orthogonalized results are not. These last three differences for Lopid Plavix and their combination are a direct consequence of the Baycol bystander effect. Specifically the subsets and for these cases in the original contingency lattice all contain a significant fraction of records that also list the drug Baycol while the corresponding subsets and in the orthogonalized lattice do not. For example 2 982 of the 11 773 rhabdomyolysis records list the drug Lopid while all but 318 of these 89 also list Baycol.

Table 3 ranks both the original contingency lattice subsets and the corresponding orthogonalized subsets by z score. In both cases the Baycol Lopid set ranks first with a huge z score of approximately 859 consistent with the strong association between this drug pair and rhabdomyolysis that was cited in the FDA s announcement of the Baycol withdrawal. Baycol alone ranks second in both cases but the z score for the orthogonalized result is substantially smaller than that for the original result 293 vs. 498 reflecting the large number of records listing Baycol that also list Lopid. The third ranked subset differs substantially between the orthogonalized and original lattice results for the original results Lopid by itself ranked third while in the orthogonalized results this subset drops to fifth and the combination BP is ranked third. This result suggests a possible Baycol Plavix rhabdomyolysis association stronger than any direct Lopid rhabdomyolysis association.

Overall the rankings based on the orthogonalized contingency lattice summarized in Table 3 suggest the following interpretation 

The orthogonalized lattice analysis approach described here can provide an extremely useful method for dealing with two important problems in pharmacovigilance the treatment of multi way interactions e.g. drug drug drug drug drug reaction drug drug gender age etc. and the treatment of bystander effects. A basic description of an example approach of an embodiment of the invention illustrates a well known case that of Baycol where significant association with rhabdomyolysis particularly when co prescribed with Lopid led to its withdrawal from the market. The technique is fairly simple and very broadly applicable so it would applicable to a number of other examples and problem types including 

It should be noted that the methods described here may have a significant advantage in computational efficiency over other methods for examining the statistical significance of N way interactions. In particular this method generates and examines fixed sized samples and does not require examination of every record in the entire data set for each of the 2combinations of factors.

It should be noted that the specific examples discussed herein with respect to medical data discloses interactions caused by one or more drugs. However it should be understood that interactions caused by one or more of drugs medications vaccines or medical devices could be analyzed equally well using the techniques disclosed herein.

These subsections describe the S plus procedures used to generate the results presented in the specific embodiments disclosed herein. The code disclosed herein is exemplary only and one skilled in the art would recognize various alternatives and modifications all of which are considered a part of the present invention. Specifically Sec. 6.1 below describes the two simple ISR retrieval utilities used to construct the record index sequences on which all results are based. Routines to construct the basic three way contingency lattice under the reference condition and the random comparison lattices are described in Sec. 6.2 and the corresponding routines used to generate the orthogonalized lattice results are described in Sec. 6.3.

Both the basic contingency lattices and the orthogonalized contingency lattices considered here are constructed from sequences of record indices that define both the reference condition and the conditions of interest on which these lattices are based. In the examples considered here the reference condition corresponds to a collection of AERS Individual Safety Reports ISR s listing the adverse event rhabdomyolysis which is a MedDRA Preferred Term PT . The S plus procedure isrreacs constructs this ISR sequence from the adverse event assumed to be a MedDRA PT in the AERS REAC dataset . The code for this routine is 

The conditions of interest in the example considered here all correspond to the presence of drugs in the AERS ISR S and the sequences are generated analogously to the reference ISR sequences just described. Specifically the ISR sequence for a condition of interest defined by a drug specified by bestdrug name from the corresponding field of the AERS drug file DRUG is constructed by procedure isrdrugs. The code for this procedure is listed in Table 4.

The procedure used to construct the basic three way contingency lattice discussed in this note is lattice3cgen listed in Table 5. This routine is called with the index sequence isr0 for the reference condition and the index sequences isr1 isr2 and isr3 for the three conditions of interest used in constructing the lattice. The result is a vector of length 8 whose first element contains the size Nof the reference dataset and whose second through eighth elements contain the sizes Nof the corresponding lattice subsets for j 1 element through j 7 element .

The M random comparison lattices used to assess the significance of the contingency lattice characterized in procedure lattice3cgen are generated and characterized by procedure lattice3cran. This procedure is listed in Table 6

The procedures used in the orthogonalized contingency lattice analysis are orthogset3gen and orthog3cran analogous to the basic contingency lattice procedures lattice3cgen and lattice3cran respectively. Routine orthogset3gen is listed in Table 7 and its calling parameters and the format of its results are exactly the same as those for procedure lattice3cgen described in Sec. 6.2. Similarly routine orthog3cran is listed in Table 8 and its calling parameters and the format of its results are exactly the same as those for procedure lattice3cran.

The orthogonalized lattice approach described herein may eliminate first order and intermediate bystander effects along with some weak second order bystander effects. However orthogonalized lattice analysis may still be susceptible to strong second order bystander effects. The following paragraphs describe a two way interaction analysis that may separate pure interactions from second order bystander effects for the case of two drugs.

For example consider two drugs Drug A and Drug B and assume that the question of interest is whether either or both are significantly associated with Adverse Reaction X. The essential idea behind the displays considered here is that they compare the numbers of times Adverse Reaction X is observed under the following four conditions 1 among records listing both Drug A and Drug B 2 among records listing Drug A without Drug B 3 among records listing Drug B without Drug A 4 among records listing neither Drug A nor Drug B.

In the following description let N denote the size of the first subset listed above i.e. the total number of records in the available database listing both drugs. The interaction analysis considered here begins by computing N the number of times that Reaction X appears in this first record subset and the objective of the analysis is to provide reference numbers to answer the following questions 

Each of these questions defines a collection of random reference sets that may be used to provide answers. Specifically M random samples each of size N are drawn from the reference population defined by each of these questions i.e. Drug A alone Drug B alone and neither drug and the number of records in each random sample that also lists Reaction X is recorded. Side by side boxplot displays provide a useful visualization of these results.

As a specific example presents the boxplot results obtained for the drugs Baycol and Lopid with the adverse event rhabdomyolysis. The solid circle in represents the number Nof records listing rhabdomyolysis in the N 1728 records listing both Baycol and Lopid. The left most boxplot summarizes the range of results obtained for the drug Baycol alone giving the number of records in 100 random samples each of size N 1728 that list the adverse event rhabdomyolysis and the drug Baycol but not the drug Lopid. The central boxplot summarizes the range of results obtained for the drug Lopid alone computed analogously and the right most boxplot summarizes the range of results obtained from 100 random samples drawn from those records that list neither drug. The fact that the solid circle lies so far above the range of variation of any of the three reference boxplots provides strong evidence of an interaction between the two drugs the adverse reaction rhabdomyolysis is much more likely in patients taking both drugs than in patients taking either drug alone. In fact this interaction was cited explicitly in the FDA s withdrawal notice for the drug Baycol.

The augmented lattice display approach may be used to address strong second order bystander effects involving more than two medical products or conditions. An augmented lattice display combines the results obtained from the orthogonalized lattice described herein with the two way interaction analysis procedure described herein. This display includes the same individual points and reference boxplots as in the orthogonalized lattice augmenting the plot for any results that are declared significant but which may represent second order bystander effects. If Drug A exhibits a strong association with the adverse event under consideration records listing Drug A along with other drugs should have a significant probability of listing the adverse event even in the absence of any effect from the other drugs as seen in the example of Infliximab and Methotrexate shown in . Thus the augmented lattice display includes an estimate of the range of values expected for the drug combination in the absence of any interaction effects. If the observed result falls significantly above this range this observation provides evidence for a positive e.g. harmful interaction involving Drug A while if the observed result falls significantly below this range this observation provides evidence for a negative e.g. beneficial interaction involving Drug A. Results falling within this range suggest that drug interaction effects are not significant.

The point in the orthogonalized lattice plot corresponds to N the number of times a specified drug combination appears among those records listing Adverse Reaction X. An equivalent interpretation of N however is as the number of times Reaction X appears in the set of N records listing the specified drug combination. This alternative view provides the basis for the augmented reference values considered here which are the numbers of times Reaction X appears in M random samples each of size N drawn from records listing Drug A alone without the other drugs included in the combination. The basic idea is that if these other drugs have no interaction effects the observed value of Nshould fall within the range of these random samples.

The drug infliximab Remicade is indicated for treatment of arthritis and Crohn s disease. The first 25 of 365 adverse events for this drug that exceed the Bonferroni corrected 5 significance threshold ranked in descending order of Statistical Unexpectedness are listed in Table 7. The strongest association seen in this list is that with tuberculosis nos consistent with the black box warning issued in October of 2001 which included the following wording Tuberculosis frequently disseminated or extrapulmonary at clinical presentation invasive fungal infections and other opportunistic infections have been observed in patients receiving Remicade. Some of these infections have been fatal. Altogether the 12 distinct tuberculosis designations listed in Table 7 fall above the Bonferroni corrected 5 Statistical Unexpectedness limit and are combined here into the overall tuberculosis adverse reaction used in subsequent discussions. Further examination of the AERS ISR s associated with both the drug infliximab and the tuberculosis reactions listed in Table 7 shows that infliximab is frequently co prescribed with the corticosteroids prednisone or prednisolone with methotrexate or with leflunomide. These observations motivate the interaction analysis described here which attempts to determine which of these drugs or drug combinations are strongly associated with tuberculosis.

In this case N 898 patients exhibit one or more of the 12 forms of tuberculosis listed in Table 8 and the subsets defining the contingency lattice correspond to subsets of these patients who are taking each of the fifteen possible combinations of one or more of these drugs numbered as defined in Table 9.

The question of what constitutes significantly above or significantly below is decided as follows. First the z score for each point relative to its associated boxplot is defined as 

Based on this observation x is declared unusually large if z 1 square root over p where p is a standard probability threshold and unusually small if z

One more refinement is needed however to account for the fact that does not represent a single comparison but rather M 15 comparisons. For statistically independent comparisons we would expect that M comparisons each having a probability p of making an error individually would have a probability on the order of Mp of making at least one error. To overcome this problem the Bonferroni correction is adopted which simply divides the probability threshold value p by the number of comparisons M so that the overall probability of making at least one error is again p. This correction has the effect of increasing the z score magnitude threshold from 1 square root over p to

In points for which z exceeds this threshold are marked as solid circles while points that do not exceed this threshold are marked as open circles. Interpreting these solid circles as evidence for significant associations with tuberculosis leads to the conclusion that the nine drugs or drug combinations labeled in exhibit significant associations.

The points represent the number of times Neach drug or drug combination appears uniquely in records listing the adverse event tuberculosis. The five solid circles represent results that are declared significant by the orthogonalized lattice analysis based on their distance from the corresponding reference boxplots appearing across the bottom of the figure. For each of the four significant multiple drug combinations involving infliximab Cases 5 6 11 and 12 the associated range of 200 random reference values for Nis shown as a dashed vertical line between the minimum represented by an open triangle and the maximum represented by an inverted open triangle. These reference values were computed as described above each drug combination defines a set of size N consisting of all records listing the indicated drugs but not listing the excluded drugs. Then 200 random samples of this size are drawn from the larger set of records listing only the drug infliximab and none of the other three and the number of these records listing tuberculosis is determined. The reference ranges shown in the plot correspond to the ranges for these numbers.

In three of these cases combinations of infliximab with methotrexate only with both steroids and methotrexate and with both steroids and leflunomide the original Nvalue falls within this range of 200 random reference values. Thus these three combinations represent second order bystander effects since the range of Nvalues expected on the basis of the infliximab tuberculosis association alone covers the observed Nvalue. In the one remaining case Case 5 the combination of infliximab with steroids the observed Nvalue falls slightly below the range of the random reference values suggesting the possibility of a weak protective interaction between steroids and infliximab. Thus the only strong positive association with tuberculosis is that with infliximab alone as shown in .

An extension of the two way interaction analysis method described earlier may be used. The purpose of this extension is to provide a computationally based tool that permit the assessment of the extent to which the association results obtained by methods described in the literature depend on demographic variables like age or gender that may be included in the data source on which the analysis is based. Given a specified drug and adverse event this analysis method is based on four data subsets analogous to those used in the two way analysis namely 1 records listing both the drug and the adverse event 2 records listing the drug but not the adverse event 3 records listing the adverse event but not the drug 4 records listing neither the drug nor the adverse event.

These records are characterized in one of two ways. For continuous demographic variables like age or weight each collection of records is characterized by the average of the available values for this demographic variable. In the illustrative embodiment described here no imputation of missing values for this variable is performed although doing so will be apparent to one skilled in the art upon review of this disclosure and could be accomplished by any one of several different methods that have been described in the literature. See for example R. J. A. Little and D. B. Rubin 2nd ed. Wiley 2002 and R. K. Pearson SIAM Philadelphia 2005. For categorical demographic variables like gender or race these collections of records are characterized by the fraction of records for which the variable assumes a specified value e.g. fraction of records listing male gender .

Given the four classes of records listed above and a numerical characterization like those just described for each record class the analysis method proposed here proceeds as follows. First the collection of records listing both the drug and the adverse event has a fixed size N and the quantitative characterization just described yields a single number when applied to these N records. Next a collection of M random samples each of N records is drawn from the collection of records from each of the other three classes all records listing the drug but not the adverse event all records listing the adverse event but not the drug and all records listing neither the drug nor the adverse event. The quantitative characterization described above is then applied to each of these M random samples yielding a collection of M numerical values for each of these three reference populations. A graphical display is then constructed to compare the original result with the M results from each reference population exactly analogous to the two way interaction analysis plots described earlier.

The results shown in demonstrate first that the average reported age for records listing both the drug and the adverse event are substantially lower than those for random samples from any of the three reference populations. This observation suggests that age may be an important factor in the association between this drug and adverse event. In particular while it appears from that the average reported ages for both records listing the drug alone and those listing the adverse event alone are significantly lower than average for the AERS database overall specifically note that the dashed line lies above the average age range for both of these populations the average reported age for records listing both the drug and the adverse event lies well below the range of variation seen for either of these reference populations.

As a second illustrative example the boxplot of shows the analogous results obtained using the fraction of records listing gender as female for the combination of the drug Accutane with the adverse event mood swings. Here the solid circle represents the fraction of the N records listing the drug Accutane and the adverse event mood swings that also list female gender. The three boxplots in give this characterization for the three reference populations analogous to those considered in the previous example M 100 randomly drawn samples each of size N from records listing the drug Accutane without the adverse event from those listing mood swings without the drug and from those listing neither the drug nor the adverse event. Here the fact that the solid circles lies above the range of all three boxplots means that the combination of the drug and the adverse event is significantly more likely to appear in a record listing female gender than is typical for any of the three reference populations. This observation suggests that gender may play a role in this drug event association.

One skilled in the art would recognize that the foregoing describes a typical computer system connected to an electronic network. It should be appreciated that many other similar configurations are within the abilities of one skilled in the art and it is contemplated that all of these configurations could be used with the methods and systems of the present invention. Furthermore it should be appreciated that it is within the abilities of one skilled in the art to program and configure a networked computer system to implement the method steps of the present invention discussed earlier herein. For example such a computing system could be used to implement the method of evaluating interaction of two or more medical products or conditions using contingency lattices.

The present invention also contemplates providing computer readable data storage means with program code recorded thereon i.e. software for implementing the method steps described earlier herein. Programming the method steps discussed herein using custom and packaged software is within the abilities of those skilled in the art in view of the teachings and code fragments disclosed herein.

Other embodiments of the invention will be apparent to those skilled in the art from a consideration of the specification and the practice of the invention disclosed herein. It is intended that the specification be considered as exemplary only with such other embodiments also being considered as a part of the invention in light of the specification and the features of the invention disclosed herein.

