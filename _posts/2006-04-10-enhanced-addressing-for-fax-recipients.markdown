---

title: Enhanced addressing for fax recipients
abstract: A rich, robust fax addressing experience is provided for users. In some embodiments, multiple different ways of addressing a fax and related functionality are exposed to a user and work seamlessly together to give a compelling addressing experience. In some embodiments, a fax application can resolve recipient names and/or numbers. Additionally, a user can type in a fax number and have that number resolved as a valid number. Further, some embodiments can provide a user interface that is designed to help a user compose a fax number, thus ensuring that the number is in the proper format. In some embodiments, the fax application can allow the user to choose from among a number of different address books and then employ the chosen address book in the fax addressing experience.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08077855&OS=08077855&RS=08077855
owner: Microsoft Corporation
number: 08077855
owner_city: Redmond
owner_country: US
publication_date: 20060410
---
In today s world people are required to collect and manage information about a large number of personal and work related contacts. Users can typically store their contact information in address books diaries contact managers and the like. When a user wishes to communicate with one of their contacts they may need to consult this stored information. For example if a user wishes to fax one of their contacts a document of some type the user may need to consult the contact information to ascertain the contact s fax number.

If the user intends to manually fax the document they will typically physically enter the fax number into a fax machine via some type of hard user interface. If the user is using a desktop faxing application or an Internet faxing solution the user will typically have to convey this information to the faxing entity in some way. In these non manual alternatives the addressing experience exposed to the user is often non standard and disparate as between the different alternatives. Moreover the addressing experience is a very light non robust experience. For example the user may simply be required to enter the fax number and this may be the only option for the user to address a fax.

The described embodiments can provide a rich robust fax addressing experience for users who utilize personal computer based faxing. In accordance with the described embodiments multiple different ways of addressing a fax and related functionality are exposed to a user. In at least some embodiments a fax application can resolve recipient names and or numbers. For example when a user types in a recipient name such name can be resolved against one or more address books that can be selected by the user. Additionally a user can type in a fax number and have that number resolved as a valid number. Further at least some embodiments can provide a user interface that is designed to help a user compose a fax number thus ensuring that the number is in the proper format. In at least other embodiments the fax application can allow the user to choose from among a number of different address books and then employ the chosen address book in the fax addressing experience.

The described embodiments can provide a rich robust fax addressing experience for users who utilize personal computer based faxing. In accordance with the described embodiments multiple different ways of addressing a fax and related functionality are exposed to a user. In at least some embodiments a fax application can resolve recipient names and or numbers. For example when a user types in a recipient name such name can be resolved against one or more address books that can be selected by the user. Additionally a user can type in a fax number and have that number resolved as a valid number. Further at least some embodiments can provide a user interface that is designed to help a user compose a fax number thus ensuring that the number is in the proper format. In at least other embodiments the fax application can allow the user to choose from among a number of different address books and then employ the chosen address book in the fax addressing experience.

In at least some embodiments all of this particular functionality is provided together to give the user a rich and robust fax addressing experience.

Here system includes a computing device in the form of a client computing device . In this example the client computing device comprises one or more processors and one or more computer readable media on which executable computer readable instructions reside. In this example computer readable media includes code that implements a fax application . In this particular example computing device also includes or otherwise uses a fax modem which together with fax application can enable a user to send and receive faxes. In addition fax application includes functionality for enhancing the user s fax addressing experience as described in more detail below.

It is to be appreciated and understood that while the computing device is illustrated as a desktop device such device can take other forms such as a laptop or notebook computer handheld computer or any other type of computing device that can be used in connection with a fax application.

Here system includes a computing device in the form of a client computing device . In this example the client computing device comprises bone or more processors and one or more computer readable media on which executable computer readable instructions reside. In this example computer readable media includes code that implements a fax application . In this particular example fax application is configured to utilize a network accessible fax service provider such as Internet fax service provider . One example of a network accessible fax service provider is Windows Fax Server. Typically to use such a provider a user will upload their document to the provider which will thereafter fax the document to one or more intended recipients. Faxes are typically although not always received from such providers in the form of an email attachment.

It is to be appreciated and understood that while the computing device is illustrated as a desktop device such device can take other forms such as a laptop or notebook computer handheld computer or any other type of computing device that can be used in connection with a fax application.

In at least some embodiments the fax application includes all of the above identified components which collectively provide a very robust and rich is addressing experience for the user. Further in at least some embodiments the fax application is intended to work with MAPI compliant address book providers. MAPI or Messaging API is a publicly available well documented API and includes programming interfaces that are used by MAPI subsystems by client application writers and by service provider writers. The main programming interface is an object based interface known as the MAPI programming interface. Based on the OLE Component Object Model the MAPI programming interface is used by the MAPI subsystem and by messaging based client applications and service providers written in C or C .

It is to be appreciated and understood that the inventive concepts can be employed in contexts other than MAPI contexts without departing from the spirit and scope of the claimed subject matter.

In the discussion below intended fax recipients can assume a couple of different forms or types a composed number or an address book contact.

These can be composed using the number composition helper user interface or just by typing the recipient in the address line manually. The Nazme part of the format is optional. The Number part of the format can be a simple sequence of digits e.g. 4257022290 or a canonical number e.g. 1 425 7022290 .

Alternately or additionally a fax recipient can take the form of a contact in an address book. Here a contact s name can be typed in and resolved against an address book on the click of a button or recipients can be picked by invoking the address book s user interface as described in more detail below. This particular way of representing recipients provides for easy addition editing and deletion of fax recipients. Further it allows for several other features such as viewing a contact s properties adding the contact to an address book auto complete and the like at the click of a button as will become apparent below.

The number composition helper user interface or simply composition interface is configured to enable a user to input or otherwise build addressing information in a manner that is standardized and designed to eliminate or at least reduce the chances that an erroneous format is entered. In at least some embodiments the composition interface includes controls for entering a recipient s name and various fax number details. In at least some embodiments one or more drop down menu items can be provided to help the user construct the addressing information for their fax. Once the composition interface has been used to construct the addressing information it can be added to the appropriate To field and other fields in the fax to be sent. One specific example of a composition interface is provided below in the section entitled Implementation Example .

The resolver component can be configured to resolve information that is entered by the user in a couple of different ways.

For example if a user enters in the address line the name of a particular recipient then the resolver component can resolve this name against one or more address books that are available to the user. For example the user may have two different address books a Windows address book and an Outlook address book. If the user has selected the Outlook address book then the resolver component can resolve the entered name against the Outlook address book. Accordingly when the fax is sent the fax application will retrieve the fax number of the intended recipient from the selected address book.

Alternately or additionally the user may instead choose to enter in an appropriate user interface field a fax number instead of a recipient s name. In this case the resolver component can resolve the entered fax number and show the number as a valid number. In this case the entered number can be resolved against a format to ensure that the format of the number is valid. Examples of how this can be done are given below in the section entitled Implementation Example .

In MAPI contexts in which the recipient is not represented as a composed number this can be implemented by programmatically calling the appropriate Resolve method of the selected address book provider given the display name of the contact. When the recipient is represented as a composed number if the number is valid a one off entry is created in the address book and a dummy entry identifier is obtained and shown as a resolved address.

In accordance with one embodiment and as alluded to above a user can be provided with an opportunity to select from amongst a number of different address books that they may have available. That is a user may have several different address books. At the beginning of the faxing session a user interface can be presented to the user through which the user can search for and or select the particular address book that is to serve as the basis for the addressing that takes place during that session.

In contexts that include MAPI compliant contexts fax format addresses can be encoded to prevent them from being construed as address book contacts and to prevent MIME from treating them as email addresses. For example while saving a partially composed fax message as a draft certain embodiments utilize the EML format which is a well document and known format. Systems that utilize EML are tailored for email and try to parse the fax format e.g. Name as an email address even though it is in fact a fax address. To prevent this situation the fax address is encoded by pre pending a fax specific GUID to it. Additionally if there is a contact with a display name such as John in the address book the GUID will prevent it from being resolved against the address book.

The discussion below describes an implementation example. Such example is not intended to limitation application of the claimed subject matter to this particular example. Rather this example is provided to assist the reader in understanding how one might implement the above described functionality. In the discussion that follows two main sections are provided Addressing Faxes and Validation of Addresses and Address Resolution each of which will have several subsections. In the discussion that follows the implementation example is described in the context of the Windows Fax and Scan solution.

The first way to address a fax is simply by the number. That is the simplest way of addressing a fax is to type a number in the To line of the Fax Compose Form. Numbers are separated by semi colons and a valid fax number consists of the digits 0 9 and modem control characters. Multiple numbers are entered on the To line and separated by semi colons. Additionally a user interface UI is provided to help the user compose a canonically valid fax number. This UI is launched from the To button by clicking on the down arrow which launches a menu that displays the Compose Fax Number UI. An exemplary To button and associated Compose Fax Number UI are shown in at .

Faxes can also be addressed using the Windows Address Book or MAPI Address Book GAL . In implementations that do not utilize or provide the user with an option to select from multiple different address books default address books can be utilized. For example when Outlook is installed on the client computer the MAPI address book is the default address book for WFS. When Outlook is not installed the Windows Address Book WAB is the default address book. Of course just because a default address book is used does not mean that a user cannot opt to select another address book. In this case the default address book would be the starting address book and the user would be free to select a different address book.

In the Windows Address Book scenario fax number information can be added and the Windows Address book can store 2 fax numbers per contact in the following fields Business fax number and Home fax number. To update a contact with his fax number the user launches the Address Book and opens the contact as shown in at . The Business Fax number can be added in the Business Tab under the field Fax . There is no validation of the fax number format. The user has to make sure that the Fax number entered is valid. The Personal Fax number can be added in the Home Tab under the field Fax . There is no in built validation of this field.

The Business Fax number is considered the default fax number of the contact. The Summary tab also displays the Business Fax number of the contact if entered.

In the MAPI Address Book context fax number information can be added to existing contacts as follows. For a contact in the GAL the relevant field is the Fax field in the Phone Notes tab of Contact Properties. Note that only the administrator can edit these settings. An associated user interface is shown in at .

For a contact in Personal Contacts the relevant fields are Business Fax Home Fax and Other Fax as shown in at . The Business Fax is considered the default followed by the Home and then the Other Fax number. A non administrative user can edit these settings because these are personal contacts stored in Outlook.

In the Windows Address Book context to create a new contact the File New Contact on the Address Book Main Menu or its associated Toolbar Icon is clicked. It launches the Contact Details page. A name for the contact is filled in the Name Tab. All the other fields are optional. To enter a fax number the user navigates to the Business Tab and types the number in the Fax field. To add a Personal fax number the user navigates to the Home tab and adds the fax number.

In the MAPI Address Book context a new contact cannot be created in the GAL by a non administrative user. Users can create personal contacts by navigating to the Contacts pane in Outlook. The Phone numbers section in the General tab of personal contacts allows the user to enter Business Fax Home Fax and Other Fax.

In the MAPI Address Book context right clicking on a contact can provide easy task to Send Fax . A fax can be sent from the Fax Compose Form or from the Address Book.

From the Fax Compose Form in the Windows Address Book context such can be done by clicking on the icons for To on the Fax Compose Form to bring up the Select Recipients Dialog of the Windows Address book when Outlook is not installed as shown in at . Here the name of the contact and his Business Fax Number are listed as the default items in the view. The user can click on To button to populate the To recipients of the Fax Message. Clicking on OK transfers the selected recipients to the Fax Compose Window and clicking on Cancel closes the Dialog without any changes.

If the chosen contact on the To line does not have a fax number associated with it either in the Business Fax or the Personal Fax field the contact is not added to the list and is displayed in a visually distinctive manner such as by being shown in red. In the case the fax is not sent until the user either removes the erroneous contact from the To line or provides a valid fax number for the contact. The Fax is always sent to the primary fax number which is the Business Fax number. If the Business fax number does not exist the fax is sent to the Personal fax number. If that too is blank the user is warned with an error message and is not allowed choose the contact in the To list box.

If both the Business Fax and Personal Fax field have valid telephone numbers listed in them the Fax is always sent only to the Primary Fax number which is the Business Fax number. If the user wants to send a Fax to the Personal Fax number he has to type the number in the To field in the Compose Form or the Address Book should provide a task to send the fax to the alternate Fax number.

From the Fax Compose Form in the MAPI Address Book context such can be done by clicking on the icons for To on the Fax Compose Form which brings up the Select Recipients Dialog of the MAPI Address book when Outlook is installed as shown in at . There the name of the contact and the Fax number are listed. The user can double click the contact or choose and click on the To button to transfer a contact to the To line in the dialog shown in .

Addition of contacts to the To line is allowed but validation is done on OK if the chosen contact has a valid fax number Fax number in the case of a GAL contact or one of the three numbers Business Fax Home Fax or Other Fax in case of a Personal Contact. If the numbers are blank then the contact is shown in a visually distinctive manner as described above.

In the Windows Address Book context the Address book should have tasks that facilitate the sending of Faxes to Contacts. The Actions Icon on the Main Toolbar of the Address Book and the Tools Action Menu item should have a task for sending a Fax such as that shown in at . Clicking on Send Fax should launch the Fax Compose form with the contact on the To line. Similarly right clicking context menu of a contact in the Address Book should also launch a similar menu.

In the MAPI Address Book context the MAPI address book should have simple tasks that facilitate sending of Faxes to Contacts. For example in the File Send a fax the file menu should have an action to send a fax the toolbar icon can have a corresponding icon for sending a fax and in the Personal contacts folder right clicking the context menu on a contact should allow a simple task to send a fax.

In the Windows Address Book context Groups can have a fax number that is entered in the Group Details page as indicated in at . In the MAPI Address Book context Groups cannot have fax numbers.

In the Windows Address Book context when a group is chosen from the Windows Address Book the group is added to the To line of the Compose Form. The contacts corresponding to the group are not expanded. Groups are always shown in bold. If all the recipients of the group have fax numbers the group is shown in bold black and underlined. If some of the recipients in the group do not have fax numbers the group is shown in bold red and underlined. When the user clicks on Send all the members who do not have fax numbers are discarded and the fax is sent to the rest after displaying a warning message to the user. Note that it is not possible for the user to manually or selectively remove recipients from an added group as a group is never expanded to display its constituent members.

In the MAPI Address Book context when a group is chosen from the MAPI Address Book the group is added to the To line of the Compose Form. The contacts corresponding to the group are not expanded. Groups are always shown in bold. If all the recipients of the group have fax numbers the group is in bold black and underlined. If some of the recipients in the group do not have fax numbers the group is shown in bold red and underlined. When the user clicks on Send all the members who do not have fax numbers are discarded and the fax is sent to the rest after displaying a warning message to the user. Note that it is not possible for the user to manually or selectively remove recipients from an added group as a group is never expanded to display its constituent members.

Numbers can be entered on the To line or the Compose Fax Number UI can be invoked to add a Fax Number to the To line. TAPI Telephone API provided by Microsoft uses a Canonical Number Format. The canonical format is intended to be a universally constant directory number. For this reason numbers in address books are best stored using canonical format. A canonical phone number is a text string with the following structure.

A valid number can be entered on the To line by simply typing it in. All these are valid numbers on the To line 

Note that all these numbers can have modem control characters as well. When the user clicks on Check Recipients or CTRL K the resolution of these numbers happens. When a number is resolved it is underlined enclosed by angle brackets and marked as a resolved recipient. An example of a resolved number list on the To line is as follows 

Another important point to note is that there is no matching of numbers entered on the To line to the contacts in the address book. This means that any string of digits that is entered on the To line is automatically treated as a number and there is no effort to match the number against a contact in the Address Book. This leads to the following scenarios 

Note that all the numbers are marked as resolved as soon as the UI is closed and the number is transferred to the To line.

For anything other than a contact double clicking a resolved address always launches the Compose Fax Number . Take the following example 

If the user makes any changes to the data in the Compose Fax Number UI before clicking on OK the changes are transferred to the To line. For example if the user adds a name for the first resolved string and clicks on OK the new Addressing looks like this 

Note that only a best effort matching is made for the entered number to Country Code Area Code and Fax Number fields in the Compose Fax Number UI. If the user enters an invalid country code for example 456 the entire number is taken and placed it in the Fax Number field for the user to fix and submit it back to the To line. The name is stripped and added in the Name field.

Any contacts added on the To line without invoking the Address Book are automatically treated as resolved. At the point of resolution they are not validated for Fax numbers for the contact. The validation whether the contact has a Business or Personal fax number is done only on Send and an appropriate error message displayed for missing Fax numbers.

Contacts support auto complete on part name Display Name of the contact . Resolution of a number to contact name is not supported. What this means is that if a user enters a number and the number matches to an entry in the Contact list the number is not replaced by the Contact Name. The reason for this is 

Clicking on a number always launches the Compose Fax Number UI and clicking on a contact launches the contact display pane WAB or GAL as appropriate .

For example if the user enters 2 contacts here is how they look on the To line. Contacts are auto resolved on addition to the To line.

A better way of displaying is the name followed by the associated number such as indicated just below 

Note that the number displayed here is the Default fax number for that contact. If there are multiple fax numbers for a given contact a right click context menu on a resolved contact should drop down a list of Fax numbers which the user can choose. The resolved string gets updated on the selection. For example if the user chooses a different number for Ananda Sarkar in the above scenario the To line looks like 

It should be noted here that there should be a differentiation between Contacts and added numbers. When the user double clicks a contact the Contact Details pane from the default Address book WAB GAL should always be opened and not the Compose Fax Number UI.

If the list of recipients on the To line cannot be prefixed by a contact icon there is no way of identifying which recipient was chosen from the Address Book and which was added as a number on the To line. A number enclosed by angle brackets can always be treated as a number entered inline or via the Number helper. resolved string like IDC Fax Team can always be treated as a contact entered via the Address Book.

The described embodiments can provide a rich robust fax addressing experience for users who utilize faxing functionality such as that provided by desktop fax solutions and Internet fax service providers. In accordance with the described embodiments multiple different ways of addressing a fax and related functionality are exposed to a user and work seamlessly together to give a compelling addressing experience to the user. In at least some embodiments a fax application can resolve recipient names and or numbers. For example when a user types in a recipient name such name can be resolved against one or more address books that can be selected by the user. Additionally a user can type in a fax number and have that number resolved as a valid number. Further at least some embodiments can provide a user interface that is designed to help a user compose a fax number thus ensuring that the number is in the proper format. In at least other embodiments the fax application can allow the user to choose from among a number of different address books and then employ the chosen address book in the fax addressing experience.

Although the invention has been described in language specific to structural features and or methodological steps it is to be understood that the invention defined in the appended claims is not necessarily limited to the specific features or steps described. Rather the specific features and steps are disclosed as preferred forms of implementing the claimed invention.

