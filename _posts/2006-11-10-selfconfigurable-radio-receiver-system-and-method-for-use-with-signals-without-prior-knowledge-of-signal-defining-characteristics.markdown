---

title: Self-configurable radio receiver system and method for use with signals without prior knowledge of signal defining characteristics
abstract: A method, radio receiver, and system to autonomously receive and decode a plurality of signals having a variety of signal types without a priori knowledge of the defining characteristics of the signals is disclosed. The radio receiver is capable of receiving a signal of an unknown signal type and, by estimating one or more defining characteristics of the signal, determine the type of signal. The estimated defining characteristic(s) is/are utilized to enable the receiver to determine other defining characteristics. This in turn, enables the receiver, through multiple iterations, to make a maximum-likelihood (ML) estimate for each of the defining characteristics. After the type of signal is determined by its defining characteristics, the receiver selects an appropriate decoder from a plurality of decoders to decode the signal.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08358723&OS=08358723&RS=08358723
owner: The United States of America as Represented by the Administrator of the National Aeronautics and Space Administration
number: 08358723
owner_city: Washington
owner_country: US
publication_date: 20061110
---
The present application derives priority from U.S. Provisional Application No. 60 736 880 filed 12 Nov. 2005.

The invention described hereunder was made in the performance of work under a NASA contract and is subject to the provisions of Public Law 96 517 35 U.S.C. 202 in which the Contractor has elected not to retain title.

The invention relates to radio receivers and more particularly to an autonomous radio receiver capable of receiving a signal without a priori knowledge about the defining characteristics of the signal recognizing these characteristics directly from the received signal and appropriately decoding the signal based on the signal type.

Conventional radio receivers typically have complete prior knowledge of the defining characteristics of signals they are designed to receive. Because conventional radio receivers know what type of signal they are going to receive they are typically hardwired or manually configured to do so. Conversely conventional radio receivers are incapable of receiving signal types different from that which they were intended for. In some cases where they do have such capability conventional radio receivers require specific pre configuration according to a pre determined schedule. Thus conventional radio receivers are capable of only receiving pre determined pre programmed types of signals. For example cellular telephones are designed according to several different standards and single mode telephones are typically preconfigured to receive only one type of cellular telephony signal. Indeed a single mode telephone configured to use Code Division Multiple Access a popular system in the United States is unable to receive a signal using Global Systems Mobile GSM signals which is the European standard. While there are dual mode telephones to solve the CDMA GSM dichotomy there remains the issue and potential future issue of varying frequency bands data rates modulation types modulation indices pulse shapes and so on which may affect the usability of cellular telephones. Therefore there is a need for a system capable of receiving multiple signal types without a priori knowledge about the defining characteristics of the signals and accurately recognizing defining features of the incoming signals and respond intelligently without explicit pre configuration or reprogramming to define the functions of the receiver. In other words there is a need for a system capable of recognizing multiple signal types and autonomously reconfiguring itself to decode the particular type of signal that is received.

It is therefore an object of the present invention to provide a system for autonomously receiving and decoding a plurality of signals having a variety of signal types without prior knowledge of the defining characteristics of the signals.

According to the present invention the above described and other objects are accomplished by providing a system inclusive of hardware and a suite of software modules to autonomously recognize various defining characteristics of a signal that are unknown prior to reception. Some of these defining characteristics include but are not limited to the angle of arrival data rate symbol timing carrier frequency and phase modulation index modulation type signal to noise ratio SNR code type and decoded message bits. The signal characteristics are recognized by estimating one or more characteristics of the signal and the estimated characteristic is utilized to enable the apparatus and system to determine other defining characteristics. Through multiple iterations of estimation and calculation the system is able to make a maximum likelihood ML or near ML estimate for each of the defining characteristics. The ML estimates assist in identifying the type of signal and the system selects an appropriate decoder from a plurality of decoders to eventually decode the signal.

The present invention is an autonomous radio receiver capable of receiving a signal without prior knowledge about the defining characteristics of the signal instead recognizing these characteristics directly from the received signal and appropriately decoding the signal based on the signal type.

The radio receiver also includes a frequency correction module FCM in communication with MIM . FCM may be any hardware and or software suitably configured to track the offset frequency of the incoming signal with unknown characteristics without knowledge a priori of the signal to noise ratio SNR data rate modulation type etc. Thus FCM receives the incoming signal and the estimated modulation index from MIM and outputs a signal having an estimated offset frequency based on the incoming signal and the estimated modulation index. FCM is in communication with a multiplier and outputs the signal having an estimated frequency offset to multiplier and multiplier mixes the original signal with the signal having the estimated frequency offset to produce a frequency corrected received signal.

Radio receiver also includes a joint estimator module JEM in communication with MIM and multiplier . JEM may be any hardware and or software suitably configured to receive the estimate of the modulation index and or the actual modulation index from MIM and to utilize the estimated modulation index and frequency corrected received signal to estimate and or determine defining characteristic s of the incoming signal. In the preferred embodiment JEM utilizes the estimated modulation index to estimate and or determine the data rate of the incoming signal the SNR of the incoming signal the waveform shape and pulse shape of the incoming signal and or symbol timing.

As discussed in greater detail below one or more of the estimates and or characteristics produced by JEM is transmitted back to MIM to refine the estimate of the modulation index and or help determine the modulation index. Furthermore one or more of the estimates and or characteristics produced by JEM is transmitted to a modulation classifier module MCM a carrier synchronization module CSM and or a fine symbol synchronizer FSS all in communication with JEM and with each other.

MCM may be any hardware and or software suitably configured to derive approximations of the maximum likelihood ML modulation classification based on one or more estimations and or characteristics received from multiplier i.e. MIM and FCM estimates JEM CSM and or FSS .

CSM may be any hardware and or software suitably configured to track the carrier phase independent of the modulation of the incoming signal. Furthermore CSM is such that it includes a structure that performs the carrier synchronization function for all orders of phase shift keying PSK modulation based on one or more estimations and or characteristics received from MIM multiplier i.e. MIM and FCM estimates JEM MCM and or FSS .

FSS may be any hardware and or software suitably configured to determine an estimate of the symbol timing of the incoming signal. FSS determines the estimate of the symbol timing of the incoming signal based on one or more estimates and or characteristics received from signal combiner i.e. MIM and FCM estimates JEM and or CSM .

In general operation radio receiver functions to receive an incoming signal and through estimations and one or more refining iterations determines the signal type and decodes the incoming signal utilizing an appropriate decoder. How MIM FCM JEM MCM CSM and FSS calculate the estimations and perform the iterations to determine the signal type is discussed in greater detail below. Notably the workings of MIM FCM JEM MCM CSM and FSS depend on whether radio receiver is performing coarse estimations fine estimations non coherent estimations or coherent estimations and on what information has been estimated and or determined by prior iterations.

Again MIM is configured to receive signals with unknown characteristics. Because radio receiver does not know exactly what type of signal it may receive MIM is configured to receive and estimate the modulation index for an array of signal types.

For example phase shift keying PSK is a method of digital communication in which the phase of a transmitted signal is varied to convey information. There are several methods that can be used to accomplish PSK. The simplest PSK technique is called binary phase shift keying BPSK . It uses two opposite signal phases 0 and 180 degrees . In the case of binary phase shift keying BPSK modulation a phase modulation index other than 90 degrees may be used. When this is done the fraction of power allocated to the discrete carrier becomes P Pcos with the remaining fractional power P Psin available for data detection. When using this signaling mode the power spectrum of the data modulation should be such that it does not interfere with the extraction of the discrete carrier by an appropriate carrier tracking loop such as a phase locked loop PLL . In other words the discrete carrier should be inserted at a point where the power spectrum of the data modulation is minimum and preferably equal to zero. In the case of digital data this rules out direct modulation of the carrier with a Non Return to Zero NRZ data stream whose spectrum is maximum at direct current DC which at radio frequencies would correspond to the carrier frequency. Thus for example the data may be first modulated onto a sub carrier whose frequency is selected significantly higher than the data rate so that the sidebands of the data modulation are sufficiently reduced by the time they reach the carrier frequency. More sophisticated forms of PSK exist. In multiple phase shift keying with or without phase compensation. In the most general scenario a taxonomy of cases for analysis is illustrated by the tree diagram of for the sampled version of the SSME . begins at the square node in the middle and proceeds outward to any of the eight leaf nodes representing combinations of circumflex over and . For SSME a few of the tree branches of namely and do not apply.

Other signals use a coherent communication mode where carrier synchronization is established directly from the data bearing signal e.g. using a conventional Costas loop . In this case none of the transmitted power is allocated to a discrete carrier and the system is said to operate in a suppressed carrier mode which in the case of BPSK corresponds to 90 . Although a Costas loop operates with a less efficient performance e.g. larger mean square phase tracking error than a PLL it offers the advantage of not requiring a discrete carrier to lock onto and thus all of the transmitted power can be used for the purpose of data detection.

Given that the foregoing or other transmission modes may be received by radio receiver it is important that MIM be able to estimate the modulation index or equivalently the ratio of transmitted carrier to data power of the various received signals. In one exemplary embodiment MIM utilizes an ML estimation approach to estimate the modulation index along with appropriate approximation of the nonlinearities that result to allow for practical implementations at course and fine modes.

With reference again to radio receiver is shown operating in a coarse mode according to one exemplary embodiment of the invention. When radio receiver receives an incoming signal which is represented as r t the signal is transmitted to MIM and signal combiner . MIM estimates an initial modulation index without a priori knowledge of the modulation data rate and or symbol timing of the incoming signal. The incoming signal with the initial estimate of the modulation index is then transmitted to other modules of radio receiver to estimate other defining characteristics.

If the signal with the initially estimated modulation index includes a residual carrier the signal is transmitted to FCM for frequency acquisition and tracking. If the signal with the initial estimated modulation index does not include a residual carrier the signal is also transmitted to FCM for frequency acquisition and tracking. Furthermore the signal with the initially estimated modulation index and corrected frequency is also transmitted to JEM CSM AND OR .

The signal with the initially estimated modulation index is transmitted to JEM so that the received signal can be used to estimate an initial data format via data format module an initial SNR via SNR module an initial data rate via data rate module and or an initial estimate of the symbol timing via CSS . Furthermore the signal with the initial estimated modulation index is transmitted to CSM so that the received signal can be used to initially track the carrier phase of the incoming signal. Moreover CSM also receives and uses the initial estimates of the data format from data format module the SNR from SNR module the data rate from data rate module and or the estimate of the symbol timing from CSS and or receives the original signal combined with the output of FCM from multiplier in initially tracking the carrier phase of the incoming signal.

FSS receives and uses the initial estimates of the data format from data format module the SNR from SNR module and or the data rate from data rate module and or receives the original signal combined with the output of FCM from multiplier to initially estimate the symbol timing of the incoming signal. Likewise MCM receives and uses the initial estimates of the data format from data format module the SNR from SNR module the data rate from data rate module and or the estimate of the symbol timing from CSS and or receives the original signal combined with the output of FCM multiplier to initially estimate the modulation classification of the incoming signal. In one exemplary embodiment the initial estimate of the carrier phase tracking the initial estimate of the symbol timing the initial estimate of the modulation classification the initial estimate of the data format and or the initial estimate of the data rate are used to refine and or determine the type of the incoming signal in a fine mode of operation of radio receiver .

For reference purposes is a block diagram of the detailed operations of radio receiver . The MIM estimates and or determines the action of total power that is allocated to a non modulated carrier signal and to a data modulated signal and outputs an estimated modulation index including such estimate. FCM receives the incoming signal and the estimated modulation index from MIM and outputs a signal having an estimated corrected frequency based on the incoming signal and the estimated modulation index. FCM outputs the signal having an estimated corrected frequency to multiplier which mixes the original signal with the signal having the estimated frequency correction to produce a frequency corrected received signal. JEM receives the modulation index estimate and frequency corrected received signal to estimate various defining characteristic s of the incoming signal including data rate of the incoming signal SNR of the incoming signal waveform shape and pulse shape of the incoming signal and or symbol timing. One or more of the estimates and or characteristics produced by JEM is transmitted to MCM CSM and FSS CSM to track the carrier phase FSS to estimate of the symbol timing of the incoming signal and MCM for maximum likelihood ML modulation classification or the modulation classifier. Radio receiver functions to receive an incoming signal and through estimations and one or more refining iterations determines the signal type and decoding the incoming signal utilizing an appropriate decoder.

In addition system includes a decoder module connected to and or in communication with radio receiver . In one exemplary embodiment decoder module includes a module including hardware and or software suitably configured to receive an output signal including fine estimations of the carrier phase tracking the symbol timing the modulation classification the data format and or the data rate of an incoming signal from radio receiver and determine the type of signal based on a comparison of the estimates with the characteristics of an array of known signal types. Furthermore decoder module includes a plurality of decoders to decode the incoming signals based upon the determination made by module wherein each decoder of the plurality of decoders may include any hardware and or software suitably configured to decode a particular signal type. As such each decoder may be any decoder known in the art or developed in the future.

System in various exemplary embodiments includes a display to display the data decoded by decoder module wherein display may be any hardware and or software suitably configured to display the data in the incoming signal such that the data can be detected by at least one the five senses of a user and or an electronic device e.g. a computing device . For example display may be an audio and or visual device such as a television a monitor a speaker a radio a computer and the like.

The following are examples of the estimation algorithms incorporated in the above referenced modules.

where p t is a pulse shape taking on values 1 and satisfying T p t dt 1 T is the symbol rate c is a binary sequence which is treated as independent identically distributed IID data taking on values 1 with equal probability is the modulation index is the carrier frequency in rad s and n t is a bandpass additive white Gaussian noise AWGN source with single sided power spectral density NW Hz.

Based on the above AWGN model then for an observation of K data intervals the maximum likelihood ML modulation index estimation may be derived. Suitable approximations to the nonlinearity can be made corresponding to low and high data detection SNR conditions. For high data detection SNR the ML modulation index estimation after approximation is given by

Making large SNR approximations a simplified solution for the ML estimate of modulation index for M PSK is 

In another embodiment MIM performs modulation index estimation for the case where carrier synchronization has not yet been established i.e. where the carrier phase is random . In the non coherent case the modulation index estimate is formed in the absence of carrier synchronization. For BPSK modulation the received signal is again modeled as in equation 1 with the addition of an unknown but assumed to be uniformly distributed carrier phase to both the discrete and data modulated carriers. This allows a non coherent estimator of modulation index 

In yet another embodiment MIM performs modulation index estimation for the case when the modulation type symbol timing and data rate are also unknown. The modulation index estimators discussed above do not require an SNR estimate or both an SNR estimate and a carrier phase estimate. However they both utilize knowledge of the PSK modulation size data rate and symbol timing as seen by the use either explicitly or implicitly of the parameters M and T and precise integration limits in equations 9 and 10 .

The same architecture shown in above can be used for a general M PSK modulation where modulation type M is unknown and where the data rate 1 T and fractional symbol timing are also unknown.

FCM in one embodiment includes an open frequency estimator when a residual carrier is available. In another embodiment FCM includes a closed loop frequency estimator when a residual carrier is available. Notably the invention contemplates use of both an additive white Gaussian noise AWGN channel and a Rayleigh fading channel.

However this operation is equivalent to obtaining the fast Fourier transform FFT of the received sequence taking its magnitude and then finding the maximum value.

An error signal detector for a closed loop frequency correction can be implemented based on the above equations.

One embodiment of a closed loop frequency estimator for a residual carrier signal with the approximate error signal detector given by 12 is illustrated in the block diagram of . The parameters N the number of samples to be summed and gain should be optimized and updated after the initial start to perform both the acquisition and tracking of the offset frequency.

The gain that was shown in the closed loop frequency tracking system is usually part of a digital loop filter . The digital loop filter without gain can be represented as 

One embodiment of a circuit for a digital loop filter is shown in the block diagram of . In addition to the gain the parameter b should also be optimized for achieving the best performance.

Consider a data modulated signal with a suppressed carrier wherein let tilde over r t be the received complex waveform and athe complex data representing an M PSK or a QAM modulation. Let p t be the transmit pulse shaping. Then the received signal can be modeled as 

is equivalent to multiplying the received signal by e passing it through the matched filter with impulse response p t and sampling the result at t k 1 T which produces the sequence of zs. Next sum the zs take its magnitude and then find the maximum value by varying the frequency f between fand fwhere fis the maximum expected frequency offset. In one exemplary embodiment FCM utilizes an open loop frequency estimator see the block diagram of for a suppressed carrier with known data to perform the operations of 16 .

An error signal detector for the closed loop frequency correction using the above equations in an exemplary embodiment is shown in . Notably in DAC denotes a Digital to Analog Converter.

The error signal can be calculated by taking the derivative of f Y to obtain 18 The error signal in 18 can also be written as 19 

Closed loop frequency estimators and each include mixed analog and digital circuits. An all digital version of a closed loop frequency estimator in accordance with another exemplary embodiment of the invention is illustrated wherein closed loop frequency estimator operates on the received samples tilde over r . In prepresents the discrete time version of the pulse shaping p t where there are n samples per data symbol duration T. Notably an all digital version of other closed loop estimators can be obtained in a similar manner and are each contemplated by the invention.

FCM includes a non data aided frequency estimator for situations where the data is unknown to radio receiver . The I x function can be approximated as 

is equivalent to multiplying the received signal by e passing it through a matched filter with impulse response p t and sampling the result at t k 1 T which produces the sequence of zs. Next take the magnitude square of each z perform summation and then find the maximum value by varying the frequency f between fand fwhere

One exemplary embodiment of an error signal detector for closed loop frequency correction using the above equations is illustrated in the block diagram of .

All digital versions of other closed loop estimators can be obtained in a similar manner and are contemplated by the invention.

Referring again to after the modulation index is estimated the incoming signal is transmitted to JEM . In accordance with one exemplary embodiment of the invention JEM includes a data format pulse shape module to determine the waveform shape and pulse of the incoming signal. In another embodiment JEM includes a signal to noise ratio SNR module to determine the strength of the incoming signal relative to background noise. JEM in yet another exemplary embodiment includes a data rate module to determine the data rate of the incoming signal. In still another exemplary embodiment JEM includes a coarse symbol synchronizer CSS to provide symbol timing to various components of the radio receiver. In accordance with one exemplary embodiment of the invention JEM includes at least two of data format pulse shape module SNR data rate and symbol synchronizer . In accordance with another exemplary embodiment JEM includes at least three of data format pulse shape module SNR data rate and symbol synchronizer . In yet another exemplary embodiment JEM includes each of data format pulse shape module SNR data rate and symbol synchronizer . Furthermore each of data format pulse shape module SNR data rate and symbol synchronizer perform their respective functions at substantially the same time.

Date format module in one exemplary embodiment is configured to determine whether the incoming signal includes non return to zero NRZ encoding or Manchester encoding. Furthermore date format module is configured to determine NRZ encoding or Manchester encoding for Binary Phase Shift Keying BPSK signals and or Quadrature Phase Shift Keying QPSK signals and whether these signals are coherently classified i.e. one encoding format is always used on a specific carrier type e.g. NRZ is always used on a suppressed carrier or non coherently classified i.e. independent of the encoding format the modulations are assumed to be a fully suppressed carrier .

In accordance with one exemplary embodiment of the invention date format module includes a coherent data format classifier for determining NRZ encoding or Manchester encoding for an incoming BPSK signal with a low SNR. Again supposing the incoming signal is represented in passband by 

Note that while the optimum classifier of 25 requires knowledge of SNR the reduced complexity classifier 27 does not.

The solution to the problem of making an ML decision on the pulse shape of a modulation from a variety of different possibilities in principle follows the identical procedure as discussed above for data format classification except for the fact that they are no longer restricted to digital pulse waveforms.

Of the many measures that characterize the performance of a communication receiver signal to noise ratio SNR is perhaps the most fundamental in that many of the other measures directly depend on its knowledge for their evaluation. Thus it is desirable that the estimation of SNR take place with as little known information as possible regarding other system parameters such as carrier phase and frequency order of the modulation data symbol stream data format and the like. In one exemplary embodiment of the invention SNR module is configured to estimate and or determine the signal to noise ratio with as little known information e.g. carrier phase and frequency order of the modulation data symbol stream data format and the like as possible. In accordance with an aspect of one exemplary embodiment of the invention SNR module includes a modified split symbol moments estimator SSME wherein is a block diagram illustrating an embodiment of SSME .

Besides being used for phase compensation of the samples or half symbols that enter into the expressions for computing U the frequency estimate also enters into play in determining the estimates that are computed from h by replacing circumflex over with its estimate circumflex over . Thus the performance of SSME and will depend on the accuracy of the frequency estimate circumflex over with or without phase compensation. In the most general scenario a taxonomy of cases for analysis is illustrated by the tree diagram of for the sampled version of the SSME . begins at the square node in the middle and proceeds outward to any of the eight leaf nodes representing combinations of circumflex over and . For SSME a few of the tree branches of namely and do not apply.

SSMEs and assume that the symbol timing is either known or could be estimated perfectly. In another exemplary embodiment the SNR estimator includes SSME to determine the SNR when symbol timing is imperfect but the carrier frequency is known but the carrier phase is still assumed unknown .

A generalized SSME structure that provides improved performance in the sense of lowering the variance of SNR module will now be disclosed. To simplify matters consider the ideal case of no frequency uncertainty and SSME . Suffice it to say that the generalization is readily applied to SSME in a manner readily attainable by one of ordinary skill in the art. A generalized SSME is such that for a fixed observation time the quality of SNR module continues to improve with increasing SNR.

Even though the optimized generalized SSME requires in principle very precise prior knowledge of the true value of R its performance can be reasonably well approximated by that of a robust estimator circumflex over R using a very coarse prior estimate of R.

Similar to the generalized SSME circumflex over R is based on complex valued samples the generalized SSME circumflex over R based on real valued samples may be optimized with respect to its asymptotic performance expressions

The equations defining both the time multiplexed estimator R SSME and the underlying observables U in terms of standard chi squared random variables are identical in form to those obtained for the special case of uniform sub sampling of all the symbols L L L . . . L .

Thus far the behavior and performance of the SSME for the class of M PSK M 2 modulations with and without frequency uncertainty have been discussed. In various other exemplary embodiments SNR module includes an SSME structure to provide SNR estimation for offset QPSK OQPSK as well as non constant envelope modulations such as QAM. As before the performance of the estimator is still independent of the data symbol sequence as well as the carrier phase and allows for the same enhancement by increasing the number of pairs of observables per symbol in accordance with the true value of SNR.

For the case of M PSK it was noted that the kth transmitted complex symbol in the interval k 1 T t kT can be represented in the form d ewhere takes on one of M phases uniformly spaced around the unit circle. A special case of the above corresponding to M 4 results in conventional QPSK. It is well known that on nonlinear channels OQPSK provides a performance advantage since it reduces the maximum fluctuation in the signal amplitude by limiting the maximum phase change to 135 rather than 180 . Since for OQPSK the complex representation of a symbol extends over 1 symbols because of the offset between the I and Q channels it cannot conveniently be represented in the polar form d eas above. Rather the I and Q channel modulations are considered separately. For convenience SSME is discussed however the same conclusions also apply to SSME .

For implementing a universal SSME structure that will handle OQPSK as well as conventional QPSK the results of inputting the I and Q channel baseband signals to half symbol I Ds are partitioned into even and odd outputs.

Date rate module in one exemplary embodiment is configured to determine and or estimate the data rate of the incoming signal. Knowledge of this parameter is important in carrying out ML detection of other parameters such as the carrier phase or modulation type. Here the data rates are assumed to come from a set of known values and related by integer powers of an integer base B. This assumption allows estimation of the true data rate based on estimates of the signal to noise ratio SNR computed for various assumed data rates. In one embodiment the SNR utilized is SSME and or SSME discussed above. These estimators are appealing in that the only parameter required for their operation is the assumed data rate. Hence estimation of the data rate can be done jointly with that of the SNR.

Though this approach provides a way of estimating both the data rate and SNR together it will be shown that it is sensitive to symbol timing error or jitter. In fact the presence of symbol timing error can severely degrade the performance of this estimator. To overcome this a modification is proposed in which the jitter is quantized and estimated alongside the data rate and SNR. This approach based on a so called generalized likelihood ratio test GLRT is robust in the presence of symbol timing error and can be used to jointly estimate the data rate SNR and symbol timing error all at once. The estimates of the symbol timing error obtained can then be used as coarse initial estimates for the data transition tracking loop DTTL which is used later in the receiver to obtain a fine estimate of the timing.

The baseband signal received at the autonomous radio is assumed to consist of a constant amplitude digital data stream corrupted by artifacts due to the conversion from IF to baseband as well as additive noise. Mathematically the received signal tilde over r t is assumed to have the following form in the complex baseband representation 

Prior to estimating parameters such as the carrier phase or the frequency offset the data rate given is estimated by R 1 T.

In one embodiment the SNR utilized is SSME for estimating tilde over r t from 32 for the case of a rectangular NRZ pulse shape. Notably for different pulse shapes the only thing that needs to be changed is that the half symbol integrate dump I D circuits need to be replaced with half symbol matched filters Here T denotes the assumed symbol period of the system i.e. the sample period N denotes the number of system observations and and denote frequency and phase compensation factors as described above.

The data rate estimation algorithms above are used to jointly estimate the data rate SNR and symbol timing error. Even with a coarse quantization of the symbol timing error a rather robust estimation of the data rate in the presence of jitter is obtained. Once a reliable estimate of the data rate has been made the DTTL can then be used to obtain a finer estimate of the symbol timing error. Furthermore the coarse estimate of the jitter can be used as an initial condition for the DTTL which may reduce the computation time required for convergence.

As the data rate of the received signal is not known a priori at radio receiver the symbol timing error corresponding to one specific data rate is one thing that can be independently quantized. By quantizing the jitter corresponding to one data rate the quantized jitter for the remaining rates may be automatically determined. Furthermore SSME is also a generalized structure to account for the quantized symbol timing error and to account for computing an ensemble average of the observed SNRs. An ensemble average of the observed SNRs is important in estimating the mean of the SNR of the SSME system.

To incorporate the estimation of the quantized symbol timing error JEM includes CSS which is described in the following algorithms.

As discussed above for each assumed data rate the SSME is run for each value of the quantized symbol timing error. The SNR and jitter for that data rate are then estimated to be the largest SNR and the jitter value leading to this maximum SNR. This data rate estimation technique halts as soon as the condition circumflex over circumflex over is not satisfied. This may lead to a premature termination of the algorithm. To prevent a premature halting of the algorithm a GLRT type modification is utilized. This GLRT type estimation algorithm is based on the principle that the true data rate and symbol timing error should yield the largest value of the mean of the SNR. Incorrect values of these quantities on the other hand should lead to a degraded estimate of the SNR mean. As opposed to the previous algorithm which lowers the assumed data rate until the SNR decreases this algorithm computes the SNR for all data rates and all jitter values. The advantage to this is that it can prevent the algorithm from prematurely terminating which can easily happen when the true SNR is low.

With reference to data rate module carrier synchronization techniques have been developed assuming that the modulation format and signal constellation characteristics are known a priori. In other words the modulation index is chosen so that either the carrier is fully suppressed or a residual carrier component remains. Notably constellation characteristics refers to the shape of the constellation e.g. a circle for multiple phase shift keying M PSK or a square for quadrature amplitude modulation QAM and its size in terms of the number of signal points it contains. Aside from knowing the modulation index and signal constellation structure it is also customary to have knowledge of the data rate and type e.g. NRZ versus Manchester code since the true optimum design of the loop depends on this information.

For radio receiver the most optimistic situation would be that the receiver contains a carrier synchronization structure that is capable of tracking the carrier phase independent of the above mentioned considerations. While this is not completely possible since for example a squaring loop or equivalently a BPSK Costas loop cannot track a QPSK modulation and likewise a 4power loop or equivalently a QPSK Costas loop sometimes referred to as an inphase quadrature I Q loop cannot properly track a BPSK signal. Nevertheless while in principle each carrier synchronization loop developed for a given modulation format constellation and data rate type has certain unique characteristics they do share a number of similarities e.g. a common front end demodulator structure that allows one to consider designs that could be operational in the absence of complete a priori knowledge of all of these characteristics . For example if the modulation is restricted to the M PSK class then it is possible to construct a universal structure that performs the carrier synchronization function for all values of M. This structure is derived by first determining the maximum a posteriori MAP estimate of carrier phase based on an observation of the received signal namely M PSK plus additive white Gaussian noise AWGN and then using this to motivate a closed loop carrier synchronization loop. By making an analogy between the closed loop bandwidth and the noise bandwidth of an integrate and dump I D filter of duration equal to the observation time for the open loop MAP estimate the closed loop approaches the Cramer Rae lower bound on the variance of an unbiased estimate of the phase of a modulated carrier.

Still further if the modulation is known to be other than suppressed carrier i.e. a modulation index less than 2 radians then it is still possible to exploit the power in both the data and residual carrier components for carrier tracking purposes provided one has knowledge of the modulation index itself. Such knowledge could be derived non coherently i.e. in the absence of carrier synchronization from a suitable modulation index estimator. Loops of this type are often referred to as hybrid carrier tracking loops and like their suppressed carrier counterparts are motivated by the same MAP considerations.

In various exemplary embodiments the matched filters in the I and Q arms of the loop are replaced with simple low pass filters to make the carrier synchronizer operation somewhat independent of the exact pulse shape but without some attendant loss in performance. These systems include a fixed modulation bandwidth which implies a fixed data symbol rate for all values of M. These systems include simplifications based on low SNR approximations applied to the nonlinearities inherent in the MAP phase estimate. When this is done the error signal in the loop for M PSK is of the form sin M where is the loop phase error which from simple trigonometry can be written as sin M 2 sin M 2 cos M 2 . Thus it is seen that the error signal in the loop for M PSK is formed from the product of the error signal sin M 2 and the lock detector signal cos M 2 in the loop for M 2 PSK modulation. This relationship forms the basis for implementing a universal structure.

In the past carrier synchronization loops have typically fallen into two categories those that track a discrete carrier e.g. the phase locked loop PLL and those that track a fully suppressed carrier e.g. the Costas loop . A fully suppressed carrier comes about when a digital modulation is impressed on a carrier with a modulation index equal to 2 radians whereas a discrete residual carrier component appears in the spectrum when the modulation is less than 2 radians.

For implementing a universal SSME structure that will handle OQPSK as well as conventional QPSK the results of inputting the I and Q channel baseband signals to halfsymbol I Ds are partitioned into even and odd inputs. SNR estimator can use the other embodiments SSME for estimating SNR when QAM is transmitted.

Date rate module in one exemplary embodiment is configured to determine and or estimate the data rate of the incoming signal. Knowledge of this parameter is important in carrying out ML detection of other parameters such as the carrier phase or modulation type. Here the data rates are assumed to come from a set of known values and related by integer powers of an integer base B. This assumption allows estimation of the true data rate based on estimates of the signal to noise ratio SNR computed for various assumed data rates. In one embodiment the SNR utilized is SSME and or SSME discussed above. These estimators are appealing in that the only parameter required for their operation is the assumed data rate. Hence estimation of the data rate can be done jointly with that of the SNR.

Though this approach provides a way of estimating both the data rate and SNR together it will be shown that it is sensitive to symbol timing error or jitter. In fact the presence of symbol timing error can severely degrade the performance of this estimator. To overcome this a modification is proposed in which the jitter is quantized and estimated alongside the data rate and SNR. This approach based on a so called generalized likelihood ratio test GLRT is robust in the presence of symbol timing error and can be used to jointly estimate the data rate SNR and symbol timing error all at once. The estimates of the symbol timing error obtained can then be used as coarse initial estimates for the data transition tracking loop DTTL which is used later in the receiver to obtain a fine estimate of the timing.

To account for the presence of symbol timing error typically a digital transition tracking loop DTTL is used. However the DTTL architecture requires knowledge of the data rate to function as required. To overcome this restriction the proposed SSME based data rate estimator can be modified to provide a coarse estimate of the symbol timing error in addition to the data rate which can then be used to obtain a finer estimate of the symbol timing error using a DTTL. As the data rate of the received signal is not known a priori at radio receiver the symbol timing error corresponding to one specific data rate is one thing that can be independently quantized. By quantizing the jitter corresponding to one data rate the quantized jitter for the remaining rates may be automatically determined.

As the number of quantization steps increases exponentially as the assumed data rate decreases it is tempting to think that a better estimate of the data rate SNR and symbol timing error for lower true data rates than for higher rates will be obtained. However this is offset by the fact that for a fixed observation time interval an exponentially larger number of observations for higher true data rates than for lower ones is obtained. Hence there is an implicit tradeoff between the number of signal observations and the number of jitter quantization levels for each true data rate.

One of the advantages of uniformly quantizing the symbol timing error to Nsteps is that it leads to an efficient all digital implementation of the SSME system.

Furthermore SSME is also a generalized structure to account for the quantized symbol timing error and to account for computing an ensemble average of the observed SNRs. An ensemble average of the observed SNRs is important in estimating the mean of the SNR of the SSME system. To do this the discrete time signal yis partitioned into blocks over which the SNR is to be computed. For each block the SSME computes an estimate of the SNR and then an ensemble average of the SNR is computed over the blocks.

There are several things to note regarding the structure of all digital SSME system . First all digital SSME system includes discrete summations analogous to the sampled version of the SNR estimator discussed above with regard to SNR . Furthermore note that all of the signals starting from the half signal integrator outputs are indexed with a semicolon followed by n. Finally note that to form a single SNR estimate a total of BN samples are squared and accumulated. This was chosen as such here to keep the total observation time interval or epoch block fixed.

All other things being equal a modulation classifier that requires the least knowledge of channel parameters is preferred. If a classifier required only as for example it would be preferred over one requiring Pand separately.

Alternatively in another exemplary embodiment the qLLR metric may be modified by normalizing its magnitude resulting in the nqLLR metric 

The analytical derivation of appropriate thresholds for the qLLR in 34 depended on the particular form of the metric and involved some approximation. As an alternative an empirical method to optimize the threshold can be used for any classifier metric including the qLLR and nqLLR metrics is disclosed. Empirical threshold determination consists of the following process 

This procedure may be implemented efficiently enough that a desktop machine can generate about 100 million samples and determine an empirically optimum threshold in less than an hour. The following additional points should be noted 

1. Threshold optimization need be performed once offline. In a practical implementation given N and ya table look up may be used to determine the threshold.

2. The optimum threshold for the LR metric and its approximation in 344 is zero and requires no empirical optimization.

3. The optimum threshold for the qLLR metric for BPSK QPSK classification is relatively flat over a broad region of being near 0.6 for 5 dB. This is a desirable characteristic because may not be known exactly.

4. The optimum threshold for the nqLLR metric is also quite flat and ranges from about 0.15 to 0.6 for 10

Thus far exact and approximate likelihood based non coherent classifiers of M PSK signals have been discussed under the assumption of unknown uniformly distributed carrier phase but with perfectly known fractional symbol timing. In other embodiments these classifiers are extended to the case where the symbol timing is unknown and also uniformly distributed

To simplify the implementation of the ML classifiers in one embodiment approximations of the nonlinearities involved in their definitions are used in much the same way as was done for the conventional non offset modulations. The approximate LLF is 

The operation and performance of various receiver functions can be quite sensitive to knowledge of the timing data transition epochs of the received data symbols. Thus the ability to accurately estimate this parameter and continuously update the estimate i.e. perform symbol synchronization with as little knowledge of other parameters is important to successful operation of a radio receiver .

Traditionally symbol synchronization techniques have been developed assuming that the data symbols are binary the modulation format e.g. NRZ or Manchester data is known a priori and carrier synchronization is perfect. Thus the symbol synchronization problem has been solved entirely at baseband assuming perfect knowledge of the carrier phase and frequency.

Since radio receiver functions in general over a wide range of SNRs in one exemplary embodiment radio receiver employs symbol timing estimation and tracking schemes whose implementations can adapt themselves to this changing environment using the knowledge obtained from SNR module . Furthermore since SNR module itself requires knowledge of symbol timing circuitry for obtaining a coarse estimate of this timing is important.

In one embodiment FSS includes a DTTL is motivated by an open loop estimate to determine the MAP estimate of the symbol timing based on an observation of a block of N symbols. Analogous to the ML approach taken in modulation classification the likelihood function LF of the received signal vector is formed conditioned on the unknown parameters to be estimated

For the purpose of finding the MAP estimate of symbol synchronization alone perfect knowledge of the carrier phase is assumed and wherein 0. Under this assumption the MAP estimate of symbol timing circumflex over is given by 

Note that the actual fractional symbol timing offset is embedded in the received complex baseband signal tilde over r t and thus the difference between circumflex over and represents the normalized symbol timing error.

A closed loop configuration that implements the expression in 446 as an error signal is referred to as a MAP Estimation Loop.

and r t is now a real signal. A block diagram of one embodiment of a MAP estimation loop that uses e of 46 as an error signal to control a timing pulse generator is illustrated in wherein the shorthand notation T circumflex over represents the time interval n circumflex over T t n 1 circumflex over T. In the accumulator represents the summation over N in 46 . Thus based on the above model the loop would update itself in blocks of N symbols. In one embodiment this block by block accumulator is replaced by a digital filter which updates the loop every T seconds and whose impulse response is chosen to provide a desired dynamic response for the loop. The design of this filter and its associated closed loop response characteristic are not dictated by the MAP estimation theory which explains the use of the term MAP motivated when describing the MAP estimation loop.

To go from the MAP estimation loop to the conventional DTTL one needs to approximate the hyperbolic tangent nonlinearity for large values of its argument equivalently at high SNR and 2 characterize i.e. approximate the derivative of the pulse shape required in . Specifically for large values of its argument one has the approximation tan sgn 51 

Based on the above assumptions and discussion it is now clear that the MAP estimation loop migrates to a DTTL as illustrated in the block diagram .

In one exemplary embodiment FSS includes a DTTL that is motivated by the MAP estimate of symbol timing at low SNR and in particular the I arm hard decisions are replaced by soft decisions whereupon in the limiting case the hard limiter is replaced by a linear device. Under high SNR conditions where the nonlinearity is approximated as in 51 in one embodiment the I arm of the resulting symbol synchronizer becomes a detector of a transition in hard decisions made on successive symbols. In accordance with one aspect of one embodiment the DTTL includes a synchronizer that results from approximating the nonlinearity for small values of its arguments as appropriate at low SNR.

For sufficiently small values of its argument the hyperbolic tangent nonlinearity can be approximated by tan sgn 52 

 i.e. a linear function . Under this assumption a MAP motivated closed loop synchronizer is illustrated in the block diagram of and its performance is analyzed as follows. After known carrier phase demodulation by the carrier reference square root over 2 cos t the baseband signal input to the LDTTL is given by 

where consistent with the assumption of NRZ data p t is a unit amplitude rectangular pulse of duration T sec and d is an iid 1 sequence with drepresenting the polarity of the nth data symbol. The additive noise is a white Gaussian process with single sided power spectral density NW Hz. The local clock produces a timing reference for the I and Q I D filters that depends on its estimate circumflex over of .

One can immediately apply the same small and large argument approximations to the hyperbolic tangent nonlinearity and analogous to arrive at DTTL like implementations which are illustrated in the block diagrams of .

As discussed above open loop MAP estimation of symbol epoch involves finding the conditional on the symbol timing likelihood function of the received signal based on a single observation of the received signal over a block of symbols. Furthermore since the unknown symbol epoch is assumed to be uniformly distributed over the symbol interval the MAP estimate is equivalent to the ML estimate. Moreover the traditional closed loop estimation scheme motivated by the MAP estimation approach employs an error signal derived from the derivative of the CLF that can be updated at intervals corresponding to the symbol time. Since for rectangular pulses e.g. an NRZ data stream the derivative of the CLF which is related to the derivative of the pulse shape is undefined closed loop structures motivated by the MAP estimation approach generally do not exist. Nevertheless with suitable approximations of the derivative of the pulse shape such a closed loop e.g. the DTTL will in fact provide symbol synchronization for an NRZ data stream with rectangular pulses. The closed loop approach provides a continuous updating tracking of the symbol timing once per bit interval which is desirable in the presence of channel dynamics whereas the open approach is usually regarded as either a one shot estimator i.e. compute the MAP or MMS estimate based on a single observed long block of data or a block by block estimator where the single shot is sequentially repeated over and over.

What is important to observe is that the open loop estimation techniques can be modified to provide sequential updates at the symbol rate to the symbol timing epoch estimates and as such resemble the closed loop techniques with however improved performance. As such the presented invention includes a sequential digital implementation of the MAP estimation of symbol epoch that can track the dynamics in this parameter yet provide a performance approaching that of the true optimum MAP estimation technique.

Because of the assumption that the unknown parameter being estimated i.e. symbol epoch is constant over the observation the implementation in referenced as includes a running accumulator with uniform weighting. In other embodiments where the parameter is dynamic but slowly varying one can assume that the unknown parameter is constant over a finite number of symbol intervals. As such the uniform running accumulator is replaced with a weighted running accumulator which reflects a fading memory and is analogous to what is done in a closed loop architecture by using a digital filter following the error signal. This embodiment referenced as is illustrated in the block diagram of wherein the feedback term is multiplied by a constant 

Since the running accumulator also accomplishes the data detection matched filter function then the epoch estimate index of 55 may be used to determine in each symbol interval which running accumulator output to use for making a hard decision on that symbol.

When the pulse shape is other than rectangular the modification that allows the bank of N correlations to be replaced by a sliding accumulator as in is not possible. However if N is large and the pulse shape is approximated by a piecewise constant staircase function with N steps then the correlation of the received signal and the pulse shape in a quantization interval can be written as 56 

where pis the assumed constant value of p t in the interval i t i 1 . In view of 56 one modification of that is necessary to allow for the inclusion of an arbitrary pulse shape is to replace the uniform sliding accumulator with a weighted sliding accumulator see where the weights are equal to the piecewise constant values of p t . Furthermore for sufficiently large N one can approximately replace the integral of over the quantization interval by the value of r t at the midpoint of this interval times the duration of this interval . As such the integrator at the input of can be replaced simply by a uniform sampler at rate 1 .

In addition to optimum symbol synchronizers such as the ones discussed thus far that are motivated by the MAP estimation approach the present invention encompasses other embodiments for determining the symbol timing. A block diagram of a real non coherent version of a cross spectrum synchronizer is illustrated in the block diagram of wherein the input is a bandpass signal whose signal component is given by s t Re tilde over s t e with denoting the carrier frequency.

Another exemplary embodiment of FSS includes non coherent versions of a DTTL. The low SNR version of the noncoherent DTTL herein given the acronym NC LDTTL is a parallel combination of two independent coherent LDTTLs acting on the I and Q baseband signals. is a block diagram illustrating NC LDTTL . In one exemplary embodiment it is important that a coarse estimate of symbol timing be provided to SNR module and is derived from the same statistics as used to form this estimator itself.

Benefits other advantages and solutions to problems have been described herein with regard to specific embodiments. However the benefits advantages solutions to problems and any element s that may cause any benefit advantage or solution to occur or become more pronounced are not to be construed as critical required or essential features or elements of the invention. All structural chemical and functional equivalents to the elements of the above described exemplary embodiments that are known to those of ordinary skill in the art are expressly incorporated herein by reference and are intended to be encompassed by the invention.

