---

title: Virus pattern update for mobile device
abstract: An updated virus pattern file is developed at an update server. A mobile management center (MMC) has a list of mobile telephone numbers and receives the new virus pattern from the update server. A Multimedia Message Service Center receives the new virus pattern and the list of mobile telephone numbers from the MMC and sends an MMS message to each of the wireless devices, including the new virus pattern as an attachment. Each wireless device replaces the old virus pattern with the new virus pattern. A unique identifier (a cryptographic signature or magic number) is added to each MMS message to enable the wireless device to recognize a new virus pattern. The pattern version and the pattern itself are merged into a single file. The file is also encrypted at the MMC and decrypted at the wireless device.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07634262&OS=07634262&RS=07634262
owner: Trend Micro, Inc.
number: 07634262
owner_city: 
owner_country: JP
publication_date: 20060307
---
The present invention relates generally to computer virus detection on a mobile telephone. More specifically the present invention relates to a technique for updating a pattern file on a mobile telephone.

The threat of computer viruses worms and other types of malicious software are now commonplace in computer systems. And as the number of data centric mobile devices grows e.g. mobile telephones these devices also will become attractive targets for computer viruses SMS spam and other malicious software. Many of these handheld devices run the same operating systems thus making it easier for unscrupulous parties to distribute malicious software and to disrupt mobile telephone usage. In addition to frustrating consumers computer viruses and message spam cause individuals and companies to suffer from lost productivity and the high cost of fixing any problems.

Computer viruses and other malware can arrive at a mobile device through a variety of delivery vectors and actions. These actions include inserting an infected storage card into the device synchronizing the device with a computer that downloads an infected file downloading an infected file from the Web to the device using the wireless application protocol WAP that pushes a suspect Web link containing an infected file to the mobile device using a Bluetooth or infrared transmission that pushes an infected file from one mobile device to another using a wireless network etc.

For example more and more malicious software is now targeting operating systems of mobile telephones. The SYMBOS FONTAL.B computer virus affects mobile devices running the Symbian operating system including a variety of mobile telephones. The virus is downloaded over the Internet or other network and pretends to be a Nokia antivirus application it tricks the user into installing it on their mobile telephone. Upon installation it displays a benign message and prompts the user to restart the device. Once the device restarts the virus causes the device to constantly restart the only way a to fix the problem is to restore the factory settings on the telephone thus erasing any personal information or other data that the user had stored on the telephone.

It is possible to run antivirus software utilizing a virus pattern on a mobile telephone in order to detect a software virus or other malware. But using a virus pattern to detect known viruses and malware requires not only that the pattern be downloaded to the telephone in the first place but also that the pattern be updated periodically.

Currently there are two techniques for updating a virus pattern on a mobile telephone. One technique is to receive a virus pattern update over a TCP IP connection. The mobile telephone user connects to an update server over a wireless connection that supports the TCP IP protocol. Or the user connects the mobile telephone to his or her computer in order to directly download the new virus pattern. Typically this update server is the normal antivirus update server used to obtain updates over a wired connection to personal computers. Unfortunately this technique relies upon the user to connect and perform the update when he or she remembers to do so. Therefore the update is often not timely. Sometimes the antivirus software provider will send an SMS message to remind the user to perform an update. In a variation specially formatted SMS messages display an alert message to the user and provide the option of connecting directly to a particular URL via the mobile telephones WAP browser. But because a wireless network typically has low bandwidth the network may become overloaded if all users attempt to perform an update at the same time from the update server.

The second technique is to use the short message service SMS to perform the update. The antivirus software provider uses SMS to make a new pattern available to the mobile telephone user. But because SMS has a body length limit of 140 bytes it is not possible to send the entire new pattern to the mobile telephone using SMS. Only the pattern differential between the old pattern and the new pattern can be sent using SMS. Also the pattern file format must be designed so that it is easy to merge the old pattern with the pattern differential. Further SMS can be unstable if an SMS update is lost the mobile telephone may be left without the full pattern and no virus detection capability.

Accordingly a technique is desired that would allow users of mobile telephones and other wireless handheld devices to simply and easily obtain virus pattern updates for their mobile telephones in a timely manner.

To achieve the foregoing and in accordance with the purpose of the present invention a technique is disclosed that allows users of wireless devices to obtain new pattern files or updates to pattern files easily and quickly.

In a first embodiment of the invention a virus pattern is updated on a handheld wireless device by first receiving a new virus pattern at a mobile management center. The new virus pattern and a telephone number of the wireless device are sent to a Multimedia Message Service Center MMSC . The Center relays the new virus pattern from the MMSC to the user s wireless device the new virus pattern is integrated with an MMS message. The wireless device receives the MMS message and the new virus pattern and replaces an old virus pattern with the new virus pattern thus updating antivirus software on the wireless device.

In a second embodiment of the invention a virus pattern is updated on a handheld wireless device by first installing an old virus pattern in the wireless device. Next the wireless device receives an MMS message and extracts a new virus pattern from the MMS message. The old virus pattern is then replaced with the new virus pattern.

In a third embodiment of the invention a system for updating a virus pattern in handheld wireless devices includes an update server with a new virus pattern. A mobile management center MMC includes a list of mobile telephone numbers and each of the mobile telephone numbers identifies one of the wireless devices. The MMC receives the new virus pattern from the update server. A Multimedia Message Service Center receives the new virus pattern and the list of mobile telephone numbers and sends the MMS messages to the wireless devices. Each wireless device includes an old virus pattern and receives one of the MMS messages from the MMSC that incorporates the new virus pattern. The wireless device replaces the old virus pattern with the new virus pattern.

The present invention is applicable to any of a wide variety of types of data centric mobile devices such as cellular telephones mobile telephones smart telephones and other similar wireless handheld devices that send and receive information over a communications network. Examples include PDAs that incorporate a mobile telephone or other wireless communication a Blackberry wireless device and other devices that support MMS programming.

The present invention is applicable to all these types of smartphones and wireless handhelds the term wireless mobile device will be used below to encompass all of these devices and in general refers to any mobile telephone or handheld wireless device capable of receiving an MMS message or its equivalent.

Telephone includes an antenna an RF transceiver and both analog and digital baseband modules and for communication in two modes. An application processor runs the operating system and any applications running on the telephone. A keypad and a microphone provide input to the device while a display and a speaker provide output. Memory is typically flash memory that stores the operating system for the device and any additional software applications. Memory card is any suitable storage medium used to store data such as text pictures audio video etc. Card may also be termed a flash memory card or a storage card and although many current products use flash memory other technologies are being developed and are encompassed by this description. There are a wide variety of types of memory cards on the markets including the SD card secure digital card the CF card compact flash card the Smart Media card the memory stick and the multimedia card MMC . These cards are of varying sizes shapes and interfaces and have a range of storage capacities. Each type of card will use a particular interface protocol to communicate with and physically connect to telephone and such interfaces are known to those of skill in the art. Earlier storage media such as the PC card and a smart card may also be considered memory cards. Memory cards are especially suited for portable devices such as mobile telephones PDAs and other wireless devices as they are removable.

In particular embodiments of the invention the operating system running on telephone or another wireless device is the Windows Mobile 2003 2003 Second Edition for smartphones or PocketPC available from Microsoft Corporation the Symbian Ltd. operating systems 7.0s or 7.0 Palm OS from PalmSource Mobilinux from MonteVista or the Blackberry operating system from Research in Motion. As is known in the art these operating systems are designed for use on mobile devices.

Implementation of memory and memory card is handled differently by the different operating systems. Memory is also referred to as the C drive or native or internal drive and memory card is also referred to as the E drive or external drive in an operating system where the C drive and the E drive are separate drives. In another operating system where only the C drive is used the memory card or E drive exists as a subdirectory of the root drive.

The present invention utilizes the Multimedia Message Service MMS in order to distribute virus pattern files and updates to pattern files. As known in the art MMS is a relatively new standard that is being defined for use in handheld wireless devices such as mobile telephones. This service allows for the transmission of various kinds of multimedia content such as graphics video clips sound files text messages etc. to MMS capable handsets. MMS is based on the same principle as conventional SMS but unlike SMS which is limited to 140 bytes MMS can transmit files having sizes of 100 Kbytes or larger. Most all carriers allow file sizes of at least 40 Kbytes. Using MMS the pattern file is attached to the MMS message and is delivered to the user s handheld device. As the pattern file in most cases will be relatively small it is feasible to deliver the entire pattern to the end user in this manner.

The advantages of using this technique are that the pattern file can be updated by the antivirus software provider whenever a new pattern is available and there is no need to wait for the user to initiate an action. Essentially the entire pattern file is pushed to the user s handset rather than only transferring a differential pattern there is no need to create a differential pattern nor run the risks of only sending the differential. Further the pattern file format does not need to be redesigned to allow for updating via a differential pattern. As most mobile device operators support MMS this is a viable option for most all users.

The update source returns the new pattern to the mobile management center over a TCP IP connection. The mobile management center then sends the new pattern via an MMS message to an MMSC Multimedia Message Service Center that then relays an MMS message incorporating the new pattern to the user s telephone . The antivirus software on the telephone then replaces the old pattern with the new pattern in order to utilize the new pattern.

In one embodiment the mobile management center checks the pattern update server s latest pattern version via a TCP IP connection. If the MMC finds a new pattern available it downloads the new pattern so that the new pattern may be distributed to all mobile devices that it manages. Often the mobile operator s MMSC provides and sends the MMS application programming interface API to the developer thus enabling a developer to send an MMS message via the MMSC.

At the center attaches the pattern file to an MMS message and sends the message to a user s mobile wireless device using the MMSC . At the MMSC relays the received MMS message and the attached pattern file to the user s mobile device using standard technology such as WAP or WAP . At the user s mobile device extracts the attached pattern file from the MMS message and overwrites the existing pattern file with the new pattern file. Various techniques for performing this step are described below.

At the MMC encrypts File A and outputs the encrypted file File B. At the MMC adds the extension .txt to File B thus producing File C. At the MMC loads the mobile telephone number list of its supported mobile devices from its database. This list is a list of all the numbers of mobile devices that have arranged with MMC to periodically update pattern files on the device. At the MMC sends File C and the mobile number list to MMSC server . At the MMSC responds that it has received the file and the number list the MMSC server accepts File C and prepares an MMS transmission using File C. 

At the MMSC sends this MMS transmission including File C to each of the telephone numbers in the list representing the mobile devices needing a pattern update. At the mobile device verifies the received MMS message and extracts the pattern file from the MMS message. If the extraction is a success the mobile device uses the pattern file to update its particular virus pattern.

As mentioned above a new pattern file may be delivered to any suitable handheld mobile device using MMS according to embodiments of this invention. In particular embodiments the mobile wireless device is a mobile telephone. Specifically the mobile telephone may be running an operating system such as the Symbian operating system or the Windows Mobile operating system for. The below description describes how the pattern file is retrieved from the MMS message and incorporated into the antivirus software on the user s mobile telephone using each of these operating systems although the present invention is also applicable to other operating systems and other mobile devices.

At the mobile device checks whether a pattern file is attached to the MMS message. In one embodiment it is determined whether the attached file is a valid virus pattern file by first decrypting the attached file and then checking the previously included magic number. If the magic number matches the number expected by the software module on the mobile device then it is determined that the attached file is a valid pattern file.

At the pattern file is extracted from the MMS message and is used to overwrite the existing pattern file in the antivirus software on the mobile device. In one embodiment the operating system of the mobile device provides an API to extract the attached pattern file from the MMS message. The antivirus software on the mobile device can also follow the WAP or WAP protocols to extract the pattern file. Once the pattern file has been extracted from the message the antivirus software uses the new pattern file to replace the current pattern file at .

In one embodiment extraction of the pattern file from the MMS message occurs under the Microsoft Mobile operating system. In this embodiment the antivirus software periodically checks the MMS inbox or uses an API hook to check whether a new MMS message has arrived. Next the software extracts the attachment of the MMS message and checks whether it is a virus pattern using the magic number. If so the pattern file or pattern files are extracted from the attached file. Next the old pattern file or files are replaced by the new file or files.

In one specific embodiment of the invention the invention is integrated with the product Trend Micro Mobile Security TMMS version 2.0 available from Trend Micro Inc. of Cupertino Calif. TMSS helps protect data centric mobile devices such as smart phones and wireless handheld devices from computer viruses and SMS spam. The product TMMS is compatible with the Microsoft Mobile operating systems and with the Symbian versions 7 and 8 operating systems. The pattern files used with Mobile Security are small enough to be sent via MMS and are on the order of about 40 kB. Mobile Security is able to perform automatic real time scanning and detection of viruses and other malware on wireless mobile devices and their storage cards. Mobile users may also initiate manual scans.

Mobile Security can also receive updated pattern files via general packet radio service GPRS or by synchronizing with antivirus pattern file updates on a local PC. Mobile Security takes advantage of TrendLabs a global antivirus research and support team of engineers from Trend Micro who monitor virus activity develop information on new threats and deliver security products to customers.

The present invention may also be used in the context of all malicious software or malware that generally causes harm to a computer system provides an effect that is not expected by the user is undesirable illegal or otherwise causes the user to want to restore their computer system from a time prior to when it was infected by the malware. Malware can be classified based upon how is executed how it spreads or what it does. The below descriptions are provided as guidelines for the types of malware currently existing these classifications are not exact in that many groups overlap. For example commercially available so called anti virus software is designed to scan a computer for viruses and worms as well as for other malicious software. Of course later developed software not currently known may also fall within the definition of malware. As used herein the term malware is used to describe both the examples of malware and grayware described below.

When computer viruses first originated common targets were executable files and the boot sectors of floppy disks later targets were documents that contain macro scripts and more recently many computer viruses have embedded themselves in e mail as attachments. With executable files the virus arranges that when the host code is executed the virus code is executed as well. Normally the host program continues to function after it is infected by the virus. Some viruses overwrite other programs with copies of themselves thus destroying the program. Viruses often spread across computers when the software or document to which they are attached is transferred from one computer to another.

Computer worms are similar to viruses but are stand alone software and thus do not require host files or other types of host code to spread themselves they can move over the Internet using e mail or socket connections. They do modify the host operating system however at least to the extent that they are started as part of the boot process. In order to execute worms either exploit some vulnerability of the target host or use some kind of social engineering to trick users into executing them. Once executed a computer worm might drop a backdoor program or a computer virus. Computer viruses and worms have common characteristics and that they both can propagate they are covert and their effects can be devastating. Other differences are that a virus will attack the affected program while it is running while a worm can attack other programs viruses typically attack local files while worms typically attack remote network computers.

A Trojan horse program is a harmful piece of software that is often disguised as legitimate software. Trojan horses cannot replicate themselves unlike viruses or worms. A Trojan horse can be deliberately attached to otherwise useful software by a programmer or can be spread by tricking users into believing that it is useful. Some Trojan horses can spread or activate other malware such as viruses a dropper . A wabbit is a third uncommon type of self replicating malware. Unlike viruses wabbits do not infect host programs or documents. And unlike worms rabbits do not use network functionality to spread to other computers. A simple example of a wabbit is a fork bomb.

A backdoor is a piece of software that allows access to the computer system by bypassing the normal authentication procedures. There are two groups of backdoors depending upon how they work and spread. The first group work much like a Trojan horse i.e. they are manually inserted into another piece of software executed via their host software and spread by the host software being installed. The second group work more like a worm in that they get executed as part of the boot process and are usually spread by worms carrying them as their payload. The term ratware has arisen to describe backdoor malware that turns computers into zombies for sending spam.

An exploit is a piece of software that attacks a particular security vulnerability. Exploits are not necessarily malicious in intent they are often devised by security researchers as a way of demonstrating that vulnerability exists. They are however a common component of malicious programs such as network worms. A root kit is software inserted onto a computer system after an attacker has gained control of the system. Root kits often include functions to hide the traces of the attack as by deleting logged entries or by cloaking the attacker s processes. Root kits might include backdoors allowing the attacker to easily regain access later or to exploit software to attack other systems. Because they often hook into the operating system at the kernel level to hide their presence root kits can be very hard to detect.

Key logger software is software that copies a computer user s keystrokes to a file which it may send to a hacker at a later time. Often the key logger software will only awaken when a computer user connects to a secure web site such as a bank. It then logs the keystrokes which may include account numbers PINs and passwords before they are encrypted by the secure web site. Software known as URL injection software modifies a browser s behavior with respect to some or all domains. It modifies the URL submitted to the server to profit from a given scheme by the content provider of the given domain. This activity is often transparent to the user.

A robot network or botnet is a large number of compromised computers that are used to create denial of service attacks or to send spam autonomously also termed a zombie army . A target computer is often compromised via a Trojan horse that opens an IRC channel and waits for remote commands from the person in control of the botnet. The software of the botnet botware may be run as an independent process but it tends to run inside other normal processes.

Other techniques used by malware include the following. A remote buffer overflow attack takes advantage of a security flaw in a computer and can be used by a worm botnet or by a hacker s remote control. Remote thread injection is a software development technique used to inject code into another process to run it as a thread. A hacker can use this same technology to propagate others processes without any file operations in order to disguise malware.

Another category of undesirable software is grayware. Grayware includes applications that cause annoying and possibly undesirable or unforeseen behavior in the way the programs run. Grayware is not necessarily detrimental to basic system operations but it harbors the risk of opening computer vulnerabilities. Some applications classified as grayware are misused for malicious activity while others together and transmit information about a computer user s behavior. Grayware includes spyware adware dialers hacking tools joke programs and remote access tools.

Spyware is a piece of software that collects and sends information such as browsing patterns or credit card numbers about users and the results of their computer activity without explicit notification. Spyware usually works and spreads like Trojan horses. Adware is software that displays banner advertisements or pop up advertisements when a computer is in use. Adware can have undesired effects on the system such as interrupting an Internet connection or system operations and is generally regarded as irritating and intrusive by users. A dialer is a program that replaces the telephone number in a modem s dial up connection with a long distance number often out of the country in order to run up telephone charges on pay per dial numbers or dials out at night to send key logger or other information to a hacker.

Hacking tools render a computer or network more vulnerable to attack or use simulated hacking to test the vulnerability of accessible components. Hacking tools can be used to spy on an entire network and make it easy to exploit vulnerabilities. Although used to test the security of networks they can be misused. Joke programs are relatively harmless although they can be annoying such as by simulating a virus attack. Remote access tools enable remote access to an infected computer thus permitting outside administration or manipulation. These tools are legitimate tools for managing external computers although they can be used to exploit vulnerabilities and can be misused. Mobile messaging malware MMM is malware propagated via a mobile messaging system including MMS SMS or WAP push messages.

CPU is also coupled to a variety of input output devices such as display keyboard mouse and speakers . In general an input output device may be any of video displays track balls mice keyboards microphones touch sensitive displays transducer card readers magnetic or paper tape readers tablets styluses voice or handwriting recognizers biometrics readers or other computers. CPU optionally may be coupled to another computer or telecommunications network using network interface . With such a network interface it is contemplated that the CPU might receive information from the network or might output information to the network in the course of performing the above described method steps. Furthermore method embodiments of the present invention may execute solely upon CPU or may execute over a network such as the Internet in conjunction with a remote CPU that shares a portion of the processing.

In addition embodiments of the present invention further relate to computer storage products with a computer readable medium that have computer code thereon for performing various computer implemented operations. The media and computer code may be those specially designed and constructed for the purposes of the present invention or they may be of the kind well known and available to those having skill in the computer software arts. Examples of computer readable media include but are not limited to magnetic media such as hard disks floppy disks and magnetic tape optical media such as CD ROMs and holographic devices magneto optical media such as floptical disks and hardware devices that are specially configured to store and execute program code such as application specific integrated circuits ASICs programmable logic devices PLDs and ROM and RAM devices. Examples of computer code include machine code such as produced by a compiler and files containing higher level code that are executed by a computer using an interpreter.

Although the foregoing invention has been described in some detail for purposes of clarity of understanding it will be apparent that certain changes and modifications may be practiced within the scope of the appended claims. Therefore the described embodiments should be taken as illustrative and not restrictive and the invention should not be limited to the details given herein but should be defined by the following claims and their full scope of equivalents.

