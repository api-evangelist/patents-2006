---

title: Network routing
abstract: At least one device receives a call request from a calling party to a called party. The device routes the call request to an Internet Protocol Multimedia Subsystem (IMS) core when a first condition is met and bypasses the IMS core when a second condition is met.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08798253&OS=08798253&RS=08798253
owner: Verizon Patent and Licensing Inc.
number: 08798253
owner_city: Basking Ridge
owner_country: US
publication_date: 20060728
---
The present application claims priority to U.S. Provisional Patent Application No. 60 703 812 filed Jul. 29 2005 and U.S. Provisional Patent Application No. 60 764 748 filed Feb. 3 2006. The entire contents of both provisional applications are incorporated herein by reference in their entireties.

The Internet Protocol Multimedia Subsystem IMS provides mobile and fixed multimedia services. The aim of IMS is not only to provide new services but all the services current and future that the Internet provides. In this way IMS gives network operators and service providers the ability to control and charge for each service. In addition users are given the ability to execute services from their home networks as well as when the users are roaming.

The following detailed description of implementations consistent with principles of the invention refers to the accompanying drawings. The same reference numbers in different drawings may identify the same or similar elements. Also the following detailed description does not limit the invention. Instead the scope of the invention is defined by the appended claims and their equivalents.

Implementations consistent with principles of the invention relate to routing traffic in relation to an Internet Protocol IP Multimedia Subsystem IMS also referred to as an IMS core or IMS platform . The IMS core may be used for routing calls data sessions from various originations towards various destinations with possible invocation of value added service during processing and routing determination. Calls not involving IMS subscriber endpoints or IMS based applications may bypass the IMS core for operational efficiency i.e. latency .

It will be appreciated that the telephony terminology that is used herein covers the United States based PSTN structure. Implementations consistent with principles of the invention are not so limited. For example implementations consistent with principles of the invention are equally applicable to other communication networks.

S CSCF I CSCF and P CSCF may be considered call session control components in system . The call control components may be responsible for parsing a session e.g. a session initiation protocol SIP session and applying logic e.g. business logic service logic operational logic etc. on a per event basis. The outcome of the session control may be to route an event to the appropriate components and or append SIP headers and values.

S CSCF may be viewed as the brain of the IMS core. S CSCF may perform session control and registration services for the users of the IMS core. S CSCF may receive a user profile from HSS and route sessions requested by an IMS user also called an IMS subscriber or subscriber . Additionally S CSCF may perform user authentication based on information from HSS .

In some implementations S CSCF may include a Service Capability Interaction Manager SCIM and Resource Management RM functions. The SCIM may be responsible for orchestrating the offerings of one or more application services across various service enabling technologies and platforms to produce valued services for IMS users. The RM may be responsible for executing business rules and service level agreements SLAs by allocating the appropriate resources.

I CSCF may act as the main point of contact for connections to subscribers served by other IP networks. I CSCF may be located at the edge of the IMS core. I CSCF may receive SIP messages and identify the next hops for the SIP messages. To achieve this I CSCF may query HSS for the location e.g. an address of the appropriate S CSCF to which a particular SIP message is to be forwarded.

P CSCF may act as the main point of contact for connections to subscribers of the local IMS. As such P CSCF may validate requests forward the requests to selected destinations and process and forward the responses. P CSCF may generate chargeable events and send information relating to the chargeable events to CF . Additionally P CSCF may interact with PDF to grant reject or downgrade a session request based on platform resources and quality of service QoS measurements.

HSS may include one or more servers that act as the central repository for user related information. HSS may contain user related subscription information for handling multimedia sessions. Some of the information contained in HSS may include information identifying the location of a particular S CSCF for a particular user. As indicated above the location of a particular S CSCF may be conveyed to I CSCF upon receiving a query from a network element. HSS may also include user profile information that contains service trigger points and information identifying the corresponding resources e.g. applications media services etc. that offer the services. The user profile information may be forwarded to S CSCF for session control and service treatment. Moreover HSS may provide and receive updates directly from application servers .

SLF may include one or more databases that contain service location information for subscribers. SLF may receive a query containing identification information for a subscriber from I CSCF and return based on the subscriber identification information information identifying an HSS that serves the subscriber.

System may include various components that bridge the IMS core to external networks such as a public switched telephone network PSTN the Internet etc. These components which may include MGW function MGCF SLG NGW BGCF and BIGCF may perform protocol conversion and event routing to or from the IMS core.

MGW function may connect PSTN networks and the IMS core. In one implementation MGW function may terminate bearer channels from a PSTN network and media steams from the IMS core e.g. real time transport protocol RTP streams in an IP network or Asynchronous transfer mode Adaptation Layer 2 AAL2 ATM connections in an ATM backbone execute the conversion between these terminations and perform transcoding and signal processing. In addition MGW function may provide tones and announcements to Circuit Switched CS users. In one implementation consistent with principles of the invention MGW function may operate under the control of MGCF .

MGCF may be part of the gateway infrastructure that enables communication between the IMS core and PSTN networks. MGCF may perform protocol conversion between the Integrated Services Digital Network ISDN User Part ISUP or Primary Rate Interface PRI and SIP protocols before forwarding a session to the IMS core. In similar fashion IMS originated sessions directed towards PSTN users may traverse MGCF . MGCF may control media channels in MGW . In addition MGCF may report account information to CF .

SLG may include an MGCF and a set of associated MGW entities within the same physical entity. SLG may connect the IMS core to the local exchange layer of the PSTN. In one implementation the interfaces between SLG and the local exchange networks may include DS0 or Digital Signal 1 DS1 based Non Facilities Associated Signaling NFAS PRIs.

NGW may include an MGCF and a set of associated MGW entities which physically reside in a separate physical entities. NGW may connect the IMS core to the Long Distance layer of the PSTN. In one implementation the interfaces between MGCF of NGW and the Long Distance networks may include DS0 or DS1 based signaling system 7 SS7 interfaces and the interfaces between MGW of NGW and the Long Distance networks may include DS1 bearer channels.

BGCF may connect IMS initiated calls to Circuit Switch CS customers e.g. an IMS user calling a telephone number in the PSTN . BGCF may based on a routing policy select an appropriate network in which the connection is to be made or may select the appropriate MGCF to the other network.

BIGCF may correspond to an ingress point that handles incoming calls from PSTN gateways e.g. NGW SLG I SBC wholesale gateways other IP based carriers e.g. based on Voice over Internet Protocol VoIP peering agreements Emergency Services Peering Points etc. BIGCF may route calls from and to non IMS subscribers. BIGCF may route calls to the IMS core when the calls are destined for IMS subscribers or when IMS applications are invoked or may bypass the IMS core elements P CSCF I CSCF S CSCF HSS etc. when calls are destined for non IMS subscribers and no IMS applications are invoked by the calling party or called party. BIGCF may route calls to PSTN based termination points to BGCF and route calls to IP based termination points e.g. a wholesale termination point IP based carriers etc. directly to I SBCs associated with the IP based termination points. BIGCF may include static routing policies to route emergency calls to BGCF . BIGCF may also support static routing policies to route non emergency calls from certain originations e.g. a wholesale gateway requiring prepaid authorization for non emergency calls to pre paid service controllers. If calls are either from and or to IMS subscribers or IMS applications or services are invoked BIGCF may route the calls to the IMS core using I CSCF to invoke calling and or called party features.

BIGCF may include a group of configuration data. For example BIGCF may maintain a list of served hosts. If the request uniform resource indicator R URI domain in the incoming request does not identify one of the served hosts BIGCF may either proxy the call externally to an address resolved by a Domain Name Service DNS service SRV record or reject the call by sending a session initiation protocol SIP response or other type of message unless the call is an emergency call. In this way BIGCF may reject calls destined for unknown entities.

BIGCF may also include a list of emergency prefixes on a per country basis. For example BIGCF may store the prefix 911 for the United States. BIGCF may store a list of non geographic numbers per country of origin e.g. 800 411 etc. . Via this list BIGCF may route calls directly for PSTN breakout.

BIGCF may further store a list of originating hosts e.g. gateway uniform resource locators URLs from which calls may be expected. If a call is not from one of the hosts in the list of origination hosts either in the second topmost via or first via BIGCF may reject the request. The originating host based data may include a number of data elements. For example the data elements may include a gateway IP address of one or more hostnames. The originating hosts may point to prefix suffix information to normalize the calling party number. For example a wholesale gateway origination may have a rule indicating that if 7 digits are given in the calling party number then prefix the calling party number with 1732. The suffix information may indicate how many digits to consider after the suffix.

The originating hosts may identify a location of the calling party identity indicators. For example the originating hosts may identify from which header in a SIP INVITE message to retrieve the calling party information.

The data elements may also include the country or location of the gateway. This location may be used by BIGCF to normalize the called party number based on the country of origination of the call. The location of the gateway may also be used by BIGCF to identify a location of a gateway to which an emergency call is to be routed.

The data elements may further include a list of blocked prefixes from each origination host. For example 1900 may indicate that 1 900 calling is blocked from this gateway. The data elements may further include an outbound route for each origination host. For example non emergency calls from a given host may be routed to a configured host such as a pre paid service controller.

In addition to the above data BIGCF may be configured with the following data a variable to either allow or reject processing of an INVITE where the request URI does not match one of the configured served hosts an option per originating domain or IP address to accept or reject the request an option to process certain SIP requests a prefix per origination that is not allowed static routing rules based on prefix matching a server group pointing to a farm of ENUM servers a server group pointing to a farm of I CSCF servers for routing to the IMS core a server group pointing to a farm of BGCF servers for bypassing the IMS core and routing directly to BGCF a server group pointing to a farm of Emergency Services Positioning Servers which may be part of the U.S. emergency service network an option to specify that certain message s are to be directed to an error log or an on screen display an option to place a gateway in service and place a gateway out of service in BIGCF country codes needed for number normalizations number normalization rules e.g. based on originating gateway an option for enabling or disabling logging categories an option for enabling or disabling alarms and an option for enabling or disabling metrics.

In one implementation consistent with principles of the invention BIGCF may connect to I CSCF SLG NGW and BGCF via SIP interfaces. Additionally BIGCF may connect to ENUM via a DNS protocol interface.

The IMS core may provide shared multimedia services. Examples of multimedia services or applications include playing announcements audio video recording and playback Interactive Voice Response IVR fax reception and transmission Automatic Speech Recognition ASR Text To Speech TTS session multimedia conferencing customized ring back tones Push to talk Over Cellular PoC video messaging etc. MRF may be part of the IMS core and may support services that use multimedia streams.

As illustrated in MRF may include MRFC MREP and MRB . MRFC and MRFP are the IMS resources that provide support for bearer related services e.g. multi party sessions announcements to a user bearer transcoding etc. . MRFC may provide bearer control related services. MRFP may provide user plane resources that may be requested and instructed by MRFC . MRB may provide a resource management function that is able to allow media resources to become common resources shared among multiple applications.

Application Servers AS may include one or more servers that provide enhanced audio video messaging and data services within the application layer of system . Application servers may be accessible to the users of the IMS core and provide value added multimedia services to those users. Application servers may submit charges to the IMS core for the services that application servers provide to the IMS user community.

Two types of application servers that may be used within system may include micro applications and macro applications or macro application services . Micro applications may be provided on a common services delivery platform through the use of SCE logic . Micro applications may include a wide variety of enhanced multimedia services that need a rapid development and deployment cycle. Macro application services may include Hosted IP CENTREX HIPC Unified Messaging UM and Carrier Application Service .

HIPC may correspond to a type of Private Branch Exchange PBX service in which switching occurs at a local telephone office instead of at the company premises where the traditional PBX is located. In one implementation HIPC may be replaced by or supplemented with a SIP Voice Features server. Unified messaging may allow users to be able to retrieve and send voice messages from a single interface regardless of the technology e.g. telephone personal computer etc. and may provide other unified messaging services e.g. fax deposit retrieval voice to email etc. . Carrier AS may facilitate tool free call processing.

SCE logic may provide a foundation for rapid development of next generation services. SCE may support Java Specification Request JSR SIP Servlet and a suite of externalized application programming interfaces APIs for developers to gain access to the IMS core. A single SCE may support a number of macro application servers and may support the building of micro applications.

The IMS core may support a number of different services such as GLMS Presence and ENUM server . GLMS may include one or more services that allow for group list creation management and use across multiple applications within the IMS core. GLMS may enforce access and visibility rules. Presence may include one or more services that automate the task of aggregating both presence and availability information. Presence may inform one user about the status of another user s availability and willingness to communicate. Presence servers may use a Presence User Agent PUA to manage the presence of the IMS subscribers and handle presence subscription requests. For example an application or an IMS subscriber may act as a watcher which is an entity that subscribes to presence information provided by Presence Server . ENUM server may provide translation of E.164 to SIP URIs. BIGCF and S CSCF may query ENUM server to determine a next hop for a call. In some implementations consistent with principles of the invention BIGCF may execute ENUM queries for both calling and called number resolution.

The IMS core may include one or more Session Border Controllers SBCs that provide control of the boundary between different service provider networks provide signaling protocol inter working between the SIP based IMS core and other service provider networks control the transport boundary between service provider networks and provide usage metering and Quality of Service QoS measurements for media flows. Two types of SBCs that may be associated with the IMS core are the Access Session Border Controller A SBC and the I SBC .

A SBC may correspond to an ingress point to the IMS core for Customer Premises Equipment CPE traffic. A SBC may provide SIP aware firewall capabilities that support network address translation NAT prevent denial of service DoS attacks and execute other security enforcement features. A SBC may be the first SIP events normalization point prior to the IMS core. In one implementation A SBC may be replaced by or supplemented with a border gateway function.

Internetworking Session Border Controller I SBC may serve as a connection point between the IMS core and wholesale gateways and also between the IMS core and IP peering VoIP carriers. I SBC may provide SIP normalization and Topology Hiding and Internetwork Gateway THIG services. In one implementation I SBC may be replaced by or supplemented with a Border Gateway Function BGF .

System may include a number of policy components. For example system may as illustrated in include a policy engine a PDF and a RM . Policy engine may include one or more rule based engines that govern subscriber access to the IMS core subscriber access to resources and routing decisions for several different types of event requests made within the IMS core. In one implementation policy engine may provide decision logic to decision and policy points within the IMS core. PDF may correspond to a Policy Decision Point PDP for service based local policy control. PDF may make policy decisions based on session and media related information. PDF may exchange this decision information with another IMS element such as A SBC or I SBC to control the flow and characteristics of the communication link. RM may be used to execute a policy at the component level. As illustrated in RM Resource Management may be associated with for example S CSCF BIGCF A SBC and I SBC . In one implementation RM may store and execute the policy decisions that are relevant for the location at which RM is associated.

CF may include a unified system for affecting both offline charging and online charging. Offline charging is a process where charging information for network resource usage is collected concurrently with that resource usage. The charging information may be passed through a chain of CFs . At the end of this process Call Detail Record CDR files may be generated by the network which may then be transferred to the network operator s billing domain for the purpose of subscriber billing processing which may includes rating and rendering.

Online charging is a process where charging information can affect in real time the service rendered. Support of this capability may include direct interaction between the charging mechanism and the network s session control mechanism. An example of online charging includes pre paid calling card usage.

CDF may compile chargeable events gathered from IMS components into a single CDR for offline billing activities. CDF may gather the chargeable events from a Charging Trigger Function CTF that may be associated with components of system and after creating the CDR pass the billing data to the CGF .

CGF may act as a gateway between both the offline charging system the online system and an external post processing system such as a billing domain.

Information related to IMS subscribers may be in many formats managed by many network elements and administrations. This complicates access to that data for users network elements and value added service providers. Generic User Profile GUP addresses this problem providing a common conceptual description of subscriber data. A GUP server may provide a means to access the data described in GUP .

Bus may permit communication among the components of BIGCF . Processing logic may include any type of processor or microprocessor that interprets and executes instructions. In other implementations processing logic may be implemented as or include an Application Specific Integrated Circuit ASIC Field Programmable Gate Array FPGA or the like. Memory may include a random access memory RAM or another type of dynamic storage device that stores information and instructions for execution by processing logic a read only memory ROM or another type of static storage device that stores static information and instructions for the processing logic and or some other type of magnetic or optical recording medium and its corresponding drive for storing information and or instructions.

Input device may include a device that permits an operator to input information to BIGCF such as a keyboard a keypad a mouse a pen a microphone one or more biometric mechanisms and the like. Output device may include a device that outputs information to the operator such as a display a speaker etc.

Communication interface may include any transceiver like mechanism that enables BIGCF to communicate with other devices and or systems. For example communication interface may include mechanisms for communicating with other components within system .

As will be described in detail below BIGCF may perform processing associated with routing calls from and to non IMS subscribers. BIGCF may perform these and other functions in response to processing logic executing software instructions contained in a computer readable medium such as memory . A computer readable medium may be defined as one or more memory devices and or carrier waves. The software instructions may be read into memory from another computer readable medium or from another device via communication interface . The software instructions contained in memory may cause processing logic to perform processes that will be described later. Alternatively hardwired circuitry may be used in place of or in combination with software instructions to implement processes consistent with the principles of the invention. Thus systems and methods consistent with the principles of the invention are not limited to any specific combination of hardware circuitry and software.

BIGCF may determine whether the call involves the IMS core act . To make this determination BIGCF may send a query to ENUM server to determine if the calling party number is served by the IMS core. For example if the calling party number is associated with an IMS profile that invokes an IMS application BIGCF may determine that the call involves the IMS core. BIGCF may send a query to ENUM server to determine if the called party number is served by the IMS core. For example if the called party number is associated with an IMS subscriber or is associated with an IMS profile that invokes an IMS application BIGCF may determine that the call involves the IMS core. On the other hand if the call does not involve an IMS application or is not destined for an IMS subscriber BIGCF may determine that the call does not involve the IMS core.

If BIGCF determines that the call involves the IMS core BIGCF may route the call request to the IMS core to perform origination and or termination IMS services act . BIGCG may for example forward the call request to I CSCF of the IMS core for forwarding to the appropriate S CSCF for processing. S CSCF may invoke the appropriate IMS service s and or forward the call request toward the appropriate IMS subscriber.

If on the other hand BIGCF determines that the call does not involve the IMS core BIGCF may route the call request toward the appropriate destination bypassing the IMS core act . BIGCF may for example forward the call request to BGCF for routing to an appropriate PSTN termination point or to an appropriate I SBC for routing to a wholesale or IP based carrier termination point.

If the call request is associated with a served domain BIGCF may determine if the originating host is known act . For example BIGCF may compare the originating host to a list of originating hosts. If the originating host does not match a host in the list of originating hosts BIGCF may reject the call by sending a SIP response or another type of response acts .

BIGCF may analyze the user portion of the Request URI and if it is a numeric string BIGCF may look up this numeric string in a list of emergency numbers for a country which is associated with an originating host act and act . BIGCF may route emergency calls to BGCF bypassing the IMS core act . When the call is determined to be an emergency call BIGCF may insert an emergency call indicator.

For non emergency calls BIGCF may apply static routing rules based on the originating hosts act . For example regardless of the prefix BIGCF may route calls from a given host to a configured address. For example BIGCF may route calls from a certain gateway to a pre paid service controller act . BIGCF may also block calls from certain originations. For example BIGCF may block non emergency calls from an Emergency Services Peering Point.

In one implementation BIGCF may support a routing policy where BIGCF routes a called number matching a prefix in a list of prefixes directly to BGCF act . This list of prefixes e.g. non geographic numbers may be specific to a country and may be configurable per originating host. As an example if the IMS does not provide the associated freephone service BIGCF may route 1 800 calls directly to BGCF .

After applying static routing rules based on prefix origination or a combination of both act BIGCF may apply call post screening processing based on configured rules on the originating party domain or IP address coupled with the dialed digits called party identity act . As one example a rule may cause BIGCF to reject any call if the identified prefix per originating domain is configured to be blocked.

When the call is not routed through a static rule BIGCF may perform calling party number CgPN normalization based on the entity that originated the call act . In this situation normalization rules may be configured corresponding to the originating gateways. In some situations the normalization may not result in an E.164 format e.g. if the calling party identity is not normalizable or specific rules per originating gateways are not available .

BIGCF may normalize the called party number CdPN e.g. adding or stripping digits adding etc. based on rules for the country code from the calling party number and the dialed digits act . For example if the calling party is in the United States and the calling party number has 10 digits the prefix 1 may be added. In some situations an E.164 format may not be achieved if the called party identity is not normalizable.

If BIGCF successfully normalizes the called party number act BIGCF may put the normalized number in a Request URI for ENUM resolution and may save the originally dialed digits for possible eventual consumption by BGCF . In one implementation consistent with principles of the invention BIGCF may save the originally dialed digits from the received request URI in the History Info header of the request.

BIGCF may select an outbound route e.g. a route to I CSCF BGCF or I SBC in cases where the calling and or called party numbers are not in E.164 format act . Table 1 provides possible route selections that may be performed by BIGCF .

Assume that BIGCF receives the call request from SLG NGW or I SBC . BIGCF may generate two DNS Naming Authority Pointer NAPTR queries towards ENUM if the called and calling party numbers are in E.164 format acts . Table 2 provides an exemplary list of queries and possible responses to those queries. BIGCF may maintain a routing table to identify an I SBC to which the call is to be forwarded based on the host part of the SIP URIs returned from ENUM . The host part may identify the wholesale or VoIP peer gateway. In case of IMS core terminations the returned ENUM response may identify an I CSCF to which the call is to be forwarded.

BIGCF may use the above responses from the two NAPTR queries to route calls to the IMS core e.g. towards I CSCF or bypassing the IMS core I SBC . Table 3 below describes how a call is routed at BIGCF based on the responses received from ENUM server to the above two queries.

If no records exist for the NAPTR queries BIGCF may query the user ENUM. If there is a SIP URI returned from this query BIGCF may directly route the call to the address indicated in the host part of the SIP UPI. If this does not return a valid URI then BIGCF may route the call to BGCF act .

Once BIGCF finds the route to be used for a call BIGCF may perform post route selection screening act to check if the selected route is allowed. BIGCF may route the call based on above queries to either I CSCF in the IMS core towards BGCF or towards I SBC for IP based termination points act acts .

The following examples illustrate the processing described above with respect to FIGS. and A C. illustrates exemplary processing for routing a call from a wholesale subscriber to a PSTN termination point. In this example assume that neither the calling party i.e. the wholesale subscriber nor the called party i.e. the PSNT termination point invokes an IMS based application.

As illustrated in the call may be received from the wholesale subscriber at a wholesale service provider SP gateway GW with which the wholesale subscriber is associated. The wholesale service provider gateway may forward the call to I SBC of system .

Processing may begin with BIGCF receiving the call from I SBC act . In response to receiving the call BIGCF may query ENUM server e.g. using a NAPTR DNS query based on the calling party number to determine whether the calling party is served by the IMS core act . If the calling party is served by the IMS core the response from ENUM server may include information identifying an I CSCF for the IMS core. If on the other hand the calling party is not served by the IMS core the response from ENUM server may include a NXDOMAIN indicating that no record has been found in ENUM server or similar response code. BIGCF may also query ENUM server e.g. using a NAPTR DNS query based on the called party number to determine whether the called party is served by the IMS core act . If the called party is served by the IMS core the response from ENUM server may include information identifying an I CSCF for the IMS core. If on the other hand the called party is not served by the IMS core the response from ENUM server may include a NXDOMAIN or similar response code.

In this example BIGCF may determine that the call is to be directed to a PSTN termination point and that no IMS application is to be invoked. BIGCF may route the call to BGCF act . BGCF may identify a PSTN egress gateway for the call and route the call to the identified PSTN egress gateway act . The PSTN egress gateway may then route the call to the appropriate PSTN termination point. Therefore in this example BIGCF may cause the call to bypass the IMS core.

As illustrated in the call may be received from the calling party at a PSTN gateway GW . The PSTN gateway may forward the call to BIGCF .

Processing may begin with BIGCF receiving the call from the PSTN gateway act . In response to receiving the call BIGCF may query ENUM server e.g. using a NAPTR DNS query based on the calling party number to determine whether the calling party is served by the IMS core act . If the calling party is served by the IMS core the response from ENUM server may include information identifying an I CSCF for the IMS core. If on the other hand the calling party is not served by the IMS core the response from ENUM server may include a NXDOMAIN or similar response code. BIGCF may also query ENUM server e.g. using a NAPTR DNS query based on the called party number to determine whether the called party is served by the IMS core act . If the called party is served by the IMS core the response from ENUM server may include information identifying an I CSCF for the IMS core. It on the other hand the called party is not served by the IMS core the response from ENUM server may include a NXDOMAIN or similar response code.

In this example BIGCF may determine that the call is to be directed to a wholesale service provider gateway and that no IMS application is to be invoked. BIGCF may determine an egress point e.g. I SBC through which to access the wholesale service provider gateway identified in the ENUM response and route the call via that I SBC act to the wholesale service provider gateway. The wholesale service provider gateway may then route the call to the appropriate wholesale subscriber. Therefore in this example BIGCF may cause the call to bypass the IMS core.

As illustrated in the call may be received from the calling party at a PSTN gateway. The PSTN gateway may forward the call to BIGCF .

Processing may begin with BIGCF receiving the call from the PSTN gateway act . In response to receiving the call BIGCF may query ENUM server e.g. using a NAPTR DNS query based on the calling party number to determine whether the calling party is served by the IMS core act . If the calling party is served by the IMS core the response from ENUM server may include information identifying an I CSCF for the IMS core. If on the other hand the calling party is not served by the IMS core the response from ENUM server may include a NXDOMAIN or similar response code. BIGCF may also query ENUM server e.g. using a NAPTR DNS query based on the called party number to determine whether the called party is served by the IMS core act . If the called party is served by the IMS core the response from ENUM server may include information identifying an I CSCF for the IMS core. If on the other hand the called party is not served by the IMS core the response from ENUM server may include a NXDOMAIN or similar response code.

In this example BIGCF may determine that the call is to be directed to a PSTN termination point and that no IMS application is to be invoked. BIGCF may route the call to BGCF act . BGCF may identify a PSTN egress gateway for the call which may be the same PSTN gateway that received the call or a different PSTN gateway and route the call to the identified PSTN egress gateway act . The PSTN egress gateway may then route the call to the appropriate PSTN termination point. Therefore in this example BIGCF may cause the call to bypass the IMS core.

Processing may begin with BIGCF receiving the call from the PSTN gateway act . In response to receiving the call BIGCF may query ENUM server e.g. using a NAPTR DNS query based on the calling party number to determine whether the calling party is served by the IMS core act . If the calling party is served by the IMS core the response from ENUM server may include information identifying an I CSCF for the IMS core. If on the other hand the calling party is not served by the IMS core the response from ENUM server may include a NXDOMAIN or similar response code. BIGCF may also query ENUM server e.g. using a NAPTR DNS query based on the called party number to determine whether the called party is served by the IMS core act . If the called party is served by the IMS core the response from ENUM server may include information identifying an I CSCF for the IMS core. If on the other hand the called party is not served by the IMS core the response from ENUM server may include a NXDOMAIN or similar response code.

In this example BIGCF may determine that the called party is served by the IMS core. Thus the response from ENUM server may include information for routing the call to I CSCF of the IMS core. BIGCF may route the call to I CSCF act . I CSCF may route the call to the appropriate S CSCF which may retrieve information relating to the called party e.g. a profile from HSS not shown . S CSCF may forward the call to the A SBC with which the IMS user is associated act . Therefore in this example BIGCF may route the call through the IMS core.

Processing may begin with BIGCF receiving the call from I SBC act . In response to receiving the call BIGCF may query ENUM server e.g. using a NAPTR DNS query based on the calling party number to determine whether the calling party is served by the IMS core act . If the calling party is served by the IMS core the response from ENUM server may include information identifying an I CSCF for the IMS core. If on the other hand the calling party is not served by the IMS core the response from ENUM server may include a NXDOMAIN or similar response code. BIGCF may also query ENUM server e.g. using a NAPTR DNS query based on the called party number to determine whether the called party is served by the IMS core act . If the called party is served by the IMS core the response from ENUM server may include information identifying an I CSCF for the IMS core. If on the other hand the called party is not served by the IMS core the response from ENUM server may include a NXDOMAIN or similar response code.

In this example BIGCF may determine that the called party is served by the IMS core. Thus the response from ENUM server may include information for routing the call to I CSCF of the IMS core. BIGCF may route the call to I CSCF act . I CSCF may route the call to the appropriate S CSCF which may retrieve information relating to the called party e.g. a profile from HSS not shown . S CSCF may forward the call to the A SBC with which the IMS user is associated act . Therefore in this example BIGCF may route the call through the IMS core.

As illustrated in the call may be received from the wholesale subscriber at a wholesale service provider gateway. The wholesale service provider gateway may forward the call to I SBC of system .

Processing may begin with BIGCF receiving the call from I SBC act . In response to receiving the call BIGCF may query ENUM server e.g. using a NAPTR DNS query based on the calling party number to determine whether the calling party is served by the IMS core act . If the calling party is served by the IMS core the response from ENUM server may include information identifying an I CSCF for the IMS core. It on the other hand the calling party is not served by the IMS core the response from ENUM server may include a NXDOMAIN or similar response code. BIGCF may also query ENUM server e.g. using a NAPTR DNS query based on the called party number to determine whether the called party is served by the IMS core act . If the called party is served by the IMS core the response from ENUM server may include information identifying an I CSCF for the IMS core. If on the other hand the called party is not served by the IMS core the response from ENUM server may include a NXDOMAIN or similar response code.

In this example BIGCF may determine that the call is to be directed to the IMS core. Thus the response from ENUM server may include information for routing the call to I CSCF of the IMS core. BIGCF may route the call to I CSCF act . I CSCF may route the call to S CSCF which may perform the necessary application invocation. Since the call is directed to a PSTN termination point S CSCF may query ENUM server to map the called party number to a SIP URI act . S CSCF may route the call with the SIP URI to BGCF act .

BGCF may identify a PSTN egress gateway for the call and route the call to the identified PSTN egress gateway act . The PSTN egress gateway may then route the call to the appropriate PSTN termination point. Therefore in this example BIGCF may route the call through the IMS core for invoking one or more IMS applications for the call.

As illustrated in the call may be received from the calling party at a PSTN gateway GW . The PSTN gateway may forward the call to BIGCF .

Processing may begin with BIGCF receiving the call from the PSTN gateway act . In response to receiving the call BIGCF may query ENUM server e.g. using a NAPTR DNS query based on the calling party number to determine whether the calling party is served by the IMS core act . If the calling party is served by the IMS core the response from ENUM server may include information identifying an I CSCF for the IMS core. If on the other hand the calling party is not served by the IMS core the response from ENUM server may include a NXDOMAIN or similar response code. BIGCF may also query ENUM server e.g. using a NAPTR DNS query based on the called party number to determine whether the called party is served by the IMS core act . If the called party is served by the IMS core the response from ENUM server may include information identifying an I CSCF for the IMS core. If on the other hand the called party is not served by the IMS core the response from ENUM server may include a NXDOMAIN or similar response code.

In this example BIGCF may determine that the call is to be directed to the IMS core. Thus the response from ENUM server may include information for routing the call to I CSCF of the IMS core. BIGCF may route the call to I CSCF act . I CSCF may route the call to S CSCF which may perform the necessary application invocation. Since the call is directed to a wholesale subscriber S CSCF may query ENUM server to map the called party number to a SIP URI act . S CSCF may route the call with the SIP URI to a wholesale gateway via an I SBC associated with that gateway act . In another implementation S CSCF may use a static registration in the case where an IMS application is invoked for the called party to route the call to the wholesale subscriber.

The wholesale service provider gateway may then route the call to the appropriate wholesale subscriber. Therefore in this example BIGCF may route the call through the IMS core for invoking one or more IMS applications for the call.

As illustrated in the call may be received from the calling party at a PSTN gateway GW . The PSTN gateway may forward the call to BIGCF .

Processing may begin with BIGCF receiving the call from the PSTN gateway NGW or SLO act . In response to receiving the call BIGCF may query ENUM server e.g. using a NAPTR DNS query based on the calling party number to determine whether the calling party is served by the IMS core act . If the calling party is served by the IMS core the response from ENUM server may include information identifying an I CSCF for the IMS core. If on the other hand the calling party is not served by the IMS core the response from ENUM server may include a NXDOMAIN or similar response code. BIGCF may also query ENUM server e.g. using a NAPTR DNS query based on the called party number to determine whether the called party is served by the IMS core act . If the called party is served by the IMS core the response from ENUM server may include information identifying an I CSCF for the IMS core. If on the other hand the called party is not served by the IMS core the response from ENUM server may include a NXDOMAIN or similar response code.

In this example BIGCF may determine that the call is to be directed to the IMS core. Thus the response from ENUM server may include information for routing the call to I CSCF of the IMS core. BIGCF may route the call to I CSCF act . I CSCF may route the call to S CSCF which may perform the necessary application invocation. Since the call is directed to a PSTN termination point S CSCF may query ENUM server to map the called party number to a SIP URI act . S CSCF may route the call with the SIP URI to BGCF act .

BGCF may identify a PSTN egress gateway which may or may not be the same PSTN gateway that received the call and forwarded the call to BIGCF for the call and route the call to the identified PSTN egress gateway act . The PSTN egress gateway may then route the call to the appropriate PSTN termination point. Therefore in this example BIGCF may route the call through the IMS core for invoking one or more IMS applications for the call.

Implementations described herein provide a break in gateway control function that routes calls through an IMS core when needed. If a call involves an IMS subscriber or invokes an IMS application the break in gateway control function may route the call through the IMS core. If on the other hand a call does not involve an IMS subscriber or invoke an IMS application the break in gateway control function may bypass the IMS core.

The foregoing description of exemplary implementations provides illustration and description but is not intended to be exhaustive or to limit the invention to the precise form disclosed. Modifications and variations are possible in light of the above teachings or may be acquired from practice of the invention. For example the call routing situations described above are provided for explanatory purposes only. Other call routing situations are possible that rely on the break in gateway control function. For example calling routing from a wholesale subscriber VoIP peering subscriber to a wholesale subscriber VoIP peering subscriber may involve the break in gateway control function.

While series of acts have been described with respect to the order of the acts may be varied in other implementations consistent with the invention. Moreover non dependent acts may be implemented in parallel.

It will be apparent to one of ordinary skill in the art that aspects of the invention as described above may be implemented in many different forms of software firmware and hardware in the implementations illustrated in the figures. The actual software code or specialized control hardware used to implement aspects consistent with the principles of the invention is not limiting of the invention. Thus the operation and behavior of the aspects of the invention were described without reference to the specific software code it being understood that one of ordinary skill in the art would be able to design software and control hardware to implement the aspects based on the description herein.

Further certain portions of the invention may be implemented as logic that performs one or more functions. This logic may include hardware such as an application specific integrated circuit a field programmable gate array a processor or a microprocessor software or a combination of hardware and software.

Implementations consistent with principles of the invention are generally applicable to multimedia sessions implemented over an Internet Protocol infrastructure that uses E.164 numbers to identify endpoints. Neither the usage of terms e.g. call frequently associated with telephony nor the historic association of E.164 numbers with such services limits the scope or applicability of this invention.

No element act or instruction used in the description of the present application should be construed as critical or essential to the invention unless explicitly described as such. Also as used herein the article a is intended to include one or more items. Where only one item is intended the term one or similar language is used. Further the phrase based on is intended to mean based at least in part on unless explicitly stated otherwise.

