---

title: Method for operating a hybrid electric powertrain based on predictive effects upon an electrical energy storage device
abstract: A hybrid electric powertrain includes an electrical energy storage device and electric machines. A method for operating the powertrain to control the electric machines is effective to attain a predetermined state of life profile for the electric energy storage device.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08091667&OS=08091667&RS=08091667
owner: GM Global Technology Operations LLC
number: 08091667
owner_city: Detroit
owner_country: US
publication_date: 20060607
---
This invention pertains generally to an electrical energy storage device. More particularly the invention is concerned with predicting effects upon an electrical energy storage device and managing state of life based thereon.

Various hybrid propulsion systems for vehicles use electrical energy storage devices to supply electrical energy to electrical machines which are operable to provide motive torque to the vehicle often in conjunction with an internal combustion engine. An exemplary hybrid powertrain architecture comprises a two mode compound split electro mechanical transmission which utilizes an input member for receiving power from a prime mover power source and an output member for delivering power from the transmission to a vehicle driveline. First and second electric machines i.e. motor generators are operatively connected to an energy storage device for interchanging electrical power therebetween. A control unit is provided for regulating the electrical power interchange between the energy storage device and the electric machines. The control unit also regulates electrical power interchange between the first and second electric machines.

One of the design considerations in vehicle powertrain systems is an ability to provide consistent vehicle performance and component system service life. Hybrid vehicles and more specifically the battery pack systems utilized therewith provide vehicle system designers with new challenges and tradeoffs. It has been observed that service life of an electrical energy storage device e.g. a battery pack system increases as resting temperature of the battery pack decreases. However cold operating temperature introduces limits in battery charge discharge performance until temperature of the pack is increased. A warm battery pack is more able to supply required power to the vehicle propulsion system but continued warm temperature operation may result in diminished service life.

Modern hybrid vehicle systems manage various aspects of operation of the hybrid system to effect improved service life of the battery. For example depth of battery discharge is managed amp hour A h throughput is limited and convection fans are used to cool the battery pack. Ambient environmental conditions in which the vehicle is operated has largely been ignored. However the ambient environmental conditions may have significant effect upon battery service life. Specifically same models of hybrid vehicles released into various geographic areas throughout North America would likely not result in the same battery pack life even if all the vehicles were driven on the same cycle. The vehicle s environment must be considered if a useful estimation of battery life is to be derived. Additionally customer expectations competition and government regulations impose standards of performance including for service life of battery packs which must be met.

It would be useful to include in a hybrid control system an ability to estimate or otherwise determine a potential effect that an operating parameter e.g. electrical current level has on life of a battery pack in order to use such information to proactively control operation of the hybrid powertrain system to optimize battery life.

A hybrid electric powertrain includes an electrical energy storage device adapted for exchanging electrical energy with a hybrid vehicular powertrain including first and second electric machines. Each machine is operable to impart torque to a two mode compound split electro mechanical transmission having four fixed gear ratios and two continuously variable operating modes. A method for operating the powertrain includes establishing a plurality of values for current of the electrical energy storage device during periods of vehicle activity and for each respective value determining a corresponding change in state of life for the energy storage device based upon the respective value. The electric machines are operated based on the determined changes in state of life. Preferably the electric machines are operated to effect a predetermined state of life profile. In accordance with an embodiment such state of life profile is effected by limiting allowable electric machine currents in accordance with the determined changes in state of life and predetermined state of life profile. In accordance with an alternate embodiment such state of life profile is effected by establishing electric machine currents in accordance with the determined changes in state of life and predetermined state of life profile. Preferably change in the state of life is determined based upon an integration of electrical current a depth of discharge of the energy storage device and an operating temperature factor of the electrical energy storage device. Depth of discharge of the electrical energy storage device is preferably determined based upon the electrical current. And the operating temperature factor of the electrical energy storage device is determined based upon the electrical current and temperature of the electrical energy storage device.

Referring now to the drawings wherein the showings are for the purpose of illustrating the invention only and not for the purpose of limiting the same shows a control system and an exemplary hybrid powertrain system which has been constructed in accordance with an embodiment of the invention. The exemplary hybrid powertrain system comprises a plurality of torque generative devices operable to supply motive torque to a transmission device which supplies motive torque to a driveline. The torque generative devices preferably comprise an internal combustion engine and first and second electric machines operable to convert electrical energy supplied from an electrical storage device to motive torque. The exemplary transmission device comprises a two mode compound split electro mechanical transmission having four fixed gear ratios and includes a plurality of gears operable to transmit the motive torque to an output shaft and driveline through a plurality of torque transfer devices contained therein. Mechanical aspects of exemplary transmission are disclosed in detail in U.S. Pat. No. 6 953 409 entitled Two Mode Compound Split Hybrid Electro Mechanical Transmission having Four Fixed Ratios which is incorporated herein by reference.

The control system comprises a distributed control module architecture interacting via a local area communications network to provide ongoing control to the powertrain system including the engine the electrical machines and the transmission .

The exemplary powertrain system been constructed in accordance with an embodiment of the present invention. The hybrid transmission receives input torque from torque generative devices including the engine and the electrical machines as a result of energy conversion from fuel or electrical potential stored in electrical energy storage device ESD . The ESD typically comprises one or more batteries. Other electrical energy storage devices that have the ability to store electric power and dispense electric power may be used in place of the batteries without altering the concepts of the present invention. The ESD is preferably sized based upon factors including regenerative requirements application issues related to typical road grade and temperature and propulsion requirements such as emissions power assist and electric range. The ESD is high voltage DC coupled to transmission power inverter module TPIM via DC lines referred to as transfer conductor . The TPIM transfers electrical energy to the first electrical machine by transfer conductors and the TPIM similarly transfer electrical energy to the second electrical machine by transfer conductors . Electrical current is transferable between the electrical machines and the ESD in accordance with whether the ESD is being charged or discharged. TPIM includes the pair of power inverters and respective motor control modules configured to receive motor control commands and control inverter states therefrom to provide motor drive or regeneration functionality.

The electrical machines preferably comprise known motor generator devices. In motoring control the respective inverter receives current from the ESD and provides AC current to the respective motor over transfer conductors and . In regeneration control the respective inverter receives AC current from the motor over the respective transfer conductor and provides current to the DC lines . The net DC current provided to or from the inverters determines the charge or discharge operating mode of the electrical energy storage device . Preferably machine A and machine B are three phase AC electrical machines and the inverters comprise complementary three phase power electronic devices.

The elements shown in and described hereinafter comprise a subset of an overall vehicle control architecture and are operable to provide coordinated system control of the powertrain system described herein. The control system is operable to gather and synthesize pertinent information and inputs and execute algorithms to control various actuators to achieve control targets including such parameters as fuel economy emissions performance driveability and protection of hardware including batteries of ESD and machines A and B . The distributed control module architecture of the control system comprises an engine control module ECM transmission control module TCM battery pack control module BPCM and the Transmission Power Inverter Module TPIM . A hybrid control module HCP provides overarching control and coordination of the aforementioned control modules. There is a User Interface UI operably connected to a plurality of devices through which a vehicle operator typically controls or directs operation of the powertrain including the transmission . Exemplary vehicle operator inputs to the UI include an accelerator pedal a brake pedal transmission gear selector and vehicle speed cruise control. Within the control system each of the aforementioned control modules communicates with other control modules sensors and actuators via a local area network LAN communications bus . The LAN bus allows for structured communication of control parameters and commands between the various control modules. The specific communication protocol utilized is application specific. By way of example one communications protocol is the Society of Automotive Engineers standard J1939. The LAN bus and appropriate protocols provide for robust messaging and multi control module interfacing between the aforementioned control modules and other control modules providing functionality such as antilock brakes traction control and vehicle stability.

The HCP provides overarching control of the hybrid powertrain system serving to coordinate operation of the ECM TCM TPIM and BPCM . Based upon various input signals from the UI and the powertrain the HCP generates various commands including an engine torque command clutch torque commands for various clutches of the hybrid transmission and motor torque commands for the electrical machines A and B respectively.

The ECM is operably connected to the engine and functions to acquire data from a variety of sensors and control a variety of actuators respectively of the engine over a plurality of discrete lines collectively shown as aggregate line . The ECM receives the engine torque command from the HCP and generates an axle torque request. For simplicity ECM is shown generally having bi directional interface with engine via aggregate line . Various parameters that are sensed by ECM include engine coolant temperature engine input speed to the transmission manifold pressure ambient air temperature and ambient pressure. Various actuators that may be controlled by the ECM include fuel injectors ignition modules and throttle control modules.

The TCM is operably connected to the transmission and functions to acquire data from a variety of sensors and provide command control signals i.e. clutch torque commands to the clutches of the transmission.

The BPCM interacts with various sensors associated with the ESD to derive information about the state of the ESD to the HCP . Such sensors comprise voltage and electrical current sensors as well as ambient sensors operable to measure operating conditions of the ESD including e.g. temperature and internal resistance of the ESD . Sensed parameters include ESD voltage V ESD current I and ESD temperature T. Derived parameters preferably include ESD internal resistance R ESD state of charge SOC and other states of the ESD including available electrical power Pand P.

The Transmission Power Inverter Module TPIM includes the aforementioned power inverters and motor control modules configured to receive motor control commands and control inverter states therefrom to provide motor drive or regeneration functionality. The TPIM is operable to generate torque commands for machines A and B based upon input from the HCP which is driven by operator input through UI and system operating parameters. Motor torques are implemented by the control system including the TPIM to control the machines A and B. Individual motor speed signals are derived by the TPIM from the motor phase information or conventional rotation sensors. The TPIM determines and communicates motor speeds to the HCP .

Each of the aforementioned control modules of the control system is preferably a general purpose digital computer generally comprising a microprocessor or central processing unit read only memory ROM random access memory RAM electrically programmable read only memory EPROM high speed clock analog to digital A D and digital to analog D A circuitry and input output circuitry and devices I O and appropriate signal conditioning and buffer circuitry. Each control module has a set of control algorithms comprising resident program instructions and calibrations stored in ROM and executed to provide the respective functions of each computer. Information transfer between the various computers is preferably accomplished using the aforementioned LAN .

Algorithms for control and state estimation in each of the control modules are typically executed during preset loop cycles such that each algorithm is executed at least once each loop cycle. Algorithms stored in the non volatile memory devices are executed by one of the central processing units and are operable to monitor inputs from the sensing devices and execute control and diagnostic routines to control operation of the respective device using preset calibrations. Loop cycles are typically executed at regular intervals for example each 3.125 6.25 12.5 25 and 100 milliseconds during ongoing engine and vehicle operation. Alternatively algorithms may be executed in response to occurrence of an event.

The action described hereinafter occurs during active operation of the vehicle i.e. that period of time when operation of the engine and electrical machines are enabled by the vehicle operator typically through a key on action. Quiescent periods include periods of time when operation of the engine and electrical machines are disabled by the vehicle operator typically through a key off action. In response to an operator s action as captured by the UI the supervisory HCP control module and one or more of the other control modules determine required transmission output torque T. Selectively operated components of the hybrid transmission are appropriately controlled and manipulated to respond to the operator demand. For example in the exemplary embodiment shown in when the operator has selected a forward drive range and manipulates either the accelerator pedal or the brake pedal the HCP determines how and when the vehicle is to accelerate or decelerate. The HCP also monitors the parametric states of the torque generative devices and determines the output of the transmission required to effect a desired rate of acceleration or deceleration. Under the direction of the HCP the transmission operates over a range of output speeds from slow to fast in order to meet the operator demand.

Referring now to a method and apparatus to estimate a state of life SOL of an energy storage device useable in a hybrid control system in real time is described. The exemplary method and apparatus to estimate state of life SOL of the energy storage device in the hybrid control system in real time is disclosed in detail in U.S. patent application Ser. No. 11 422 691 entitled Method and Apparatus for Real time Life Estimation of an Electric Energy Storage Device in a Hybrid Vehicle which is incorporated herein by reference. The exemplary method and apparatus to estimate state of life comprises an algorithm that monitors an electrical current and a state of charge and temperature of the electrical energy storage device during operation. Temperature of the electrical energy storage device is further monitored during quiescent periods of ESD operation. Quiescent periods of ESD operation are characterized by ESD power flow that is de minimus whereas active periods of ESD operation are characterized by ESD power flow that is not de minimus. That is to say quiescent periods of ESD operation are generally characterized by no or minimal current flow into or out of the ESD. With respect to an ESD associated with a hybrid vehicle propulsion system for example quiescent periods of ESD operation may be associated with periods of vehicle inactivity e.g. powertrain including electric machines is inoperative such as during periods when the vehicle is not being driven and accessory loads are off but may include such periods characterized by parasitic current draws as are required for continuing certain controller operations including for example the operations associated with the present invention . Active periods of ESD operation in contrast may be associated with periods of vehicle activity e.g. accessory loads are on and or the powertrain including electric machines is operative such as during periods when the vehicle is being driven wherein current flows may be into or out of the ESD The state of life SOL of the electrical energy storage device is determined based upon the ESD current the state of charge of the ESD and the temperature of the ESD during quiescent and active periods of operation. The inputs to calculation of SOL include ESD internal resistance R ESD temperature T ESD state of charge SOC and ESD current I. These are known operating parameters measured or derived within the distributed control system. From these parameters an A h integration factor a depth of discharge DOD factor a driving temperature factor and a resting temperature factor T are determined and provided as input to determine a parameter for SOL. The operating parameters used to calculate SOL include ESD current I which is monitored in real time measured in amperes and integrated as a function of time magnitude of electrical current flowing through the ESD during each active charging and discharging event ESD state of charge SOC including depth of discharge DOD and ESD temperature factor during active periods of operation referred to as T. The inputs of R T SOC and I are known operating parameters within the distributed control system. The input Tis a derived parametric value.

Referring now to a schematic diagram of an algorithm preferably executed in one of the aforementioned control modules is described which is executed in the control system to pre calculate an array of possible changes in ESD state of life SOL for a subsequent time step k 1 for each control degree of freedom. In this embodiment the selected control degree of freedom comprises ESD current T. The algorithm is executed to determine an effect upon ESD state of life at a subsequent time step for the array of ESD electrical current levels to optimize vehicle operation and control based upon SOL of the ESD . This comprises estimating values for a change in SOL referred to as SOL over a range of current levels as follows.

SOLis a State of Life parameter calculated for a subsequent iteration k 1 typically a time step equal to elapsed time until the subsequent loop cycle in the control system 

SOLdelta x y comprises a vector containing a range of the parameters SOL wherein values for y are held constant while values for x are incremented over a range. The SOLdelta parameter determined is preferably used by the aforementioned hybrid vehicle control system for optimization in conjunction with other system constraints. This is shown graphically with reference to and specifically items and .

Referring again to the algorithm operates by monitoring input parameter T comprising temperature of the ESD at point in time k. The ESD current for the subsequent time step k 1 referred to as I comprises the aforementioned array of ESD electrical current values as shown at 138 in this instance from 200 amperes to 200 amperes in incremental values of 100 amperes wherein the positive and negative symbols refer to direction of current flow for charging and discharging of the ESD respectively. All other parameters right arrow over y in Eq. 1 to calculate SOLare held constant. The input parameters used in calculation of SOL including current integration depth of discharge factor driving temperature factor are determined for each value of ESD current for the subsequent time step I. A second array comprising a table of SOLvalues determined based upon ESD current I is calculated and useable by the control system to make decisions regarding subsequent operation of the vehicle.

Estimation of total cumulated effect on current A h integration component can be directly calculated for of the array of current values 138 in this instance from 200 amperes to 200 amperes in incremental values of 100 amperes for time step k 1. The A h integration component to SOLis used to calculate a final value for SOLfor each cell in the SOLdelta x y vector. A cumulative value of A h mile driven is generally known for each vehicle and typically comprises a direct linear relationship between values for ESD current and SOL.

Estimation of effect upon depth of discharge DOD is knowable as follows. A parametric value for SOC is known at time k. The value for electrical current shown with reference to vector is used in calculation of a parametric value for SOC as shown in wherein the resulting SOCis calculated. This value is then compared to the SOC which comprises a ESD state of charge achieved at the subsequent calculation cycle were the proposed current commanded. The contribution of the DOD effect on SOC increases as the system exceeds the SOC DOD LOCK IN threshold which has a parametric value of 75 in this embodiment. This means the system penalizes departures from a SOC target area. The system greatly penalizes SOC when for example an action by the controller causes ESD discharge below a set value e.g. 40 as a result of an action such as an extended vehicle acceleration. A resulting parametric value for Depth of Discharge is passed into the DOD SOL impact table. This SOL delta component is then submitted to the SOLcalculation.

Estimating an effect based upon ESD operating temperature comprises calculating estimates of heat transfer to the ESD caused by the upcoming change of the control parameter I. This provides an indication of an amount the ESD is warmed up during the elapsed time. The ESD heating value is determined by inputting each value for the current I to a mathematical model of the ESD which includes one or more vectors or matrices of resistance as a function of SOC and temperature. The matrix may be based upon predetermined calibration based upon laboratory data or a calculated resistance from a control module. The calculation is further based upon thermal mass of the ESD and any ESD cooling system capability. An estimate of thermal change is determined based on a control operation as shown in block and referred to as a difference between ESD temperatures at times k and k 1 i.e. T T which is determined based upon the control parameter Iat time k 1. Driving temperature factor is determined at block which is passed to the SOLcalculation of block for the timestep k 1. This result occurs because operating temperatures and resting temperatures affect ESD total life. The time integrated current factor from block the DOD factor from block and the driving temperature factor from block comprise the inputs to Block which determines a parametric value for SOLfor each current value of the array of current values input to the algorithm from block . An array of values as previously described are created in the SOLdelta x y vector .

As an example operating a hybrid vehicle to maximize ESD current and charging typically leads to large amounts of current passing through the ESD. The parameter for A h mile is likely higher than for an average operator and the A h component for calculation of SOLdelta x y likely reflects fairly high values for SOLat all positive and negative current values. However because the control system has enough time to adapt to driving style of various operators usually more astute drivers attempt to maximize operation in a recharging mode e.g. regenerative braking and identify areas of ESD boost the State of Charge in this example remains at an optimal level around 75 2 . At the given moment of the calculation with SOC at 74.5 the SOCvalue of block was at 74.9. The instantaneous DOD at this point is only 0.4 DOD. This translates to a relatively small effect upon SOLfor all Icurrent values. Stated differently in the next timestep there is limited risk to SOL related directly to a large depth of discharge.

Lastly when the operator most likely started with a high ESD temperature while passing large quantities of current through the ESD which most likely warms it beyond the capability of its cooling system the effect due to low current levels are likely reasonable. However at higher positive charging currents there would be larger effect upon SOL due to a future potential for ESD heating. There would be lesser increases in the SOLfor larger discharging currents as well but not as large as the charging currents because discharge currents have less resistance than charging currents.

Referring again to a datagraph showing a state of life factor as a function of vehicle operating time and mileage is shown. Included is a target profile comprising an idealized linear change in SOL over time and distance driven. A second line comprises a system wherein initial SOL v. time is above the idealized profile potentially leading to a shorter service life for the ESD . Therefore there is a need to have a less aggressive use of the ESD in subsequent usage to optimize ESD life. A third line comprises a system wherein the initial SOL v. time is below the idealized profile leading to an extended service life for the ESD . In this instance the operating system may be able to more aggressively use the electric machines to propel the vehicle. Furthermore such a system facilitates more effective utilization of the hybrid propulsion system in a vehicle used in a climate having lower ambient temperatures. Referring now to items there is shown three values for SOLthat have been calculated in accordance with Eq. 1 above and the invention as described herein. This information is useable by the hybrid control system to decide on an appropriate level of operation of the electrical machines in terms of electrical current flow for the subsequent step while taking into account effect on life of the ESD using the SOL factor. Therefore electric machine currents can be controlled in accordance with the general objective of maintaining SOL in accordance with the target profile . Varying degrees of control techniques can effect this objective including for example establishing e.g. setting or dictating machine currents where aggressive control is warranted e.g. where actual SOL requires gross adjustments to comply with the target profile or SOL is on a track to premature end of life relative to the target profile. Alternatively merely establishing machine current limits may be more appropriate where less aggressive control is warranted e.g. where actual SOL requires minor adjustments to comply with the target profile or SOL is on a track to an extended end of life relative to the target profile. In general it is desirable to converge the actual SOL to the target profile quickly while minimizing overshoot.

The invention has been described with specific reference to the preferred embodiments and modifications thereto. Further modifications and alterations may occur to others upon reading and understanding the specification. It is intended to include all such modifications and alterations insofar as they come within the scope of the invention.

