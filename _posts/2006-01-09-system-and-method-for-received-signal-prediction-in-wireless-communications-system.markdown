---

title: System and method for received signal prediction in wireless communications system
abstract: Method and apparatus to compute the combiner coefficients for wireless communication systems for a space-time solution. One embodiment trains the weights on a signal known a priori that is time multiplexed with other signals, such as a pilot signal in a High Data Rate, HDR, system, wherein the signal is transmitted at full power. A Minimizing Mean Square Error, MMSE, approach is applied allowing weight combining on a per path basis. The weights are calculated as a function of a noise correlation matrix and spatial signature per path. The noise correlation matrix is determined from an autocorrelation matrix of the received signal. In one embodiment, the MMSE approach is applied to a non-time gated pilot signal.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07433384&OS=07433384&RS=07433384
owner: QUALCOMM Incorporated
number: 07433384
owner_city: San Diego
owner_country: US
publication_date: 20060109
---
The present application for patent is a Continuation of patent application Ser. No. 09 860 707 entitled System and Method for Received Signal Prediction in Wireless Communications System filed May 17 2001 now U.S. Pat. No. 6 990 137 and assigned to the assignee hereof and hereby expressly incorporated by reference herein.

The present invention is related to a U.S. application for patent entitled SYSTEM AND METHOD FOR PROVIDING AN ACCURATE ESTIMATION OF RECEIVED SIGNAL INTERFERENCE FOR USE IN WIRELESS COMMUNICATIONS SYSTEMS by Nagabhushana Sindhushayana et al. having U.S. application Ser. No. 09 310 053 filed May 11 1999 now U.S. Pat. No. 6 661 832 and assigned to the assignee hereof and

 SYSTEM AND METHOD FOR ADJUSTING COMBINER WEIGHTS USING AN ADAPTIVE ALGORITHM IN WIRELESS COMMUNICATIONS SYSTEMS by Ivan J. F. Corbaton et al. filed concurrently herewith now U.S. application Ser. No. 09 860 705 filed May 17 2001 and assigned to the assignee hereof.

The present invention relates to communications systems. Specifically the present invention relates to methods of decoding a received signal in a wireless communications systems.

In a wireless communications system the transmitted signal is altered by the transmission channel as well as the receiver processing operations such as filtering demodulating etc. For accurate communications the receiver must consider these influences in decoding the received data. The receiver determines a relationship between a transmitted signal and a received signal. The relationship may then be applied to subsequent received signals. The relationship may be referred to as a signature wherein the various influences that alter a transmission signal are included in the signature.

Application of the signature to the received signal typically involves complex matrix operations. Various techniques have been developed to simplify the problem by adopting various assumptions. Often these assumptions refer to the noise energy. While some assumptions hold true for transmissions in one type of wireless system others do not. There is a need therefore for accurate and efficient determination of received signals.

According to one aspect in a wireless communication system having a plurality of receive antennas and a combiner for combining signals received on the plurality of receive antennas a method for determining combiner weights applied in the combiner includes receiving a first signal at a first antenna of the plurality of receive antennas receiving a second signal at a second antenna of the plurality of receive antennas wherein the second signal is a function of the first signal and determining a first weight in the combiner based on the first and second signals the first weight associated with the first and second signal.

In another aspect a remote station apparatus includes a first rake receiver having a plurality of fingers a second rake receiver having a plurality of fingers and a first path processing unit coupled to one of the plurality of fingers of the first rake receiver and one of the plurality of fingers of the second rake receiver.

Wireless communications systems are characterized by a plurality of mobile stations in communication with one or more base stations. Signals are transmitted between a base station and one or more mobile stations over a channel. Receivers in the mobile stations and base stations must estimate noise introduced to the transmitted signal by the channel to effectively decode the transmitted signal.

In a spread spectrum system such as a Code Division Multiple Access CDMA communications system signals are spread over a wide bandwidth via the use of a code such as a Pseudorandom Noise PN spreading sequence. When the spread signals are transmitted over a channel the signals take multiple paths from the base station to the mobile station. The signals are received from the various paths at the mobile station decoded and constructively recombined via path combining circuitry such as a rake receiver. The path combining circuitry applies gain factors called weights to each decoded path to maximize throughput and compensate for path delays and fading.

The rake structure is extensively used in digital communications receivers particularly in mobile communications due to its simplicity and robustness. The idea behind the rake is very simple and can be broadly stated as 1 finding the time of arrival of the different paths 2 assigning individual correlators commonly called fingers to those times of arrival and 3 combining the outputs of the individual correlators to form the final symbol estimate which typically results in a weighted sum over all active fingers of the per finger symbol estimate.

Given a set of time offsets there exists an optimal set of weights that will maximize the Signal to Interference and Noise Ratio SINR of the final symbol estimate. In a non stationary radio channel optimal time offsets and weights will vary with time hence both sets of parameters are computed dynamically in the receiver. The traditional method for obtaining the weight vector for given time offsets is called Maximum Ratio Combining MRC and it has the inherent assumption that the interference on different fingers every finger output will consist of desired signal plus interference is uncorrelated from finger to finger.

Often a communications system transmission includes pilot interval a power control interval and a data interval. During the pilot interval the base station transmits a pre established reference signal to the mobile station. The mobile station combines information from the received reference signal i.e. pilot signal and the transmitted pilot signal to extract information about the channel such as channel interference and Signal to Noise Ratio SNR. The mobile station analyzes the characteristics of the channel and subsequently transmits a power control signal to the base station in response thereto during a subsequent power control interval. For example if the base station is currently transmitting with excess power given the current channel characteristics the mobile station sends a control signal to the base station requesting that the transmitted power level be reduced. Note that in one embodiment of a packetized data transmission system referred to generally as a High Data Rate HDR system has a time gated pilot wherein the pilot information is exclusively available separate from the traffic signals.

Digital communications systems often use Log Likelihood Ratios LLRs to accurately decode a received signal. An SNR measurement or estimate is typically used to accurately calculate the LLR for a received signal. Accurate SNR estimates require precise knowledge of the noise characteristics of the channel which may be estimated via the use of a pilot signal.

The rate or power at which a base station or mobile station broadcasts a signal is dependant on the noise characteristics of the channel. For maximum capacity transceivers in the base stations and mobile stations control the power of transmitted signals in accordance with an estimate of the noise introduced by the channel. If the estimate of the noise i.e. the interference spectral density of different multipath components of the transmitted signal is inaccurate the transceivers may broadcast with too much or too little power. Broadcasting with too much power may result in inefficient use of network resources resulting in a reduction of network capacity and a possible reduction in mobile station battery life. Broadcasting with too little power may result in reduced throughput dropped calls reduced service quality and disgruntled customers.

The word exemplary is used exclusively herein to mean serving as an example instance or illustration. Any embodiment described herein as exemplary is not necessarily to be construed as preferred or advantageous over other embodiments.

The TIA EIA IS 95 Mobile Station Base Station Compatibility Standard for Dual Mode Wideband Spread Spectrum Cellular System hereinafter referred to as the IS 95 standard and the TIA EIA IS 2000 Standards for cdma2000 Spread Spectrum Systems hereinafter referred to as the cdma2000 standard detail spread spectrum CDMA systems. Further operation of a CDMA system is described in U.S. Pat. No. 4 901 307 entitled SPREAD SPECTRUM MULTIPLE ACCESS COMMUNICATION SYSTEM USING SATELLITE OR TERRESTRIAL REPEATERS assigned to the assignee of the present application for patent and hereby expressly incorporated by reference.

One type of communication system adapted for data transmissions referred to as an HDR subscriber system is detailed in the TIA EIA IS 856 cdma2000 High Rate Packet Data Air Interface Specification hereinafter referred to as the HDR standard details an HDR system. Within the context of an HDR system an access terminal AT may be mobile or stationary and may communicate with one or more HDR base stations referred to herein as modem pool transceivers MPTs. An access terminal transmits and receives data packets through one or more modem pool transceivers to an HDR base station controller referred to herein as a modem pool controller MPC.

Modem pool transceivers and modem pool controllers are parts of a network called an Access Network AN. An access network transports data packets between multiple access terminals. The access network may be further connected to additional networks outside the access network such as a corporate intranet or the Internet and may transport data packets between each access terminal and such outside networks.

An access terminal that has established an active traffic channel connection with one or more modem pool transceivers is called an active access terminal and is said to be in a traffic state. An access terminal that is in the process of establishing an active traffic channel connection with one or more modem pool transceivers is said to be in a connection setup state. An access terminal may be any data device that communicates through a wireless channel or through a wired channel for example using fiber optic or coaxial cables. An access terminal may further be any of a number of types of devices including but not limited to PC card compact flash external or internal modem or wireless or wireline phone. The communication link through which the access terminal sends signals to the modem pool transceiver is called a reverse link. The communication link through which a modem pool transceiver sends signals to an access terminal is called a forward link.

In a spread spectrum system such as CDMA wireless communication systems and specifically such as HDR systems it is desirable to implement a rake receiver to achieve time diversity for processing the received signal and the echoes or multipaths generated by transmission of the signal. The air interface channels in a CDMA wireless system become dispersive as a result of multipath signal propagations that differ from one another by more than one spreading chip duration allowing independent demodulation using a rake receiver.

Additionally generally buildings and other obstacles in built up areas scatter the signal. Furthermore because of the interaction between the several incoming waves the resultant signal at the antenna is subject to rapid and deep fading. Average signal strength can be 40 to 50 dB below the free space path loss. Fading is most severe in heavily built up areas in an urban environment. In these areas the signal envelope follows a Rayleigh distribution over short distances and a log normal distribution over large distances.

The use of a rake receiver is described in detail in U.S. Pat. No. 5 109 390 entitled Diversity Receiver in a CDMA Cellular Telephone System assigned to the assignee of the present invention and hereby expressly incorporated by reference herein. Rake receivers process the individual multipath signals and combine them to form a composite signal. Rake receivers may exploit both the spatial and temporal diversities of a wireless system. The temporal diversities arise as the signal is altered by the air interface over time thus creating multipaths. The rake receiver takes advantage of such temporal diversity by processing signals according to arrival time and effectively recombining the energy from each time varying multipath propagation.

In addition to the implementation of a rake receiver wireless systems often employ diversity techniques of improving the SNR of a received signal. Diversity reception refers to the combining of multiple signals in order to improve the SNR of a communication. Time diversity is used to improve system performance for IS 95 CDMA systems. Diversity reception techniques are used to reduce the effects of fading and improve the reliability of communication without increasing either the transmitter s power or the channel bandwidth.

The basic idea of diversity receptions is that if two or more independent samples of a signal are taken these samples will fade in an uncorrelated manner. This means that the probability of all the samples being simultaneously below a given level is much lower than the probability of any individual sample being below that level. The probability of M samples all being simultaneously below that level is p where p is the probability that a single sample is below that level. Thus it is clear that a signal composed of a suitable combination of the various samples will have much less severe fading properties than any individual sample.

In principle diversity reception techniques can be applied either at the base station or at the mobile station although each type of application has different problems that must be addressed. The cost of the diversity combiner can be high especially if multiple receivers are required. Also the power output of the mobile station is limited by its battery life. The base station however can increase its power output or antenna height to improve coverage to a mobile station. Since the path between the mobile station and the base station is assumed to be recriprocal diversity systems implemented in a mobile station work similarly to those in a base station.

It is desirable to use multiple receive antennas at a receiver to get space diversity and solve for multipath fades in the received signal energy at each antenna. With a suitable choice of combiner weights multiple receive antennas allow for interference suppression in the spatial domain. In particular there is a need to compute the space time combiner coefficients i.e. for each rake finger of each receiver antenna for wireless communication systems that use a CDMA waveform with a gated pilot signal transmitted at full power. A gated pilot signal used in an HDR system is illustrated in wherein the pilot is periodically transmitted. As illustrated the pilot is transmitted during the intervals of tto tand tto t. In the illustrated embodiment the pilot is a sequence of logical ones spread by a PN sequence. Alternate embodiments may employ various pilot signals wherein the pilot scheme is known a priori at both the transmitter and receiver. While the pilot is inactive the data or traffic is transmitted. The data signal may include a variety of other signals specific to the implementation of a given system. The full transmission power signals are available for both data and pilot as illustrated in .

In one embodiment a system uses non recursive methods of specifying Minimization of Mean Square Error MMSE combiner weights. The non recursive computations of the combiner weights are based on computing correlation statistics during the pilot portion of the frame to form an estimate of the noise correlation matrix. The correlations are then averaged or filtered across multiple pilot bursts to trade off noise suppression through averaging and the ability to track channel variations. In one embodiment the combiner weights are calculated once per pilot burst by inverting the noise correlation matrix and multiplying the result by an estimate of the desired signal vector.

In an exemplary embodiment the data information is extracted from the received signal by filtering and smoothing. A filter is a device in the form of a piece of physical hardware or software that is applied to a set of noisy data in order to extract information about a prescribed quantity of interest. The noise may arise from a variety of sources. For example the data may have been derived by means of noisy sensors or may represent a useful signal component that has been corrupted by transmission through a communication channel.

A filter is designed to perform three basic information processing tasks filtering smoothing and prediction. Filtering means the extraction of information about a quantity of interest at time t by using data measured up to and including time t. Smoothing differs from filtering in that information about the quantity of interest need not be available at time t and data measured later than time t can be used in obtaining this information. This means that in the case of smoothing there is a delay in producing the result of interest. In the smoothing process data is available from times after time t. In other words not only data obtained up to time t but also data obtained after time t is available. Smoothing may be more accurate in some sense than filtering. Finally prediction is the forecasting side of information processing. The aim here is to derive information about what the quantity of interest will be like at some t in the future for some 0 by using data measured up to and including time t.

Filters may be generally classified as linear and nonlinear. A filter is said to be linear if the filtered smoothed or predicted quantity at the output of the device is a linear function the observations applied to the filter input. Otherwise the filter is nonlinear.

In a statistical approach to the solution of the linear filtering problem assume the availability of certain statistical parameters i.e. mean and correlation functions of the useful signal and unwanted additive noise. A linear filter is designed to accept noisy data as input and minimize the effects of that noise at the filter output according to some statistical criterion. A useful approach to this filter optimization problem is to minimize the mean square value of the error signal that is defined as the difference between some desired response and the actual filter output i.e. MMSE. For stationary inputs the resulting solution is considered optimum in the mean square sense. A plot of the mean square value of the error signal versus the adjustable parameters of a linear filter is referred to as the error performance surface. The minimum point of this surface represents the solution.

For those situations in which nonstationarity of the signal and or noise is intrinsic to the problem the optimum filter has to assume a time varying form. Linear filter theory may be discussed for continuous time however in practice the discrete time representation is often preferred. In this method of representation the input and output signals as well as the characteristics of the filters themselves are all defined at discrete instants of time. A continuous time signal may be represented by a sequence of samples that are derived by observing the signal at uniformly spaced instants of time. No loss of information is incurred during this conversion process provided the sampling theorem is satisfied wherein according to the sampling theorem the sampling rate has to be greater than twice the highest frequency component of the continuous time signal. Thus the continuous time signal u t may be represented by the sequence u n n 2 . . . where for convenience the sampling period is normalized to unity.

The design of a filter generally uses a priori information about the statistics of the data to be processed. The filter is optimum only when the statistical characteristics of the input data match a priori information on which the design of the filter is based. When this information is not known completely it may be difficult to design the filter or else the design may no longer be optimum. A straightforward approach that may be used in such situations is the estimate and plug procedure. This is a two stage process whereby the filter first estimates the statistical parameters of the relevant signals and then plugs the results so obtained into a nonrecursive formula for computing the filter parameters. For real time operation this procedure requires matrix inversion. An efficient method is to use an adaptive filter. By such a device it is meant one that is self designing in that the adaptive filter relies for its operation on a recursive algorithm which makes it possible for the filter to perform satisfactorily in an environment where complete knowledge of the relevant signal characteristics is not available.

Adaptive algorithms start from some predetermined set of initial conditions representing whatever is known about the environment. Yet in a stationary environment it is found that after successive iterations of the algorithm it converges to the optimum solution in some statistical sense. In a nonstationary environment the algorithm offers a tracking capability in that it can track time variations in the statistics of the input data provided that the variations are sufficiently slow.

As a direct consequence of the application of a recursive algorithm whereby the parameters of an adaptive filter are updated from one iteration to the next the parameters become data dependent. This therefore means that an adaptive filter is in reality a nonlinear device in the sense that it does not obey the principle of superposition. Notwithstanding this property adaptive filters are commonly classified as linear or nonlinear. An adaptive filter is said to be linear if the estimate of a quantity of interest is computed adaptively e.g. at the output of the filter as a linear combination of the available set of observations applied to the filter input. Otherwise the adaptive filter is said to be nonlinear.

A variety of recursive algorithms have been developed for the operation of linear adaptive filters. The choice of an algorithm for a particular application is based on any one of several parameters of the system. A first parameter is the rate of convergence defined as the number of iterations required for the algorithm in response to stationary inputs to converge close enough to the optimum solution in the mean square sense. A fast rate of convergence allows the algorithm to adapt rapidly to a stationary environment of the unknown statistics. A second parameter is called misadjustment. For an algorithm of interest this parameter provides a quantitative measure of the amount by which the final value of the mean squared error averaged over an ensemble of adaptive filters deviates from the minimum mean squared error that is produced by the filter. A third parameter is tracking. When an adaptive filtering algorithm operates in a nonstationary environment the algorithm is required to track statistical variations in the environment. The tracking performance of the algorithm however is influenced by two contradictory features rate of convergence and steady state fluctuation due to algorithm noise.

An additional parameter is the robustness of the adaptive filter to small disturbances. For an adaptive filter to be robust small disturbances i.e. disturbances with small energy can only result in small estimation errors. The disturbances may arise from a variety of factors internal or external to the filter.

Further computational requirements present several issues including the number of operations i.e. multiplications divisions and additions subtractions required to make one complete iteration of the algorithm the size of the memory locations required to store the data and the program and the investment required to program the algorithm in a computer.

Still another parameter is the structure of information flow in the algorithm. The structure determines the manner in which the algorithm is implemented in hardware. For example an algorithm having a structure that exhibits high modularity parallelism or concurrency is well suited for implementation using Very Large Scale Integration VLSI.

Yet another parameter considers the numerical properties of the algorithm. When an algorithm is implemented numerically inaccuracies are produced due to quantization errors. These errors are due to analog to digital conversion of the input data and digital representation of internal calculations. The digital representation causes serious design problems. There are two basic issues of concern numerical stability and numerical accuracy. Numerical stability is an inherent characteristic of an adaptive filtering algorithm. Numerical accuracy is determined by the number of bits used in the numerical representation of data samples and filter coefficients. An adaptive filtering algorithm is said to be numerically robust when it is insensitive to variations in the wordlength used in its digital implementation.

Adaptive filtering involves two basic processes filtering a sequence of input data samples to produce an output response and adaptive control of an adjustable set of parameters used in the filtering process.

As illustrated by the discussion provided hereinabove a variety of methods may be used to increase the SNR of a received signal including diversity techniques and the use of a rake receiver. In designing a particular system often a trade off is made between accuracy with cost and or complexity. Hereinbelow are described a variety of methods for determining combiner weights for application in a rake receiver. Each method provides a balance of accuracy with cost and or complexity for a variety of situations. First MRC approaches are described wherein assumptions regarding the noise energy of the received signal are made to simplify the computational complexity of combiner weight determination. Second MMSE approaches are described wherein alternate assumptions are made to further simplify the computation complexity of combiner weight determination. Third an adaptive algorithm is described that effectively avoids matrix inversion calculations without using the assumptions of the other methods.

In one embodiment in a wireless communication wherein a receiver employs a rake receiver adaptive filtering is applied to calculate the combiner weights of the rake receiver. Ideally the calculation of combiner weights considers all of the energy present in the system including multipaths interference from other users and noise energy. The complexity of such calculation has encouraged the use of simplifying assumptions. For example one method of calculating combiner weights applies a Maximal Ratio Combining MRC scheme wherein the weights are calculated specific to a path and antenna combination. In this way for a system having A antennas and L paths the AL AL matrix describing the system is reduced to AL 1 1 matrices wherein each path is assumed to have independent noise. An MRC generated weight is calculated for each path of each antenna.

For clarity many details of the transceiver system have been omitted such as clocking circuitry microphones speakers and so on. Those skilled in the art can easily implement the additional circuitry without undue experimentation.

The transceiver system is a dual conversion telecommunications transceiver and includes an antenna connected to a duplexer . The duplexer is connected to a receive path that includes from left to right a receive amplifier a Radio Frequency RF to Intermediate Frequency IF mixer a receive bandpass filter a receive Automatic Gain Control circuit AGC and an IF to baseband circuit . The IF to baseband circuit is connected to a baseband computer at the C I and Nestimation circuit .

The duplexer is also connected to a transmit path that includes a transmit amplifier an IF to RF mixer a transmit bandpass filter a transmit AGC and a baseband to IF circuit . The transmit baseband to IF circuit is connected to the baseband computer at an encoder .

The C I and Nestimation circuit in the baseband computer is connected to a path weighting and combining circuit a rate power request generation circuit and a log likelihood ratio LLR circuit . The LLR circuit is also connected to the path weighting and combining circuit and a decoder . The decoder is connected to a controller that is also connected to the rate power request generation circuit and the encoder .

The antenna receives and transmits RF signals. A duplexer connected to the antenna facilitates the separation of receive RF signals from transmit RF signals .

RF signals received by the antenna are directed to the receive path where they are amplified by the receive amplifier mixed to intermediate frequencies via the RF to IF mixer filtered by the receive bandpass filter gain adjusted by the receive AGC and then converted to digital baseband signals via the IF to baseband circuit . The digital baseband signals are then input to a digital baseband computer .

In the present embodiment the receiver system is adapted for use with Quadrature Phase Shift Keying QPSK modulation and demodulation techniques and the digital baseband signals are Quadrature Amplitude Modulation QAM signals that include both In phase I and Quadrature Q signal components. The I and Q baseband signals represent both pilot signals and data signals transmitted from a CDMA telecommunications transceiver such as a transceiver employed in a base station. HDR type systems often use 8 PSK or 16 QAM modulation schemes.

In the transmit path digital baseband computer output signals are converted to analog signals via the baseband to IF circuit mixed to IF signals filtered by the transmit bandpass filter mixed up to RF by the IF to RF mixer amplified by the transmit amplifier and then transmitted via the duplexer and the antenna .

Both the receive and transmit paths and respectively are connected to the digital baseband computer . The digital baseband computer processes the received baseband digital signals and outputs the digital baseband computer output signals . The baseband computer may include such functions as signal to voice conversions and or vise versa.

The baseband to IF circuit includes various components not shown such as Digital to Analog Converters DACs mixers adders filters shifters and local oscillators. The baseband computer output signals include both In phase I and Quadrature Q signal components that are 90 out of phase. The output signals are input to DACs in the analog baseband to IF circuit where they are converted to analog signals that are then filtered by lowpass filters in preparation for mixing. The phases of the output signals are adjusted mixed and summed via a 90 shifter not shown baseband to IF mixers not shown and an adder not shown respectively included in the baseband to IF circuit .

The adder outputs IF signals to the transmit AGC circuit where the gain of the mixed IF signals is adjusted in preparation for filtering via the transmit bandpass filter mixing up to RF via the IF to transmit mixer amplifying via the transmit amplifier and eventual radio transmission via the duplexer and the antenna .

Similarly the IF to baseband circuit in the receive path includes circuitry not shown such as Analog to Digital Converters ADCs oscillators and mixers. A received gain adjusted signals output from the receive AGC circuit are transferred to the IF to baseband circuit where they are mixed to baseband via mixing circuitry and then converted to digital signals via ADCs.

Both the baseband to IF circuit and the IF to baseband circuit employ an oscillator signal provided via a first oscillator to facilitate mixing functions. The receive RF to IF mixer and the transmit IF to RF mixer employ an oscillator signal input from a second oscillator . The first and second oscillators and respectively may be implemented as phase locked loops that derive output signals from a master reference oscillator signal.

Those skilled in the art will appreciate that other types of receive and transmit paths and may be employed instead without departing from the scope of the present invention. The various components such as amplifiers and mixers and filters and AGC circuits and and frequency conversion circuits and are standard components and may easily be constructed by those having ordinary skill in the art and access to the present teachings.

In the baseband computer the received I and Q signals are input to the C I and Nestimation circuit . The C I and Nestimation circuit accurately determines the interference energy of the I and Q signals based on the pilot signal and determines a carrier signal to interference ratio in response thereto. The C I is similar to SNR and is the ratio of the energy of the received I and Q signals less interference and noise components to the interference energy of the received I and Q signals . Conventional C I estimation circuits often fail to accurately estimate the multipath interference energy.

The C I and Nestimation circuit outputs a C I signal to the rate power request generation circuit and the LLR circuit . The C I and Nestimation circuit also outputs the reciprocal of the interference energy 1 N a despread and decovered data channel signal and a despread and decovered pilot channel signal to the path weighting and combining circuit . The despread and decovered data channel signal is also provided to the decoder where it is decoded and forwarded to the controller . At the controller the decoded signal is processed to output voice or data or to generate a reverse link signal for transfer to the associated base station not shown .

The path weighting and combining circuit computes an optimal ratio path combining weights for multipath components of the received data signal corresponding to the data channel signal under the given assumptions weights the appropriate paths combines the multiple paths and provides the summed and weighted paths as a metric to the LLR circuit .

The LLR circuit employs metrics from the path weighting and combining circuit with the C estimation provided by the C I and Nestimation circuit to generate an optimal LLR and soft decoder decision values. The optimal LLR and soft decoder decision values are provided to the decoder to facilitate decoding of the received data channel signals. The controller then processes the decoded data channel signals to output voice or data via a speaker or other device not shown . The controller also controls the sending of speech signals and data signals from an input device not shown to the encoder in preparation for transmission.

The rate power request generation circuit generates a rate control or power fraction request message based on the C I signal input from the C I and Nestimation circuit . The rate power request generation circuit compares the C I with a set of predetermined thresholds. The rate power request generation circuit generates a rate request or power control message based on the relative magnitude of the C I signal with respect to the various thresholds. The exact details of the rate power request generation circuit are application specific and easily determined and implemented by those ordinarily skilled in the art to suit the needs of a given application.

The resulting rate control or power fraction request message is then transferred to the controller . The controller prepares the power fraction request message for encoding via the encoder and eventual transmission to the associated base station not shown over a data rate request channel DRC via the transmit path duplexer and antenna . When the base station receives the rate control or power fraction request message the base station adjusts the rate and or power of the transmitted signals accordingly.

The accurate C I and Nestimates from the C I and Nestimation circuit improve the performance of the rate power request generation circuit and improve the performance of the decoder thereby improving the throughput and efficiency of the transceiver system and associated telecommunications system.

The C I and Nestimation circuit includes from left to right and top to bottom a PN despreader an M ary Walsh decover circuit a total received signal energy Icomputation circuit a first constant circuit a pilot filter a subtractor a first multiplier a pilot energy calculation circuit a Look Up Table LUT a second multiplier and a C I accumulation circuit . In the C I and Nestimation circuit the PN despreader receives the I and Q signals from the IF to baseband circuit of . The PN despreader provides input in parallel to the M ary Walsh decover circuit and the Icomputation circuit . The M ary Walsh decover circuit provides input to the pilot filter and to a constant divider circuit in the path weighting and combining circuit .

The output of the energy computation circuit is connected to a positive terminal of the subtractor circuit . A negative terminal of the subtractor circuit is connected to an output terminal of a first multiplier . A first input of the first multiplier is connected to an output of the first constant circuit . A second input of the first multiplier is connected to an output of the pilot energy calculation circuit . The pilot filter provides input to the pilot energy calculation circuit .

An output of the subtractor is connected to the LUT . An output of the LUT is connected in parallel to a first input of the second multiplier and a first input of a third multiplier in the path weighting and combining circuit . A second input of the second multiplier is connected to the output of the first multiplier . An output of the second multiplier is connected to the C I accumulator circuit the output of which provides input to the LLR circuit .

The path weighting and combining circuit includes a second constant generation circuit a fourth multiplier the third multiplier the constant divider circuit a complex conjugate circuit a fifth multiplier and a path accumulator circuit . In the path weighting and combining circuit a first terminal of the fourth multiplier is connected to the output of the pilot filter which is also connected to an input of the pilot energy calculation circuit in the C I and Nestimation circuit . A second terminal of the fourth multiplier is connected to the second constant generation circuit . An output of the fourth multiplier is connected to a second input of the third multiplier . The output of the third multiplier provides input to the complex conjugate circuit . The output of the complex conjugate circuit is connected to a first input of the fifth multiplier . An output of the constant divider circuit is connected to a second input of the fifth multiplier . An output of the fifth multiplier is connected to an input of the path accumulator circuit . The output of the path accumulator circuit is connected to a second input of the LLR circuit . The output of the LLR circuit is connected to an input of a decoder see of .

In operation the PN despreader receives the I and Q signals and despreads L fingers i.e. paths l . The PN despreader despreads the I and Q signals using an inverse of the pseudo noise sequence used to spread the I and Q signals before transmission over the channel. The construction and operation of the PN despreader is also well known in the art.

Despread signals are output from the PN despreader and input to the M ary Walsh decover and the Icomputation circuit . The Icomputation circuit computes the total received energy I per chip which includes both a desired signal component and an interference and noise component. The Icomputation circuit provides an estimate of Iin accordance with the following equation 

where N is the number of chips per pilot burst and is 64 in the present specific embodiment and represents the received despread signal output from the PN despreader .

Those skilled in the art will appreciate that the Imay be computed before despreading by the PN despreader without departing from the scope of the present invention. For example the Icomputation circuit may receive direct input from the I and Q signals instead of input provided by the PN despreader in which case an equivalent estimate of Iwill be provided at the output of the Icomputation circuit .

The M ary Walsh decover circuit decovers orthogonal data signals called data channels and pilot signals called the pilot channel in accordance with methods known in the art. In the present specific embodiment the orthogonal data signals correspond to one data channel s that is represented by the following equation square root over 2 

where M is the number of chips per Walsh symbol is the modulation symbol energy of the lmultipath component circumflex over is the phase of the data channel s and Xis the information baring component of the data channel s. The decovered data channel represented by equation 2 is provided to the decoder see of and to the constant divider circuit of the path weighting and combining circuit .

While the exemplary embodiment is illustrated as being adapted for use with signals comprising various Walsh codes the present invention is easily adaptable for use with other types of codes by those ordinarily skilled in the art.

The pilot channel is input to the pilot filter . The pilot filter is an averaging filter that acts as a lowpass filter which removes higher frequency noise and interference components from the pilot channel. The output of the pilot filter p is represented by the following equation square root over circumflex over 3 

where M is the number of chips per Walsh symbol is the pilot chip energy of the lmultipath component and is the phase of the filtered pilot channel p.

An estimate of the energy of the filtered pilot channel p is computed via the pilot energy calculation circuit which is a square of the complex amplitude of the filtered pilot channel p represented by equation 3 . The square of the complex amplitude of the filtered pilot channel p is multiplied by a predetermined scale factor c represented by the following equation 

where Iis the received energy of the desired signal i.e. is equivalent to Iless noise and interference components. Eis the pilot chip energy. The scale factor c is a known forward link constant in many wireless communications systems.

The scale factor c is multiplied by the energy of the filtered pilot signal p via the first multiplier to yield an accurate estimate of the energy of the received desired signal Io less noise and interference components associated with the lmultipath component of the received signals .

The accurate estimate is subtracted from the estimate of Ivia the subtractor to yield an accurate measurement of the interference energy N associated with the lmultipath component. Nis then provided to the LUT which outputs the reciprocal of Nto the third multiplier in the path weighting and combining circuit and to the first input of the second multiplier . The second input of the second multiplier is connected to the output of the first multiplier which provides at the second input terminal of the second multiplier . The second multiplier outputs an accurate estimate of the carrier signal to interference ratio or C I associated with the lmultipath component in accordance with the following equation 

The accurate C I value is then accumulated over L paths in the received signal via the C I accumulator circuit . The accumulated C I values are then provided to the LLR circuit and to the rate power request generation circuit see of .

In the path weighting and combining circuit the fourth multiplier multiplies the filtered pilot signal p by a constant k provided by the second constant generation circuit . The constant k is computed in accordance with the following equation 

where Eis the modulation symbol energy Eis the pilot symbol energy and M is the number of Walsh symbols per chip as mentioned above. The ratio of Eto Eis often a known constant for both reverse link and forward link transmissions.

The output of the fourth multiplier provides an estimate of the channel coefficient circumflex over described by the following equation circumflex over square root over 7 

where is an estimate of the modulation symbol energy of the lmultipath component circumflex over is an estimate of the phase of the pilot signal. The channel circumflex over is a scaled estimate of the complex amplitude of the output of the pilot filter .

The channel estimate is then multiplied by the reciprocal of the interference energy Nassociated with the lmultipath component by the third multiplier . The interference energy Nincludes both interference and noise components. The complex conjugate circuit then computes the conjugate of the output of the third multiplier which represents maximal ratio path combining weights. The maximal ratio path combining weights are then multiplied by the corresponding data symbol output from the divider circuit via the fifth multiplier . The data symbol d is represented by the following equation square root over circumflex over 8 

The output of the fifth multiplier represents optimally weighted data signals that are then accumulated over the L paths that comprise the signals via the path combiner circuit . The resulting optimally combined data signals are provided to the LLR circuit which facilitates the calculation of optimal soft decoder inputs to the decoder see of .

Those skilled in the art will appreciate that the constants c and k provided by the first constant generation circuit and the second constant generation circuit respectively may be constants or variables other than those represented by equations 3 and 6 without departing from the scope of the present invention.

The operation of the interference energy computation circuit is similar to the operation of the C I and Nestimation circuit of with the exception of the calculation of N. The interference energy computation circuit includes the PN despreader the M ary Walsh decover circuit and the pilot filter . The M ary Walsh decover circuit decovers i.e. extracts the pilot channel and the data channel from the despread I and Q signal samples output from the PN despreader .

In the interference energy computation circuit the pilot channel is provided to a positive input of a pilot subtractor circuit and to the pilot filter . The pilot filter suppresses noise and interference components in the pilot channel and provides a filtered pilot signal to a negative input of the pilot subtraction circuit . The pilot subtractor circuit subtracts the pilot channel from the filtered pilot channel and outputs a signal representative of the interference and noise per symbol introduced by the channel between the transmitting base station not shown and the transceiver system see of in which the interference energy computation circuit is employed. The energy N of the interference and noise signal for each symbol computed via an interference energy computation circuit in accordance with the following equation 

where M is the number of chips per Walsh symbol N is the number of chips 64 chips in the pilot burst and is the output of the pilot subtractor circuit .

The interference energy computation circuit is employed when the constant value c provided by the first constant generation circuit of is not known. This is the case with many reverse link applications.

An output of the LUT is connected in parallel to another input of the pilot energy signal multiplier and to another input of the pilot signal multiplier . The output of the pilot energy signal multiplier is input to a C I path accumulation circuit . An output of the C I path accumulation circuit is connected in parallel to an input of the rate power generation circuit of and to an input of an generalized dual maxima circuit .

An output of the pilot signal multiplier is connected to an input of a dot product circuit . Another input of the dot product circuit is connected to an output of the M ary Walsh decover circuit of . An output of the dot product circuit is connected to an input of an I and Q signal demultiplexer DEMUX . The I and Q DEMUX provides a quadrature output Y and an in phase output Y of the I and Q signal DEMUX are connected to an input of the generalized dual maxima circuit . An in phase metric m and a quadrature metric m of the generalized dual maxima circuit are connected to the LLR circuit see of and . The I and Q DEMUX provides a quadrature output Y and an in phase output Y of the I and Q signal DEMUX are connected to an input of the generalized dual maxima circuit .

In operation the pilot fingers filter receives a despread pilot signal from the output of the M ary Walsh decover circuit of and outputs a filtered signal p in accordance with the following equation 

where Pis a pilot signal associated with the lmultipath component of the received pilot signal and Iis the total received energy per chip as defined by the following equation 11 

where Nrepresents as previously mentioned the interference and noise component associated with the lmultipath component of the received signal and I represents the energy of the desired component of the received signal associated with the lmultipath component.

The filtered signal p is input to the pilot energy calculation circuit where the magnitude of the signal p is squared and output to the LUT . The LUT is adjusted to subtract the squared signal p from 1 and then invert the result to yield the following equation 

where Pand Iare as given for equations 10 and 11 . N as mentioned previously represents the energy associated with an interference and noise component of the received signal associated with the lmultipath component. P provides an accutate estimate of I.

The resulting output of the LUT is multiplied by the output of the pilot energy computation circuit via the pilot energy signal multiplier to yield an accurate C I value for the lmultipath component of the signal received by the system of . The C I values are added over the L multipaths comprising the received signal via the C I path accumulation circuit . The C I path accumulation circuit provides an accurate estimate of the total C I to the rate power request generation circuit of and to the dual maxima computation circuit .

The pilot signal multiplier multiplies the output of the pilot fingers filter with the output of the LUT to yield the following output y 

The output of the pilot signal multiplier as given in equation 13 is provided to the dot product circuit . The dot product circuit also receives as input a data signal d from the M ary Walsh decover circuit of . In the present embodiment the data signal d is represented by the following equation 

where Xis a quadrature amplitude modulation QAM signal associated with the lmultipath component of the signal received by the system of and Iis as given in equation 11 .

The system of implements a similar algorithm as the system of with the exception that the system of shows scaling due to automatic gain control circuitry see explicitly. The system of also shows the LUT used to convert I I to I N and to the reciprocal of N I without explicitly computing Ias in . I I is approximately equal to P I as output from the pilot energy calculation circuit of and equals E Iif E I 1 where Eis the pilot symbol energy as described above.

The dot product circuit takes the dot produce of the signal d with the signal y which are defined in equations 14 and 13 respectively and provides an output signal Y in accordance with the following equation 

where L is the total number of multipaths l is a counter and represents a particular l path of the L multipaths Yrepresents an in phase component of the received data signal and Yrepresents an imaginary quadrature component of the received data signal. The other variables i.e. X P and Nare as given for equations 13 and 14 .

The DEMUX selectively switches l Y and Q Y components of the output Y defined by equation 15 onto separate paths that are provided to the generalized dual maxima circuit that outputs metrics circumflex over m and circumflex over m respectively in response thereto to the LLR circuit of .

With reference to the FAC circuit can be inserted in the C I and Nestimation circuit of at the input of the LUT . The FAC circuit receives Nfrom the output of the subtractor circuit and the data channel output from the M ary Walsh Decover and the output of the first multiplier and outputs a new estimate of N i.e. N which is an interference including noise estimate revised for the fact that some base stations broadcast during the pilot interval and do not broadcast during the data interval. Base stations that broadcast during the pilot interval contribute to the noise and interference associated with the channel and measured via the pilot signal. If some base stations do not broadcast during the data interval but broadcast during the pilot interval the estimate of the channel noise and interference based on the pilot interval will be too large i.e. N

Waveforms broadcast by base stations include a FAC bit. The FAC bit indicates to a mobile station such as the system of whether or not the traffic channel of the associated pilot signal will be transmitting during the half frame following the next half frame. If the FAC bit is set to a logical 1 for example the forward traffic channel may be inactive. If the FAC bit is clear i.e. corresponds to a logical 0 the corresponding forward channel is inactive. The FAC bit transmitted during half frame n for the ibase station i.e. FAC n specifies the forward data channel activity for the next frame i.e. half frame n 2 .

Use of the FAC bit improves C I estimates in communications systems where some base stations broadcast during the pilot interval and not during the data interval. As a result use of the FAC bit results in superior data rate control as implemented via the rate power request generation circuit of . Use of the FAC bit also helps to ensure that forward data channel transmissions of up to 8 slots beginning with half frame n 1 and based on data rate control messages accounting for base station inactivity via the FAC bits are valid.

The FAC circuit subtracts the interference contributions from the base stations that will not be broadcasting during the data interval in accordance with the following equation.

where i is the index of the base station i.e. sector for which Nis being estimated. j is a counter that is incremented for each base station counted. Nrepresents the interference energy for the lmultipath component and associated with the data transmission for the jbase station. Similarly Nrepresents the interference energy for the lmultipath component and associated with the pilot transmission for the jbase station. is the energy of the desired signal component received from the jbase station.

With access to the present teachings those ordinarly skilled in the art can easily construct the FAC circuit without undue experimentation.

During the pilot interval and while the interference energy Nis being estimated all base stations in communication with the transceiver system of are transmitting at full power. If a certain base station is idle during the data intervals preceding and following a pilot interval then in the presence of a large multipath spread the interference from the base station may not be received during the entire duration of the pilot signal from another base station. To avoid a resulting inaccuracy in the estimation of N the base station transmits an idle skirt signal before and after pilot bursts and during idle data intervals. The length of the idle skirt signal is longer than the anticipated multipath spread associated with the channel. In a preferred embodiment the length of the idle skirt signal is configurable from a minimum length of zero to a maximum length of 128 chips.

FAC signals i.e. reverse power control channel RPC signals are also shown before and after a third pilot burst in the idle slot and a corresponding fourth pilot burst in the active slot .

In CDMA wireless communication systems such as HDR systems it is desirable to implement a rake receiver to achieve time diversity wherein the rake receiver combines the energy from time varying multipath propagations as described hereinabove. It is also desirable to implement receiver diversity via multiple receiver antennas to achieve space diversity to overcome multipath fades in the received signal energy at each antenna. Additionally a suitable choice of combiner weights for the rake receiver and configuration of multiple antenna receivers allows for interference suppression in the spatial domain.

The receiver uses the pilot symbol to determine the data symbol estimate. In the exemplary embodiment an HDR system has a time gated pilot wherein the pilot is transmitted at full power. illustrates one embodiment wherein data and pilot transmissions are mutually exclusive thus allowing the pilot symbol to be used to train the receiver in preparation for estimating the received data symbol. The receiver uses the a priori knowledge of the pilot symbol to determine a signature of the transmission channel. As the pilot occurs at a time known a priori to the receiver and the pilot is transmitted at an energy level known a priori to the receiver the pilot provides valuable information for training. The signature associated with the channel tracks the changes to a transmitted signal for a given path. The signature considers the transmission channel and the receiver processing effects. Throughout this discussion the signature is given as a vector made up of the individual associated with each path.

As illustrated in BS transmits pilot and data symbols to MSs . According to the particular implementation the BS may transmit a variety of information including but not limited to paging symbols sync symbols other traffic symbols etc. The BS transmits the symbols as signals wherein a given signal transmission from BS creates multiple transmission paths. A first direct path is generated from BS to MS and a second direct path is generated from BS to MS . The transmission signal from BS creates multipaths as echoes bounce off of structures in the environment. Multipaths are created as the transmission signal experiences geographical structure . Multipaths are created as the transmission signal experiences a building structure wherein echoes bounce off structure . Each of MSs receives the multipaths thus created and must distinguish among the various received signals. Note that geographical structure and building structure may be any structure or construct within the wireless system environment. With respect to MS path is referred to as PATH 1 path is referred to as PATH 2 and path is referred to as PATH 3. Similarly with respect to MS path is referred to as PATH 1 path is referred to as PATH 2 and path is referred to as PATH 3.

Consider a communications system in which a stream of data symbols y n are transmitted through a communications channel to a receiver. In MS has multiple antennas. A pre processor not shown at each antenna would typically comprise radio receiver Radio Frequency RF to baseband conversion receiver lowpass filtering Automatic Gain Control AGC and ADC. The inphase I and quadrature Q samples of the complex signal at the preprocessor output are input to the baseband processor. In contrast to an MRC calculation an example of which is described hereinabove wherein symbol estimates are determined for each path antenna combination MS determines symbol estimates using a Minimization of Mean Square Error MMSE approach. The MMSE method generates path specific combiner weights wherein the AL AL matrix that defines the system is reduced to L A A matrices as illustrated in described hereinbelow. Again L is the number of paths as illustrated in and A is the number of receive antennas. The exemplary embodiment considers a scenario of three paths and two receive antennas however alternate embodiments may be of any configuration including Single Input Single Output SISO wherein a given communication link has one transmit antenna and one receive antenna Single Input Multiple Output SIMO wherein a given communication link has one transmit antenna and multiple receive antennas Multiple Input Single Output MISO wherein a given communication link has more than one transmit antenna and one receive antenna Multiple Input Multiple Output wherein a given communication link has more than one transmit antenna and more than one receive antenna.

The MMSE method allows MS to generate symbol estimates for each path by considering the signal as received at multiple antennas. MS has two antennas each coupled to RAKE receivers respectively. Each RAKE receiver has 3 fingers for identifying various transmission paths. Each of the three fingers corresponds to one of the paths. For example in RAKE receivers and the fingers track paths i.e. PATH 1 PATH 2 PATH 3. Note that paths are the versions of PATH 1 PATH 2 PATH 3 received respectively at rake receiver . Note that alternate embodiments may include any number of antennas and receivers.

Continuing with within MS the PATH 1 signals from both rake receiver and rake receiver are processed by unit PATH 2 signals by unit and PATH 3 by unit . In this way MS analyzes each path for determination of the combiner weights and other parameters. Note that in alternate embodiments other parameters may be used to generate the combiner weights and similarly the combiner weights may be used to generate still other parameters as used in MS and system .

Continuing with units generate symbol estimates and SNR values for each of PATH 1 PATH 2 PATH 3 respectively. Unit generates and SNR unit generates and SNR unit generates and SNR. The symbol estimates are combined at summation node and output as a composite estimate . The SNR values are combined at summation node and output as a composite SNR. These values are then available for further processing within MS . In one embodiment the MS provides the SNR and or the composite estimate to the BS for further processing such as statistical analysis of the channel environment.

Unit includes cross correlation calculation unit weight calculation unit spatial signature generator and SNR computation unit . The data samples xand xare provided to units . The cross correlation calculation unit generates the values for used in determining a received signal autocorrelation matrix based on the received data samples xand x. The unit generates the cross correlation Ebetween all antennas of MS specifically in the present embodiment antennas . Further unit generates an expectation value for each path E E respectively.

Continuing with the values E E and Eare provided to weight calculation unit . The unit forms the autocorrelation matrix Ras given in . provides equations used in one embodiment for generating the autocorrelation matrix. The noise correlation Ris then determined as a function of the autocorrelation matrix Rand the signature. The calculation of Raccording to one embodiment is illustrated in . Additionally the unit generates a weight to be applied to PATH 1. The weight calculation uses the noise correlation and the spatial signature c. The spatial signature is generated by spatial signature generator which provides the signature vector to weight calculation unit and SNR computation unit which generates SNRassociated with PATH 1. The weight calculation unit provides the weight vector to SNR computation unit .

The unit provides the weight to the multiplier for application to data samples received on PATH 1. The data samples x from antenna and the data samples xfrom antenna are then provided to multiplier for application of the calculated weight . The multiplier outputs an estimated value for PATH 1 labeled . Operation of units and are similar to that of unit with respect to PATH 2 and PATH 3 respectively.

The method of calculating the combiner weights on a per path basis may be performed in hardware software and or firmware. The operation of each module within units may be implemented by a digital signal processor or other processing unit. A method for calculating combiner weights in a wireless communication system having is illustrated in . The MS receives a transmitted signal at step . The received signal is converted to the digital domain to form data samples. From the data samples the MS computes a cross correlation considering all receive antennas.

Continuing with the cross correlation of multiple antennas for a common path is given as in . At step the receiver computes signal expectation values for each antenna E as given in . Having calculated all the elements of the autocorrelation matrix the receiver then builds the autocorrelation matrix Rfor the received signal of a given path. The autocorrelation matrix is given in . At step the receiver computes the noise correlation matrix of the received signal. The noise correlation matrix is equal to the autocorrelation matrix minus a signature matrix wherein the signature matrix is formed by multiplying the spatial signature by its Hermitian value. Finally the receiver computes the weights for the given path.

Basically the method computes the correlations to estimate a noise autocorrelation matrix and the desired signature. This MMSE approach computes MMSE per path combiner weights by matrix inversion. The computed weights are then used to combine signal paths from rake receiver fingers for all receive antennas of the receiver. Further a SNR estimate is calculated based on the desired signal signature and the MMSE weights. The SNR estimate may be used for rate and or power control. The LLRs may be calculated based on the SNR estimate and the MMSE combined signal path wherein the LLRs are fed to the channel decoder circuitry not shown .

In a CDMA system with PN spreading and Walsh covering it is often reasonable to assume that the interference associated with different paths are uncorrelated on all antennas but that interference associated with the same path are correlated across different antennas. With this assumption it is possible to disjointly compute the A combiner weights for each of the L paths and thus invert L different A A matrices as illustrated in . Such computation is for the spatial MMSE weights for each of the L paths i.e. spatial MMSE for uncorrelated interference on different paths. One embodiment of the resultant autocorrelation matrix is illustrated in wherein each path has a smaller matrix on the diagonal of the autocorrelation matrix. While still more complex than that of the MRC method these smaller matrices are easier to manipulate and invert than a full matrix thus reducing the problem to L A A matrix inversions.

Referring again to for a receiver with two antennas and L RAKE fingers per antenna assume the interference associated with different paths is uncorrelated. For the lth path compute the 2 1 complex combining vector by calculating 

When the CDMA system includes PN spreading and Walsh covering the baseband processor first PN despreads and then Walsh decovers the appropriately interpolated and or aligned baseband samples for the ath antenna and lth path yielding the chip rate samples z n . The spatial signature is computed from pilot filtering the received samples corresponding to the N chip pilot interval 

The noise autocorrelation matrix is then computed by subtracting the outer product of the spatial signature from the received signal autocorrelation matrix . 20 

Although the Rwas inverted to compute the combiner weights it is also possible to average or filter the Rfrom successive pilot bursts and then invert the resulting averaged or filtered matrix. To invert the 2 2 Rand calculate the MMSE combiner weights for the lth path and make use of the simple result that 

The LLRs fed to the channel decoder are based on the SNR computed in equation 15 and the combined signal path computed in equation 24 .

The noise autocorrelation matrix Rwill generally be different for each path because that path s contribution is subtracted as per equation 20 . In this embodiment it is possible to calculate the spatial MMSE coefficients for each path by estimating and calculating the spatial signatures

Each of the above detailed methods of estimating a received signal utilizes a variety of assumptions. The MRC approach considers all noise as independent. Such an assumption may be particularly applicable in a voice communication system wherein the ratio of the signal to pilot is high. In a CDMA or spread spectrum type system it is reasonable to assume that the other users may be treated as noise. In a data communication system however this assumption is not always accurate. Therefore a MMSE approach may prove more accurate and efficient in an HDR environment. In contrast to the MRC method the MMSE approach is performed per channel and considers all of the energy received on each receive antenna. The MMSE approach uses the full power pilot to train the adaptive filters and then applies the resultant values to the received data. The MMSE approach improves the C I estimate and therefore allows for more accurate and efficient Data Rate Control DRC decisions. The MMSE also improves the weights and the resultant signal estimates. Like the MRC approach the MMSE approach assumes noise to be independent.

It is desirable to apply the spatial MMSE approach for determining combiner weights to a system wherein the pilot is transmitted concurrently with other signals such as traffic signals. In a cdma2000 type system the pilot signal is transmitted continuously and shares the power of the transmitter with the traffic information. In such a system wherein the pilot signal is not time gated i.e. is not Time Division Multiplexed extraction of the pilot energy is not straightforward. One example is a CDMA type system having a pilot signal or other signal known a priori by the transmitter and receiver that is not time gated i.e. time multiplexed with other signals.

An alternate embodiment applicable in such spread spectrum systems may be implemented by considering an analog of equation 23 above namely replacing 

wherein is the spatial signature. The covariance term is analogous to the autocorrelation of the noise R the first term on the right side of the equation is analogous to the autocorrelation of the signals R. The second term on the right side of the equation includes a first term representing the relative energy of the pilot signal to the energy of other channels and a second term representing a correction term. As given in equation 28 x is the sample value m is a time index d is a data symbol and N is the length of the Walsh code. The covariance of equation 28 is based on the correlation of the signals prior to despreading. The despread signal is given as 

The spatial signature is computed by despreading and decovering the pilot channel i.e. for a CDMA system by filtering the pilot signal or other known signal and is given as 

wherein P is the PN code i is the user index associated with the PN code j is the index of the Walsh code and is defined as 1 if i j and else is equal to 0. 33 

wherein i is the user or transmitter index i.e. the PN code index in a CDMA system with unique PN codes associated with each transmitter j is the receiver index i.e. the Walsh code index in a CDMA system with Walsh code assignment to the receiver n is a time index d is the data symbol for the jth channel of user i w is the Walsh code for the jth channel of user i p is the PN code which is the same for all channels of user i is the spatial signature of the channel wherein is the same for all channels j of a user i. One of the channels j corresponds to the pilot channel. The last term corresponds to noise. Note that in one embodiment for a Forward Link FL system l corresponds to a base station and j corresponds to the Walsh channels. In an alternate embodiment for a Reverse Link RL system l corresponds to a mobile station and j corresponds to the parallel Walsh channels transmitted by that mobile station.

wherein q t h t circle around h t and t t circle around h t . Here Tc is the chip period and is an offset for the kth path. The sample definition thus reduces to 

wherein N is the length of the Walsh code and is the variance of white noise. By assuming q mT nT 0 m n it can be shown that 

wherein the difference of equations 40 and 39 is the error correction term. The combiner weights for the lth subchannel of the kth user are then given as . 41 

Application of an adjustment term that considers the relative energy of the pilot to other terms results in 

which provides the iterative definition of the combiner weights i.e. the combiner weight solution. The combiner weight solution is the product of the covariance matrix of the despread signal and the spatial signature.

By application of equation 42 the spatial MMSE approach for determining combiner weights is applicable to a system wherein the pilot is transmitted concurrently with other signals such as traffic signals.

In general for a system with A antennas and L RAKE fingers per antenna specifying the MMSE combiner weights requires computing AL complex weights one for each antenna of each path . Consider the nth received complex sample for antenna a and path l wherein these samples can be calculated by a suitable interpolation and or aligning of the I Q baseband sample stream input to the baseband processor. In an exemplary embodiment the samples x m may be generated at the CDMA chip rate e.g. 1.2288 Mcps or higher e.g. 2 1.2288 Mcps while the transmitted data symbols y n are at the chip rate. The chip rate samples aligned with the lth path are given as 43 

wherein s n is the desired signal complex amplitude y n is the transmitted symbol stream and n n is comprised of all other additive noise and interference terms. It is desirable to choose the AL combiner weights wfor sample n to form the symbol estimate 

By forming length AL column vectors for the received samples and combiner weights it is possible to rewrite equation 41 as 45 

wherein represents conjugate transpose. Assume that the channel and interference vary slowly enough that the statistics of the received signal do not change during a pilot burst. Under these assumptions it is possible to rewrite equation 31 as 47 

The AL 1 desired signal signature vector is defined as . By calculating the AL AL noise autocorrelation matrix R the MMSE choice for the combiner weight vector can be written as 48 

Thus it is possible to determine the MMSE combiner weights upon accurate estimation of Rand and by inversion of the AL AL matrix. Furthermore the SNR i.e. C I at the output of the MMSE combiner can be calculated as 50 

This SNR measure calculated at the terminal can be used to transmit power control and rate control information from the terminal to the base station on the reverse transmission link.

The various methods of determining combiner weights discussed hereinabove make a variety of assumptions regarding the noise and interference of as received at a receiver. According to an alternate embodiment signal estimation uses an MMSE based dynamic algorithm such as Least Mean Square LMS or Recursive Least Squares RLS to obtain a set of weights without any assumptions as to the correlations between different fingers. In other words the method includes noise correlations across paths. Such methods lead to a set of weights that achieves a higher SINR than would be achieved by the MRC algorithm. The exemplary embodiment employs a CDMA waveform with a time gated pilot transmitted at full power such as IS 856 forward link. Regardless of the specific processing per finger the final step in operation of the rake receiver involves combining the finger outputs to produce the final symbol estimate. The following signal model is applicable for the output of a given finger just prior to the combiner and is given as 51 

The combining operation can be viewed as a simple complex inner product between the set of weights and the set of samples coming from the F fingers 53 

where c k is an F dimensional complex vector containing the channel coefficients i.e. the signature given as 

Note that the channel gains vector and the noise correlation matrix depend on k the time index. However in most practical scenarios i.e. different velocities of transmitter receiver multipath profiles etc. these quantities change only slowly with respect to the chip rate. In fact it is common to assume constancy for several thousand chips. By application of this approach and dropping the time index of the vectors the resultant MMSE weights are independent of k 56 

The traditional MRC method avoids this inversion by using a pilot sequence having known symbols to obtain estimates of c and the diagonal terms of R i.e. the variance of the individual noises at the output of each finger. With this information and the assumption that the off diagonal terms of Rare all zero the combiner weight for finger f can be computed as 

where is the diagonal element of R. The assumption that the off diagonal matrix elements are zero is valid only if the offsets of the fingers are far apart. This assumption becomes less and less accurate as the fingers become proximate. In some channels where it is necessary to place fingers close to each other to collect multipath energy application of the MRC combiner weights of equation 55 will lead to substantial performance degradation.

For improved operation it is desirable to drop this assumption and use a Mean Square Error MSE method based on a dynamic algorithm to compute the vector of weights. There are a variety of different ways of solving equation 56 such as direct matrix inversion the LMS algorithm the RLS algorithm and variants of these.

The direct matrix inversion considers the noise correlation across paths and the full autocorrelation matrix without assumptions. The direct matrix inversion is the most accurate method of determining weight values however the direct matrix inversion requires complicated and complex matrix operations increasing processing time and consuming a great amount of processing power. The other methods make simplifying assumptions or use adaptive algorithms or a combination thereof that allow shortcut solutions to the matrix inversion problem. Some of these methods are more suitable for implementation in a digital receiver than others.

Under the assumption that the vector c is uncorrelated with the vector of interference N solving equation 56 is equivalent to solving equation 58 given hereinbelow in terms of SINR performance of the solution because both solutions only differ by a constant 58 

Using the RLS algorithm to compute W based on the known pilot sequence that is time division multiplexed with the unknown data the adaptive algorithm will change the filter coefficients during the pilot bursts and the weights would be held constant for the demodulation of the data to produce the estimates of the unknown symbols. In other words the weights are trained on the pilot bursts and the trained weights are used for processing traffic.

Note that alternate embodiments may apply other recursive algorithms for determining mean square error as well as alternate methods of implementing those algorithms. The RLS algorithm recursively updates the estimate k at each pilot symbol based on its prior value the input data the know symbol and a matrix that the algorithm keeps updating as well 

The K is a gain term applied to weight updates as indicated in equation 60 . The gain term K is a function of which is a history gain factor for the algorithm the history gain determines an amount of past iterative information maintained by the algorithm.

Under suitable conditions the combining coefficient vector k will converge to the W defined in equation 58 . Simulations have shown that this MMSE approach for selecting combiner weights provides important performance advantages over the MRC approach. The gains can be significant particularly when fingers are spaced within a few chips and or the predominant component of the interference at a given finger stems from multipath rather than additive thermal noise or other user interference.

In one embodiment illustrated in B and C an RLS algorithm is applied to an adaptive transversal filter such that given the least squares estimate of the weight vector of the filter i.e. vector of tap weights at iteration n 1 the updated estimate is computed for iteration n upon arrival of new inputs. An important feature of the RLS algorithm is the utilization of information contained in the input data extending back to the instant of time when the algorithm is initiated. The resulting rate of convergence is therefore typically an order of magnitude faster than the simple LMS algorithm.

As illustrated in the system includes a transversal filter coupled to a weight control unit . For input x k the transversal filter applies a weight vector W k 1 wherein the weight vector includes weights assigned to the various taps of the transversal filter . The input x k is also provided to a weight control unit for adapting the weights of the weight vector according to the algorithm. The output of the transversal filter is then the application of the weights to the input x k wherein the output of the transversal filter is provided to a summing node . The summing node receives the desired signal and subtracts the output of the transversal filter to provide an error signal to the weight control unit . The weight control unit uses this information as applied to the RLS algorithm and updates the weights for the taps of the transversal filter . Note that according to one embodiment the weight control unit trains using a time gated pilot signal wherein the updates to the tap weights occur during the pilot interval.

The RLS method is further illustrated in wherein process starts by receiving a frame n including pilot and traffic information at step . The filter is trained to determine the weights to apply in the filter by using the pilot symbols at step . The filter then uses the weights to demodulate the traffic including data information. The training involves application of the RLS equations provided hereinabove to determine a new weight vector on each iteration of the algorithm. Alternate embodiments may use alternate adaptive algorithms wherein the weights of the filter are adjusted iteratively without requiring complex matrix inversion.

A system implementing an RLS algorithm for a spread spectrum system is illustrated in having two antennas each coupled to a rake type receiver respectively. Each of rake receivers is illustrated as having three fingers for processing received signals. The outputs of rake receivers are provided to estimation unit . Estimation unit also receives a pilot reference y k . The estimation unit processes the signals received from rake receivers by combining the signals received on each path. Each path is weighted prior to combination with the weighted signals from other paths. The adjustment of these combiner weights is performed using the RLS algorithm. The estimation unit uses a signal that is known a priori to train the combiner weights. The output of estimation unit is the estimate n and an estimate of the SNR of the received signal. Alternate embodiments may implement alternate adaptive algorithms for determining combiner weights wherein the algorithm seeks to minimize the mean square error between the estimated signal and the transmitted signal.

Thus a variety of methods have been illustrated hereinabove for determining combiner weights. Each method finds application according to the design and resource requirements of a given system. A trade off exists between accuracy and computational complexity i.e. cost. The various methods and wireless systems described hereinabove provide improved accuracy while reducing the computational complexity. While the various embodiments have been described with reference to a CDMA type spread spectrum communication system the concepts are applicable to alternate spread spectrum type systems as well as other type communication systems. The methods and algorithms presented hereinabove may be implemented in hardware software firmware or a combination thereof. For example using the MMSE approach to a non time gated pilot the equations for solving for the combiner weights may be performed in software or using a Digital Signal Processor DSP to perform the calculations. Similarly the adaptive algorithms may be implemented in software in the form of computer readable instructions stored on a computer readable medium. A Central Processing Unit such as a DSP core operates to perform the instructions and provide signal estimates in response. Alternate embodiments may implement hardware such as an Application Specific Integrated Circuit ASIC where feasible.

Those of skill in the art would understand that information and signals may be represented using any of a variety of different technologies and techniques. For example data instructions commands information signals bits symbols and chips that may be referenced throughout the above description may be represented by voltages currents electromagnetic waves magnetic fields or particles optical fields or particles or any combination thereof.

Those of skill would further appreciate that the various illustrative logical blocks modules circuits and algorithm steps described in connection with the embodiments disclosed herein may be implemented as electronic hardware computer software or combinations of both. To clearly illustrate this interchangeability of hardware and software various illustrative components blocks modules circuits and steps have been described above generally in terms of their functionality. Whether such functionality is implemented as hardware or software depends upon the particular application and design constraints imposed on the overall system. Skilled artisans may implement the described functionality in varying ways for each particular application but such implementation decisions should not be interpreted as causing a departure from the scope of the present invention.

The various illustrative logical blocks modules and circuits described in connection with the embodiments disclosed herein may be implemented or performed with a general purpose processor a digital signal processor DSP an application specific integrated circuit ASIC a field programmable gate array FPGA or other programmable logic device discrete gate or transistor logic discrete hardware components or any combination thereof designed to perform the functions described herein. A general purpose processor may be a microprocessor but in the alternative the processor may be any conventional processor controller microcontroller or state machine. A processor may also be implemented as a combination of computing devices e.g. a combination of a DSP and a microprocessor a plurality of microprocessors one or more microprocessors in conjunction with a DSP core or any other such configuration.

The steps of a method or algorithm described in connection with the embodiments disclosed herein may be embodied directly in hardware in a software module executed by a processor or in a combination of the two. A software module may reside in RAM memory flash memory ROM memory EPROM memory EEPROM memory registers hard disk a removable disk a CD ROM or any other form of storage medium known in the art. An exemplary storage medium is coupled to the processor such the processor can read information from and write information to the storage medium. In the alternative the storage medium may be an integral part of the processor. The processor and the storage medium may reside in an ASIC. The ASIC may reside in a user terminal. In the alternative the processor and the storage medium may reside as discrete components in a user terminal.

The previous description of the disclosed embodiments is provided to enable any person skilled in the art to make or use the present invention. Various modifications to these embodiments will be readily apparent to those skilled in the art and the generic principles defined herein may be applied to other embodiments without departing from the spirit or scope of the invention. Thus the present invention is not intended to be limited to the embodiments shown herein but is to be accorded the widest scope consistent with the principles and novel features disclosed herein.

