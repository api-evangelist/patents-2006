---

title: Automatically controlling operation of a BRAS device based on encapsulation information
abstract: A technique controls operation of a BRAS device. The technique involves extracting encapsulation information from a communications exchange between a CPE device and an external server device (e.g., a DHCP server). The communications exchange passes through the BRAS device and a DSLAM device. The technique further involves storing the encapsulation information in local memory of the BRAS device, and controlling a flow of a downstream communication passing through the BRAS device and the DSLAM device toward the CPE device based on the encapsulation information stored in the local memory of the BRAS device. Accordingly, the BRAS device is well suited for performing ATM overhead accounting as well as shaping and policing downstream traffic.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07821941&OS=07821941&RS=07821941
owner: Cisco Technology, Inc.
number: 07821941
owner_city: San Jose
owner_country: US
publication_date: 20061103
---
A Digital Subscriber Line Access Multiplexer DSLAM is a network device that is capable of receiving upstream signals from multiple subscribers e.g. Customer Premises Equipment or CPE and aggregating these upstream signals onto backbone switching equipment such as a Broadband Remote Access Server BRAS of a Network Service Provider NSP . In a typical CPE DSLAM BRAS layout the communications between the CPE and DSLAM is ATM based e.g. Point to Point over asynchronous transfer mode or PPPoA while the communications between the DSLAM and the BRAS is generally packet based.

A number of standards are available which enable encapsulation of Local Area Network LAN and Wide Area Network WAN protocols over ATM e.g. AAL5 AAL3 RBE PPPoE PPPoA IPoA IMA and so on . Such standards provide different alternatives for integrating ATM communications into existing WAN and or LAN communications.

Moreover since packets can be quite large e.g. 8 000 bytes in length but ATM cells are fixed at 53 bytes in length i.e. the first 5 bytes being header information and the remaining 48 bytes being reserved for data the overhead cost of using ATM is relatively high. That is relatively speaking the 5 byte header is an excessive overhead cost and cuts into the amount of data that can be transferred between the CPE and the DSLAM. Along these lines the term ATM cell tax is often used to describe the overhead cost imposed by ATM cells.

Nevertheless providers typically offer Quality of Service QoS support to their subscribers and thus intelligently apportion data within the fixed 48 byte data fields of ATM cells in a hands on manner. One way to accomplish this hands on apportionment is for the providers to manually configure BRAS equipment to control the downstream flow of network traffic with knowledge that packetized communications between the BRAS and the DSLAM will then face ATM encapsulation from the DSLAM to the CPE. In particular technicians of the providers manually enter knowledge of the downstream protocols in use from the DSLAM to the CPE e.g. PPPoA and a conversion scheme which appropriately accounts for the ATM cell tax. Such operation involves the technicians entering such information through a command line interface CLI of the BRAS equipment.

For example if the BRAS receives a 64 byte packet en route to the DSLAM and if the BRAS knows that the DSLAM will split the 64 byte packet into two 53 byte ATM cells the BRAS can impose a level of flow control which is commensurate for two 53 byte ATM cells i.e. 106 bytes in total . Accordingly the BRAS may impose a scheme for shaping and policing the downstream flow which is more favorable to the DSLAM. As a result the operation of the DSLAM can be improved e.g. less dropped packets enhanced ability to preserve packet priorities etc. . It should be understood that different encapsulations will have different overhead and thus require different computations.

Unfortunately the above described conventional approach which involves technicians manually configuring BRAS equipment to account for a particular ATM encapsulation scheme suffers from a variety of deficiencies. For example it is extremely burdensome for technicians to manually configure the BRAS equipment through a CLI. That is each configuration endeavor is labor intensive and susceptible to human error. Furthermore such manual configuring may significantly slow down the process of adding new subscribers. Furthermore whenever the encapsulation between the DSLAM and the subscriber CPE changes the technicians of the providers need to manually update the knowledge of the changed encapsulation in the BRAS device.

In contrast to the above described conventional approach to manually configuring BRAS equipment to account for a particular ATM encapsulation scheme an improved technique involves automatically controlling operation of a BRAS device i.e. a data communications device configured to perform BRAS operations based on encapsulation information obtained from communications flowing through a DSLAM device i.e. a data communications device configured to perform DSLAM operations and the BRAS device. Such encapsulation information e.g. the particular type or types of ATM encapsulation is easily acquired by the BRAS device e.g. from a exchange of Dynamic Host Configuration Protocol or DHCP messages between the CPE and a DHCP server passing through the DSLAM and BRAS devices thus removing the burden of a technician having to configure the BRAS device manually. Accordingly the time delays human error risks and related burdens associated with a technician manually configuring the BRAS device are alleviated.

One embodiment is directed to a method of controlling operation of a BRAS device. The method includes extracting encapsulation information from a communications exchange between a CPE device and an external server device e.g. a DHCP server . The communications exchange passes through the BRAS device and a DSLAM device. The method further includes storing the encapsulation information in local memory of the BRAS device and controlling a flow of a downstream communication passing through the BRAS device and the DSLAM device toward the CPE device based on the encapsulation information stored in the local memory of the BRAS device. Accordingly the BRAS device is well suited for performing ATM overhead accounting as well as shaping and policing downstream traffic.

Each subscriber is customer premises equipment which is configured to acquire a network address using DHCP. In particular each subscriber is configured to operate as a DHCP client that obtains and renews an IP network address from the DHCP server . To facilitate such operation the DSLAM device includes an enhanced DHCP relay agent D and the BRAS device includes another enhanced DHCP relay agent B . The DHCP relay agents D B collectively DHCP relay agents are configured to relay DHCP messages from the CPE upstream to the DHCP server . The DHCP relay agents are further configured to relay DHCP messages from the DHCP server downstream to the CPE.

Moreover the DHCP relay agent D is configured to receive upstream DHCP messages and add a Relay Agent Information option e.g. option code 82 information thus generating DHCP messages . Similarly the DHCP relay agent B are configured to receive upstream DHCP messages and add a Relay Agent Information option thus generating DHCP messages . A description of DHCP options is provided in a publication entitled RFC 2132 DHCP Options and BOOTP Vendor Extensions by S. Alexander and R. Droms dated March 1997 the teachings of which are hereby incorporated by reference in their entirety.

Along these lines and as will be explained in further details later the DHCP relay agent D is configured to participate in the addition of encapsulation information within DHCP communications through the system while the DHCP relay agent B is configured to automatically acquire the encapsulation information from the DHCP communications and then shape and police downstream traffic based on the acquired encapsulation information. In contrast to conventional approaches for ATM overhead accounting such operation by the enhanced DHCP relay agents occurs dynamically and without the need for any manual adjustment thus saving substantial set up time and effort. At this point it should be understood that a suitable network topology for the system is that of WT 101 where the DSLAM device operates as an access node and is configured to add DHCP relay agent information containing information on the port e.g. DSL line of the subscriber requesting an IP network address .

To obtain an IP network address the subscriber outputs DHCP client messages e.g. DHCPDISCOVER DHCPREQUEST etc. to the DHCP server . The DHCP server responds to the DHCP client messages from the subscriber with DHCP server messages e.g. DHCPOFFER DHCPACK etc. . Some or all of these DHCP messages between the subscriber and the DHCP server collectively DHCP signals may be forwarded and embellished by the DHCP relay agents D B collectively relay agents . In this manner IP addresses are robustly and reliably assigned and managed within the system . A suitable technique for exchanging DHCP information which involves multiple DHCP relay agents is described in U.S. patent application Ser. No. 11 495 273 entitled TECHNIQUES FOR EXCHANGING DHCP INFORMATION AMONG DHCP RELAY AGENTS AND DHCP SERVERS the entire teachings of which are hereby incorporated by reference.

Once the subscribers have obtained network addresses from the DHCP server the subscribers are then well equipped to exchange signals with a variety of external devices e.g. the device . For example the subscribers can then operate as subscriber edge devices that obtain web content from various web servers over the Internet.

It should be understood that within the flow of the DHCP signals is encapsulation information which identifies the type of ATM encapsulation carried out for communications between the subscribers and the DSLAM device i.e. the particular protocols utilized in communications flowing through the final leg extending between the DSLAM device and CPE . The BRAS device is configured to i automatically obtain such information from the DHCP signals and then ii control the manner in which communications flow between the BRAS device and the DSLAM device based on that information i.e. the communications leg between the BRAS device and the DSLAM device . In particular the BRAS device is configured to determine the particular ATM cell tax incurred due to ATM encapsulation for the edge communications and thus throttle the edge communications in the downstream direction to preserve QoS to the subscribers . Such ATM overhead accounting enhances subscriber QoS e.g. provides less dropped packets enhances the ability of the system to preserve packet priorities etc. but without the burden of forcing technicians to manually configure a BRAS as in conventional approaches.

For example based on the encapsulation information automatically gathered by monitoring the DHCP signals suppose that the BRAS device determines that the type of ATM encapsulation employed between the subscribers and the DSLAM device results in 53 byte ATM cell transmissions with 5 byte headers. That is the DSLAM device will split a 64 byte packet from the BRAS device into two 53 byte ATM cells. Armed with this knowledge the BRAS device is capable of controlling the rate of data flowing in the downstream direction to the CPE e.g. throttling packets dropping lower priority packets combining or dividing packets classifying and queuing packets etc. so that the subscribers properly receive their prescribed QoS. Further details will now be provided with reference to .

In some arrangements the DSLAM module and the DHCP relay agent module operate on separate designated circuits within the DSLAM device . In other arrangements the DSLAM module and the DHCP relay agent module run on the same circuitry e.g. as different processes or threads on the same set of processors . In all of these arrangements the DSLAM module and the DHCP relay agent module are configured to communicate with each other e.g. via one or more internal communications buses via one or more inter process communications schemes via operating system and or application programming interfaces combinations thereof etc. .

In the manner of traditional DHCP relay agents the DHCP relay agent module conveys the DHCP messages between the subscribers and the DHCP server also see . However the DHCP relay agent module is further configured to add encapsulation information as relay agent information under option code 82 e.g. also see RFC 2132 to the upstream DHCP messages and to extract such relay agent information from corresponding downstream DHCP messages . Along these lines the network interface is configured to receive a DHCP client message from a subscriber and provide the DHCP client message to the DHCP relay agent module . The DHCP relay agent is configured to then send a request to the DSLAM module asking for the type or types of encapsulation employed for the communications between the subscribers and the DSLAM device . It will be appreciated that a variety of protocols are available for use such as AAL5 AAL3 RBE PPPoE PPPoA IPoA IMA and so on. Upon receipt of a response indicating the type or types of encapsulation carried out for the communications the DHCP relay agent inserts one or more identifiers which identifies the type or types of encapsulation as contents of a relay agent information option e.g. option code 82 within the DHCP client message and then provides this embellished DHCP client message to the network interface which forwards the DHCP message upstream.

It should be understood that the DSLAM module is configured to continue to provide the encapsulation information within subsequent DHCP messages from the same subscribers i.e. DHCP clients during IP address renewal operations. That is when the subscribers send new DHCP messages to the DHCP server to renew their network addresses the DSLAM module adds the encapsulation information for these clients to the DHCP messages to continuously inform the BRAS device of the type of ATM encapsulation carried out on behalf of the subscribers . Further details will now be provided with reference to .

In some arrangements the BRAS module and the DHCP relay agent module operate on separate designated circuits within the BRAS device . In other arrangements the BRAS module and the DHCP relay agent module run on the same circuitry e.g. as different processes or threads on the same set of processors . In all arrangements the BRAS module and the DHCP relay agent module are configured to communicate with each other e.g. via one or more internal communications buses via one or more inter process communications schemes via operating system and or application programming interfaces combinations thereof etc. .

As further shown in the DHCP relay agent includes a controller and memory . The controller is configured to extract the encapsulation information from the DHCP communications exchange between the subscribers i.e. DHCP clients and the DHCP server . The controller stores this encapsulation information in the memory . As a result the BRAS module is capable of controlling the flow of downstream communications passing through the BRAS and DSLAM devices based on the encapsulation information.

In some arrangements the encapsulation information is stored in the memory as an entry of a database of multiple entries . In these arrangements each entry corresponds to a particular subscriber and the particular form of ATM overhead accounting carried out for that subscriber .

Furthermore in some arrangements the memory and the database resides within and is managed by the BRAS module rather than the DHCP relay agent module . In these arrangements the DHCP relay agent module simply conveys the encapsulation information to the BRAS module as part of its communications see with the BRAS module .

It should be understood that the DHCP relay agent module is configured to continue to provide the encapsulation information from subsequent DHCP communications to the BRAS module during IP address renewal operations. That is when the subscribers send new DHCP messages to the DHCP server to renew their network addresses the DSLAM device adds the encapsulation information for these clients to the DHCP messages . The DHCP relay agent module then extracts this encapsulation information from the DHCP communications i.e. either the upstream DHCP messages or the downstream DHCP messages to continuously inform the BRAS module of the type of ATM encapsulation carried out on behalf of the subscribers .

At this point it should be understood that there are different operating modes in which the DHCP relay agent module is capable of obtaining the encapsulation information from the DHCP messages . In one operating mode the DHCP relay agent module is configured to snoop the encapsulation information from upstream DHCP messages from the DSLAM device en route to the DHCP server . In another operating mode the DHCP relay agent module is configured obtain the encapsulation information from the DHCP server within downstream DHCP response messages from the DHCP server . Further details of these two different operating modes will now be provided with reference to .

In step the DHCP relay agent module stores the encapsulation information in the memory . In some arrangements the DHCP relay agent module stores the encapsulation information as a database entry associated with the particular subscriber see the database in .

In step the BRAS module of the BRAS device then controls the flow of a downstream communication passing through the BRAS device and the DSLAM device toward the subscriber based on the encapsulation information stored in the memory . For example the BRAS module is capable of throttling downstream traffic from other devices see the device in dropping lower priority packets combining or dividing packets classifying and queuing packets and so on so that the subscribers properly receive their prescribed QoS. Accordingly the BRAS device robustly and reliably shapes and polices traffic to maintain QoS for the subscriber .

In step the network interface of the BRAS device receives a DHCP message en route from the DHCP server back to a particular subscriber in response to an earlier DHCP request message . In particular the subscriber sent that DHCP request message upstream to obtain an assigned network address from the DHCP server . As that DHCP request message traveled upstream through the DSLAM device the DSLAM device added encapsulation information as Option information to the DHCP request message . The DHCP server then generated the DHCP response message and provided further encapsulation information within the DHCP response message e.g. as Option information to direct the BRAS device . Accordingly the DHCP relay agent module of the BRAS device then extracts the encapsulation information from DHCP messages .

In step the DHCP relay agent module stores the encapsulation information in the memory in a manner similar to that described above in connection with . For example in some arrangements the DHCP relay agent module stores the encapsulation information as a database entry associated with the particular subscriber see the database in .

In step the BRAS module of the BRAS device then controls the flow of a downstream communication passing through the BRAS device and the DSLAM device toward the subscriber based on the encapsulation information stored in the memory . For instance once the subscriber is operational and begins acquiring content from other devices through the network the BRAS module is capable of throttling packets dropping lower priority packets combining or dividing packets classifying and queuing packets and so on so that the subscribers properly receive their prescribed QoS. As a result the BRAS device robustly and reliably shapes and polices traffic to maintain QoS for the subscriber .

In the return direction the DHCP server replaces the DHCP relay agent information of the BRAS device with direction as to how to perform ATM overhead accounting for downstream traffic i.e. represented in as OPT ENCAPS FOR BRAS. Such information is capable of being added automatically by the DHCP server e.g. based on a lookup procedure from a predefined table within the DHCP server thus alleviating the need for a technician to manually configure the BRAS device . Next the BRAS device extracts the direction from the DHCP server and subsequently shapes and polices traffic passing through the BRAS device and the DSLAM device en route to the subscriber based on this direction.

As described above embodiments of the invention are directed to techniques for automatically controlling operation of a BRAS device based on encapsulation information e.g. an identifier of the type or types of encapsulation obtained from communications flowing through a DSLAM device and the BRAS device . Such encapsulation information is easily acquired e.g. through monitoring of DHCP messages thus removing the burden of configuring the BRAS device manually e.g. by a technician in order to account for encapsulation overhead.

While various embodiments of the invention have been particularly shown and described it will be understood by those skilled in the art that various changes in form and details may be made therein without departing from the spirit and scope of the invention as defined by the appended claims.

