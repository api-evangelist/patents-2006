---

title: Provision of location-based services utilizing user movement statistics
abstract: Location-based services are provided in a communication system comprising at least a portion of at least one wireless network. One aspect of the invention relates to generation of user movement statistics that may be utilized to facilitate the development of targeted marketing campaigns or other types of message delivery. In this aspect, the user movement statistics are generated based on location and profile information for mobile user devices, and delivery of at least one message to a given one of the mobile user devices is controlled based on the user movement statistics. The user movement statistics may comprise, for example, information sufficient to determine approximately how many users having particular designated characteristics are likely to be in a given location at a given time, and may be utilized to determine prices charged for delivery of messages to the mobile user devices.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07756534&OS=07756534&RS=07756534
owner: Alcatel-Lucent USA Inc.
number: 07756534
owner_city: Murray Hill
owner_country: US
publication_date: 20060519
---
Ser. No. 11 437 154 entitled Methods and Apparatus for Providing Location Based Services in a Wireless Communication System. 

Ser. No. 11 437 065 entitled Auctioning of Message Delivery Opportunities in a Location Based Services System. 

Ser. No. 11 437 157 entitled Prioritization of Location Queries in a Location Based Services System. 

All of the above listed applications are filed concurrently herewith and are incorporated by reference herein.

The present invention relates generally to wireless networks and other types of wireless communication systems and more particularly to techniques for providing location based message delivery and other services to mobile user devices in such systems.

A wide variety of different types of wireless communication systems are known. For example a typical wireless cellular network includes a multitude of interconnected base stations which communicate with mobile user devices within defined coverage areas.

Recently techniques have been developed which deliver advertising or other types of messages to mobile user devices based on the current locations of those devices. Thus if a given user device is determined to be in close proximity to a particular retail establishment an advertisement associated with that establishment may be delivered to the user device.

Examples of techniques of this type are described in U.S. Patent Application Publication Nos. 2002 0095333 entitled Real Time Wireless E Coupon Promotion Definition Based On Available Segment 2002 0164977 entitled System and Method for Providing Short Message Targeted Advertisements Over a Wireless Communications Network 2003 0198346 entitled Push Delivery Service Providing Method Information Providing Service System Server System and User Station 2004 0209602 entitled Location Based Content Delivery 2005 0221843 entitled Distribution of Location Specific Advertising Information Via Wireless Communication Network 2005 0227711 entitled Method and Apparatus for Creating Directing Storing and Automatically Delivering a Message to an Intended Recipient Upon Arrival of a Specified Mobile Object at a Designated Location and 2006 0058037 entitled Custom Information For Wireless Subscribers Based on Proximity. 

Unfortunately conventional wireless communication systems such as those described in the above cited references suffer from a number of significant drawbacks. For example the conventional systems are typically configured in a manner which can lead to excessive location queries or other types of location related communications between the base stations and the mobile user devices thereby undermining the ability of the systems to support their primary voice and data traffic functionality. Also the above noted systems are lacking in terms of the revenue generating capabilities that are provided. In view of these and other problems associated with conventional practice a need exists for improved techniques for delivering location based services to mobile user devices.

The present invention in one or more illustrative embodiments provides improved techniques for delivering location based services to mobile user devices associated with a wireless network.

One aspect of the invention relates to generation of user movement statistics that may be utilized to facilitate the development of targeted marketing campaigns or other types of message delivery. In this aspect the user movement statistics are generated based on location and profile information for the mobile user devices and delivery of at least one message to a given one of the mobile user devices is controlled based on the user movement statistics.

The user movement statistics may comprise for example information sufficient to determine approximately how many users having particular designated characteristics are likely to be in a given location at a given time and may be utilized to determine prices charged for delivery of messages to the mobile user devices. The user movement statistics may also or alternatively be utilized to determine appropriate bidding levels for auction of one or more message delivery opportunities to interested parties to estimate impact of a marketing campaign comprising messages to be delivered to the mobile user devices or for other purposes relating to the controlled delivery of messages.

In an illustrative embodiment the operations associated with generation and utilization of user movement statistics are implemented at least in part in a location based services system referred to herein as a Gcast system which may be coupled to a message service center or other element of the wireless network via a gateway. The location based services system may be coupled to a marketing message database and a subscriber information database. The location based services system may comprise by way of example at least one processing device accessible to a browser equipped external processing device over an Internet protocol network. The location based services system may comprise a location server that is configured to minimize location related communications between the mobile user devices and base stations of the wireless network by for example eliminating duplicate location queries and prioritizing location queries.

The present invention in the illustrative embodiments provides significant advantages over the conventional systems identified above. For example the number of location queries and other types of location related communications that are required can be considerably reduced while still allowing implementation of a wide variety of location based services within the communication system. This prevents location related communications from overwhelming the wireless network and interfering with the primary voice and data traffic functionality of that network. Furthermore many additional revenue generating capabilities are provided including the above noted auction of message delivery opportunities as well as more effective marketing through utilization of user movement statistics.

These and other features and advantages of the present invention will become more apparent from the accompanying drawings and the following detailed description.

The present invention will be illustrated below in conjunction with exemplary wireless communication systems and associated location based services. It should be understood however that the invention is not limited to use with any particular type of wireless system or location based service s . The disclosed techniques are suitable for use with a wide variety of other systems and in providing numerous alternative services. For example the described techniques are applicable to many different types of wireless networks including those utilizing well known standards such as UMTS W CDMA CDMA2000 HSDPA IEEE 802.11 etc. The term wireless communication system as used herein is intended to include these and other types of wireless networks as well as sub networks or other portions of such networks and combinations of multiple networks operating in accordance with potentially different standards. A given wireless communication system may also include as a component thereof one or more wired networks or portions of such wired networks.

Also included in the communication system is a wireless network comprising a number of subscriber devices which communicate with base stations . The base stations are arranged in respective cells of the wireless network . Although the wireless network is illustratively configured as a wireless cellular network which may be for example an otherwise conventional UMTS network other types of wireless networks may be used in implementing the invention.

The subscriber devices are illustratively shown in and elsewhere herein as cellular telephones and may be viewed as examples of what are more generally referred to herein as mobile user devices. Such devices may also be referred to herein as mobile stations or as simply mobiles. The invention is not restricted to use with any particular type of mobile user device and mobile user devices herein may comprise for example portable or laptop computers personal digital assistants PDAs wireless email devices or other portable processing devices in any combination.

The communication system further includes a computer network that is comprised of multiple computers and is associated with at least one marketing agent . The computer network provides marketing information that is stored in the marketing message database . Alternatively the marketing information may be stored directly in the Gcast system or partially in the marketing message database and partially in the Gcast system .

Wireless subscribers which may be users of the subscriber devices provide profile information within communication system . This profile information may comprise for example opt in lists or other user preferences demographic information or other types of profile information generated from for example point of sale POS questionnaires responses to billing inserts service provider SP websites or any other source of subscriber profile information. The profile information may be stored for example in subscriber information database and thereby made accessible to the Gcast system . Alternatively the profile information may be stored directly in the Gcast system or partially in the subscriber information database and partially in the Gcast system .

It should be noted that at least a portion of the profile information as well as or alternatively marketing information location and presence information or other types of information utilized by the Gcast system may be stored on one or more of the subscriber devices or in one or more other system elements. For example a given subscriber device may store location presence and profile information for that device and provide such information to the Gcast system on an as needed basis.

One possible mode of operation of the communication system in the illustrative embodiment is indicated generally by Steps 1 through 5 as shown in the figure. It is to be appreciated that although the communication system operations in this embodiment are directed towards delivery of advertising messages the described techniques can be adapted in a straightforward manner for use in delivery of any type of content associated with any type of location based service. The content can be generated by a variety of different entities rather than just marketing entities as in the present example and such other entities may include the subscribers themselves. Also the particular operations need not occur sequentially in the order shown for example certain of the steps may be performed at least in part concurrently with one another.

In Step 1 the computer system associated with marketing agent is utilized to collect advertising content and target profiles for that advertising content. Although only a single networked computer system associated with a single marketing agent is shown in this example other embodiments may include multiple marketing agents or other types of marketing entities each having its own computer system.

In Step 2 opt in lists are built and other types of profile information are collected for the wireless subscribers . As indicated previously this information may be stored in the subscriber information database .

In Step 3 subscriber location and presence information in subscriber information database is automatically collected and updated by communication with the wireless network . The location information may indicate for example the current locations of respective ones of the subscriber devices. The presence information may indicate for example whether the user of a given subscriber device is currently participating in an active voice call on that device or whether the user is in a meeting or otherwise occupied or unavailable.

In Step 4 a rules engine in the Gcast system matches marketing messages from the marketing message database to appropriate subscribers based on information stored in the subscriber information database .

In Step 5 the messages matched to respective subscribers in the rules engine of the GcaSt system are delivered to those subscribers at their respective subscriber devices via one or more of the base stations of the wireless network .

Referring now to an example of one possible implementation of at least a portion of the communication system of is shown. In the communication system as shown in the Gcast system of is implemented in a network operations center that is separate from the wireless network . The network operations center communicates with one or more processing devices of the wireless network via a conventional integrated services gateway ISG .

More specifically the ISG communicates with a first processing device comprising one or more of a mobile positioning center MPC and a gateway mobile location center GMLC and with a second processing device comprising one or more of a short message service center SMSC and a multimedia message service center MMSC . The wireless network in this embodiment further comprises at least one additional processing device which illustratively comprises one or more of a home location register HLR mobile switching center MSC a position determining element PDE and possibly one or more additional elements such as a visitor location register VLR serving GPRS support node SGSN location services element LCS etc. It should be understood that the notation as used in and elsewhere herein refers generally to and or. Conventional operations associated with wireless network elements such as the above noted MPC GMLC SMSC MMSC HLR MSC PDE VLR SGSN and LCS are well known to those skilled in this art and are therefore not described in detail herein.

A given one of the processing devices and in wireless network may be implemented as one or more computers servers switches storage elements or other elements in any combination. Generally such processing devices comprise at least one processor coupled to at least one memory and can be configured to execute software programs for providing functionality associated with the techniques described herein. Although particular network elements such as MPC GMLC SMSC MMSC HLR MSC and PDE are shown in as being associated with particular ones of the processing devices and this is by way of illustrative example only. In alternative embodiments each such network element may be implemented using one or more dedicated processing devices or other combinations of these elements may be implemented using one or more shared processing devices. The term processing device as used herein is therefore intended to be construed generally so as to encompass any processor based device suitable for use in providing at least a portion of the functionality associated with a given location based service.

The Gcast system in the embodiment comprises an arbitrary number N of processing devices denoted through N. As indicated above each such processing device may be implemented as one or more computers servers switches storage elements or other elements in any combination. For example one of the processing devices may comprise a web server accessible over a network. Also although the Gcast system is shown in as comprising multiple processing devices in alternative embodiments the Gcast system may be implemented using only a single such device. Again as indicated previously such a processing device generally comprises a processor coupled to a memory.

The term location based services system as used herein is intended to encompass for example the Gcast system of or any other arrangement of one or more processing devices each comprising at least one processor coupled to at least one memory. A given such system may be implemented internal to a wireless network that is within a base station or other element of that network or external to the wireless network. The system may alternatively be implemented in a distributed manner with portions being internal to the wireless network and other portions being external to the wireless network. Moreover a location based services system may be configured to include one or more of the system components that are shown in or A as being external to the Gcast system . For example elements such as one or more of the computers associated with marketing agent in or one or more of the processing devices or may be part of a given location based services system in an alternative embodiment.

Information passed between the Gcast system and the wireless network via the ISG includes in the present example locations of the mobile subscriber devices as indicated by dashed line between processing device and the Gcast system and messages targeted to respective ones of the subscriber devices as indicated by dashed line between processing device and the Gcast system . Although ISG is used as an interface between the Gcast system and the wireless network in this embodiment other types of interfaces may be used in other embodiments.

The Gcast system is also coupled in this example via an Internet protocol IP network to at least one computer which is equipped with a web browser . The web browser may be used for example to access a map server over the IP network . Other types of web servers can also be accessed in a conventional manner via the web browser of the computer . One of such servers may be a web server implemented within the Gcast system itself using one or more of the processing devices . The computer may be for example one of the computers of the marketing agent computer system in . The marketing agent is also referred to as an advertising service provider AdSP or advertising campaign manager in this embodiment. Alternatively such a computer or another similar computer of other processing device may be associated with a system administrator an entity of the wireless service provider or a particular one of the subscribers. Of course each such entity may have its own browser equipped computer or computers in a given embodiment of the invention.

Referring now to a more detailed view of one possible interconnection of certain elements of the system is shown. In this embodiment a base station communicates with a mobile user device and an MSC as shown. The MSC is coupled to PDE and MPC . The MSC is also coupled to SMSC HLR and VLR as shown. MPC interacts with one or more LCS elements . Advertising content and other types of location based service content are accessible in this embodiment from element illustratively designated in the figure as an ad content element via SMSC and MSC . Element may represent a component of the Gcast system or other component of communication system . Again conventional aspects of the operation of wireless network elements such as those shown in are well known and therefore will not be described in detail herein. Also numerous alternative arrangements of wireless network elements may be used in other implementations of the invention. For example in alternative embodiments the PDE may be eliminated and the position determination or other type of mobile user device location measurement may be performed entirely within the mobile user device itself.

The LCS element in may implement at least a portion of the Gcast system in the illustrative embodiment. Thus the Gcast system may be viewed as an otherwise conventional LCS element suitably modified to incorporate one or more aspects of the location based services techniques described herein. Such an LCS element may but need not reside within the wireless network . Although shown as communicating with the MPC in the LCS element in other embodiments may communicate directly with other system elements such as for example MSC PDE SMSC etc.

As will be described in greater detail below the Gcast system proactively delivers messages to subscribers based on a combination of location presence and profile information. As noted above the location information may indicate for example the current geographic location of the subscriber device associated with a particular subscriber while the presence information may indicate for example whether the particular subscriber is currently participating in an active voice call on the subscriber device. It was indicated previously that other types of presence information may include for example indications as to whether the subscriber is in a meeting or otherwise occupied or unavailable. The profile information also as indicated previously may comprise subscriber preferences demographic information and the like.

The messages in the illustrative embodiments may comprise push messages and include advertisements or any other type of content that may be targeted to one or more subscriber devices in conjunction with the provision of location based services. Thus as a more particular example the messages may comprise push advertisements directed to all subscriber devices currently located within a given zip code or other specified geographic area not participating in an active voice call and assigned to subscribers fitting a particular user preference and target demographic profile.

The Gcast system as shown in comprises a number of layers including an application support layer an application enabling layer a location based services LBS enabling layer and a network connectivity layer . Also included are services components illustratively comprising hosting carrier management privacy management integration custom application development content aggregation and billing management.

The application support layer comprises configuration profiles and development tools . The configuration profiles may be associated with for example horizontal end user applications vertical market bundles or other types of configuration information. The development tools may comprise software development kits SDKs application programming interfaces APIs middleware etc.

The application enabling layer allows applications to be written which can make use of the location based service capabilities of the Gcast system across diverse networks to provide context sensitive targeted messages. The application enabling layer comprises the above noted rules engine for matching messages from marketing message database with appropriate subscribers whose information is stored in the database as previously described in conjunction with . Other elements of the application enabling layer include a service management component a subscriber management component and a content management component the latter being associated with additional components including electronic coupons and mobile commerce M commerce component . The M commerce component supports the provision of electronic commerce applications such as on line shopping via mobile user devices of the system.

The LBS enabling layer comprises a location server . The location server is advantageously configured to minimize the number of location queries generated in the wireless network by for example eliminating duplicate queries and prioritizing queries based on the importance of the applications making those queries. Other components of the LBS enabling layer include a messaging server a privacy guard component a billing component and a security component .

The network connectivity layer comprises a location and presence query module and a messaging module . The location and presence query module works across diverse types of wireless network technologies to obtain user location and presence information. For example in this embodiment it can obtain location and presence information using cellular triangulation techniques such as Advanced Forward Link Trilateration AFLT global positioning system GPS techniques such as assisted GPS AGPS and IEEE 802.11 Wi Fi techniques although as indicated previously location and presence information determination for other types of wireless networks can also be supported. The messaging module delivers and receives messages across a variety of media such as for example short message service SMS multimedia message service MMS Email instant messaging IM etc.

The Gcast system can be utilized to implement a wide variety of location based services including geographic messaging in store coupons user defined lifestyle alerts and event related marketing as will now be illustrated in conjunction with B C and D respectively. It should be understood that these are merely examples and numerous other types of location based services can be provided in a particularly efficient manner using the Gcast system .

Referring now to an example of a location based service involving in store electronic coupons is shown. In this example a merchant delivers electronic coupons to the subscriber devices of opted in customers upon those customers entering the vicinity of the store. The coupon may be in the form of a message presented on the display of a given subscriber device as shown. Coupons are selected based on customer profiles such as profile information in system . Possible pricing models for this exemplary service may involve merchants paying a flat fee per coupon delivered merchants paying a fee per coupon redeemed or other arrangements.

An example of an event related marketing service is shown in . In this example an event organizer or merchant at a sporting event concert or other type of event sends marketing or other informational messages to the subscriber devices of an opted in audience of subscribers. The content may be customized to the profiles of respective subscribers. As an example a message indicating gift items on sale may be presented on the display of a subscriber device located within a stadium or other event venue. More particular examples may include messages such as Reply to this message to buy an MMS clip of the goal just scored and forward it to your friends or New York Yankees T shirts on sale for the next 30 minutes. Again possible pricing models may involve charging merchants per message delivered with higher prices for completed transactions.

As mentioned previously numerous other location based services may be implemented in an efficient manner using the Gcast system of the illustrative embodiments. One advantage of these embodiments is that the number of location queries and other types of location related communications required between the base stations and the subscriber devices can be reduced while still allowing implementation of a wide variety of location based services within the communication system . The Gcast system is thus configured to prevent location related communications from overwhelming the wireless network and interfering with the primary voice and data traffic functionality of that network.

Examples of techniques for reducing the number of location related communications will be described in a number of separate sections below including sections denoted Prioritizing Location Queries Traffic Synchronized Location Measurement Mobile Initiated Location Measurement Broadcast Channel Delivery of LBS Information and Reverse Lookup. Before these sections are presented a number of additional features of the Gcast system will be described. These features are described in the following sections entitled Auctioning of Message Delivery Opportunities and User Movement Statistics. In a final section a number of exemplary location measurement techniques are presented including a trajectory method an expanding disk method and a nucleation area method.

The communication system as illustrated in may be configured to permit auctioning of message delivery opportunities so as to provide an additional source of revenue in the system. In an embodiment of this type the Gcast system allows marketers or other interested parties to bid on particular available slots or other opportunities for delivery of marketing messages to subscriber devices . Assuming for purposes of illustration that a fixed number of messages belonging to certain categories e.g. coffee ads can be delivered in a given location e.g. a mall at a given time e.g. Sundays a given message delivery opportunity comprising a specified category location time combination can be bid for by the parties interested in pushing the messages e.g. various coffee advertisers . The Gcast system may make use of real time and historical information about the popularity of a given location category time combination to facilitate the bidding for the corresponding message delivery opportunity. Other types of message delivery opportunities can be auctioned in a similar manner for example opportunities based on location category category time or location time combinations.

A message delivery opportunity auction of the type described above can be controlled at least in part via software running on one or more of the processing devices of the Gcast system . Such software may include for example a bidding engine and a corresponding web site that allows interested parties to access the bidding engine via respective computers or other devices coupled to IP network . Such devices may be browser equipped devices similar to computer . The auction may occur in real time for example based on the current number of messages that can be delivered to subscriber devices in wireless network . Alternatively the auction may be based on an estimated count of messages that can be delivered at some future point in time.

The communication system may also or alternatively be configured to determine user movement statistics and to utilize such statistics to facilitate delivery of marketing messages or other types of messages to subscribers. For example such statistics may capture the flow of users in conjunction with their profile information. This would allow the system to determine how many users of certain profiles are likely to be in a given area in a given period and such information can be used to facilitate the establishment of advertising campaigns by marketing agents in the system. For example the movement statistics would allow an advertiser to create a campaign to deliver advertisements to opted in subscribers with matching profiles entering a given region in a given period of time e.g. males between 15 and 25 within 1 mile of a mall on Sundays while providing the advertiser with an a priori estimate of the likely success of the campaign.

In operation the communication system may obtain profile information for users associated with respective subscriber devices of the wireless network obtain location information for the subscriber devices and generate user movement statistics based on the location and profile information. The system then controls the delivery of at least one message to a given one of the devices based on the user movement statistics.

The statistics may be used for example to estimate the impact of a marketing campaign to determine prices charged to advertisers for message delivery or to establish appropriate bid levels for the above noted auction of message delivery opportunities. The statistics may be computed at least in part using the location presence and profile information stored in subscriber information database as such information is routinely gathered and updated in conjunction with the message delivery functions of the communication system.

As noted previously an aspect of the present invention relates to the prioritization of location queries in the communication system . This prioritization which may be implemented using the location server of the LBS enabling layer in Gcast system as shown in will now be described in greater detail.

Conventional systems comprising wireless network elements such as the above noted MPC and GMLC utilize such elements to determine the locations of the mobile devices . For example location based service applications may query these network elements in order to obtain mobile device locations when needed. Location based service applications typically query the network elements for device locations on demand in an approach commonly referred to as forward lookup FL . In the FL approach the network elements typically page the mobile user devices in order to determine their respective locations. Thus the paging channel carries a large burden since a given mobile device has to be paged every time a location measurement involving that mobile device is performed and this paging often has to be performed over a large network area involving many cells. However the conventional systems are deficient in that the number of location queries that can be supported within a given period of time is often very small on the order of about 5 to 30 queries per second. While this number of location queries may be sufficient for low throughput applications such as emergency 911 services it is inadequate for location based services that involve for example substantially continuous monitoring of subscriber device locations to support the delivery of push messages such as advertisements.

The communication system of is advantageously configured in an illustrative embodiment to provide improved scalability of location based services while minimizing any revenue losses incurred by not delivering a message. This embodiment utilizes a software algorithm for scheduling user location queries such that users whose locations are less beneficial to the corresponding location based services application are queried less frequently than others. This is an example of an arrangement in which users associated with respective mobile user devices of the system are separated into at least first and second groups of users having respective first and second benefit classes.

The various benefit classes may be defined based on respective perceived benefits to a provider of a given location based service or using other techniques. An approach of this type in which different benefit classes are defined based on perceived benefit to a service provider or other types of benefit quantification uses the benefit classes to determine how often particular mobile user devices are queried for their locations. Such approaches provide significant advantages relative to conventional FL approaches and are also referred to herein as smart lookup approaches. The reverse lookup approach described in greater detail below may be viewed as another type of smart lookup.

The benefit of a user location response may be defined for example as the ability to send an advertisement or other revenue generating message to the user. As described elsewhere herein such messages may be sent based on a match between the message and the user based on a combination of location presence and profile information. The software algorithm which may be part of the above noted location server may utilize location information for a given user to prioritize location queries. This allows the system to handle a larger number of users for a given network throughput while also minimizing revenue losses. As a result scalability of location based service applications is improved while deployment cost is reduced.

The location information utilized to prioritize location queries may be obtained for example using the trajectory method expanding disk method or nucleation area method described below or using other location measurement techniques. As a more particular example the location information may comprise a probability that a particular user will be in a particular geographic area at a particular time.

As described above the conventional FL approach does not scale well for location based service applications that involve frequent monitoring of mobile user device locations. This is attributable to the limited capacity of the paging channel as well as the limited throughput of wireless network elements such as the MPC and GMLC.

In an illustrative embodiment of the communication system this problem is further alleviated by the provision of traffic synchronized location measurement. Generally such an approach involves automatically performing location measurements for any of the mobile user devices that are currently active on a traffic channel within the wireless network . This advantageously synchronizes location measurement initiation with traffic channel activity.

The location measurements can be performed using techniques such as AFLT AGPS or others as well as combinations of such techniques. The traffic channel may be associated with a voice call an SMS message an MMS message or any other type of communication. The term traffic channel in this context is therefore intended to be construed broadly. The mobile user device location measurement data can be sent over the reverse link of the traffic channel. The forward link of the traffic channel can be used for example to forward satellite information or other assist data for AGPS. This traffic synchronized location measurement advantageously leads to higher scalability of location based service applications at a lower cost.

One possible implementation of the above described traffic synchronized location measurement feature in the communication system will now be described in greater detail with reference again to . In this particular implementation a location measurement session is initiated by the MSC of . The location measurement session can alternatively be initiated by another wireless network element such as the above noted SGSN. The initiation may occur by way of example upon setup and or teardown of the traffic channel. Other possible circumstances for initiating a location measurement session include when a cell identifier ID of the mobile user device has changed or a corresponding active set has changed both of which can be interpreted as an indication that the mobile user device has moved sufficiently to justify a new location measurement.

The MSC initiates the location measurement session by sending a location measurement request to the MPC . This request contains information such as a mobile user device ID user ID and cell ID.

The MPC forwards the location measurement request to at least one LCS which compares the user ID to information in an associated database. The LCS reports back to the MPC if a match was found and if the location measurement session is approved. Reasons for non approval can be that the subscriber has denied location measurements or that the LCS has just obtained a location update for this subscriber.

Assuming that a match was found and approval of the appropriate LCS is obtained the MPC sends the location measurement request to the PDE . The PDE initiates the location measurement via the MSC and the appropriate base station s utilizing the traffic channel that is already available. The mobile user device sends location measurement data back to the PDE along the same channel. The PDE determines the location based on the mobile user device measurement data and reports the results to the MPC. The MPC in turn sends the results to the LCS that approved the location measurement session.

In another possible implementation the MSC or other wireless network element may perform the location measurement via triangulation utilizing roundtrip delay data obtained in a conventional manner.

In yet another possible implementation the mobile user device itself rather than the MSC or another wireless network element automatically initiates the location measurement process.

Those skilled in the art will recognize that numerous alternative processes other than those described above may be used to implement traffic synchronized location measurement in accordance with the present invention.

It is to be appreciated that the traffic synchronized location measurement feature of a given embodiment of the invention can be implemented using otherwise conventional standard communication protocols. For example in a communication system comprising a CDMA2000 wireless network the above described location measurement process may closely follow the protocols set forth in the associated standards documents including for example CDMA2000 Access Network Interoperability Specification 3GPP2 A.S0001 A V2.0 CDMA2000 TIA EIA Location Services Enhancements 3GPP2 X.S0002.0 V1.0 and CDMA2000 Wireless Intelligent Network Support for Location Based Services 3GPP2 X.S0009 0 V1.0 all of which are incorporated by reference herein.

The traffic synchronized location measurement approach described above avoids the need to page the mobile user devices independently for location measurements thereby substantially reducing the paging channel overhead. It also allows location based services information to be communicated in conjunction with data sessions for example during or right after completion of data sessions or voice calls. Under such circumstances the subscriber typically pays an elevated degree of attention to his or her mobile user device and is therefore more likely to perceive the location based service message and to react to it. Moreover since the location measurements are relatively inexpensive when performed over an existing traffic channel they can easily be repeated when the mobile device has undergone a handover to another cell. This has the additional advantage that the mobile device location can be tracked and the associated information stored in a subscriber database such as database for reference at later times for instance to derive user mobility patterns or other types of user movement statistics.

A given embodiment of the invention may be configured such that one or more of the mobile user devices autonomously performs location measurements. For example when its location has substantially changed it may request a location readout session from the wireless network. In this session the location measurement data are forwarded to the LCS. This approach is particularly well suited for use with mobile user devices that are in an idle state.

In one possible implementation of a mobile initiated location measurement technique the mobile user device determines its location via GPS or AGPS. For AGPS the mobile user device requires satellite information or other assist data to be forwarded from a cell in its vicinity. For that purpose all cells may broadcast the corresponding satellite information or other assist data via a paging channel or other type of broadcast channel as will be described in greater detail below. The frequency of location measurements can be set at the mobile user device provided via so called third layer messaging to the mobile user device when powering up provided by a default or provided using other techniques.

When the mobile observes a sufficient location change it requests a location readout session from the network. For that purpose it sends a burst on the access channel to the MSC of with a request to setup a traffic channel for location readout. This process can be implemented in a manner compliant with existing communication standards such as the CDMA2000 standards referred to previously herein.

The MSC performs the routine protocol steps for traffic channel setup. It further provides the mobile user device ID and user ID to all LCSs that provide location based services to the mobile user device. The LCSs compare the user ID to the subscriber database and reply with an acknowledgement or denial. If at least one LCS has acknowledged the location readout session the MSC sends a location measurement readout command to the mobile user device. The mobile then returns the location measurement data to the MSC. The MSC forwards the location measurement data to the particular LCSs. The MSC can also keep a copy of the location measurement data in its database for future reference for example in order to handle reverse lookup requests from one or more of the LCSs.

The use of mobile initiated location measurement can facilitate the scaling of location based services and reduce deployment costs. It can reduce paging channel overhead and also reduce the signaling overhead between wireless network elements such as the MSC LCSs base stations and mobile user devices.

The communication system of may be configured such that content identifying information or other types of location based service information are transmitted to the mobile user devices over a paging channel or other type of broadcast channel. The content identifying information may comprise information that identifies particular types of location based service content that are available to the mobile user devices such that a given mobile can autonomously select the particular available location based service content it wishes to have delivered. Other types of location based service information that can be delivered using a paging channel or other type of broadcast channel comprise for example assist data for use in an AGPS location process. Again this feature facilitates scalability of location based service applications while reducing deployment costs.

As an illustration consider a situation in which all the subscribers in a given cell of the wireless network want to initiate a location measurement. Since the assist data for all of the subscribers in a common cell is the same a paging channel or other type of broadcast channel could be used to deliver the assist data for AGPS. The returned location measurement information may still be delivered over traffic channels although other types of channels such as an access channel may also be used for this purpose. This approach would advantageously reduce the time that the mobile user devices spend on the traffic channels and eliminate use of the traffic channels for the assist data transmission.

In another example the above noted paging channel or other type of broadcast channel may be used to deliver advertisements electronic coupons or other location based service content to mobile user devices in a common cell or other common geographic area. A given mobile user device may then store such broadcast content locally in its internal memory and automatically retrieve portions of the content at appropriate times as determined for example based on a combination of location presence and profile information. An arrangement of this type can advantageously avoid the need for any use of the traffic channel in delivering location based service content.

The location based service content may be transmitted on a paging channel or other type of broadcast channel that is separate from that used to transmit the assist data for AGPS.

In an arrangement in which content identifying information is transmitted over a paging channel or other type of broadcast channel the information may be in the form of a table of contents or other type of content summary. A given content summary may comprise information such as a content provider ID a content reference ID a content classification ID e.g. can refer to alerts ads social networking groups etc. a geographical target location e.g. minimum latitude maximum latitude minimum longitude maximum longitude etc. and a time frame of validity e.g. start time end time etc. .

As a more particular example the content identifying information may be transmitted over a slotted paging channel in the form of a linked list of content summaries. The list may start in one particular slot. This particular slot may be the same for all cells in an area controlled by the MSC and can be advertised to the mobile user devices via a third layer message or other type of message delivered when the mobile user devices power up or otherwise access base stations in the MSC area. Several content summaries may be fit into one slot. The last content summary in a given slot may be followed for example by a list termination flag or by a pointer to the next slot where the list is continued.

The content summaries may change from one cell to the next such that each cell presents summaries of only the content available in its particular coverage area. This reduces the overall paging overhead. However since mobiles user devices often move from cell to cell very frequently it may be desirable in some applications to present summaries of content available over areas comprising multiple cells. These areas could match the location areas used for conventional mobile user device paging services or other types of services. For example a mobile user device may determine that it has entered an area with a different set of content summaries by making use of one or more of the above noted content related IDs. Such IDs may be transmitted as header information with the content summaries.

This header can also include other information such as the time when the last update occurred. A given mobile user device would then have to decode the entire list only when updates have occurred or upon entering an area with different content related IDs which conserves mobile user device battery power. The header could also provide information which identifies the paging channel slots having content summaries that have been updated. This increases the overhead but it allows mobile user devices to perform selective decoding which is faster and again saves battery power.

Using the content summaries and its own location measurement the mobile user device can determine if any of the available location based service content is suited for the subscriber. If the mobile user device has found such a match it sends a message to the appropriate content provider and requests the delivery of the corresponding content. In this message the mobile user device may also provide a subscriber ID and or other information to the content provider for authentication purposes. This authentication may be performed in addition to a standard authentication performed with the wireless network upon request of a traffic channel. If the authentication is successful the LCS or other system element returns the requested location based service content to the mobile user device.

The mobile user device may be provided with a content selection algorithm that determines for example how often location measurements are to be performed what the filter criteria are for selection from available location based service content and other information relevant to the content selection process. Such an algorithm may be similar to a conventional FL algorithm and downloaded from the network or a third party provider. Alternatively the algorithm could be determined at least in part by the subscribers themselves. For example a given subscriber could define various selection criteria through interface commands. The subscriber may also be permitted to turn off all location based service content features at the mobile user device with or without having a connection to the network. This allows complete decoupling between location based service provision and content selection thereby providing a high level of security to the subscriber.

As another example a subscriber may be permitted to select location based service content for particular locations where he or she is not currently present. This allows the subscriber to participate in activities at other locations. If alerted responsive to such selections he or she can either decide to travel to that area or call a friend or family member in that area to participate in the activity e.g. take advantage of coupons sales offers etc .

As yet another example enterprises can provide location based services for their employees. Such services can be matched specifically to the needs of the enterprise and functions of particular employees.

A content selection algorithm of the type described above can be configured to search and display content alerts only when the subscriber is using the terminal. This ensures that the available location based service content is made apparent at a time when the subscriber is paying attention to the device. It also saves battery power since it may allow the device to return to a dormant state at other times. Since the content selection algorithm in this embodiment is assumed to be resident on the mobile user device it can react to device activity even when the device is not active on a call but is instead used for other purposes for example when the subscriber checks an address book a calendar a time display etc.

Another feature that may be implemented in the communication system of is referred to herein as reverse lookup or RL. As indicated above the conventional FL approach is problematic in that it limits scalability of location based services and can place excessive demands on the traffic channels and other resources of the wireless network. The RL approach to be described below advantageously overcomes the problems associated with the conventional FL approach. Like the other features described previously this feature can provide higher scalability of location based services at reduced cost.

Generally the RL approach involves limiting FL location requests based on information that is readily available at a given wireless network element such as the LCS of such that the actual number of executed location requests is substantially reduced.

A first illustrative example of the RL approach involves identifying users that are registered in the HLR and or VLR of . More specifically a list of currently registered users can be obtained from the HLR VLR and processed to identify one or more users that have been recently active in a given location of interest. This information can then be utilized for example to send messages or other location based service content to particular users right away or to identify a reduced set of users for which FL location requests will be executed. The list of currently registered users can be obtained for example via a batch lookup initiated by the LCS or another wireless network element.

The above described RL example based on identification of users registered in the HLR VLR can advantageously eliminate the need to execute FL location requests for those users that are not available for location based services at a particular point in time for example because they are roaming in another network have their mobile devices powered down are in a coverage hole etc. This type of RL also facilitates the provision of location based services to roaming users for example users that are visiting wireless network from other wireless networks.

In another possible implementation the RL process may be based on signaling data records obtained from the MSC or another wireless network element that maintains such information. For example roundtrip delays between a given mobile user device and multiple base stations of the wireless network are often used to determine the mobile location via AFLT or other type of cellular triangulation. These roundtrip delays can be obtained for example from channel cards or other components at each serving base station and can be forwarded to the MSC or any other wireless network element. Further a pilot strength measurement message PSMM contains information about the relative roundtrip delays between secondary and primary serving base stations. The PSMM is frequently provided by the mobile user device during a call. These and other types of signaling data can be recorded together with other relevant information as for instance mobile user device ID cell ID time stamp etc.

The resulting signaling data records can be forwarded to the LCS or another wireless network element after certain time periods upon request or whenever an update has occurred and stored in an associated database for example subscriber information database . The database can then be queried prior to delivery of location based service content in order to eliminate certain users from consideration based on the signaling data records and thereby limit the number of FL location requests that are needed.

Again this type of RL approach can substantially reduce the number of FL location requests that are executed. It avoids unnecessary FL location requests for registered mobiles that have insufficient coverage. Also the resource savings increase with the amount of traffic calls in that the higher the network load the more signaling data is available and the fewer FL location requests that need to be executed. Further this approach facilitates the delivery of location based service content to a mobile user device during or immediately following a call at which time the targeted subscriber will likely be more attentive to the device.

As an estimate of the savings in FL location request execution that can be achieved using the RL approach assume that one FL location request per subscriber per hour would normally be executed. Further assume that the likelihood that the subscribers will be active on a call in a particular hour is around 80 and the likelihood that the subscribers will send or receive an SMS is around 40 . The combined likelihood for subscribers to have a traffic channel up during the particular hour is 1 1 0.8 1 0.4 88 . If these subscribers can be located via the RL approach the remaining FL location request requirements have been substantially reduced to 100 88 12 .

A given RL implementation in accordance with this aspect of the invention may be based on other types of available information rather than just HLR VLR registrations or signaling data records as in the above examples.

The foregoing sections entitled Prioritizing Location Queries Traffic Synchronized Location Measurement Mobile Initiated Location Measurement Broadcast Channel Delivery of LBS Information and Reverse Lookup disclose exemplary techniques for reducing the number of location related communications in the Gcast system . It should be understood however that other types of reduction techniques may be used. Also the particular features described in the Auctioning of Message Delivery Opportunities and User Movement Statistics sections above are just a few of the advantageous features that may be provided by a given implementation of the Gcast system .

In the following section examples of particular location measurement techniques suitable for use in conjunction with the Gcast system are described in greater detail. These techniques include a trajectory method an expanding disk method and a nucleation area method.

It will be assumed for purposes of illustration that the location measurement techniques to be described below are implemented in a location estimation engine that utilizes a data structure to store location measurement data. The data structure may be internal to the location estimation engine external to the location estimation engine or may comprise a combination of internal and external data.

The location estimation engine may be implemented at least in part in software running on a processing device of the system . For example the location estimation engine may be part of a system element such as the LCS of or may be distributed across multiple system elements in the embodiments previously described. At least a portion of its operations may be implemented using elements such as the location server and location and presence query module of .

The data structure utilized by the location estimation engine may comprise measurement data for each user including for example one or more of a time stamp an availability flag location data such as latitude longitude and location accuracy radius a velocity flag indicating a derived velocity from two consecutive location measurements an explicit velocity value from AGPS or an indication of no reliable value a vector of average velocity averaging time frame and speed accuracy an acceleration flag indicating a reliable value or no reliable value and a vector of average acceleration and averaging time frame.

The data structure may also comprise nucleation areas for each user including for example one or more of time data such as time bin index k start time and end time geographic area data such as geographic bin i j step index s bounding box of bin SW NE and area size and probability of finding a user in a nucleation area. These data may be provided separately for workdays and weekends or for other arrangements of different time periods.

The data structure may further comprise availability areas for each user including for example one or more of time data such as time bin index k start time and end time and probability that the user is available in this time frame. Again these data may be provided separately for workdays and weekends or for other arrangements of different time periods.

Other types of data that may be present in the data structure include accumulate data such as geographic distribution of speed and geographic distribution of acceleration and global data such as location prediction confidence level average and or worst case user speed typical or average user acceleration temporal and geographic bin sizes and or bin expansion sequence nucleation area cutoff parameter lowest lookup rate and non availability lookup rate etc.

It is to be appreciated that other types of data structures may be used in implementing the present invention.

The location estimation engine in this illustrative embodiment provides an estimate of the location of a mobile user device at a given time. Parameters passed to this location estimation function may be user identifier and time stamp. In the following it is assumed that the time stamp always refers to the current time.

The location estimation function returns a set of location areas with the corresponding probabilities to find the particular user LA P. This set can be empty. The location areas are either specified as circular disks e.g. center radius or as rectangles e.g. southwest northeast . The probabilities are larger than zero and add up to a value smaller than or equal to one 

The location estimation function may also return a parameter that indicates the probability Pthat the user is available at a particular point in time. The availability parameter captures factors such as availability of location information and availability of radio connection to the user in the network.

The location estimation engine may also provide functions to update the internal measurement database. These functions can for example import measurement results from forward lookups FL of individual users import a batch of reverse lookup RL data for a larger number of users or use combinations of these and other techniques. In addition one or more functions can be invoked to update user behavior pattern analysis.

The location estimation engine may use one or more of a number of different location estimation methods including for example a trajectory method an expanding disk method and a nucleation area method each of which will be described below.

It is possible for the system to use different ones of these methods under different conditions. For example the trajectory method may be used when recent and reliable velocity measurement data are available the expanding disk method may be used when the last location measurement occurred recently but velocity data are not available or are too unreliable and the nucleation area method may be used in all other cases. Numerous other types of switching between these and other types of location measurement techniques may be used.

As a more detailed example of switching between the various methods all three methods may be applied initially in response to a location estimation request. When no explicit velocity data are available the trajectory method uses the last two location measurements to derive such velocity information. The trajectory method and the expanding disk method will provide one location area with probability one LAand LA respectively. The size of this area captures the uncertainty in all parameters such as location measurement accuracy velocity accuracy and probability of user acceleration including change of direction of motion over time. The nucleation area method provides a set of location areas with fractional probabilities LA P.

The three initial estimates provided by the respective methods are then compared with respect to their total area size. For the nucleation area method the total area size is set to the area covered by location areas with an accumulative probability of at least 50 . This evaluation captures the fact that multiple location areas can overlap with each other. The overlap area is counted only once and the corresponding probabilities are added up.

As indicated previously other types of techniques can be used to determine which of the three exemplary methods or other methods should be used under a given set of conditions.

Each of the exemplary methods that is the trajectory method the expanding disk method and the nucleation area method will now be described in greater detail.

The trajectory method is based on the availability of velocity information e.g. speed and direction of motion. Velocity information is obtained from at least two if not more consecutive location measurements. When AGPS is used for example the velocity can be directly obtained from one conventional FL. In this case the FL execution evaluates a sequence of consecutive location measurements and derives a velocity metric from those. This procedure is part of the wireless communication standard known as IS 801.

When such information is not available velocity can be derived from the measurement results of consecutive lookups. At the typical lookup rates for each user one can expect that only the last two location measurements be of value.

Which of these two techniques is used for the velocity estimation should be included in the measurement data velocity flag .

Let the last two location measurements provide the coordinates and at times tand twith radial accuracies of dxand dx respectively. The average velocity between tand tcan be derived as 

The center of the user location area at the present time can be estimated to with i 1 2 i.e. the more recent point of both.

The size of this location area is given by the accuracy of the initial location measurements and the accuracy of the derived velocity.

The accuracy of the velocity has two components one is due to the accuracy of the location measurement the other due to the potential change of the actual velocity since the measurements have been performed 

For simplicity we approximate the former contribution of the velocity accuracy by the accuracy in user speed 

The later contribution is modeled through an empirical approach 0.5 where a represents an average acceleration term which is estimated or derived from accumulative data.

The accuracy contains constant terms due to the initial location measurement accuracy terms linear in t due to the speed accuracy associated with the location accuracy and terms quadratic in t due to the additional acceleration term . Note that the acceleration term captures both changes in speed and changes in the direction of motion.

When velocity information is provided explicitly from one lookup measurement the corresponding speed accuracy dvshould be provided by the network. The second term dv however is included as shown above. Since the measurement session typically takes a few seconds which is small compared to typical inter lookup time frames tand tcan be set equal to the time stamp of the last measurement.

In the above trajectory estimation the user s acceleration has been approximated through a scalar parameter. In principle it is possible to derive the complete acceleration vector from three or more consecutive location measurements. With and being the average velocities between times t tand t t respectively the average acceleration vector computes to 0.5 0.5 . This estimation suggests an accuracy that may not be justified. Since strong accelerations such as changing roads braking to a stop or getting into motion do usually occur on time scales of a few seconds to one minute which is far shorter than the typically FL time period the past measurements can hardly anticipate the present trajectory. It makes sense however to derive typical average acceleration distributions from location measurements over time. For that reason the acceleration has been included into the location measurement database. It should be sufficient to update the aggregate data once every day although other update periods may be used. Expanding Disk Method

When velocity information is not available the user s location area can be estimated based on an average or worst case speed value. The resulting location area has circular shape and its radius expands with time expanding disk .

Let the location measurements provide the coordinate at twith accuracy dxand the speed value be vwith accuracy dv. Since no information of the direction of motion is available the center of the location area does not change . Instead the radius of the location area will change with time square root over square root over In this estimate the acceleration term has been neglected. The reason for this is that the speed information is very inaccurate and adding additional complexity through empirical acceleration terms seems not justified.

The expanding disk method can be improved when the average or worst case speed value is replaced by aggregate area specific speed data obtained from lookups or from external sources. It should be sufficient to update the aggregate speed data once every day although again other update periods may be used.

The nucleation area analysis operates on a 3 dimensional 3D bin space with coordinates longitude latitude and time. Each 3D bin is referred to as B. The lower dimensional subspaces of each 3D bin are referred to as geographic bin B or temporal bin B respectively. In the geographic plane the bin space is bound by the bounding rectangle around the network area. In the temporal dimension it covers the time frame of one day.

For each user the location measurement data acquired over some extended time frame e.g. 3 months are assigned to the bin space. Since in the illustrative embodiment we differentiate between user behavior at workdays and at weekends we perform the entire process independently for both subsets of measurement data workdays and weekend days.

The assignment operation leads to a measurement count cfor every bin. The total number of measurements for a user during the time frame t dt 2 

When a user exhibits a repetitive behavioral pattern the location measurement points for that user will nucleate in a small subset of bins resulting in higher ccounts for those bins. The probability Pto find a user in Bduring the ktime interval can be estimated to 

In principal each bin with non zero Pcould be defined as one nucleation area NA. If all these nucleation areas are kept in memory they can be used to find the set of location areas LA where the user can be found at t Bwith the associated probability P. This approach however leads to reliable results only when the uncertainty dPof Pis much smaller than Pitself. This means that the set of nucleation areas should be limited to those that meet the condition P dP where is a design parameter. The probability error dPcan be estimated to 1 square root over 1 square root over . It has the same value for all bins with same time index k. The minimum number of counts per nucleation area is square root over which means that only bins with c ccan become nucleation areas.

A reasonable value for can be found in the following manner. Since the probability error dPis independent of Pitself we can divide the probability space into equidistant bins of size dPand assign the various Pvalues into this space. The lowest bin has P 0 the next lowest P dP and so forth. Nucleation areas should be created for all Bwhose Pare not in the lowest bin which sets the condition P P 2 or 0.5.

The number of measurement points provided under typical lookup rates e.g. once per hour is small even if an extended time frame is chosen for data acquisition. As a result the above nucleation area method may miss user patterns that stretch over several bins due to the lack of counts. The following example illustrates this phenomenon.

Assume that every user is looked up approximately once per hour over 1 month 31 days. This corresponds to approximately 19 working days or an average of c 19 location measurements per hour. We assume that the temporal bin size is 1 hour. The cutoff count is c 2.18 for 0.5 the minimum number of counts per nucleation area is therefore c 3. For this cutoff the maximum number of nucleation areas per temporal bin is 19 3 6. When the 19 measurements points are distributed over 13 bins with each holding 1 to 2 counts none of them can be identified as nucleation area since they do not meet condition c c. Some of these bins may be scattered while others are grouped in close vicinity to each other. The latter ones hold statistically significant information about the presence of the user in the associated area. This information can be extracted if a larger bin size is used. For example an extension of the geographic bin size by a factor of four may be sufficient to identify multiple nucleation areas with c c. Thus it may be necessary to repeat the nucleation area analysis over a large scale of bin sizes to capture nucleation patterns on different length scales.

The nucleation area analysis is repeated multiple times with ascending geographic bin size. In each increment the geographic bin size can be increased simultaneously in both longitude and latitude. The bin size may be stepped up geometrically e.g. using a multiplier of two for each geographic component or equivalently a factor of four for the geometric bin area.

In every step all measurement points that have formed nucleation areas have to be taken out of the total set of measurement points used for the subsequent step. This avoids a situation where the same measurement points contribute to multiple nucleation areas.

The location areas LA where the user can be found at time t can be derived from the subset of nucleation areas NAwith t B. As before the associated probabilities are P c c. Note that location areas of different geographic size can overlap each other.

While the above algorithm can recognize nucleation areas of varying geographic length scales it may miss patterns that last over longer time frames i.e. multiple temporal bins rather than a large number of geographic bins. To capture such patterns the algorithm may include variations of the temporal bin size as well. This variation should occur independently from the variation of the geographic bin size to recognize nucleation over a small geographic area but long time frames and vice versa.

Since every nucleation analysis reduces the measurement data set by those assigned to the new nucleation areas each step influences the outcome of the subsequent step. When scanning over a 2 dimensional 2D parameter space temporal and geographic bin size it may not be clear which sequence will lead to the best results. Also it may not be clear what the appropriate metric should be to rank and compare the outcome of different scanning sequences. The outcome may further depend on the choice of the initial i.e. smallest temporal and geographic bin sizes. Reasonable values could be 0.75 hours 45 minutes for the temporal bin and 500 m for longitude and latitude. This choice would create 32 temporal bins and around 40 000 geographic bins for a 100 km 100 km market i.e. 200 in each geographic dimension.

Two potential sequences are shown in TABLE 1 below. Sequence A keeps a monotonic order for the 3D bin size increments and gives temporal expansion priority over geographic expansion. This sets the focus on patterns where the user sits at one spot for a long time. Sequence B keeps the product of step increments in the temporal and in one geographic dimension monotonic and expands first geographic bins then temporal bins. This emphasizes patterns where the user roams over a larger geographic area for shorter time frames which may better suit practical applications.

Another aspect that should be considered when expanding in the temporal dimension is that various time intervals Bcan have different total counts c. In the following index k refers to the smallest temporal bin and index l to any other eventually expanded temporal bin. To account for variations of cover all k the count fractions z c cinstead of the counts care used for the analysis. The associated certainty for each count fraction is dz square root over c c 1 square root over c . For the temporally expanded bin B the total count fraction and its certainty are 

After all nucleation areas NAhave been identified the corresponding location areas and their probabilities are derived for a location request at time t. For that purpose we decompose the NAinto nucleation areas of same size geographic but smallest size temporal bins 

The count fraction of NAgets evenly distributed over all decomposed NA where nis the number of Bcontained in B.

At time t the location areas LAare equal to the geographic cross sections of all decomposed NAwith t B. The derivation of the probability Pfor each LAis based on the z values for all i j s and on z 

The above illustrative approaches work well when the data acquisition rate is independent of time and the user s location. One or more of the smart lookup approaches described elsewhere herein may violate this condition since such approaches may for example schedule location updates more frequently when users have high overlap likelihood with desired ad regions. This biases nucleation areas around ad regions suggesting that the user resides in their vicinity more often than he or she actually does. Although this effect may be self stabilizing in the steady state it does create a delayed response when ad regions change.

The second step above represents a pre binning of all measurement data with respect to the temporal dimension. The pre binning space extends the entire time axis of all measurement data and has bin size T. The measurement data are entered into this pre bin space for each user. Then the number of counts per time bin is determined. When the measurement data are entered into the bin space B each count s contribution to cis weighted by 1 of its pre bin. This leads to a fractional value for c. This fraction count will then be normalized by Ck to create z etc.

The illustrative algorithms given above do not specify how measurement data have to be processed that do not yield any location information. This is the case for instance when the user does not have coverage has powered down his her mobile device has roamed to a different network or has set a location information restriction LIR flag.

It is assumed for purposes of illustration that these conditions may be held by the location database as not available with an associated time stamp. When a user was looked up 100 times during temporal bin B but was available only twice with geographic bin locations Band B the probability to find the user in either of these two bins should be set to 0.01 rather then 0.5. This example indicates that the non availability should be taken into account in the normalization.

For this purpose an additional geographic bin B Bmay be introduced which has no neighbor relation with any other bin but whose entries are considered in the total count c. This automatically includes non availability into the location area probabilities.

It further makes sense to provide availability information as an additional property to a smart lookup process. This allows a reduction in the number of lookups to levels significantly below ffor users that are never or hardly ever available. The corresponding lookup rate is f. To avoid an additional pre binning operation on time scale T 1 f measurement data with consecutive non availability results that are more than one Tapart are filled in with artificial non availability data at the center of all pre bins in between. These additional data are also entered into the bin space B.

An additional availability area AA analysis can be performed in temporal dimension with respect to availability alone. This analysis follows the same concept as the nucleation area analysis but only in one dimension that is the temporal dimension. It allows identifying the typical time frames for each user where the user is not available e.g. during nights or during weekends. As a result a smart lookup process could save throughput resources by looking up these users at a very low rate.

Since nucleation areas capture the integral user behavior over a longer time frame they are relatively insensitive to the most recent location updates. Thus such areas need not be updated very frequently. For example it may be sufficient in a given application to update all nucleation areas at the end of each day e.g. at midnight . Of course other update frequencies may be used in other embodiments.

Again it is to be appreciated that the particular system elements process operations and other features of the illustrative embodiments described above are presented by way of example only. As indicated previously the above described techniques can be adapted in a straightforward manner for use in other types of wireless communication systems and with other types of location based services. In addition the invention can be applied to sub networks or other designated portions of a given wireless network or to combinations of multiple wireless networks or other networks of potentially differing types. These and numerous other alternative embodiments within the scope of the appended claims will be readily apparent to those skilled in the art.

