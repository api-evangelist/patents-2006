---

title: Network aware firewall
abstract: A system and method for a network aware firewall is disclosed. The method includes accessing a first network connection from a client computer system and determining whether the first network connection is public or private. The method further includes dynamically modifying security parameters associated with a firewall local to the client computer system in response to determining whether the network connection is public or private.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07886351&OS=07886351&RS=07886351
owner: Microsoft Corporation
number: 07886351
owner_city: Redmond
owner_country: US
publication_date: 20060619
---
Firewalls filter traffic flowing between two or more networks. Typically these devices are routers connecting a public e.g. untrusted network and one or more private e.g. trusted networks. These types of firewalls are called an edge firewalls. As more personal computers connect to the public networks such as the Internet host firewalls e.g. personal firewalls local to the client computer system became a necessary component of a host protection strategy. Host firewalls help reduce the available attack surface against malware and malicious entities on the Internet by blocking unsolicited traffic directed toward computers. In addition host firewalls give an administrator a way to enforce policy on the system by creating an allow list or do not allow list of applications that can be allowed or blocked from listening on or connecting to the network.

As mobile computing becomes widespread users attach their computers to untrusted public networks e.g. via public WiFi in order to get access to the Internet which poses a security risk for the users. In most cases firewall exceptions e.g. allow and do not allow policies for services and applications that are enabled on the user s home networks e.g. file sharing also remain enabled when these users connect to unprotected public networks such as a coffee shop or the airport WiFi . Conventional firewall systems are not smart enough to understand the type of network the computer is connected to and disable the exceptions that are not needed on unprotected public networks.

Once a user has created a list of firewall exceptions that are allowed to listen for incoming connections a conventional host firewall makes sure that no other unsolicited traffic will get inside the computer. Most conventional host firewalls enforce allow block rules in a fairly static manner for example once an application is allowed blocked it continues to be allowed blocked regardless of the environment a computer could be operating under.

This Summary is provided to introduce a selection of concepts in a simplified form that are further described below in the Detailed Description. This Summary is not intended to identify key features or essential features of the claimed subject matter nor is it intended to be used as an aid in determining the scope of the claimed subject matter.

In one embodiment a computer implemented method for a network aware firewall is disclosed. The method includes accessing a first network connection from a client computer system and determining whether the first network connection is public or private. The method further includes dynamically modifying security parameters associated with a firewall local to the client computer system in response to determining whether the network connection is public or private

The drawings referred to in this description should be understood as not being drawn to scale except if specifically noted.

Reference will now be made in detail to embodiments of the present technology for a network aware firewall examples of which are illustrated in the accompanying drawings. While the technology for a network aware firewall will be described in conjunction with various embodiments it will be understood that they are not intended to limit the present technology for a network aware firewall to these embodiments. On the contrary the presented technology for a network aware firewall is intended to cover alternatives modifications and equivalents which may be included within the spirit and scope the various embodiments as defined by the appended claims.

Furthermore in the following detailed description numerous specific details are set forth in order to provide a thorough understanding of the present technology for a network aware firewall. However the present technology for a network aware firewall may be practiced without these specific details. In other instances well known methods procedures components and circuits have not been described in detail as not to unnecessarily obscure aspects of the present embodiments.

Unless specifically stated otherwise as apparent from the following discussions it is appreciated that throughout the present detailed description discussions utilizing terms such as receiving performing generating accessing blocking forming identifying enabling modifying comparing classifying reporting configuring determining prompting and incrementing or the like refer to the actions and processes of a computer system or similar electronic computing device. The computer system or similar electronic computing device manipulates and transforms data represented as physical electronic quantities within the computer system s registers and memories into other data similarly represented as physical quantities within the computer system memories or registers or other such information storage transmission or display devices. The present technology for a network aware firewall is also well suited to the use of other computer systems such as for example optical and mechanical computers. Additionally it should be understood that in embodiments of the present technology for a network aware firewall one or more of the steps can be performed manually.

With reference now to portions of the technology for a network aware firewall are composed of computer readable and computer executable instructions that reside for example in computer usable media of a computer system. That is illustrates one example of a type of computer that can be used to implement embodiments which are discussed below of the present technology for a network aware firewall.

System of includes an address data bus for communicating information and a processor A coupled to bus for processing information and instructions. As depicted in system is also well suited to a multi processor environment in which a plurality of processors A B and C are present. Conversely system is also well suited to having a single processor such as for example processor A. Processors A B and C may be any of various types of microprocessors. System also includes data storage features such as a computer usable volatile memory e.g. random access memory RAM coupled to bus for storing information and instructions for processors A B and C.

System also includes computer usable non volatile memory e.g. read only memory ROM coupled to bus for storing static information and instructions for processors A B and C. Also present in system is a data storage unit e.g. a magnetic or optical disk and disk drive coupled to bus for storing information and instructions. System also includes an optional alphanumeric input device including alphanumeric and function keys coupled to bus for communicating information and command selections to processor A or processors A B and C. System also includes an optional cursor control device coupled to bus for communicating user input information and command selections to processor A or processors A B and C. System of the present embodiment also includes an optional display device coupled to bus for displaying information.

Referring still to optional display device of may be a liquid crystal device cathode ray tube plasma display device or other display device suitable for creating graphic images and alphanumeric characters recognizable to a user. Optional cursor control device allows the computer user to dynamically signal the movement of a visible symbol cursor on a display screen of display device . Many implementations of cursor control device are known in the art including a trackball mouse touch pad joystick or special keys on alpha numeric input device capable of signaling movement of a given direction or manner of displacement. Alternatively it will be appreciated that a cursor can be directed and or activated via input from alpha numeric input device using special keys and key sequence commands.

System is also well suited to having a cursor directed by other means such as for example voice commands. System also includes an I O device for coupling system with external entities. For example in one embodiment I O device is a modem for enabling wired or wireless communications between system and an external network such as but not limited to the Internet. A more detailed discussion of the present technology for a network aware firewall is found below.

Referring still to various other components are depicted for system . Specifically when present an operating system applications modules and data are shown as typically residing in one or some combination of computer usable volatile memory e.g. random access memory RAM and data storage unit . In one embodiment the present technology for a network aware firewall for example is stored as an application or module in memory locations within RAM and memory areas within data storage unit .

Embodiments of the present technology for a network aware firewall are directed towards mobile computing. For example as increasing number of computers become mobile in home and enterprise they connect to different types of networks at different times. Host firewalls e.g. local to the computer system have a simple allow block policy for applications meaning once an application is allowed to listen on the network it s added to the firewall policy. This change is fairly static. The application is allowed to listen regardless of the network the computer is connecting this is true even when the computer connects to multiple networks where one connection is private e.g. trusted and the other is public e.g. untrusted . This is illustrated through below. Embodiments of the present technology for a network aware firewall dynamically modify firewall security settings according to the type of network the computer system is connected to which provides seamless firewall protection when switching from one connection to another.

Embodiments of the present technology for a network aware firewall are also directed towards parallel connectivity. Mobile laptops as well as stationary desktops can use remote connectivity technologies e.g. VPN and can be connected to different types of networks simultaneously. For example a roaming computer can be connected to the enterprise network from a public place via a VPN connection. Another example is an enterprise desktop can be connected to a home network via a firewall traversal interface personal VPN. In the first case the computer is primarily connected to a public e.g. untrusted network and further connects to an inside e.g. trusted network. In the second case the situation is reversed.

The firewall of the present technology stores and enforces network specific policies. As a computer roams between multiple networks e.g. one at a time or simultaneously network profiles for those networks are created and or activated and the firewall dynamically applies those policies according to which network the computer is connected to.

In one embodiment a firewall keeps two sets of firewall policies locally. The first policy is associated with private e.g. trusted networks. Examples of a private network include home a virtual private network VPN to a trusted network a trusted Intranet etc. The second policy is associated with public e.g. untrusted networks. Examples of public networks include WiFi at a local coffee shop an airport connection etc. In one embodiment the private policy can be only enabled when connected to the home network directly or through a VPN whether the network connected to is home or not can be determined automatically by analyzing the network attributes and at all other times the public profile is enabled. This provides the simplest solution to users that are not interested in managing the profiles. In another embodiment the user is asked whether a network is public or private every time a network connection is made.

In another embodiment the firewall profiles are modifiable meaning a user can establish any number of network specific profiles and can establish exceptions for specific networks. An exception is rule that either allows or denies access of an application or service on the client computer system.

When the laptop computer system is then used in a public network e.g. at a local coffee house the file sharing enabled within the home network should be disabled to prevent other computer systems from accessing information and or applications on the laptop computer system . Within the public network environment the laptop is sharing the network with unknown computers. Also the security infrastructure in some public networks is largely non existent.

Embodiments of the present technology for a network aware firewall dynamically modify security settings on the laptop in response to the network the computer is connected to. For example in the case described above the firewall on the laptop would disable file sharing when the laptop is connected to the public network and enable file sharing when the laptop is connected to the home network .

In one embodiment of the present technology the connection determiner is notified by a helper API application programming interface . The helper API notifies the connection determiner when a physical or virtual network interface comes up or goes down. In response the firewall checks to see if a network profile is established for the particular connection. If there is an existing profile the profile is enabled. If not a new profile is created or a default e.g. global profile is enabled.

The firewall further includes a firewall modifier that modifies security policies associated with the firewall in response to the connection determiner determining a connection type. For example in response to the connection determiner determining that a connection is public the firewall modifier accesses the security profiles and enables the public security profile . In response to the connection determiner determining that a connection is private the firewall modifier accesses the security profiles and enables the private security profile . In one embodiment the public security profile is a default e.g. global profile which provides the most security.

It is appreciated that any number of security profile models can be used in accordance with the present technology for a network aware firewall. For example a two firewall policy can be implemented wherein two different profiles can be used. The first profile is used for public networks and the second is used for private networks. In an unmanaged environment e.g. the user does not modify security policies the private profile is used primarily at home and the public profile is used everywhere else. In this example it is assumed that all other networks are not to be trusted and that the home network is the only network to be trusted. In another embodiment a standard profile is set. A standard profile is a profile that an administrator for example wants to enforce on both public and private networks. In this case public and private profiles created for networks are merged with the standard profile with conflicts being resolved in favor of what is specified in the standard profile.

In one embodiment a user selects whether a connection is public not trusted or private trusted every time a connection is made. In another embodiment a plurality of network profiles can be simultaneously enforced. For example if a computer is coupled to N networks N or more different security profiles could be simultaneously implemented.

In a managed computer environment e.g. managed by a system administrator examples of profiles include a public profile a private profile and a corporate profile for example. The corporate profile can be used in the case of a domain joined network wherein a user may connect from a first network to a second network e.g. VPN from work to home or vice versa . In the case of a domain joined network a standard profile can be established by a system administrator for example. The standard profile can be merged with the public and private profiles for the specific network interfaces that are not connected to the corporate or home network for example.

In addition to the two policy model described above an n 1 model can be used where the firewall maintains distinct policies per network. For example as a computer connects to arbitrary networks the network determiner creates new network profiles and the firewall is made aware of the new network profile. In addition to maintaining the per network policy the firewall can also maintain a global policy which is applicable to any network the computer connects to. For N networks the firewall maintains N profiles and a global profile hence the name N 1 firewall policy model.

In one embodiment network profiles are virtual system objects. They can be created as a computer connects to different networks. For example a laptop that has connected to a home network a coffee shop network and an airport network at different times can have as many as three network profiles while a desktop computer system may only have one network profile since it is stationary . The desktop however can VPN to different networks in which case it can have a separate network profile for each such network.

It is appreciated that a computer can have both physical e.g. wired wireless and virtual e.g. VPN interfaces. Physical interfaces are hardware interfaces for example a LAN Local Area Network interface using an Ethernet card or a wireless interface. Virtual interfaces are created manually by system administrators for example VPN interfaces or some other dial on demand interface. The exemplary firewall of the present technology maps the network interfaces physical or virtual connected to a system to network profiles and implements them at the firewall.

At method includes determining whether the first network connection is public or private. As stated above any number of methods for determining whether the network connection is public or private can be used. For example a network location awareness NLA service can be used to determine network properties such as location.

At method includes dynamically modifying security parameters Associated with a firewall local to the client computer system in response to determining whether the first network connection is public or private. For example can include automatically modifying the firewall security parameters to a public profile in response to determining the first network is public and vice versa. can also include enabling a default e.g. global security profile e.g. a public security profile in response to detecting a network connection other than a home network.

In one embodiment a security policy restricts actions of a particular service and or application on the client computer system to prevent malicious access from others coupled to the network. Firewall exceptions can be created for individual networks and can also be automatically disabled in in response to detecting a network connection that does not have a network profile.

The following exemplary scenarios are provided as examples of the present technology for a network aware firewall. The first scenario referred to as the Abby scenario relates to enabling and disabling file sharing when connecting to different networks. Suppose Abby attaches her laptop to her home network. Abby then opens the file sharing port on the laptop to share files between her laptop and her desktop. Abby then takes her laptop to a coffee shop and connects to the wireless network available. Embodiments of the present technology for a network aware firewall can automatically disable file sharing in response to determining the laptop is connected to a public network.

Scenario two referred to as the Ichiro scenario relates to a system administrator that wants to prevent system users from modifying firewall parameters. Suppose Ichiro has deployed a host firewall in his enterprise network and sets the policy for the desktops. Ichiro wants to discourage the users of the desktops from changing the firewall policies. Embodiments of the present technology for a network aware firewall can disable a firewall control panel e.g. firewall user interface for users other than administrators or any other authorized user.

Scenario three relates to creating exceptions to firewall policies. Suppose Ichiro has deployed a host firewall in his enterprise network and has set the policy for the laptops. Ichiro knows that users of the laptops can attach those computers to outside networks e.g. networks away from home when they are roaming so he wants to deploy a stricter default firewall policy when users are connected to networks other than the home network. Embodiments of the present technology for a network aware firewall can create a default e.g. global firewall policy and enable the default firewall policy when the computer is connected to networks other than the home network.

Scenario four relates to virtual networks. Suppose Ichiro has deployed a host firewall in his enterprise network and configured the policies for the desktops. When users are roaming and VPN into a corporate network Ichiro wants those computers to have a Domain policy only on the VPN interface and not on the physical interface that was used to establish the VPN. Further Ichiro is aware of the firewall traversal feature that can be used by users to connect to an outside network from the corporate desktop. Ichiro wants to make sure that the firewall exceptions created by him on the corporate desktops are only available to computers on the corporate network. Embodiments of the present technology for a network aware firewall can establish and enforce multiple network specific security policies simultaneously and can distinguish between virtual and physical network connections.

In one embodiment for an enterprise network a domain administrator continues to have the option to define whether local users can change firewall settings from a firewall user interface. If the administrator disables the local edit functionality the UI for private as well as public exceptions is not accessible to users other than the administrators.

Embodiments of the present technology for a network aware firewall improve firewall protection against malicious activity even when a user connects a computer to multiple networks over a course of time or simultaneously. The exemplary network aware firewall of the present technology dynamically modifies firewall security policies in response to determining what network s the computer system is connected to. The firewall provides flexibility by allowing users to customize profiles for individual connections. The firewall also protects users that are not interested in customizing profiles but still want to be protected by automatically enabling a public security profile when outside of a private network.

Although the subject matter has been described in a language specific to structural features and or methodological acts it is to be understood that the subject matter defined in the appended claims is not necessarily limited to the specific features or acts described above. Rather the specific features and acts described above are disclosed as example forms of implementing the claims.

