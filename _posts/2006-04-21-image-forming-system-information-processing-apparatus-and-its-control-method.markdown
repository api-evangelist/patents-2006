---

title: Image forming system, information processing apparatus and its control method
abstract: An information processing apparatus, connectable to an information forming system having plural devices corresponding to plural processing stages including at least a printing stage and a bookbinding stage. Function information indicating abilities regarding plural function items of the plural devices are held, and a user interface for function selection is provided by displaying options based on contents of the function items of plural devices corresponding to one processing stage in accordance with the held function information. Then, available devices are narrowed down based on the selection of the options, and a device to be used in the processing stage is determined.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07900146&OS=07900146&RS=07900146
owner: Canon Kabushiki Kaisha
number: 07900146
owner_city: Tokyo
owner_country: JP
publication_date: 20060421
---
The present invention relates to an image forming system having an image forming apparatus a client computer and a network connecting these devices and more particularly to a technique for utilization of a postprocessing device existing on such network.

Generally a printing system in which an image forming apparatus and a client computer are connected with each other having finishers for cutting bookbinding and the like is known. In this type of printing system various settings regarding finishers can be made upon generation of a print job by utilizing characteristic information of postprocessing devices finishers available in the system. As methods for utilizing the finisher characteristic information upon generation of print job 1 a method for controlling printing attribute s upon printing and 2 a method for controlling user interface function items of a printer driver and the like are known.

In the above method 1 i.e. the method for controlling printing attribute s upon printing by utilizing the finisher characteristic information a method for automatically setting printing attribute s by a printer driver in correspondence with the finisher characteristic information upon generation of print job is known. According to Japanese Patent Application Laid Open No. 2004 078449 the printer driver obtains the following two items regarding a bookbinder 

Further as the above method 2 a method for controlling the user interface function items of the printer driver by utilizing the finisher characteristic information has been proposed. In this method the type of a finisher attached to a printer is manually or automatically identified thereby the user interface function items can be controlled.

Further Japanese Patent Application Laid Open No. 2001 125765 discloses a user s selection of a bookbinding format then converting print data for bookbinding in accordance with the bookbinding format selected by the user then print outputting the print data for bookbinding converted in accordance with the bookbinding format and outputting a bookbinding original copy. According to Japanese Patent Application Laid Open No. 2001 125765 a preview screen of bookbinding product generated based on the bookbinding format designated by the user is displayed. Accordingly the user s desired bookbinding original copy can be outputted without mistake and improvement in working efficiency cost reduction and resource conservation can be realized.

As described above when printing is performed using a printer driver the contents of works performed by the image forming apparatus such as a printer or a multi function peripheral device MFP and an in line finisher connected to the apparatus can be set on a setting screen of the printer driver and print instruction can be performed. That is the both image forming apparatus and in line finisher can be controlled from the printer driver. Note that the in line finisher is a postprocessing device which is physically connected with the image forming apparatus as an optional device of the image forming apparatus and which conveys a printed matter outputted by the image forming apparatus to the finisher without manual operation. Further the in line finisher by itself cannot perform communication with a host computer however the finisher can generate a print job where the content of processing in the finisher for example staple processing is designated using the image forming apparatus or the printer driver.

However for the user to select such many devices and perform desired settings of these devices it is necessary and troublesome to grasp functions of the devices and settings to be made. Accordingly when the settings are complicated or when some settings have been omitted outputting is performed again. Thus wasteful output may occur.

Further in some cases bookbinding work is performed by using a postprocessing device such as a near line finisher or an off line finisher to which a paper sheet outputted from the image forming apparatus is not automatically conveyed in addition to the in line finisher. Note that the near line finisher has a unit for communication with an external device such as a computer or the image forming apparatus and the content of processing by the finisher can be set from the external device. That is in the near line finisher the content of processing can be set from an operation unit of the finisher and further the content of processing job ticket can be inputted and set from another device such as the host computer via the network. Note that the near line finisher which is different from the in line finisher is not physically connected with the image forming apparatus. A paper sheet outputted from the image forming apparatus is conveyed by an operator. Further the off line finisher is a postprocessing device which is not physically connected with the external device as in the case of the near line finisher and which has no unit for communication with the external device as in the case of the near line finisher.

When the postprocessing device such as the near line finisher or the off line finisher is used the abilities of these postprocessing devices cannot be recognized on the driver side while the recognition of the abilities of the in line finisher are considered as options upon printer driver design. Accordingly it is necessary for the operator to determine a device to obtain a finally desired bookbinding form and perform print settings while imagining processings executed in the respective postprocessing devices. The operator s higher level knowledge and experiences are required.

On the other hand Japanese Patent Application Laid Open No. 2001 125765 discloses setting bookbinding data as an original copy of bookbinding product through plural selection screen images. However in the technique disclosed in Japanese Patent Application Laid Open No. 2001 125765 the operability for a user who has an image of final bookbound product but who cannot perform determination of a device to be used and perform setting of the device based on the image is not considered. According to the technique disclosed in Japanese Patent Application Laid Open No. 2001 125765 an output format is selected in a predetermined bookbinder and the output format processed based on settings selected by the user is displayed as a preview screen. Further processing when the system configuration becomes complicated or changed is not disclosed. Further when plural postprocessing devices are available or when a new postprocessing device is added to the system and the number of available bookbinding formats is increased processing cannot be performed in a flexible manner in accordance with such situation.

The present invention has been made in consideration of the above problems and has its object to facilitate selection and setting of a device necessary to obtain a desired final product.

According to one aspect of the present invention there is provided an information processing apparatus connectable to an image forming system having plural devices corresponding to plural processing stages including at least printing stage and bookbinding stage comprising a holding unit configured to hold function information indicating abilities regarding plural function items of the plural devices an interface unit configured to provide a user interface for displaying options based on contents of the function items of plural devices corresponding to one processing stage in accordance with the function information held in the holding unit a narrow down unit configured to narrow down available devices based on selection of the options and a determination control unit configured to cause the interface unit and the narrow down unit to function regarding different function items more than once for one processing stage and determine a device to be used in the processing stage.

A printing system according to a first embodiment to be described below has image forming apparatuses finishers client computers in which a printer driver is installed and a network connecting these devices. In the printing system the printer driver performs finisher setting processing using a file describing the characteristic of a finisher. Further in the present embodiment as a wizard format setting screen is provided a user can determine a finisher to be used and an image forming apparatus and can perform print setting by appropriately performing setting through the setting screen based on a desired final output form.

Also according to another aspect of the present invention there is provided an image forming system having plural devices corresponding to plural processing stages including at least printing stage and bookbinding stage comprising a holding unit configured to hold function information of the plural devices an interface unit configured to provide a user interface for displaying options based on contents of the function items of plural devices corresponding to one processing stage in accordance with the function information held in the holding unit a narrow down unit configured to narrow down available devices based on selection of the options and a determination control unit configured to cause the interface unit and the narrow down unit to function regarding different function items more than once for one processing stage and determine a device to be used in the processing stage.

Furthermore according to another aspect of the present invention there is provided a control method for an information processing apparatus connectable to an image forming system having plural devices corresponding to plural processing stages including at least printing stage and bookbinding stage comprising an interface step of referring to a holding unit holding function information indicating abilities regarding plural function items of the plural devices and providing a user interface for displaying options based on contents of the function items of plural devices corresponding to one processing stage a narrow down step of narrowing down available devices based on selection of the options and a determination control step of performing the interface step and the narrow down step regarding different function items more than once for one processing stage and determining a device to be used in the processing stage.

Other features and advantages of the present invention will be apparent from the following description taken in conjunction with the accompanying drawings in which like reference characters designate the same name or similar parts throughout the figures thereof.

Preferred embodiments of the present invention will now be described in detail in accordance with the accompanying drawings.

A printing system according to a first embodiment to be described below has image forming apparatuses finishers client computers in which a printer driver is installed and a network connecting these devices. In the printing system the printer driver performs finisher setting processing using a file describing the characteristic of a finisher. Further in the present embodiment as a wizard format setting screen is provided a user can determine a finisher to be used and an image forming apparatus and perform print setting by appropriately performing setting through the setting screen based on a desired final output form.

As described in the above conventional art the respective terms in line near line and off line will be described again. First explanations of the respective terms from a viewpoint of finisher processing control will be made. The in line finisher is a device which cannot perform communication by itself with a host computer but the content of processing performed in the finisher can be set from the image forming apparatus or the host computer via the image forming apparatus. The off line finisher is a device which has no unit for communication with an external device and the content of processing performed in the finisher is set in the finisher itself. The near line finisher is a device which has a unit for communication with an external device and the content of processing performed in the finisher can be set in the finisher itself or from another device e.g. the client PC or via the network.

Further the features of the in line near line and off line in a print output conveyance passage paper path will be described. The in line finisher is physically connected to the image forming apparatus. The in line finisher has a structure where paper print outputted from the image forming apparatus is passed through the conveyance passage paper path to the finisher directly and quickly. The off line finisher is not physically connected to the image forming apparatus. Paper print outputted from the image forming apparatus is temporarily buffered on a cart tray belt conveyer or the like then set in an input unit of the finisher by the user. In the near line finisher paper is temporarily buffered and set in the input unit of the finisher by the operator as in the case of the off line finisher.

The client PCs and are realized with a so called personal computer. As the hardware construction of the personal computer is well known the illustration and explanation of the hardware construction will be omitted. As the client PCs and have the same structure only the client PC will be described.

The printer driver has a user I F driver for display of a user I F and storage of settings and a graphic driver which converts a print drawing command received from an application program through the OS to code interpretable for the image forming apparatus. Note that a printer driver setting storage area is provided in a storage area managed by the OS . A printing attribute set by the user via the user I F driver is stored in the printer driver setting storage area . Further the user I F driver the graphic driver and the application software can access the printer driver setting storage area via the OS and read the printing attribute set by the user. A profile storage area is an area within the OS for storing a finisher profile obtained by the printer driver via the image forming apparatus or directly from a finisher. The finisher profile stored in the profile storage area will be described later with reference to .

Further a communication I F of the client PC is connected to a communication I F on the image forming apparatus and or side via a communication medium such as the network . The graphic driver can transmit print data to the image forming apparatuses and via the OS and can obtain construction information statuses and the like of the image forming apparatuses and via the OS . Note that the image forming apparatuses and are respectively provided with a specialized printer driver.

A job controller controls a processing process processing path to temporarily store image data in accordance with purpose of the image forming apparatus and appropriately read the stored image data or the like and output the data. Further the job controller performs various controls based on an instruction from the operator inputted via the operation unit . For example the job controller controls reading of image data stored in a memory such as a hard disk and transfer of the data to the client PCs and or an external device such as another image forming apparatus via the specialized I F unit or the like.

A document storage unit has a memory such as a hard disk capable of storing plural image data. For example plural types of image data including image data from the scanner input unit image data of a facsimile job inputted via the FAX unit image data from an external device such as a computer inputted via the NIC unit and image data from another image forming apparatus inputted via the specialized I F unit can be stored in the memory such as a hard disk. The job controller controls appropriate reading of image data stored in the memory such as a hard disk and transfer of the data to an output unit such as a printer unit .

When image data is stored into the document storage unit a compression decompression unit compresses the image data and stores the compressed image data or upon reading compressed image data from the storage unit decompresses the data to original image data in accordance with necessity. Further when image data is transmitted via the network compressed data such as JPEG JBIG or ZIP data may be used. In such case when the image data has been inputted into the image forming apparatus the compression decompression unit decompresses the compressed data.

A common DB unit holds commonly used various parameter tables such as font color profile and gamma tables and calls them in accordance with necessity. Further the common DB unit can hold new parameters and tables and correct or update them. For example registration data regarding a near line finisher to be newly registered in the image forming apparatus can be stored.

When PDL data has been inputted the job controller controls a PDL unit to perform RIP Raster Image Processor processing or in accordance with necessity controls an image processing unit to perform image processing for print outputting. Further the job controller controls storage of intermediate data and print ready data print output bitmap data and compressed data thereof generated upon such image processing in accordance with necessity into the document storage unit again.

Then the job controller sends the above described print ready data to the printer unit . A recording medium print paper sheet print outputted by the printer unit is subjected to finishing processing such as sorting or bookbinding in a postprocessing unit . That is the postprocessing unit includes an in line finisher.

The job controller performs path switching as follows in accordance with use of image forming apparatus.

In addition to the above functions combinations of various functions including E mail services and a Web server function can be employed however they will be omitted here.

Further the box scanning the box printing the box reception and the box transmission are processing functions of the image forming apparatus accompanied by data writing or reading utilizing the document storage unit . These processing functions divide a memory in the document storage unit by job or user for temporary data storage and perform data input output using combinations of user IDs or passwords.

Further the operation unit for selecting various flows as above and for issuance of operation instructions is also used for preview of image data in the document storage unit in accordance with improvement in high resolution display unit of the operation unit . When checked image data is OK print output can be performed.

In the present embodiment the respective devices including the image forming apparatus and the finishers have profile information describing their abilities in the XML format. There are various finisher types such as a bookbinder a cutting machine and a folding machine and the functions are much different in accordance with finisher type. Further the information changes very often by addition of new function or the like. Accordingly in the present embodiment the XML format having tag description which can appropriately used in such situation is employed as the finisher profile. Note that any description format can be used without any problem as long as a newly added function or the like can be adaptively described. Further the finisher profile is prepared by finisher.

Next a procedure for acquisition of finisher profile of a near line finisher from the image forming apparatus by the printer driver and storage of the acquired profile will be described.

In the construction of the profile storage area is a storage area in the OS to store a finisher profile obtained by the printer driver from the image forming apparatus . The printer driver starts a profile acquisition module through the API Application Programming Interface of the OS then obtains a finisher profile from the image forming apparatus using the profile acquisition module and stores the profile into the profile storage area . The profile acquisition module may be a module as a part of the printer driver or may be provided as a part of the functions of the OS . Further to make a finisher profile request or perform transmission of finished profile a communication medium is used between the communication I F on the client PC side and the communication I F on the image forming apparatus side. Note that any protocol can be used in the communication as long as a finisher profile acquisition request can be made from the printer driver and transmission of the substance of finisher profile can be performed and there is no designation of protocol. Next a method for acquisition of a finisher profile from the image forming apparatus by the printer driver will be described with reference to a flowchart. is a flowchart showing this procedure. The processing in is performed when the power of the computer is turned on when a print processing instruction is made by the user or performed in accordance with the user s explicit instruction.

First at step S the printer driver requests the image forming apparatus obtain a finisher profile of a finisher which is connected to and registered in the image forming apparatus. In response to the acquisition request from the printer driver the image forming apparatus transmits a finisher profile stored in the finisher profile storage area to the client PC where the printer driver operates.

First at step S the image forming apparatus which has received the request MFP in sequentially browses the finisher management table from the top and thereby checks connection statuses of the respective finishers. For example when the image forming apparatus has the finisher management table shown in the image forming apparatus checks the connection status of the top Finisher A at the first step. In this table the finisher connection status is false meaning that the finisher is not available. Next at step S the connection status condition is determined. As the Finisher A is in the false connection status the process proceeds to step S. At step S it is determined whether or not all the finishers have been checked. If all the finishers have not checked the process returns to step S. This processing is similarly repeated for Finisher B Finisher C and Binder ABC .

Next at step S the connection status of the next entry Finisher X is checked. As the connection status of the Finisher X is true meaning that the finisher is available in the condition determination at the next step S the process proceeds to step S. At step S the image forming apparatus transmits the finisher profile of each finisher managed in an available status i.e. the finisher currently checked on the finisher management table to the printer driver. For this purpose the image forming apparatus reads a corresponding finisher profile name finisher x of xyz.xml from the finisher management table . Then the image forming apparatus reads a file with this file name from the finisher profile storage area and transmits the file to the printer driver step S .

The processing at the above steps S to S is repeated on all the finishers registered in the finisher management table . When the last finisher in the finisher management table has been checked information indicating the completion of all the finishers is transmitted to the printer driver at step S and the processing of the flowchart ends.

On the other hand the printer driver receives a response from the image forming apparatus step S to determine whether or not the content of the response is end step S . When the response is not end as the received data is a finisher profile the printer driver stores the data in the storage area step S . In this manner the printer driver obtains a finisher profile of a near line finisher in a connected status i.e. available status from the image forming apparatus.

Note that a profile of an in line finisher can be obtained as in the case of the near line finisher. Further regarding the in line finisher as the number of in line finishers connectable to the image forming apparatus is limited it may be arranged such that the profiles of all the in line finishers are previously stored in the image forming apparatus. In this case an activation flag or the like is associated with the profile of a near line finisher actually connected to the image forming apparatus thereby the connection status is indicated. Accordingly upon processing for finisher setting or the like an activated in line finisher is an available finisher.

Note that in the present embodiment as the profiles of the near line finishers are consolidately managed by the image forming apparatus all necessary finisher profiles can be acquired from the image forming apparatus however the present invention is not limited to this arrangement. For example it may be arranged such that the printer driver directly access a near line finisher to obtain a finisher profile. In this case it is necessary for the printer driver to obtain the address of the near line finisher on the network however such address acquisition or the like is apparent for those skilled in the art. Further in the above description the printer driver obtains a finisher profile however the present invention is not limited to this arrangement. A print setting application or another acquisition unit may be employed to obtain a finisher profile.

The acquisition of finisher profile from the image forming apparatus and the acquisition of finisher profile from a near line finisher realized by the communication function of the printer driver are described as above. The acquisition of finisher profile may be performed at arbitrary timing by e.g. polling or may be performed upon e.g. wizard generation to be described below. Further it may be arranged such that near line finisher and off line finisher may be manually registered. Note that as described above in a case where the profiles of all the finishers in line finishers near line finishers and off line finishers available for the image forming apparatus can be registered in the finisher management table the printer driver can obtain all the finisher profiles in the printing system from the image forming apparatus. Further it may be arranged such that profiles of in line finishers are notified from the image forming apparatus to the printer driver without management by the finisher management table in this case the in line finishers are not registered in the finisher management table .

The print setting application held on the client PC generates a print setting wizard for the user to instruct print settings. The print setting wizard is generated based on the finisher profiles stored in the profile storage area and the ability information of the image forming apparatuses held in the respective printer drivers. Note that in the present embodiment the wizard is called the print setting wizard however the wizard can be used upon setting for performing postprocessing such as bookbinding finishing on printed sheets using the respective finishers.

Note that the wizard means a function and its display screen to display an interactive guidance for a user and cause the user to make a selection among plural options in accordance with guidance thereby facilitate complicated software operation or setting. For example a wizard screen upon installation of application software into a computer which sequentially displays installed functions and installation destination directories is well known.

The print setting application first collects the finisher profiles and ability information of the image forming apparatuses and analyzes the contents of the profiles by function. Then the print setting application generates function tables having information in function units such as print function bookbinding function and cutting function. In the present embodiment processing stages are classified into print stage and postprocessing stage .

In the present embodiment the image forming apparatus is a color machine also available as a monochrome machine having a print speed of 100 sheets minute and an available paper size of A4 and A3. Further the in line finisher is connected to the image forming apparatus and as its abilities the available paper size is A4 and A3 the number of placeable sheets is and the binding method is side stitching. The print setting application generates a device table where these ability information are registered by device.

Next the print setting application generates a function table from the device table . For example the print setting application classifies the processings in the printing system into plural processing stages such as print processing and print postprocessing collects the ability information by processing stage function print function or bookbinding function and generates the function table . For example the print setting application collects the ability information of the respective image forming apparatuses ability information of the image forming apparatus and ability information of the image forming apparatus and generates a printing table where the print functions are collected. Further the print setting application collects the ability information of the respective finishers ability information of the in line finisher ability information of the near line finisher and ability information of an off line finisher not shown and generates a bookbinding table where the bookbinding functions are collected. show the data structure of the function table printing table and bookbinding table in the present embodiment.

The print setting application has a wizard generator to read the above described function table and construct the print setting wizard. The wizard generator refers to the function table and generates a wizard screen to be used upon print setting processing to be described later. As shown in the function table includes a bookbinding table where finisher functions are collected with a printing table where image forming functions are collected. The wizard generator is an application to generate a wizard screen to be displayed on a display and a control program where interscreen transition condition or the like is described.

At step S the wizard generator determines whether or not a bookbinding table exists in the function table . When a bookbinding table exists the process proceeds to step S at which a wizard screen is generated for inquiry about execution non execution of bookbinding. is an example of the wizard screen.

Next at step S the wizard generator determines whether or not plural bookbinding types exist in the bookbinding table . When there are plural bookbinding types it is impossible merely based on the designation TO BE BOOKBOUND in the wizard screen generated at step S to determine a bookbinding type and a finisher to be used. Accordingly at step S when there are plural bookbinding types the process proceeds to step S. Then a wizard screen for selection of bookbinding type is generated at step S.

Next the determination at step S and the generation of the wizard screen at step S will be described more specifically. At step S the contents of stitching function in the bookbinding table are referred to and it is determined whether or not plural stitching functions exist in the stitching function . In the stitching function of the bookbinding table shown in it is found that the in line finisher has a function of side stitching and the near line finisher has the function of side stitching and a function of saddle stitching. That is as a bookbound product by side stitching and that by saddle stitching as the bookbinding forms can be produced a selection is to be made from plural bookbinding types.

In this manner when it is determined at step S that plural bookbinding types bookbinding forms exist the process proceeds to step S. At step S a bookbinding type selection wizard screen is generated for the user to select one of the plural bookbinding types determined at step S. In this example as the two bookbinding types side stitching and saddle stitching exist a screen to select one of them is generated. shows the wizard screen at this time.

At step S if a single finisher has been determined as a result of the selection of function type in the wizard screen in the device is set and the process proceeds from step S to step S. That is in a case where a finisher corresponding to the selected bookbinding type selected from the plural bookbinding types displayed in the bookbinding type selection wizard screen generated at step S the finisher to execute the user s desired bookbinding processing is determined at this stage.

On the other hand when the wizard generator determines at step S that a device finisher to be used cannot be determined only by selecting one bookbinding type the process returns from step S to step S. Then the wizard generator generates a wizard screen for determination of a device to be used in accordance with a finishing device selection rule to be described later.

Next there will be described a particular example of a case where a device finisher to be used cannot be determined only by selecting one bookbinding type. For example when the bookbinding table is referred to and side stitching is selected as a function type this function can be realized by the in line finisher and the near line finisher . Accordingly the device to be used cannot be determined at this stage. In the present embodiment a wizard in accordance with the finishing device selection rule is generated at step S.

Further in a case where only one type of stitching function exists the stitching function is set. When a finishing device cannot be determined at this stage for example there are plural finishers having the same side stitching function a wizard screen is generated in accordance with the finishing device selection rule to be described later. Note that at this time it may be arranged such that the existing stitching function is indicated and at the same time a screen notifying that there is no choice of stitching function is generated.

Hereinbelow the finishing device finisher selection rule will be described with reference to the function tables in . Note that the selection rule is merely an example and it does not pose any limitation on the present invention.

In a case where plural bookbinding devices exist in the bookbinding table the functions of the respective devices are compared with each other in accordance with the order of predetermined inquiries. Then regarding devices having different contents of function information a screen for inquiry about selection of function is generated. In the example of the bookbinding table in two types of devices i.e. the in line finisher and the near line finisher exist. In this case for example function comparisons are made in the order stitching function available paper size number of sheets . . . and a wizard is generated only regarding different function information. Hereinbelow the generation of wizard will be described more specifically. Note that in this example of finishing device selection rule the processing at step S will be described.

By the processing at step S based on the above described finishing device selection rule when it is determined at step S that a finisher corresponding to the bookbinding type can be determined the process proceeds to step S. At step S a wizard screen for setting necessary setting conditions stitching position paper size the number of sheets etc. for use of the finisher corresponding to the bookbinding type is generated. This wizard screen may be a screen displaying all the setting items processible by each finisher or may be a wizard screen group for stepwisely setting the respective items. For example in a screen regarding the in line finisher various setting items including a stitching direction long side stitching or short side stitching and stitching position may be displayed in one screen. Otherwise a screen for selection of stitching direction is generated first then a screen for selection of stitching position is generated as a screen to be displayed next.

Note that in the above example plural finishers having stitching functions exist however the finishers include a cutting machine to cut paper or the like. For example when a cutting machine exists a wizard screen is generated in accordance with whether or not cutting function exists from step S in the flowchart of . Then a transition condition between a wizard screen regarding the bookbinding function and a wizard screen regarding the cutting function is determined. That is when the user has selected Not to be bound in the wizard screen in linkage is made such that the screen changes to a wizard screen for selecting To be cut or Not to be cut as a wizard screen regarding the cutting function. Further when the user has selected To be bookbound in the wizard screen in linkage is made such that setting for the above described bookbinding is made then the screen changes to a wizard screen for selecting To be cut or Not to be cut . When the user has selected To be bookbound and the content of set bookbinding has not correspond with the ability of the cutting machine a wizard regarding the cutting is not displayed otherwise a screen notifying the user that the cutting function cannot be utilized is generated and linkage is made such that the screen is displayed when such setting has been made. For example when the paper type determined by the user in a wizard screen regarding bookbinding is not an available paper type for the cutting machine even if a wizard screen for inquiry about use of cutting function has been prepared the screen is not displayed. Otherwise a transition condition is previously determined such that a screen notifying paper type determined in bookbinding setting is not available for cutting function is displayed.

By the above processing the generation of wizard screen group for the purpose of setting of bookbinding and other postprocessing has been completed. Next the processing changes to generation of wizard screen group for the purpose of print setting.

At step S generation of a wizard screen for determining a printing device is performed. In this example the generation processing will be described using a printing device selection rule.

When plural printing devices exist in one printing table the functions of the respective devices are compared with each other in accordance with a predetermined order. Then a wizard screen for inquiry about selection of function is generated regarding different function information. In the present embodiment the functions and abilities are compared in the order color selection available paper size printing speed . . . and a wizard is generated regarding different information. Hereinbelow a particular procedure will be described using the printing table in .

When color output has been selected in 1 as only the image forming apparatus is capable of color printing the image forming apparatus is selected in the change screen. Accordingly a screen not for specifying a printing device but for making various settings specific to the image forming apparatus is generated. When monochrome printing has been selected as an image forming apparatus cannot be specified the wizard generator generates a wizard screen corresponding to the available paper size . In this case a wizard screen for selecting output paper is generated. In this example a paper selection screen by pull down selection is shown. When A3 size has been selected the image forming apparatus incapable of A3 size output is excluded and the image forming apparatus is selected as a printing device. However when A4 size has been selected a printing device cannot be specified.

Note that it may be arranged such that the user s preference speed priority running cost priority or the like is set. Otherwise it may be arranged such that a screen to display a printing device which has become the last one is generated to cause the user to select the displayed device.

The print setting wizard generation processing by the wizard generator is as described above. Note that the wizard generated by the wizard generator is stored as a print setting application in the host computer in . Further the screen group and the transition conditions among the screens are also stored.

Next print setting using the wizard generated in the above described procedure will be described. The user starts a print setting wizard stored as an application. Then the user causes the print setting wizard to recognize document data e.g. a PDF file that the user wants to print output. This processing is performed by the user s causing the wizard to display a reference screen for designation of a file and designating a data path of the document data. When a file has been specified the screen shown in is displayed on the screen of the client PC.

Then the user changes the screen while inputting desired contents through the displayed screen thereby a finishing device and a printing device are automatically determined.

Note that the setting information inputted through the wizard is stored by the OS in a temporary storage area owned by the wizard print setting application . When a printing device has been determined the print setting application stores the setting information stored in the storage area of the print setting application into the printer driver setting storage area corresponding to the printing device. Thus a status similar to that upon print setting via a general printer driver can be obtained.

In the above described wizard when all the setting has been completed a screen for the user s designating whether or not printing is to be started is displayed. When printing is to be started in this screen the user input designation of start printing .

When start of printing has been designated the print setting application starts the printer driver of the printing device to be utilized. The printer driver receives the document data designated through the wizard using the print setting stored in the printer driver setting storage area .

Hereinbelow a print job including the print subject data that reflects the print setting and commands for execution of instructions and controls for the device is generated.

The print job generated by the printer driver is transmitted via the network to the printing device and printing is performed on the set printing condition.

Note that in the case of print setting using a near line finisher the setting information is notified to the near line finisher. The notification of the setting information to the near line finisher is made as notification of job control information describing the contents of postprocessing. The job control information which is also referred to as a job ticket has a description in structured language interpretable for the near line finisher. The job ticket generated by the printer driver is transmitted via the image forming apparatus or directly to the near line finisher. The near line finisher receives the job ticket and interprets the job control information thereby setting necessary for postprocessing of printed matter outputted from the image forming apparatus can be automatically performed. Note that in the present invention any method can be used in the generation of the print job and transmission of the print job from the printer driver to the image forming apparatus the in line finisher or the near line finisher and any data format of the print job can be used.

Note that in the above processing the generation of the wizard is previously performed and when the user performs printing the user interactively sets the conditions from a final product using the wizard thereby easily performs print setting and postprocessing device setting. However it may be arranged such that a wizard screen is generated upon display of the wizard.

As described above according to the first embodiment the print setting wizard is generated for interactive input of necessary items from the user s desired final product and the setting regarding printing and postprocessing is performed using the wizard thereby the selection and setting of an image forming apparatus to obtain the desired final product and other necessary device can be easily performed.

Hereinbelow the operation of the wizard generator when a near line finisher has been newly added to the construction of the first embodiment will be described as a second embodiment.

Next at step S a user interface for changing the status of the connected finisher to a connected status by the operation panel of the image forming apparatus is displayed. Next the connection operation using the user interface will be described with reference to .

In the finisher registration screen shown in a list of registrable finishers is displayed and connection registration of the respective finishers can be performed. The list has a finisher name a maker name and a connection status . In the list seven finishers are displayed at once. To browse finishers prior and subsequent to these seven finishers buttons and to scroll up and down the display list are depressed.

The connection registration and cancellation of connection registration using the finisher registration screen in are performed as follows. First a subject finisher is set to a selected status by touching a part of a column displaying the subject finisher. In a column is in a selected status. In this status where the desired finisher is selected the finisher in the selected status is connection registered by touching a Connect button and the connection status of the finisher in the selected status is released by touching a Disconnect button .

Hereinbelow the connection registration of a Finisher Y near line finisher a Finisher A near line finisher a Finisher B near line finisher with respect to the system configuration of the first embodiment as shown in will be described.

First to register the Finisher Y the Finisher Y is set to a selected status by touching a part of the column . Next the finisher is connection registered by touching the Connect button . Similarly to connection register the Finisher A and the Finisher B the above registration operation is performed with respect to columns and . In this manner the Finisher Y near line finisher the Finisher A near line finisher and the Finisher B near line finisher become in the Connect status.

Finally when an OK button is touched the above described setting is enabled and the initial screen of the operation panel of the image forming apparatus main body is restored. Note that when the above registration operation is cancelled a Cancel button is touched. By this operation the contents of the above described operation are cancelled and an update operation of the finisher management table of the image forming apparatus to be described later is not performed.

By the depression of the OK button the process proceeds to step S at which the image forming apparatus updates the finisher management table . Hereinbelow the update processing of the finisher management table will be described. In the finisher connection registration screen in as the user connection registered the Finisher Y by XYZ company the Finisher A by ABC company and the Finisher B by ABC company the finisher management table in is updated. In accordance with the connection registration columns of management numbers and Finisher Y Finisher A and Finisher B are written from false to true . shows the finisher management table in which such update has been performed on the status in . As shown in the connection status of the Finisher A the Finisher B and the Finisher Y of management numbers and as the management number are changed to true .

In the above procedure the connection registration of the finishers installed by the user is completed. Note that in the present embodiment the user connects the finishers and then performs the finisher connection registration with the operation panel of the image forming apparatus however the setting can be performed by any other method as long as the finisher management table can be updated. For example as the image forming apparatus and the finishers are connected via a communication medium it may be arranged such that the image forming apparatus automatically connection registers the finishers by defining a protocol upon connection and performing communication by the image forming apparatus and the finishers based on the protocol.

Thereafter when the client PC performs collection of ability information at predetermined timing such as polling by the above described finisher profile acquisition method the updated ability information is obtained from the image forming apparatus . Accordingly the client PC updates the function table in accordance with the obtained ability information. Hereinbelow the update processing of the function table will be described.

The print setting application refers to the finisher management table and updates the previously held bookbinding table as shown in utilizing the profiles of the newly added finishers. shows the bookbinding table corresponding to the present embodiment. Note that in this example a cutting machine near line finisher and a folding machine near line finisher are displayed in the bookbinding table however these finishers may be managed in another function table.

In this manner when the function table has been updated the wizard generator determines whether or not unconformity has occurred between the updated content and the generated wizard. When unconformity has occurred i.e. new function s has been added or function s has been deleted the wizard is re constructed.

For example as shown in when a case bookbinding function has been added as a stitching function case bookbinding is added to the screen in which the user designates a bookbinding printing method as shown in and at the same time a screen for setting information specific to a case bookbinding machine is generated. Further in addition to addition deletion of finisher similar processing is performed for addition deletion of image forming apparatus.

As described above according to the second embodiment the update processing of the function table is performed and the wizard is re constructed in a flexible manner in correspondence with a change of printing system configuration.

When the print setting application has been started the status information of the respective devices stored in the profile storage area or the device table is obtained. Then it is checked whether or not there is a device having a trouble in its operation out of consumable goods failure busy or the like based on the status information. When there is a device having a trouble in its operation a flag is set in the function table so as to disable selection of the device.

When there is a device for which the above flag is set the wizard generator specifies a screen related to the device in condition branching of a previously generated wizard and reconstructs the wizard screen not to select the device. Further when there are other screens setting conditions influenced by the reconstruction of the wizard screen the construction of the screens are sequentially changed.

As described above according to the third embodiment the wizard screen can be constructed in accordance with finisher status. For example as the wizard screen can be constructed such that a finisher having a trouble in its operation is excluded from subjects of selection a reliably available device can be automatically selected. Thus the operability is improved.

As described above the present invention facilitates a user s selection and setting of a device necessary for obtaining the user s desired final product.

As many apparently widely different embodiments of the present invention can be made without departing from the spirit and scope thereof it is to be understood that the invention is not limited to the specific embodiments thereof except as defined in the appended claims.

This application claims the benefit of Japanese Patent Application No. 2005 128621 filed on Apr. 26 2005 which is hereby incorporated by reference herein in its entirety.

