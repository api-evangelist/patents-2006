---

title: Virtual multicasting
abstract: A method and system of virtual multicasting content is disclosed. The method and system disclosed enable the receipt of virtual multicast content without requiring the expensive investment in the infrastructure necessary for a network to be multicast enabled. The virtual multicasting may be performed according to a method of virtual multicasting multicast content on non-multicast enabled networks, comprising the steps of determining if an attached network is multicast enabled, if the attached network is not totally multicast enabled, querying for virtual multicast requests for the multicast content from non-multicast enabled client computers, listening for virtual multicast requests, and determining, based on the virtual multicast requests, which client computers request the multicast content, from the unicast addresses, and the requested methods of delivery for the multicast content. The network includes client computers that have unicast addresses and the at least one virtual multicast request includes a unicast address identifying a client computer of the network and a requested method of delivery for the multicast content.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08898320&OS=08898320&RS=08898320
owner: 
number: 08898320
owner_city: 
owner_country: 
publication_date: 20060619
---
This is a Continuation of application Ser. No. 09 893 634 filed on Jun. 29 2001 now abandoned which is hereby incorporated by reference in its entirety.

This application hereby claims the benefit of the priority of U.S. Provisional Patent Application Ser. No. 60 214 752 filed Jun. 29 2000 which is hereby incorporated by reference. This application also hereby incorporates by reference U.S. patent application Ser. No. 09 835 529 entitled Channel Dancer and filed Apr. 17 2001 U.S. patent application Ser. No. 09 878 232 entitled Personal Content Manager and filed Jun. 12 2001 and U.S. patent application entitled Digital Rights Management invented by Khanh Mai Roland Noll and Tom Grimes and filed on the same date under separate cover as the present application.

The present invention is related to Internet Protocol IP multicasting and more particularly to IP multicasting over a non IP multicast supported network.

Over the past ten years the bandwidth capacity available to consumers for receiving content from the Internet and other networks has increased ten fold and more. The increased bandwidth capacity has enabled consumers to download larger and larger files and other content including rich media and multimedia content such as audio clips video clips songs programs and movies. This increased bandwidth capacity has increased Internet usage and the potential for enjoyable and productive usage.

The content may be delivered to users for example as real time IP multicast or unicast streams. IP multicasting is a method to send a single message to multiple recipients belonging to a multicast group. To multicast content a multicast group is created by a multicast router and Internet Group Management Protocol IGMP queries for the multicast content are sent out to clients via the router s network. Clients that want to receive the multicast content send a IGMP report in response to the IGMP query to the multicast router and are added to the multicast group. Any client that is a member of the multicast group receives the multicast content. The IP multicasting method can reduce the unnecessary network load caused by the unicasting method which sends out multiple copies of the same message to multiple recipients. Despite the increased bandwidth capacity however most networks especially Internet Service Provider ISP networks are not IP multicast enabled. Enabling IP multicasting in a network requires equipment upgrades. Also broadcasting of heavily requested content may be bandwidth prohibitive for many networks. Unfortunately the necessary equipment upgrades are often not undertaken by many networks. Many networks do not make the necessary equipment upgrades because the equipment upgrades are not cost efficient.

What is needed is a mechanism for delivering IP multicast content to users via a non multicast enabled network.

An advantage of the present invention is that it overcomes the disadvantages and shortcomings of the prior art. Another advantage of the present invention is that it provides a method and a system for simulating multicasting over non multicast enabled networks. Another advantage of the present invention is that it provides a system that is able to distribute multicast unicast packets to multiple end users through non multicast enabled networks with multicast efficiency. Another advantage of the present invention is that it does not require changes on the pre existing infrastructure of the networks. The potential beneficiaries of the present invention include applications involving fan out distribution of packets content distribution to multiple isolated non multicast enabled in between networks and last stop distribution of packets see and .

These and other advantages of the present invention are achieved by a method of virtual multicasting multicast content on non multicast enabled networks comprising the steps of determining if an attached network is multicast enabled if the attached network is not totally multicast enabled querying for virtual multicast requests for the multicast content from non multicast enabled client computers listening for virtual multicast requests and determining based on the virtual multicast requests which client computers request the multicast content from the unicast addresses and the requested methods of delivery for the multicast content. The network includes client computers that have unicast addresses and the at least one virtual multicast request includes a unicast address identifying a client computer of the network and a requested method of delivery for the multicast content.

These and other advantages of the present invention are also achieved by a computer readable medium comprising instructions for virtual multicasting VMC multicast content on non multicast enabled networks by determining if an attached network is multicast enabled if the attached network is not totally multicast enabled querying for virtual multicast requests for the multicast content from non multicast enabled client computers listening for virtual multicast requests and determining based on the virtual multicast requests which client computers request the multicast content from the unicast addresses and the requested methods of delivery for the multicast content. The network includes client computers that have unicast addresses and the at least one virtual multicast request includes a unicast address identifying a client computer of the network and a requested method of delivery for the multicast content.

These and other advantages of the present invention are also achieved by a system for virtual multicasting VMC multicast content on non multicast enabled networks comprising a virtual router and an attached network associated with the virtual router that includes a plurality of client computers that have unicast addresses. The virtual router includes software comprising instructions for determining if the attached network is multicast enabled if the attached network is not totally multicast enabled querying for virtual multicast requests for the multicast content from non multicast enabled client computers listening for virtual multicast requests and determining based on the virtual multicast requests which client computers request the multicast content from the unicast addresses and the requested methods of delivery for the multicast content. The at least one virtual multicast request includes a unicast address identifying a client computer of the network and a requested method of delivery for the multicast content.

Virtual Routers VRs which preferably are standard computers with networking capabilities. Except for client components the VMC software resides on the VRs.

Clients which preferably are standard computers for end users that comprise client software including certain VMC software components and receive content delivered by the VMC system over the virtual network . Clients are the end recipients of content distribution. Clients preferably also include a network interface card adapter and necessary networking software such as TCP IP.

Content servers which preferably are standard computers with networking data storage and web hosting capabilities. Content preferably originates from the content servers . Content servers may also serve as a web site accessible via the Internet hosting information about content availability.

A Virtual Multicast Distribution protocol VMCDP that dictates how VRs convert packets from multicast packets to unicast packets and vise versa replicate packets for unicast clients or downstream VRs VRs located at virtual sub networks downstream e.g. VR is downstream from VR and deliver packets. The software conversion of packets from multicast to unicast may be accomplished by modifying destination IP of the packet at the IP layer. A standard multicast group is defined by an multicast IP address and a port. A unique value in the VMC system is how a channel is defined. A VMC channel map see VMC file below is created at the central location VR e.g. VR and fetched by all the downstream VRs . In the VMC system a channel or a multicast group in standard multicast is defined by a port. When a VR receives a unicast stream designated to the VR at a port on the map the VR automatically knows what multicast group the unicast stream belongs to based on the VMC channel map. This is impossible for standard Transmission Control Protocol Internet Protocol TCP IP without adding more information like the multicast IP address to the packet. Another unique feature is that VMC system does not alter the original packet. The VMC system does not add information to the original packet. The VMC system always keeps the original sender s IP address for possible backlink service. The VMC protocols describe below are only used on VRs for registration and distribution mechanisms.

A Virtual Multicast Registration protocol VMCRP . The VMCRP is used by VRs for dynamic registration of client requests for VMC content periodic probing and the addition removal of clients or downstream VRs from VMC client table files see below . VMCRP is a protocol used among VRs to forward requests of VMC content on certain channels. Upon receiving a request from a client or another VR forwarding requests a VR will send a short message to all the VRs at its parent level on the Virtual Network Tree see VNT file below asking for the parent VR s loads and distance judging by round trip time RTT of an ICMP packet . After making an optimal selection of a parent VR based these two factors the VR will add the parent VR entry to its client table for unicast request see VCT file below or the multicast flag will be turned on for a multicast request and forward the request to the selected parent VR . VRs will periodically send a probing in dynamic registration message to all it clients . A client which fails to answer the probing will be removed from the client table. So no unnecessary streams for clients that fail to answer will be send to that network. At the same time clients and VRs may periodically send probing to their registered parent VRs . If a parent VR fails to answer the probing the client VR will re register all the content requests associated with the parent VR with other parent VRs .

A Virtual IGMP protocol VIGMP for clients to register requests for content with Virtual Routers . VIGMP reports generally indicate that the client is requesting unicast delivery the client is not multicast enabled . Clients in a multicast enabled portion of a network may transmit VIGMP reports requesting multicast delivery the client is multicast enabled . The VIGMP preferably is an application programming interface API for easy integration with client software.

A Virtual Network Tree VNT File. The VNT file preferably contains a list of the VRs on the entire virtual network . These VRs are grouped by levels starting from root level VRs at a central location i.e. network A in . The VNT file describes the hierarchy of the virtual routers . For the example in VR is at root level or level . VR and VR are at level i.e. level VRs . VR VR and VR are at level i.e. level VRs . The levels may represent regions states and cities for example. The maximum number of VRs at a certain level may be determined by the capacities of the VRs at a higher level i.e. closer to the root level .

The VNT file preferably also includes information about each VR on the list. This information preferably includes an IP address of the VR that is accessible by other VRs and the full host name of the VR . The VNT file is preferably created at the central location and is preferably fetched by VRs on the same virtual network during the VR s startup in order for the VRs to determine their level e.g. level and to find the closest upstream VR .

A VMC Channel Map VCM File. The VCM file preferably includes a list of pairs of multicast IP addresses and port numbers supported by the specific VMC system. Each pair of addresses and port numbers defines a multicast channel for content distribution. The VCM file may be created at the central location and be fetched by VRs on the same virtual network during the VR s startup in order for the VRs to determine what multicast channels are available.

A VMC Client Table VCT File. Preferably each VR keeps a client table the VCT file for each available multicast channel group . The VCT file contains a multicast flag and a list of unicast clients for each supported multicast channel. The VCT file is created locally by the registration protocols VIGMP and VMCRP. The multicast flag for each supported multicast channel is turned on upon the VR receiving of a VIGMP report for a multicast group indicating that a client wants to receive the multicast content . The list of unicast clients requesting content from each supported multicast channel is updated as follows upon the VR receiving a VIGMP VMCRP unicast request from a client or downstream VR the senders the client s or and downstream VR s IP address is added to the list of unicast clients in the VCT file if the client or VR is not already on the list.

The above VMC protocols VMCDP VMCRP and VIGMP are built on top of standard TCP IP protocols such as UDP user datagram protocol IP Internet Protocol ICMP Internet Control Message Protocol and IGMP. Indeed the messaging proscribed by the VMC protocols is identical to the underlying standard TCP IP protocols. For example the VIGMP reports are identical to IGMP reports.

Each VR can receive distribute multicast as well as unicast packets. The VRs can also convert multicast packets to unicast packets and vise versa. Whether a VR concerts multicast packets to unicast packet or vice versa is determined by the VR virtual multicast client table VCT files created by the registration protocol VMCRP requests. For example if a client sends a VIIGMP unicast request to the VR the client s IP address is added to the list of unicast clients in the VCT file and multicast packets for the requested multicast content group are converted to unicast packets for that client .

Referring to the exemplary application of the VMC system shown in the virtual network includes six sub networks networks A F. Networks A D are separate and connected only via the Internet which is not or at least not fully multicast enabled. Network A is the central location where all the content packets content for multicast distributing originate in the virtual network . As shown network A receives the content from the content server which may be co located with or remotely located from network A.

In the example illustrated in virtual multicasting is achieved by running a virtual router on each network A F in a similar way normal networks are configured with different routers that requires virtual multicasting. The VNT file which includes a virtual multicasting tree that describes the virtual network and the sub networks A F is built at the network A the central location the root of the tree . During the startup of each VR each VR communicates with VR the VR at the central location and fetches the VNT file and the VCM file. Each VR uses the VNT file to determine their tree level and the closest upstream VR .

The VMC client registration process is driven by client requests for multicast content. Once a VR detects the absence of a multicast enabled router the absence of IGMP queries the VR periodically issues VIGMP queries using a control channel to the attached network A F. The VIGMP queries are identical to IGMP queries for multicast clients. A user on a client may review available multicast content on the content server using a web browser or other means. A multicast enabled client for example Client on Network D may request to join a multicast group for multicast content by sending out IGMP reports to the VR . A unicast client wanting to receive the multicast content may use VIGMP reports to request unicast delivery Unicast UDP of the multicast packets. On a multicast enabled network where a regular router is issuing IGMP queries the VR preferably only listens to and processes the VIGMP reports.

A VR for example VR that receives the VIGMP report adds the requesting unicast client to the VCT file of the VR i.e. the VMC client table for the requested multicast content group and forwards registers the requested multicast group with one of the upstream VRs using the registration protocol VMCRP. The upstream VR with which the requested multicast group is registered is preferably selected based on an optimal balance of the loading on each upstream VR and the Round Trip Time RTT necessary for the registration to reach each upstream VR . The selected VR parent VR forwards the registration to a further upstream VR in a similar manner. This registration process preferably continues until the registration reaches the root VR at the center location network A .

The multicast content server which may be on the same network as the center location or remotely located from the center location does not necessarily need to be multicasting since the root virtual router can receive both multicast and unicast packets and convert them if necessary. With the distribution protocol VMCDP once a VR receives a multicast or unicast packet the VR checks against its VCT file the VMC client table conducts the necessary packet conversion and or replication and delivers a multicast packet to the attached network or and multiple unicast packets to clients on the attached network or and downstream VRs .

A VR preferably can send out a multicast packet and or multiple unicast packets to clients on the same network and or to downstream VRs . For example referring to the virtual network in VR may send a multicast packet to Network B if requested by a multicast client e.g. MC Client on Network B . In addition VR replicates the packet and unicast the replicated packets to the unicast client UC Client on the attached network Network B and to downstream virtual routers VR and VR.

The registration protocols VMCRP and VIGMP may be implemented dynamically. With the dynamic VMCRP and VIGMP clients and VRs periodically re register requests check VCT files the VMC client tables and probe registered parent VRs . The probe may be to check if the registered parent VR is still up. The registered parent VR could be accidentally down or shut down for maintenance. The VR or client have the ability to switch to other parent VRs for those channels already associated with the down parent VR . A client in the VMC client table of a VR is preferably removed from the VMC client table if the client has not re registered within a certain period of time. If the probe to a registered parent VR fails the current VR re registers with other upstream VR s all the multicast content requests associated with the failed parent VR .

User machine illustrates typical components of a user machine. User machine typically includes a memory a secondary storage device a processor an input device a display device and an output device . Memory may include random access memory RAM or similar types of memory and it may store one or more applications including client software and VIGMP API and a web browser for execution by processor . Secondary storage device may include a hard disk drive floppy disk drive CD ROM drive or other types of non volatile data storage. Processor may execute applications or programs stored in memory or secondary storage or received from the Internet or other network . The processor may execute one or more applications including client software and VIGMP API in order to provide the functions described in this specification. Input device may include any device for entering information into user machine such as a keyboard mouse cursor control device touch screen infrared microphone digital camera video recorder or camcorder. Display device may include any type of device for presenting visual information such as for example a computer monitor or flat screen display. Output device may include any type of device for presenting a hard copy of information such as a printer and other types of output devices include speakers or any device for providing information in audio form.

Web browser is used to access the VMC system and to choose which broadband content the user wishes to view. The web browser also is used to access the Internet content servers e.g. a NOC and ISPs. Examples of web browsers include the Netscape Navigator program and the Microsoft Internet Explorer program. Any web browser co browser or other application capable of retrieving content from a network any wireline or wireless network may be used and displaying pages or screens may be used. Content broadcast multicast or unicast and received by the client may be displayed through the web browser . The content may include links for example HyperText Transport Protocol HTTP hyperlinks to other content and or Internet websites. Multimedia applications such as Microsoft Media Player and RealPlayer may be used to enable viewing of real time multicast or unicast streams.

Examples of user machines for interacting within the system include personal computers laptop computers notebook computers palm top computers network computers Internet appliances set top terminals or any processor controlled device capable of executing a web browser or other type of application for interacting with the VMC system.

Content server may store one or more database structures in secondary storage for example for storing and maintaining information regarding the clients . For example it may maintain a relational object oriented or other client database for storing information concerning system users the access rights of the users and their account status. The database structures may also include content databases. For example the content server may maintain a relational object oriented or other content database for storing content and or information concerning the content.

Processing by the processors may provide and support pages windows and menus described in this specification and otherwise for display on display devices associated with the client . The pages windows and menus may be formatted for example as web pages in HyperText Markup Language HTML Extensible Markup Language XML or in any other suitable form for presentation on a display device depending upon applications used by users of the clients .

Although only one content server is shown multiple servers may be used as necessary or desired to support and provide the content and may also use back up or redundant servers to prevent network downtime in the event of a failure of a particular server.

The network input device and the network output device may comprise network adaptors and or network information cards NIC . The network input device and the network output device are able input output IP packets from to the connected network e.g. network A F . The operating system on the VR and the drivers on the network input device and the network output device support the standard TCP IP protocols and can issue IP level protocols such as ICMP and IGMP. It is preferable for the operating system to support web hosting protocols such as HTML so the VR may be configured and operated from remote sites.

In addition although VR client and content server are depicted with various components one skilled in the art will appreciate that VR client and content server can contain additional or different components. In addition although aspects of an implementation consistent with the present invention are described as being stored in memory one skilled in the art will appreciate that these aspects can also be stored on or read from other types of computer program products or computer readable media such as secondary storage devices including hard disks floppy disks or CD ROM a carrier wave from the Internet or other network or other forms of RAM or ROM. The computer readable media may include instructions for controlling a computer system such as VR client and content server to perform a particular method.

A VR is preferably associated with a network e.g. network B and preferably determines whether the attached network is multicast enabled step by listening for IGMP queries e.g. on the network control channel . If no IGMP queries are received within a certain period of time the VR determines that the attached network is not multicast enabled. If the network is not totally multicast enabled e.g. a UNICAST UDP network the VR preferably queries for virtual multicast content requests step by issuing VIGMP queries and listens for virtual multicast content requests from clients and downstream VRs step by listening for VIGMP reports and listening for VMRCP reports . The VR e.g. VR in preferably determines step which clients and or downstream VRs e.g. VR request the multicast content and the requested delivery method for the multicast content e.g. multicast or unicast for each request by reading VIGMP and IGMP reports from clients and reading VMCRP reports from downstream VRs . The VIGMP reports indicate whether the requesting clients are to get unicast or multicast delivery clients that will join the multicast group . The IGMP reports indicate that the requesting clients are to get multicast delivery.

The virtual router preferably builds a table of requesting clients and virtual routers step by building a VCT file that comprises unicast addresses of the clients and or downstream VRs that requested the content and an associated multicast address es that identifies the requested content. As described above if the VR is a downstream VR e.g. VR in the VR preferably selects an optimal upstream virtual router by determining the upstream VR e.g. VR in loads and round trip times RTTs and balancing these two factors to select an optimal upstream VR . This step is only performed when there is a plurality of upstream VRs to choose from. The VR may perform step at startup.

The VR preferably forwards the multicast request to the selected upstream VR step by turning on the multicast flag in the VCT file and transmitting the VCT file to the upstream VR . As noted above the multicast request e.g. the VCT file is forwarded upstream until it reaches the root level or central location VR e.g. VR .

If the central location VR the selected VR and any intervening VRs have received the multicast request the multicast content is transmitted to the current VR preferably as unicast packets . The current VR preferably receives the content step as a stream of packets. The VR replicates the packets for each requesting network client and downstream VR addresses the replicated packets with the unicast addresses of the requesting network clients and downstream VRs step as determined by reading the VCT file for unicast clients VRs and their addresses . If the VR receives the content as multicast packets the VR converts the multicast packets to unicast packets. For clients requesting multicast delivery the VR simply transmits the packets as multicast packets in the normal manner. The VR transmits the unicast packets to each requesting unicast client and downstream VR step . If the virtual router determines that the network is multicast enabled the content is multicast to the requesting network multicast users in a normal way see above .

As noted above if the network is multicast enabled the VR will only listen to VIGMP reports. As noted before for multicast clients VIGMP reports may be identical to IGMP reports. If the network is not multicast enabled the VR will periodically send out VIGMP queries after it detects the absence of IGMP query message. Clients can use VIGMP to request for multicast delivery or unicast delivery of the content.

As noted above a VR may replicate multicast content to other VRs as well as clients . Virtual routers may be logically stacked or hierarchically located on top of one another. illustrates the hierarchical structure of VRs of the example in . A VR therefore may maintain a VMC client table a VCT file that comprises unicast addresses for clients and other VRs . A VR may register with any VRs above it closer to the root by using VMCRP or similar routing protocols. As noted the decision of which parent VR to register with is made based on an optimal balance of the load of parent VRs and the round trip time RTT to reach them. Accordingly a central VR may be co located with a multicast content server in order to convert multicast streams to virtual multicast streams with unicast addressing that are broadcast to other VRs at multiple networks. Likewise one VR may act as a backup for another VR below it in the hierarchical structure.

In addition to the multicast content the NOC may also provide information about content availability to its users through other channels such as on a web site accessible via the Internet or other network . Clients can access the web site to check which multicast content is available. If the network is multicast enabled a client can request certain multicast content by registering with the ATM DSLAM switch . The ATM DSLAM switch builds a table comprising the client s address and the multicast address of the content and sends an IGMP packet to the router. In response to the IGMP packet the router transmits the multicast stream for the requested content to the ATM DSLAM switch The ATM DSLAM switch replicates the multicast stream packets of the requested content and transmits them to the client and any other requesting clients based on its table.

If the network is not multicast enabled e.g. the ATM DSLAM switch does not have multicasting capability a client can transmit a VIGMP packet through the ATM DSLAM switch to the VR requesting for unicast delivery. Preferably the VIGMP packet registers the client with the VR and tells the VR that the network or sub network on which the client is located is not multicast enabled and that the client wants to receive multicast content. The client may contact the NOC via the Internet or other network to determine where the closest VR is located before sending the VIGMP. The VR may build a virtual VMC table or dynamic routing table the VCT file with information about the client e.g. the client s unicast address so that it can replicate and transmit content packets to the client when the client requests content. As the VR receives multicast content the VR may convert the requested multicast content by replicating the content packets and transmitting to the client at the client s unicast address. Note that the VR may receive the multicast content as a unicast stream for example if there is another VR upstream e.g. co located with the NOC from the VR located at a central office . The packets of the unicast stream may include the multicast address of the content so that the VR can identify and properly route the content.

It is further noted that content that has been virtual multicast as unicast may be converted back to or re broadcast as multicast. For example in the system shown in if any of the central office servers supported multicast enabled networks the unicast stream received by the VR at such central office servers may be sent through to the ATM DSLAM switch and multicast to the clients since the packets comprise the actual multicast address of the content. Likewise if the network receiving the virtual multicast stream is a LAN the stream may be re broadcast as a actual multicast stream since multicasting is supported within the LAN.

As noted above the virtual network in is an application of the VMC system that may be used for fan out distribution of packets. are schematic diagrams of additional exemplary applications of the VMC system according to the present invention. The exemplary virtual networks and shown in comprise VRs clients content servers center networks corresponding to central location or root level network A in and remote networks corresponding to networks B F at levels and below in . The virtual network in is a bridging islands network. The virtual network in is a last stop conversion network. The virtual networks and perform virtual multicasting as described above with the center networks fulfilling the role of the central location or center office server.

It is also noted that certain portions of networks may be multicast enabled while other portions are not. Consequently a virtual router may conduct virtual multicasting simultaneously with a co located router conducting true multicasting.

The terms and descriptions used herein are set forth by way of illustration only and are not meant as limitations. Those skilled in the art will recognize that numerous variations are possible within the spirit and scope of the invention.

