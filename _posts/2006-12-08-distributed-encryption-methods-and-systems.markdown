---

title: Distributed encryption methods and systems
abstract: A method and system for providing communication over arbitrary distances with a desired probability of security is disclosed. In accordance with one embodiment of the invention shares of a random key are encoded, the random key for effecting communication of a message through a network employing a cryptographically strong forward security system having a limited effective communications distance. A distributed re-randomization of the encoded shares is then effected at a plurality of intermediate network nodes.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08050410&OS=08050410&RS=08050410
owner: UTI Limited Partnership
number: 08050410
owner_city: Calgary
owner_country: CA
publication_date: 20061208
---
This invention was made with government support under a National Defense Science and Engineering Graduate Fellowship awarded by the Department of Defense. The government has certain rights in the invention.

Embodiments of the invention relate generally to the field of secure communication systems and more specifically to methods and systems for encrypting communicated content.

Cryptographic systems or cryptosystems are composed of several cryptographic primitives such as algorithms for encryption and decryption ciphers one way hash functions random number generators authentication algorithms digital signatures and key distribution systems. In general a cryptosystem is only as secure as its weakest component.

Many conventional encryption schemes that provide secure transmission of data messages employ an asymmetric encryption such as public key encryption PKE .

PKE schemes such as the Rivest Shamir and Adelman RSA algorithm use two keys a public key known to everyone and a private or secret key known only to the recipient of the message. When the originator of a message source wants to send a secure message to a recipient destination the source uses the public key of the destination to encrypt the message. The message is then decrypted using the private key of the destination. For public key digital signatures the sender signs using his or her private key and the recipient verifies using the sender s public key.

All PKE schemes are based on the fact that key deduction would require a prohibitive amount of time and processing resources. RSA for example is based on the lack of efficient schemes for factoring large numbers. Such schemes were once thought to be highly secure but are now known to be susceptible under certain conditions. For example RSA and other PKE schemes are vulnerable to particular cryptanalysis techniques employing quantum computers such as Shor s Algorithm. The only way to increase the security of an algorithm like RSA would be to increase the key size to ensure that keylength exceeds the storage capacity of any foreseeable quantum computer. Such a scheme is impractical and unreliable given the efficient scaling of Shor s Algorithm and other quantum computer based cryptanalysis techniques.

The potential vulnerability of current encryption schemes has increased the interest in the development of systems that provide security against conventional cryptanalysis as well contemplated future cryptanalysis techniques. Systems that provide such cryptographically strong forward security CSFS will include some common attributes. CSFS systems will not use algorithms that are vulnerable to conventional or quantum cryptanalysis. For example CSFS systems will not employ PKE due to its vulnerability e.g. Shor s Algorithm . For CSFS systems implementing symmetric encryption very high key rates approaching those of one time pad OTP will be used. CSFS systems will provide a secure manner for key distribution and employ authentication when necessary to prevent man in the middle MITM attacks.

For many applications providing sufficiently high key rates in a secure manner will require some secure means of ongoing key distribution since it would be impractical to distribute and store the large numbers of keys upfront. Additionally preventing conventional cryptanalysis and MITM attacks requires a secure replacement for public key cryptography s role in authentication.

If two parties share a small secret key for authentication they can use quantum key distribution QKD as a means of performing ongoing key distribution in a secure manner other techniques may also be possible . QKD uses fundamental physical properties of quantum systems to provide secure communications. In contrast to PKE schemes that employ mathematical techniques and rely on the computational difficulty of certain mathematical problems e.g. integer factorization QKD is based on principles of quantum mechanics i.e. measurement of a generic quantum state inherently disturbs the state .

Conventional QKD technology is not widely implemented due to two significant disadvantages which we term the relay problem and the stranger identification authentication problem.

Presently QKD suffers limitations on the length of a single QKD link. Multiple links can be concatenated to extend the distance but if this is done in a naive way it exposes the system to compromise if any of the intermediate nodes are corrupt. This is referred to as the relay problem . As mentioned above QKD is a secure key distribution scheme that in one implementation involves transmitting quantum bits while using quantum mechanics to detect eavesdropping compromised security . QKD provides security between parties who share a small secret key which is used for authentication. Practically however the quantum bits are transmitted using conventional optical transmission means e.g. fiber optic cable . Such optic transmission means are subject to losses which limit the transmission distance. That is due to the attenuation of light through the transmission media signals have a practical limitation of approximately 100 km. The use of conventional amplifiers or repeaters would distort or destroy the quantum information. The development of efficient quantum repeaters may extend this distance but such developments are years away and will require quantum memory and other technically complex features. Moreover quantum repeaters may not extend the transmission distances enough to develop a practical QKD system.

The relay problem has been addressed theoretically with multi party protocols. Such schemes have their own disadvantages in that any disconnection in the transmission path will result in lost or corrupted information. Moreover such schemes require 100 trust of the parties which is typically not a practical assumption.

A second significant disadvantage of conventional encryption systems such as those employing QKD technology is the stranger authentication problem.

In large networks in which public key cryptosystems cannot be relied upon a special means for authenticating mutual strangers that do not share secret keys is necessary. While this problem could be addressed with a small number of central authentication servers this requires all users to completely trust the authentication servers and imposes enormous communications bandwidth and storage requirements on the servers. This is referred to this as the stranger authentication problem .

As larger networks implementing CSFS systems are created it will become increasingly common for parties that do not share a secret key to wish to communicate. Without a shared secret key such parties cannot authenticate the channel used and are thus vulnerable to man in the middle attacks in which an attacker is able to read insert and modify at will messages between two communicating parties without either party knowing that the link between them has been compromised.

With these disadvantages conventional encryption systems including those employing QKD provide only a partial solution to the difficulties posed by the advent of cryptanalysis techniques employing quantum computers.

In accordance with one embodiment of the invention shares of a random key are encoded and the random key is relayed in a distributed fashion through a network employing a CSFS system having a limited effective communications distance. A distributed re randomization of the encoded shares is then effected at a plurality of intermediate network nodes. The key is then used for the secure transmission of information.

Other features and advantages of embodiments of the present invention will be apparent from the accompanying drawings and from the detailed description that follows below.

A method and system for providing random key distribution in CSFS systems having distance limitations is disclosed. One embodiment of the invention extends the distance limit of a CSFS system to an arbitrary distance employing a network of partially trusted parties.

One embodiment of the invention provides a method for establishing a shared secret key between an originator and a recipient of a digital communication. An embodiment of one such method employs secret sharing techniques together with a network of partially trusted parties to provide an arbitrarily high degree of confidence in the secrecy of the protocol.

For one such embodiment a plurality of routes from a source node of a network to a destination node of a network are determined. A portion of the determined routes is then selected and shares of a random secret are generated with each share corresponding to one of the routes of the portion of the plurality of routes.

In accordance with one embodiment of the invention shares of a random key are encoded and the random key is relayed via multiple routes through a network employing a CSFS system. At the destination shares are recombined to reconstruct the key and the recipient verifies the integrity of the key with the sender. If the key is intact it is used for authentication or encryption in future communication between the sender and recipient.

In the following description numerous specific details are set forth. However it is understood that embodiments of the invention may be practiced without these specific details. In other instances well known structures and techniques have not been shown in detail in order not to obscure the understanding of this description.

Reference throughout the specification to one embodiment or an embodiment means that a particular feature structure or characteristic described in connection with the embodiment is included in at least one embodiment of the present invention. Thus the appearance of the phrases in one embodiment or in an embodiment in various places throughout the specification are not necessarily all referring to the same embodiment. Furthermore the particular features structures or characteristics may be combined in any suitable manner in one or more embodiments.

Moreover inventive aspects lie in less than all features of a single disclosed embodiment. Thus the claims following the Detailed Description are hereby expressly incorporated into this Detailed Description with each claim standing on its own as a separate embodiment of this invention.

Embodiments of the invention are applicable in a variety of settings in which digital content is communicated through a secure communications network employing QKD or other cryptographic technology having similar properties. One such property is that the system has a limited effective communications distance that is communications cannot be effectively communicated directly between at least two nodes of the network due to the distance between the nodes.

For one embodiment of the invention each of the network nodes comprises a digital content storage and communication device e.g. a digital processing system DPS . The DPSs that comprise the network may include network servers personal computers or other types of digital processing systems. The DPSs are configured to store and communicate a plurality of various types of digital content including e mails audio and video clips and multimedia for example as well as documents such as web pages content stored on web pages including text graphics and audio and video content.

The stored digital content may be communicated between the DPSs through any type of communications network through which a plurality of different devices may communicate such as for example but not limited to the Internet a wide area network WAN not shown a local area network LAN an intranet or the like.

For various practical embodiments of the invention assumptions regarding the characteristics of the network are made. These assumptions may include the following. 1. All network nodes within a node cluster e.g. a given city have secure links to each other and that each node cluster is linked to at least one adjacent node cluster. 2. Network nodes within a node cluster can communicate securely with network nodes in adjacent node clusters. 3. Nodes controlled by honest and dishonest parties are distributed randomly throughout the network. 4. Conventional communications channels are lossless i.e. since it is possible to suppress the loss on such channels using conventional error correction techniques .

Process shown in begins at operation in which the message originator initiates the protocol. For one embodiment the protocol can be initiated when the message originator wishes to transmit a message. In an alternative embodiment the protocol can be run continuously to generate random keys which are stored to be used when desired.

At operation a random key is generated. The random key may be generated by the message originator the message recipient or at intermediate network nodes e.g. in a distributed fashion . For one embodiment of the invention the random key is generated using a CSFS scheme. For one such embodiment the CSFS scheme used to generate the random key is QKD. For another such embodiment the CSFS scheme used to generate the random key is a random number generator.

At operation the random key is encoded into shares. For one embodiment of the invention the random key may be encoded into shares using conventional techniques e.g. Shamir s secret sharing scheme .

At operation the encoded shares are transmitted to network nodes within an intermediate node cluster that is within the limited effective communications distance of the CSFS system.

At operation a distributed re randomization of the received shares is effected at the intermediate node cluster. Operation and operation are repeated until the encoded shares are received at the recipient node at operation .

At operation the received random key is decoded at the recipient node. At this point the recipient and the originator may verify that the received random key matches the generated random key.

The random key may then be used to encrypt messages which may be encrypted using conventional encryption techniques including one time pad data encryption standard DES triple DES TDES 2TDES 3TDES Blowfish Twofish advanced encryption standard AES and other symmetric ciphers.

The following example illustrates how a secure communication network employing a CSFS scheme e.g. QKD can overcome distance limitations on effective communications in accordance with an embodiment of the invention. Consider an example in which the origination network node and the recipient network node are separated by m intermediate cities each containing n participating parties with trustworthiness t. To achieve good security and low intercity bandwidth usage Shamir s secret sharing scheme may be used together with a distributed re randomization of the shares performed by the participating parties in each city. For one embodiment of the invention the re randomization process is described as follows.

Let F be some finite field where F n and let x i in 1 . . . n xin F be a set of x coordinates . Both F and x are public and are known to all parties. Let Pbe the iparty in the jcity.

The message originator generates a polynomial f x s ax . . . axover F. The coefficients aare chosen randomly while s is the random key that the message originator wishes to send to the message recipient. The message originator then computes n shares f x and sends them to the parties Pin the first intermediate city. In all cities except the first and the last the parties in that city perform a distributed randomization protocol to ensure that the shares passed on to the next city are independent of anything less than the entire set of original shares. Within a given city j each party Phas received a message f x from a party in the previous city. Each Pcomputes a polynomial h x of degree n 1 over F where all coefficients are random except the y intercept which is zero. Each party computes h x for all k in 1 . . . n and sends h x to P. Each party then adds all the messages they have received to obtain a new share

Therefore in order for the secret number to be compromised there must be some j in 1 . . . m 1 such that for all i in 1 . . . n at least one of Pand Pis dishonest. If this is the case the protocol has been compromised at stage j. For a given j the probability of compromise is 1 t but the probability for j is not entirely independent of the probabilities for j 1 and j 1. Thus the overall probability p of the channel between originator and recipient being secure can be bounded by p 1 1 t .

Therefore to ensure the probability of a secure channel that is at least to p it is sufficient to choose n log 1 p log 1 . Therefore embodiments of the invention provide a communication system that overcomes the effective communications distance limitation of some CSFS systems with an arbitrarily small compromise probability.

Further because intercity bandwidth consumed is proportional to n the described embodiment provides an cost effective scaling of resource consumption with communication distance. Thus as shown embodiments of the invention provide a system in which the bandwidth requirements grow only logarithmically with distance.

Large scale conventional secure communications networks typically employ authentication methods that are either vulnerable to quantum computers and require a trusted central server. Without secure authentication such systems are susceptible to MITM attacks as discussed above. illustrates a process in which a shared secret key is established between a message originator and a message recipient across a partially trusted network of participants in accordance with one embodiment of the invention.

Process begins at operation in which the initiating party determines a plurality of routes from a source node of a network to a destination node of the network i.e. between a first communicating party and a second communicating party . The network may be for example network described above in reference to . The number of routes determined may be based on a desired level of security or confidence of either or both of the communicating parties. The determination of routes across the network may be accomplished using a variety of conventional route determination techniques as known in the art.

At operation the initiating party selects a sufficiently large portion of the determined routes to provide a desired level of security.

At operation a number of shares of a random secret key are generated. The number of shares generated corresponds to the number of routes of the selected subset of the determined routes.

At operation each of the generated shares is transmitted to the other party via one of the selected subset of routes.

At operation the other communicating party receives the transmitted shares and uses the shares to reconstruct the random secret key.

At this point the communicating parties have established a shared secret key. The parties can then verify that they have the same key and take remedial action if the keys do not match.

The following example illustrates how a shared secret key can be established between communicating parties in accordance with one embodiment of the invention. For example consider two parties A and B who are mutual strangers i.e. they do not have a shared secret key . A and B are part of a communication network and each has several secure authenticated channels to various other parties who in turn have secured authenticated channels to still other parties. The network can be modeled as a random graph G with V being the set of vertices participating parties in the network and Ebeing the set of edges secure authenticated channels . N is the total number of vertices V . Vis the set of vertices representing dishonest or corrupted parties which are subject to compromise e.g. due to bribery blackmail or subterfuge . G is random in the sense that each possible edge e in Vis equally probable to be a member of the set of edges E. A and B can establish a small shared secret key to effect secure communication as follows.

A generates a random of length l s in 0 1 which we hereafter refer to as the random secret s. A then determines the number n of cycle free paths between A and B and encodes the random secret s into n shares. A then transits one of the n shares via each of the n cycle free paths to B. B receives the n shares and combines them to obtain s .

A and B may then verify that s s and thus establish a shared secret key. If s s then s and s are discarded and the protocol is repeated. An example of a method by which communicating parties may verify the establishment of a shared secret key in accordance with one embodiment of the invention is included as Appendix A.

If any of the paths contain dishonest parties the communication is subject to a denial of service DOS attack. To protect the protocol from DOS attacks the initiating party could employ a conventional k n secret sharing scheme with k

The following is a brief analysis of the security of such a scheme. If one or more paths between A and B contain dishonest parties those parties can modify the share they receive before passing it on. Such modifications will be detected by the communicating parties during verification of the established shared secret key. The parties can then take remedial action to determine and eliminate the dishonest party or parties before repeating the protocol. Thus only if all possible paths between the parties are compromised can an attacker determine the shared secret key and effect a successful MITM attack. Therefore the probability of compromised security can be made arbitrarily small by determining how many edges are required to effect a desired security probability. That is determine the size of Esuch that the subgraph G induced by V Vis connected. Let t 1 V be the percentage of honest parties. Suppose we wish to ensure a probability pof connection after the vertices Vhave been removed. Let c log log p 2t then the number of edges necessary is E N 2t log tN cN t where the number of edges E does not exceed the total possible number of edges. The number of shares n required for performing the protocol between two arbitrary parties will grow with the total number of paths between them and thus much faster than the total number of parties. Therefore for one embodiment the initiating party may select only a small subset of the total number of possible paths with the subset selected so as to reduce the probability of a successful attack below a desired threshold.

Therefore through the use of a sufficient number of paths in a network with sufficiently many edges the probability of successful attack can be reduced below a desired threshold.

As discussed above embodiments of the invention may employ DPSs or devices having digital processing capabilities as network nodes. illustrates a functional block diagram of a digital processing system that may be used in accordance with one embodiment of the invention. The components of processing system shown in are exemplary in which one or more components may be omitted or added. For example one or more memory devices may be utilized for processing system . Referring to the processing system shown in may be used as a server processing system. Furthermore the processing system may be used to perform one or more functions of an Internet service provider. The processing system may be interfaced to external systems through a network interface or modem . The network interface or modem may be considered a part of the processing system . The network interface or modem may be an analog modem an ISDN modem a cable modem a token ring interface a satellite transmission interface a wireless interface or other interface s for providing a data communication link between two or more processing systems. The processing system includes a processor which may represent one or more processors and may include one or more conventional types of processors such as those made by Motorola or Intel etc. A memory is coupled to the processor by a bus . The memory may be a dynamic random access memory DRAM an or may include static RAM SRAM . The processor may also be coupled to other types of storage areas memories e.g. cache Flash memory disk etc. that could be considered as part of the memory or separate from the memory .

The bus further couples the processor to a display controller a mass memory e.g. a hard disk or other storage which stores all or part of the application or stored digital content depending on the DPS the network interface or modem and an input output I O controller .

The processing system represents only one example of a system which may have many different configurations and architectures and which may be employed with the present invention. For example various manufacturers provide systems having multiple buses such as a peripheral bus a dedicated cache bus etc. On the other hand a network computer which may be used as a processing system of the present invention may not include for example a hard disk or other mass storage device but may receive routines and or data from a network connection such as the network interface or modem to be processed by the processor . Similarly a portable communication and data processing system which may employ a cellular telephone and or paging capabilities may be considered a processing system that may be used with the present invention. However such a system may not include one or more I O devices such as those described above with reference to I O device .

In the system shown in the mass memory and or the memory may store data that may be processed according to the present invention. For example the mass memory may contain a database storing previously determined configuration information in accordance with one embodiment of the invention. Alternatively data may be received by the processing system for example via the network interface or modem and stored and or presented by the display and or the I O device s . In one embodiment data may be transmitted across a data communication network such as a LAN and or the Internet.

Embodiments of the invention include methods and systems that address the disadvantages of conventional CSFS systems. For one embodiment of the invention the relay problem is addressed by encoding shares of a random key and effecting a distributed re randomization of the encoded shares at a plurality of intermediate network nodes.

For one embodiment of the invention the stranger authentication problem is addressed by determining a plurality of routes from a first communicating party to a second communicating party generating shares of a random secret key the number of shares corresponding to the number of the routes and transmitting each share of the random key via a corresponding route.

Embodiments of the invention have been described as including various operations. Many of the processes are described in their most basic form but operations can be added to or deleted from any of the processes without departing from the scope of the invention.

The operations of the invention may be performed by hardware components or may be embodied in machine executable instructions which may be used to cause a general purpose or special purpose processor or logic circuits programmed with the instructions to perform the operations. Alternatively the steps may be performed by a combination of hardware and software. The invention may be provided as a computer program product that may include a machine readable medium having stored thereon instructions which may be used to program a computer or other electronic devices to perform a process according to the invention. The machine readable medium may include but is not limited to floppy diskettes optical disks CD ROMs and magneto optical disks ROMs RAMs EPROMs EEPROMs magnet or optical cards flash memory or other type of media machine readable medium suitable for storing electronic instructions. Moreover the invention may also be downloaded as a computer program product wherein the program may be transferred from a remote computer to a requesting computer by way of data signals embodied in a carrier wave or other propagation medium via a communication cell e.g. a modem or network connection . All operations may be performed at the same central cite or alternatively one or more operations may be performed elsewhere.

The operations of the invention may be performed by hardware components or may be tangibly embodied in machine executable instructions stored on a machine readable medium which may be used to cause a general purpose or special purpose processor or logic circuits programmed with the instructions to perform the operations. Alternatively the steps may be performed by a combination of hardware and software. The invention may be provided as a computer program product that may include a machine readable medium having stored thereon instructions which may be used to program a computer or other electronic devices to perform a process according to the invention. The machine readable medium may include but is not limited to. Floppy diskettes optical disks CD ROMs and magneto optical disks ROMs RAMs EPROMS EEPROMs magnet or optical cards flash memory or other type of media machine readable medium suitable for storing electronic instructions. Moreover the invention may also be downloaded as a computer program product wherein the program may be transferred from a remote computer to a requesting computer over a network via a communication cell e.g. a modem or network connection and stored on a machine readable medium. All operations may be performed at the same central cite or alternatively one or more operations may be performed elsewhere.

