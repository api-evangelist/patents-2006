---

title: Integrated address book based on departmental hierarchy
abstract: A hierarchical address book for an organization is implemented where employees are represented by user objects and departments are represented by department objects. Computer-readable media include executable instructions for displaying and navigating the hierarchical address book. Computer-readable media also include executable instructions for ordering a list of recipients of an electronic mail message as a function of the seniority rating of an object in the hierarchical address book.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07617243&OS=07617243&RS=07617243
owner: Microsoft Corporation
number: 07617243
owner_city: Redmond
owner_country: US
publication_date: 20060524
---
As organizations rely more and more on electronic messages such as email to facilitate communication between employees and other business associates an address book containing all the email addresses of employees and business associates of an organization has become a critical tool. Users consult the address book to determine the location telephone number email address and other important information about the employees or business associates. A commonly utilized approach to the address book design is to display a flat list of contacts representing employees and business associates in an organization in alphabetical order by last name. Users search the alphabetical list to locate desired contact information.

However this can be problematic if the user knows he or she needs to contact someone within a certain department but is unsure of the name of the person. Additionally in countries like Japan employees are more oriented towards working with departments and titles and thus prefer information on a departmental rather than individual basis. Furthermore in countries like Japan it is considered rude to have a more senior person identified after a less senior person in the recipient line of an electronic message.

Embodiments of the invention provide an address book view of a departmental hierarchy integrated with electronic messaging. In one aspect of the invention a hierarchical address book for an organization represents employees by user objects and represents departments by department objects. Computer executable instructions display and enable navigation of the hierarchical address book. Advantageously aspects of the invention improve the address book user experience and provide resource and cost savings in administering and maintaining the integrated departmental hierarchy.

Further aspects of the invention order a list of recipients corresponding to objects in the hierarchical address book according to a seniority rating of the object in the hierarchical address book. Aspects of the invention may also synchronize via replication employee and department information maintained by other systems with the objects in the hierarchical address book.

This summary is provided to introduce a selection of concepts in a simplified form that are further described below in the Detailed Description. This Summary is not intended to identify key features or essential features of the claimed subject matter nor is it intended to be used as an aid in determining the scope of the claimed subject matter.

Referring to the drawings illustrates a computing system for implementing a hierarchical address book according to aspects of the invention. In one embodiment of the invention a computer such as the computer is suitable for use in the other figures illustrated and described herein. Computer has one or more processors or processing units and a system memory.

In one embodiment the hierarchical address book HAB displays contact information for a plurality of employees business associates or other persons associated with a business organization. For example the HAB maintains a hierarchy of departments for the business organization. The HAB allows a user to navigate the HAB through the hierarchy of departments to locate the employee. As shown a computing device interacts with a directory service database for implementing the HAB which is presented to a user via a graphical user interface GUI . A directory service is for example a service on a network that returns email addresses and other information to users and enables a user to locate hosts and services.

The database stores a hierarchy of user objects associated with a hierarchy of department objects . It is to be understood that the GUI may be integrated with other system applications executed by the computing device . For example GUI may be integrated with an electronic messaging client or a resource sharing application. In another embodiment department objects may serve as security principals for assigning access rights to employees. In this embodiment for example an employee can share content such as his her calendar with employees associated with a department by selecting the department object from the HAB.

The computer typically has at least some form of computer readable media. Computer readable media which include both volatile and nonvolatile media removable and non removable media may be any available medium that may be accessed by computer . By way of example and not limitation computer readable media comprise computer storage media and communication media. Computer storage media include volatile and nonvolatile removable and non removable media implemented in any method or technology for storage of information such as computer readable instructions data structures program modules or other data. Communication media typically embody computer readable instructions data structures program modules or other data in a modulated data signal such as a carrier wave or other transport mechanism and include any information delivery media. Those skilled in the art are familiar with the modulated data signal which has one or more of its characteristics set or changed in such a manner as to encode information in the signal. Wired media such as a wired network or direct wired connection and wireless media such as acoustic RF infrared and other wireless media are examples of communication media. Combinations of any of the above are also included within the scope of computer readable media.

According to aspects of the invention the department objects represent departments within an organization while the user objects represent employees or business associates of the organization. A user of the HAB finds and selects employees or business associates in the organization using the GUI . A user may enter commands and information into computer through input devices or user interface selection devices such as a keyboard and a pointing device e.g. a mouse trackball pen or touch pad . Other input devices not shown may include a microphone joystick game pad satellite dish scanner or the like. A monitor or other type of display device is also connected to system bus via an interface such as a video interface . In addition to the monitor computers often include other peripheral output devices not shown such as a printer and speakers which may be connected through an output peripheral interface not shown .

The computer may operate in a networked environment using logical connections to one or more remote computers such as a remote computer .

In one embodiment the directory service database stores the department objects and user objects . The user objects store contact information about an employee or business associate and may include properties such as name office location phone number title and email address. The user objects may also include the following properties member of department property representing the departments the employee belongs to and a seniority rating representing the seniority of the employee compared to other employees in the organization. The user object may be a member of zero or more department objects .

In one embodiment the seniority rating represents the relative importance or seniority of an employee. For example the higher the value of the seniority rating the higher the seniority of the employee. The seniority rating may be calculated as a function of one or more of the following parameters a number of years of service of the employee an age of the employee an experience level of the employee an education level of the employee and a merit of the employee. In another embodiment the seniority rating of the department objects and user objects is tracked and maintained in a related application.

In an embodiment for systems that host two or more organizations each user object includes a reference to the root department of the organization. The root department of the organization represents the department that is the highest department in a hierarchy of departments for an organization.

In another embodiment the HAB includes organization objects that store information about a company or organization and typically include fields such as name mailing address and phone number. The organization objects include a reference to the root department of the organization. The root department of an organization may only reference one department object .

Although described in connection with an exemplary computing system environment including computer embodiments of the invention are operational with numerous other general purpose or special purpose computing system environments or configurations. The computing system environment is not intended to suggest any limitation as to the scope of use or functionality of any aspect of the invention. Moreover the computing system environment should not be interpreted as having any dependency or requirement relating to any one or combination of components illustrated in the exemplary operating environment. Examples of well known computing systems environments and or configurations that may be suitable for use with aspects of the invention include but are not limited to personal computers server computers hand held or laptop devices multiprocessor systems microprocessor based systems set top boxes programmable consumer electronics mobile telephones network PCs minicomputers mainframe computers distributed computing environments that include any of the above systems or devices and the like.

In operation computer executes computer executable instructions such as those illustrated in the figures to implement aspects of the invention.

In another embodiment the seniority rating represents the most important or senior department. The higher the value of the seniority rating the higher the seniority of the department. The seniority rating may be calculated as a function of the number of years since the department was created or the age of most senior department member.

In yet another embodiment each department object includes a root department property representing the relative level of departments in the hierarchy for an organization. This is implemented in systems hosting two or more organizations. In this embodiment each organization has access limited to information regarding their departments and users. To find the root department of an organization the HAB performs a check of a PR EMS AB HAB ROOT DEPARTMENT attribute of the Organization Container of the directory service database derived from the user and searches for the department object having that value as LegacyDN.

Referring further to each department object represents a department in the hierarchy . The department object may have only one parent department link . The parent department is one level higher in hierarchy than the department. A child department is one level subordinate to the department in the hierarchy . The child departments of a department are maintained in the child department link . For example in Department G G has two subordinate departments namely Department H H and Department I I and one parent department namely Department D D in the hierarchy . Accordingly Department G s G parent department link F contains the reference to Department D D. And Department G s G child department link G H contains the reference to Department H H and Department I I. The reference may be a list of one or more department object IDs pointers to department objects links to department objects or other implementations that allow one department object to reference another department object in the hierarchy .

In one embodiment department objects are email enabled. In this embodiment an email addressed to the department is delivered in one or more of the following ways to all departments subordinate to the department in the hierarchy to a manager of the department to all employees within the department to all employees of subordinate departments in the hierarchy to only the manager of the department to all employees within all departments subordinate to the department in the hierarchy and to a department mailbox where all members of the department have access to the mailbox. Advantageously aspects of the invention allow a system administrator to configure the way in departmental emails are delivered.

The HAB may be administered by synchronizing department and user information contained in another system of the organization via replication or through a graphical user interface tool where an administrator can create delete rename and move department objects in the hierarchy and manage the membership of user objects for a department object.

Appendix A contains an exemplary schema and Appendix B contains a functional specification for implementing the hierarchical address book in a directory service server database such as database .

Beginning at the electronic messaging client receives a list of intended recipients for an electronic message. Each recipient refers to one of the user objects in the HAB. In one embodiment the references in the recipient list include one or more of the following email addresses and display names. In another embodiment the recipients refer to user objects and department objects . At user objects of the HAB are accessed to determine the seniority rating of the user object referenced in the list of intended recipients.

At the list of intended recipients is ordered as a function of the seniority rating of the user object . In one embodiment the recipients appear in the list in decreasing seniority rating order. In another embodiment where the recipients refer to user objects and department objects the recipients are order as function of their seniority rating. For example suppose the recipient list contains three references Sue user object with a seniority rating of 5 Marketing Department department object with a seniority rating of 7 and Bob user object with a seniority rating of 15. The ordered list of recipients would be Bob Marketing Department and Sue.

In at the electronic messaging client receives the ordered list of recipients and displays the ordered list to the user in the electronic message. By ordering the list of recipients according to the HAB and the seniority rating of department objects and user objects GUI can automatically display references to departments and employees in the recipient list in an order that conforms to the customs of countries where it is considered rude to have a more senior person identified after a less senior person in the recipient line of an electronic message.

A synchronization component synchronizes department and user information maintained another system of the organization via replication or through a graphical user interface tool where administrators can create delete rename and move department objects in the address book component and manage the membership of user objects for a department object .

In one embodiment the organization maintains a reporting line hierarchy for the organization. The synchronization component accesses the reporting line hierarchy and updates the address book component by adding deleting and updating department objects and user objects such that the information in the address book component is consistent with the reporting line hierarchy.

The electronic mail component integrates an email client with the address book component . The electronic mail component features a graphical user interface GUI e.g. GUI that allows a user to navigate through the address book component and select department objects or user objects as recipients for an email.

In one embodiment the GUI includes two views of the address book component namely a list view illustrated in and a tree view illustrated in . Referring first to the list view includes a list view tab and a recipients well . In the list view the GUI displays user objects ordered by name or some other specified criteria. For example the GUI may display the following properties for each user object name title phone number and email address. The user of the GUI may select the user object in the list view by selecting the user object with a mouse keyboard or another selection device. Once selected the user object appears highlighted in the display. Highlighting alters the appearance of displayed characters as a means of calling attention to them. In an embodiment highlighting includes displaying the characters in one or more of the following formats reverse video light on dark bolded italicized underlined uppercase characters and characters in a particular font. For example in User C has been selected and highlighted in the list view .

Once a user object has been selected the user may add the user object s email address to an electronic message by selecting one of the options in the recipients well . illustrates an embodiment with three options in the recipients well to copies the selected user object s email address in the to recipient list A of an email cc copies the selected user object s email address in the carbon copy recipient list B of an email and bcc copies the selected user object s email address in the blind carbon copy recipient list C of an email. In one embodiment each recipient list of the recipient well is ordered according to method described above. In addition list view includes a tree view tab see .

Referring next to the tree view is divided into three sections a tree pane a people pane and recipient s well . The tree pane lists the department objects in hierarchical order the people pane lists user objects and the recipients well is used to send email to selected departments and users. The GUI includes functionality to allow the user to switch back and forth between the tree view and the list view by selecting the list view tab for the list view and the tree view tab for the tree view .

In one embodiment the address book component saves the view that was active when the GUI is closed and opens the GUI to that view the next time the address book component is accessed. For example the user selects the tree view tab to view the address book component in tree view . Then in tree view the user closes the GUI. The next time the user accesses the address book component the GUI opens to the tree view with the tree view tab selected.

In another embodiment the last selected view is stored in a central database used to maintain information for configuring a computer system for users applications and hardware devices. In this embodiment at startup the address book component checks the database to determine the last view selected by the user and displays that view to the user. And when the user closes the GUI the address book component writes the last selected view either tree view or list view to the database so the next time the user accesses the address book component the GUI can display the last selected view.

In the tree pane displays a subset of department objects in the address book component . For each department object in tree pane a status indicator and the department name is displayed. If the length of the department name exceeds the width of tree pane the entire department name is in the tree pane and accessible with a horizontal scrollbar. In one embodiment the display for the department object in the tree pane may be accompanied by a department icon.

When the user selects a department name using a mouse or other input device the corresponding department object opens and appears selected in the GUI department highlighted in the GUI . For example in Department H is currently selected shown by highlighting . If the user selects the Department G name in the tree pane Department G opens revealing subordinate departments if they exist. And Department G appears selected highlighted and Department H appears unselected unhighlighted .

The status indicator indicates if the department object is opened or closed. In one embodiment a A indicates the department object is closed and a B indicates that the department object is opened. The A indicates that the department has one or more subordinate departments and the department is closed. The B indicates that the department has at least one subordinate department and the department is open. If the status indicator is not displayed the department does not have one or more subordinate departments. For example in Department H does not have a subordinate department.

In one embodiment to enhance performance the department object is accompanied by A as a default except for the root department . Once the user selects the department object the GUI determines if subordinate department objects are available by accessing the address book component and checking the child department link of the department object . If subordinate department objects are available the indicator remains a A. If no subordinate department objects are available then no status indicator is displayed. For example in if Department B is selected the GUI determines if Department B has at least one subordinate department object. If Department B has at least one subordinate department object the status indicator remains a A. If Department B has no subordinate department objects the status indicator is removed from the tree pane .

When the user selects the closed indicator A for the department object that department object opens but the selection remains on the department object department highlighted in the GUI . For example in if the user selects the closed indicator B of Department G Department G opens revealing subordinate department objects if they exist and the open indicator A is displayed next to the department name. But Department H remains selected highlighted .

When the user selects the open indicator A that department object closes and any subordinate department objects in the address book component do not appear in the tree pane . For example in if the user selects the open indicator A of Department F Department F displays with the close indicator B and remains in the tree pane . Accordingly subordinate departments Department G Department H Department I and Department J are removed from the tree pane .

The GUI renders the tree view by displaying the hierarchy of department objects . When user accesses address book component as a default the root department is opened and the subordinate department objects are closed. For example when the user would open the address book component illustrated in Department A is opened in the tree pane with subordinate departments Department A Department B Department C Department D Department E and Department F listed in the tree pane . The departments subordinate to Department F departments Department G Department H Department I and Department J would not be listed in the tree pane .

In the tree pane the department objects may be ordered by one or more of the following orders seniority rating descending department name ascending and if the user is in Japan and the phonetic display name is populated by phonetic display name ascending. In the last case it is possible to have department objects where the phonetic display name is empty for some department objects . In this case the department objects with a blank phonetic display name will be ordered according to the department name and placed in order by comparing the department name to the other department objects phonetic display name.

When the user selects one of the department objects in the tree pane the selected department will be highlighted. illustrates a view where Department H has been selected. By default the root department is selected when the address book component is accessed.

In one embodiment the GUI generates a context menu for the selected department. The context menu contains options available to the selected object. In this embodiment the user may select all members of the selected department from context menu. Once the members have been selected the user may send an electronic message to all members or set an appointment with all members of the department.

The people pane displays the user objects of the selected department object by accessing the address book component and checking the department member property of the selected department object. Thus the user of the GUI can navigate the address book component by department to locate employees of that department. This allows the user to locate an employee in a department even if the employee does not know or is unsure of the employee s name.

In one embodiment the people pane lists the user name and title of a user object for users who are members of the selected department in the tree pane . In User A User B User C and User D shown in the people pane are members of selected highlighted Department H in the tree pane . In another embodiment for users in Japan the GUI displays a phonetic display name in the people pane .

The user objects in the people pane may be ordered by one or more of the following orders seniority rating descending user name ascending and if the user is in Japan and the phonetic display name is populated by phonetic display name ascending. In the last case it is possible to have user objects where the phonetic display name is empty for some user objects. In this case the user object with the blank phonetic display name is ordered according to the user name and placed in order by comparing the user name to the other user objects phonetic display name. The user objects in the list view of the GUI may also be ordered in a similar fashion. The people pane is blank if the department selected in the tree pane has no members. In one embodiment the people pane may contain other email enabled objects such as distribution lists or resources that are members of the department in addition to the user objects .

The recipients well is used to address an electronic message to one or more users or departments. Once a user object or department object has been selected the user may add the user object s or department object s email address to an email by selecting one of the options in the recipients well . illustrates an embodiment with three options in the recipients well to copies the selected user object s or department object s email address in the to recipient list A of an email cc copies the selected user object s or department object s email address in the carbon copy recipient list B of an email and bcc copies the selected user object s or department object s email address in the blind carbon copy recipient list C of an email. In one embodiment each recipient list of the recipient well is ordered according to method described above.

In another embodiment a default department may be set to reduce the time to browse through the tree pane from the root department to frequently accessed departments. The user can set the default department from the context menu of the department object . When a default department is set by the user and the tree view of the GUI is to open the department object of the default department opens the address book component between the root department and the default department opens all other departments are closed and the default department is selected.

In one embodiment the default department stored in central database used to maintain information for configuring a computer system for users applications and hardware devices. In this embodiment at startup the GUI checks the database to determine if the user has set a default department. If the user has the GUI opens the default department in the in the tree pane of the tree view as described above. And if the user sets a default department while accessing the GUI the GUI writes the default department to the database so the default department is available the next time the user accesses the GUI. If the default department is no longer valid e.g. the department object has been deleted from the address book component the GUI removes the entry from the database and opens the tree pane with the root department selected.

When user switches from list view to tree view in the GUI the user selected in list view appears selected in the tree view . Therefore all the department objects between the root department and the department of the select user are open.

For example in User C is selected in list view . User C is a member of Department H. When the user switches from the list view to the tree view as shown in User C is selected in the people pane and the department tree will be open to User C s department Department H. If User C is not the member of any department when the user switches to tree view the selection is ignored and the tree view opens in default status with the first user in the root department selected.

The same functionally exists when a user switches from tree view to list view . For example if Department H is open and User C is selected in tree view as shown in when the user switches to list view the list of users opens with User C selected as shown in . If multiple user objects are selected in the list view when the user switches to tree view the tree view opens to the department of the last selected user object with the last user object selected in the people pane .

In another embodiment the GUI supports a bidirectional text format. The GUI displays right to left as illustrated in for the list view and for the tree view.

Referring now to if the organization the user belongs to contains many departments it may be time consuming and inconvenient to browse through the tree pane from the root department. Therefore in an embodiment of the invention the user may create a shortcut to frequently referenced departments. The user can create the shortcut from context menu of the department object. The context menu is disabled when the department object does not have any subordinate departments and for the root department. Shortcut trees for department objects are listed under the address book component tree in the tree pane . The icon for the shortcut department is different than any icon used for departments in the address book component tree. The shortcut to a department has the same functionally as for department objects described above. For example the user may open and close the shortcut as described above with regard to department objects in the tree pane . Shortcuts trees are ordered in one or more of the following orders seniority rating descending and phonetic display name ascending.

In one embodiment the shortcuts are stored in a central database used to maintain information for configuring a computer system for users applications and hardware devices. In this embodiment at startup the GUI checks the database to determine if the user has created any shortcuts. If the user has created at least one shortcut the shortcuts appear below the address book component in the tree pane of the tree view . And if the user creates any new shortcuts while using the GUI the GUI writes the shortcuts to the database so the shortcuts are available the next time the user accesses the address book component .

As illustrated in there can be multiple department roots in the tree pane including the root department of the address book component and the root department of any shortcut trees . When user opens the GUI either the tree view or the list view opens as described above. If the GUI is to open in tree view the selection is at the root department of the last used tree. For example in if Department B was selected at the time the user closed the GUI then Department A will be selected the next time the user opens the GUI.

The order of execution or performance of the operations in embodiments of the invention illustrated and described herein is not essential unless otherwise specified. That is the operations may be performed in any order unless otherwise specified and embodiments of the invention may include additional or fewer operations than those disclosed herein. For example it is contemplated that executing or performing a particular operation before contemporaneously with or after another operation is within the scope of aspects of the invention.

Embodiments of the invention may be implemented with computer executable instructions. The computer executable instructions may be organized into one or more computer executable components or modules. Aspects of the invention may be implemented with any number and organization of such components or modules. For example aspects of the invention are not limited to the specific computer executable instructions or the specific components or modules illustrated in the figures and described herein. Other embodiments of the invention may include different computer executable instructions or components having more or less functionality than illustrated and described herein.

When introducing elements of aspects of the invention or the embodiments thereof the articles a an the and said are intended to mean that there are one or more of the elements. The terms comprising including and having are intended to be inclusive and mean that there may be additional elements other than the listed elements.

As various changes could be made in the above constructions products and methods without departing from the scope of aspects of the invention it is intended that all matter contained in the above description and shown in the accompanying drawings shall be interpreted as illustrative and not in a limiting sense.

