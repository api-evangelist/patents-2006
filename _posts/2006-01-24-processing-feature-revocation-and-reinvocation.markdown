---

title: Processing feature revocation and reinvocation
abstract: A method includes storing, at a storage location of a system, a first security value and utilizing, at the system, a first security certificate compatible with the first security value and incompatible with at least a second security value, wherein the first security certificate enables one or more processing features of the system in conjunction with the first security value. The method also includes receiving a certificate revocation stimulus and modifying a value at a first bit position of the storage location so as to convert the first security value stored at the storage location to the second security value. Another method includes receiving multimedia data at a system, wherein the multimedia data is representative of multimedia content including a digital watermark representing one or more system identifiers, and disabling at least one processing feature if the system identifiers includes a unique identifier associated with the system.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08131995&OS=08131995&RS=08131995
owner: Vixs Systems, Inc.
number: 08131995
owner_city: Toronto, Ontario
owner_country: CA
publication_date: 20060124
---
The present application is related to U.S. patent application Ser. No. 10 830 242 filed Apr. 22 2004 and entitled Method and System for Secure Content Distribution the entirety of which is incorporated by reference herein.

The present disclosure relates generally to data processing and more particularly to revoking processing features in systems.

Concerns about content ownership and copyright protection are driving the development of security procedures for preventing unauthorized copying modification or distribution of multimedia content. One conventional security procedure includes the provision of security privileges to a system that handles multimedia by binding a security certificate to an encryption key or other system code so that the system is required to have access to both the security certificate and its corresponding system code before particular aspects of the system can be enabled. However this conventional certificate binding procedure is susceptible to abuse by a hacker or other unauthorized entity because once provided a valid certificate system code can subsequently be used to gain unauthorized access to multimedia content. Accordingly revocation techniques have been developed to remove the security privileges of a system. However conventional revocation techniques are limited in that they typically do not provide an effective way to re invoke the security privileges of a system in the event that the revocation was in error or deemed to be too harsh under the circumstances or in the event that the system was transferred to an authorized user. Moreover many of these conventional revocation techniques are easily circumvented by hackers thereby reducing their effectiveness when revocation of the security privileges of the system is deemed the proper course of action. Accordingly improved techniques for revoking and or re invoking the processing features of a system would be advantageous.

The following description is intended to convey a thorough understanding of the present disclosure by providing a number of specific embodiments and details involving revoking and re invoking processing features of systems. It is understood however that the present disclosure is not limited to these specific embodiments and details which are exemplary only. It is further understood that one possessing ordinary skill in the art in light of known systems and methods would appreciate the use of the disclosure for its intended purposes and benefits in any number of alternative embodiments depending upon specific design and other needs.

In accordance with one aspect of the present disclosure a method includes storing at a storage location of a system a first security value. The method further includes utilizing at the system a first security certificate compatible with the first security value and incompatible with at least a second security value wherein the first security certificate enables one or more processing features of the system in conjunction with the first security value. The method additionally includes receiving at the system a certificate revocation stimulus and modifying a value at a first bit position of the storage location so as to convert the first security value stored at the storage location to the second security value.

In accordance with another aspect of the present disclosure a method includes receiving multimedia data at a system wherein the multimedia data is representative of multimedia content and wherein the multimedia content includes a digital watermark representing one or more system identifiers. The method further includes disabling at least one processing feature of the system if the one or more system identifiers includes a unique identifier associated with the system.

In accordance with an additional aspect of the present disclosure a system comprises a storage location to store a security value a certificate storage component to store one or more security certificates a multimedia processing module to process multimedia data and a security module operably coupled to the storage location and the multimedia processing module. The security module is to disable one or more processing features of the multimedia processing module in response to determining an incompatibility between a selected security certificate stored at the certificate storage module and the security value stored at the storage location. The security module further is to modify the security value by modifying a value at an identified bit position in response to a certificate revocation stimulus.

In accordance with yet another aspect of the present disclosure a system includes an input to receive multimedia data representative of multimedia content wherein the multimedia content includes digital watermark data representative of one or more system unique identifiers. The system further includes a security module to disable at least one processing feature of the system if the one or more system unique identifiers includes a unique identifier associated with the system.

In accordance with another aspect of the present disclosure a method includes receiving a request to reinvoke one or more processing features of a system the request comprising a first security value and generating a first security certificate based on the first security value wherein the first security certificate enables the one or more processing features of the system in conjunction with the first security value. The method further includes transmitting the first security certificate to the system.

In accordance with another aspect of the present disclosure a method includes determining that an identified multimedia system has performed an unauthorized action based on a first digital watermark incorporated in data output by the identified multimedia system. The method further includes providing multimedia data for use by a plurality of multimedia systems wherein the multimedia data represents multimedia content including a digital watermark representative of a multimedia system identifier uniquely associated with the identified multimedia system.

In accordance with another aspect of the present disclosure a method includes issuing a first security certificate from a certificate authority to a processing device wherein the first security certificate is compatible with a first security value stored at the processing device and wherein the first security certificate in conjunction with the first security value enables one or more processing features of the processing device. The method further includes modifying at the processing device the stored first security value to generate a second security value in response to a certificate revocation stimulus and providing via a communications link a reinvocation request from the processing device to the certificate authority in response to modifying the stored first security value. The method additionally includes issuing a second security certificate from the certificate authority to the processing device wherein the second security certificate is compatible with the second security value stored at the processing device and wherein the second security certificate in conjunction with the second security value enables the one or more processing features of the processing device.

In accordance with another aspect of the present disclosure a system includes a processing device and a certificate authority. The processing device comprises a storage location to store a security value a certificate storage component to store one or more security certificates and a security module operably coupled to the storage location. The security module is to modify the security value in response to a certificate revocation stimulus to generate a modified security value disable one or more processing features of the processing device in response to determining an incompatibility between a selected first security certificate stored at the certificate storage module and the security value stored at the storage location and transmit via a communications link a reinvocation request in response to disabling the one or more processing features. The certificate authority is coupled to the processing device via the communications link. The certificate authority is to generate a second security certificate in response to the reinvocation request wherein the second security certificate is compatible with the modified security value and issue the second security certificate to the processing device for implementation at the processing device.

The term one time programmable storage location and its variants as used herein is defined as a storage component e.g. a register memory cache buffer etc. or portion thereof whereby a value at each bit location can transition only once while the storage component is implemented in a system. To illustrate one time programmable OTP read only memories often are manufactured so as to originally store a value of 0 at each bit location. These OTP read only memories then can be programmed to store data by transitioning the appropriate bit locations to a value of 1 to that the resulting binary sequence represents the stored data. However once a bit location is transitioned to a value of 1 they cannot be transitioned back to a value of 0 by the systems in which they are implemented. Often they can t be reprogrammed back to the original bit values in any circumstance. Other examples of OTP storage locations include non volatile memories and programmable read only memories that although reprogrammable require that they be removed from the system and returned to a manufacturer or third party for reprogramming.

Due to their particular utility for digital multimedia content protection the exemplary revocation re invocation techniques disclosed herein are described in the context of the revocation of security privileges one embodiment of revocable processing features in multimedia systems. Examples of multimedia systems can include complete multimedia systems such as digital video disc DVD players cable set top boxes STB portable video systems televisions desktop computers laptop computers video enabled personal digital assistants PDAs video enabled phones etc. or processing sub components such as video processors video or audio decoders encoders transcoders display controllers and the like implemented as for example a system on a chip SOC . Those of ordinary skill in the art may implement these techniques in other contexts using the guidelines provided herein without departing from the scope of the present disclosure.

Referring to an exemplary multimedia system is illustrated in accordance with at least one embodiment of the present disclosure. As depicted the multimedia system includes a multimedia data interface a security certificate interface an encryption decryption module a certificate storage component a multimedia processing module a security module a watermark module a mass storage interface a display interface a read write control module and a plurality of OTP storage locations such as OTP storage locations . The various components of the system may be implemented as hardware software firmware or combinations thereof. For example in one implementation the system may include a multimedia processor implemented as a single integrated circuit such as a system on a chip SOC where certain functionalities may be implemented as circuitry or alternately as microcode or other executable instructions executed by a central processing unit of the multimedia processor. In another exemplary implementation some or all of the functionality of the system may be implemented as software instructions executed by a general processor.

The multimedia data interface received multimedia data representative of multimedia content from a content source. In one embodiment the multimedia data is data encoded in accordance with a multimedia encoding scheme such as the motion pictures experts group MPEG standard the MPEG 2 standard the MPEG 4 standard the advanced audio encoding AAC standard the Apple QuickTime standard and the like. In instances where the system includes a sub component of a multimedia system e.g. the multimedia processor of a DVD player the multimedia data interface can include for example a memory controller or mass storage controller to receive previously stored or buffered multimedia data from memory or a mass storage system the content source in this instance . In instances where the system is a multimedia system the multimedia data interface can include or example a cable television interface e.g. a coaxial cable interface a data packet network interface e.g. an Ethernet interface a wireless interface and the like.

The certificate interface receives certificate data representative of one or more security certificates from a certificate authority. As described in detail below the security certificate may be provided to a user via an email a file transfer protocol FTP action and the like. Accordingly in such instances the certificate interface and the multimedia data interface may be implemented the same interface.

The certificate storage module stores one or more security certificates for use by the system in enabling various processing features such as encryption decryption multimedia encoding decoding transcoding multiple stream processing display control functions and the like. In at least one embodiment the certificate storage module is accessible only internally to the system so that external access to its contents is prevented. The certificate storage module can include random access memory RAM cache registers a programmable read only memory PROM and the like. Techniques for isolating the certificate storage component from external access can include for example implementing all of the components that need access to the certificate storage component in the same integrated circuit package. In such instances blowable fuses can be used to link the certificate storage component to the pins of the integrated circuit package in the event that system testing is desirable by a manufacturer.

The encryption decryption module implements one or more cryptographic techniques to encrypt and or decrypt data handled by the system . For example security certificates may be received at the system in the form of encrypted data which may be decrypted by the encryption decryption module for storage in the certificate storage component . Likewise the encryption decryption module can be used to encrypt a security certificate before it is stored at an external component such as a mass storage system via the mass storage system interface so as to prevent unauthorized access to the security certificate while stored externally. Similarly the encryption decryption module can decrypt encrypted multimedia data received at the system and encrypt multimedia data before it is output for storage by the system .

Exemplary cryptographic techniques implemented by the encryption decryption module can include Rivest Shamir Adleman RSA based encryption data encryption standard DES based or triple DES 3DES based encryption advanced encryption standard AES based encryption digital video broadcasting DVB based encryption Cryptomeria Cipher C2 based encryption and the like. It will be appreciated that many of the cryptographic techniques implementable by the encryption decryption module make use of various security codes or values such as a public key a private key a code word CW an initial value IV a unique system identifier ID a primary number exponent and the like. Accordingly one or more security values are stored at the system for access by the encryption decryption module . In the illustrated embodiment a CW an IV and a system ID are stored at OTP storage locations and respectively of a storage component . The storage component can include for example an OTPROM and each of the OTP storage locations and is a corresponding memory location of the OTPROM or the storage component can include an OTP register file and each of the OTP storage locations and is a corresponding OTP register of the register file. Although the security values are illustrated as stored in OTP storage locations for ease of discussion some or all of the security values can be stored in non OTP memory locations such as general registers ROM RAM caches and the like. In one embodiment read and write access to the storage component is provided by read write control module .

The multimedia processing module in one embodiment processes multimedia data and provides the processed multimedia data for storage in one or more mass storage systems e.g. hard drives optical disk drives etc. via the mass storage interface or for display or output at a display system or an audio system via the audio video system interface . The multimedia processing module may implement a variety of processing features related to multimedia content such as audio and or video encoding decoding transcoding scaling filtering and the like. In at least one embodiment the multimedia processing module can operate in both a single stream processing mode whereby only a single data stream can be processed at any given time or a dual stream processing mode whereby two or more display streams can be processed concurrently.

For received multimedia data the watermark module can extract digital watermark data embedded in the multimedia data e.g. embedded in video data audio data header data etc. using any of a variety of watermarking techniques. In one embodiment the digital watermark data can include data representative of a list of one or more unique identifiers for the purposes of directing those systems identified by the unique identifiers to initiate a security certificate revocation process as described herein. Additionally the watermark module can add a digital watermark to processed multimedia data before it is output for storage or display. In at least one embodiment the digital watermark added by the watermark module includes a representation of a unique identifier associated with the system such as the system ID stored in the OTP storage location thereby allowing a third party to identify the system as the source of the processed multimedia data for the purposes of identifying systems that are used in an unauthorized manner so that they subsequently can be disabled via security certificate revocation as described herein.

In one embodiment the security module enables or disables certain processing features of the encryption decryption module the multimedia processing module the watermark module as well as other components of the system based on the compatibility between the one or more security certificates and the accessibility of their binding security values. In the event that the security module is unable to authenticate a particular security certificate using an available corresponding security value the security module revokes the security privileges associated with the particular security certificate by directing the components of the system to disable the processing features enabling the security privileges. To illustrate assume that a particular security certificate is used to enable RSA encryption decryption by the encryption decryption module and the security module is unable to authenticate the security certificate with its corresponding security value because the security value was purposely modified or overwritten so as to revoke the certificate. In this instance the security module can prevent the encryption decryption module from implementing RSA encryption by removing the security certificate from the certificate storage component or otherwise preventing the encryption decryption module from accessing the security certificate . Alternately the security module can provide a signal to the encryption decryption module or set one or more bits in a control register of the encryption decryption module so as to disable its RSA encryption decryption features. In a similar manner the security module can direct the multimedia processing module to disable one or more of its processing features which can include for example dual stream processing encoding decoding or transcoding by sending a signal modifying a control register or preventing access to the corresponding security certificate . Moreover it will be appreciated that in some instances the incompatibility between the modified security value and the corresponding security certificate may itself prevent a component from effectively implementing one or more processing features.

Further in at least one embodiment the security module is responsive to certificate revocation stimuli so as to revoke security privileges by creating incompatibilities between identified security certificates and their security values so as to disable one or more processing features of the system . In at least one embodiment the security module creates an incompatibility between a security certificate the stored security value to which it is bound by modifying the stored security value so that it is no longer compatible with the security certificate. The stored security value can be modified by entirely overwriting one or more bit positions the storage location where the security value is stored thereby generating in a different resulting security value that is incompatible with the security certificate associated with the previous security value stored in the same storage location.

In one embodiment a certificate revocation stimulus includes a lapse of a predetermined time or the occurrence of a predetermined event. To illustrate a security certificate may be valid only for a certain time period e.g. three months at which time the security certificate is to be revoked. The passing of this time period in this instance may serve as the certificate revocation stimulus. A certificate revocation stimulus in another embodiment includes a determination at the system that it is being used in an unauthorized manner. To illustrate a user may direct the system to encode copyrighted content for storage on a DVD without having the proper permissions. Upon detecting this unauthorized use via e.g. the detection of a copyright watermark extracted by the watermark module the system may initiate the revocation process so as to prevent subsequent unauthorized content copying. In another embodiment a certificate revocation stimulus includes a revocation command received at the system from another source. To illustrate the revocation command may come from a content provider such as a television broadcaster a multimedia distributor or producer from a governmental or quasi governmental agency from a manufacturer of the system and the like.

Alternately the certificate revocation stimulus may take the form of the transmission of a list of one or more unique system IDs that are to have security privileges revoked. As described above the watermark module may be used to insert a digital watermark into data output by the system that identifies the system using e.g. its system ID as the source of the data. Accordingly content owners and their associates may extract these digital watermarks to identify those systems being used for unauthorized activities and generate lists of IDs to be revoked accordingly. This list in one embodiment may be provided as data embedded in the multimedia data received at the system for processing. For example the list of unique IDs to be revoked may be included in a received multimedia file as a digital watermark that is extracted by the watermark module and provided to the security module . The security module in turn compares the system ID of the system with the list of system IDs. If the ID of the system is present in the list the security module initiates the revocation process described herein. In another embodiment the list of IDs to be revoked may be transmitted separately e.g. as a RF transmission or via a separate transmission channel.

Additionally in the event that a user would like to re invoke the security privileges the security module or alternately a user of the system can transmit a request for a new security certificate that is compatible with the modified security value to a certificate authority or other entity via e.g. an email a short messaging service SMS message an FTP transfer etc. As discussed in detail herein security privileges may be re invoked up to a maximum number of re invocations at which time the security module can permanently disable some or all of the processing features by for example blowing fuses associated with the processing features by permanently overwriting some or all of the security values or by permanently setting one or more control bits that are used to control access to the processing features.

It will be appreciated that hackers and other unauthorized users may attempt to circumvent the revocation process by attempting to restore the security value stored a particular storage location back to its original value that was compatible with a revoked security certificate. To prevent such circumventions in at least one embodiment the security values used for authentication of security certificates are stored at the OTP memory e.g. in the OTP storage locations so that a stored value cannot be reverted back to the original authenticated value after the security module has modified it by modifying at least one bit value at one or more bit locations of the OTP storage location used to store the value. As discussed above OTP storage locations have the characteristic of allowing only one transition at each bit location so that once modified the OTP storage location cannot be reprogrammed to store the original value. Accordingly in at least one embodiment one or more bit positions are kept at their initial value during the programming of the OTP storage location so that they can be altered to change the stored value during a revocation process. Further in one embodiment one or more other bit positions of a OTP storage location are used to as control bits for disabling corresponding processing features. For example assuming a thirty two bit OTP storage location bits can be used as control bits to disable an encryption feature of the encryption module and a dual stream mode of the multimedia processing module respectively. Bits can be used as revocation bits whereby bit is transitioned to a value of 1 in response to a first revocation command and bit is transitioned to a value of 1 in response to a second revocation command. The remaining bits can be used to store the original security value such as a unique system ID or encryption key. A security certificate initially may be authenticated based on the entire value of all thirty two bits then stored at the certificate storage component for use by the system in enabling various processing features.

Referring to an exemplary revocation re invocation method is illustrated in accordance with at least one embodiment of the present disclosure. For ease of discussion the method is described in the context of the exemplary system of . The method includes receiving a certificate revocation stimulus at a multimedia system at block . As described above the certificate revocation stimulus can include for example a determination at the multimedia system that an unauthorized activity has occurred or it can include the receipt of a list of system IDs to be revoked where the system s ID matches one of the listed IDs.

In at least one embodiment the multimedia system is enabled to re invoke security privileges up to a maximum number of re invocations. Accordingly at block the system determines whether any re invocation chances remain. As noted above in one embodiment each time a revocation stimulus is received the multimedia system changes a revocation bit location of OTP storage location from its default value e.g. from a value of 0 to 1 so as to modify the stored security value. Thus in one embodiment the maximum number of re invocations is based on the number of re invocation bits allocated from the storage location used to store the security value corresponding to the security privileges. Alternately the number of permitted re invocations can be represented by a value stored in a decremented counter.

In the event that the maximum number of re invocations already have been performed the system permanently disables the corresponding processing features at block . The processing features may be permanently disabled by blowing one or more fuses overwriting security values setting clearing certain control bits of a control register and the like.

Otherwise if there are re invocation chances remaining the system revokes the processing features associated with a security certificate by modifying the corresponding security value so that the modified security value is incompatible with the security certificate e.g. cannot authenticate the security certificate . In one embodiment the security value is modified by changing a bit position of an OTP storage location used to store the security value so as to modify the security value as discussed above.

As a result of the incompatibility between the modified security value and the security certificate the system or alternately the user will need to obtain a new security certificate in order to re enable the disabled processing features. Accordingly at block a request for a new security certificate that is compatible with the modified security value is sent to a certificate authority. The request may include for example a reason for the request an explanation of why the request should be granted and the like. Further the request may include the modified security value so that the certificate authority can bind the new security certificate to the modified security value.

Upon receipt of the new security certificate the system prepares the new security certificate for implementation at the system at block . This preparation can include for example decrypting the new security certificate if encrypted storing the new security certificate in an internal storage location encrypting the new security certificate and storing the encrypted version at an external storage location and re enabling the disabled processing features. At block the remaining number of re invocation changes is decremented and the flow returns to block .

Referring to a diagram illustrating an exemplary modification of a value stored at a one time programmable storage location in response to a sequence of revocation events in accordance with at least one embodiment of the present disclosure. For ease of discussion the revocation process is described with respect to the OTP storage location used to store the unique system ID.

Storage state illustrates the value initially stored in the OTP storage location prior to any revocation events. In the illustrated example the OTP storage location has eight bit positions bits where bits are used as control bits to disable an encryption processing feature and a decoding feature respectively when changed to a value of 1 . Bits are used as revocation bits that are transitioned in response to revocation stimuli and bits are used to store the original system ID 1011in this example . As illustrated bits initially have the default value of 0 resulting in the initial security value of 00001011 to which one or more security certificates are bound.

Storage state illustrates the modification of the bit position at bit to a value of 1 in response to a first revocation event so as to change the stored security value to 00001011 which is inconsistent with the security certificate in this example. Accordingly a request for a new security certificate bound to the modified security value 00011011is requested and implemented upon receipt.

Storage state illustrates the modification of the bit position at bit to a value of 1 in response to a second revocation event so as to change the stored security value to 00111011 which is inconsistent with the current security certificate in this example. Accordingly a request for a new security certificate bound to the modified security value 00111011is requested and implemented upon receipt.

As the illustrated example of provides for only two re invocations the occurrence of a third revocation event results in permanently disabling one or more processing features. As illustrated by storage state the processing features associated with bit positions and can be disabled by modifying these bit positions to a value of 1. As a result the stored security value is changed to 11111011 which is incompatible with the current security certificate and results in the permanent disabling of the processing features associated with the security disable bit positions and .

The stored security value that is altered by revocation may be the system ID e.g. a chip ID used for identification a CW used for de scrambling or a private exponent used for RSA decryption. For example a chip ID may be 0x00001234 before being revoked and set to 0x10001234 after being revoked a CW may be 0x0123456789ABCDEF before being revoked and 0x1123456789ABCDEF after being revoked and an RSA private exponent may be 0x0123456 . . . ABCDEF before being revoked and 0x1123456 . . . ABCDEF after being revoked. In each case the new revoked value may be determined from the previous value and may be re invoked by the certificate authority. In the case of a revoked private exponent a new set of public exponent and public modulus must be re calculated which corresponds to the new private exponent so that encrypted data may only be decrypted by the new private exponent and public modulus. If the original system ID CW and private exponent were unique for all systems then the revoked security values also will be unique provided the most significant 4 bits for all security values in all systems are reserved i.e. defaulted to 0 for the purpose of revocation.

Referring to an exemplary system on a chip SOC implementation of the multimedia system of is illustrated in accordance with at least one embodiment of the present disclosure. The SOC includes a 1024 bit PROM a CW IV exponent internal storage area a transport stream de multiplexer TSD a direct memory access DMA controller an RSA engine plurality of registers a frame buffer a read write controller an I2C interface and a PCI bus .

The PROM can be programmed via the registers and or via the I2C interface and is utilized to record a 32 bit unique chip ID a 64 bit unique CW IV a 32 bit subsystem ID and vendor ID a private RSA exponent up to 896 bits and R W lockout bits 32 bits . The CW IV exponential internal storage area comprises internal memory to store up to 32 64 bit CW values up to 32 64 bit IV values and up to 16 64 bit CW values.

The TSD processes input multimedia transport stream TSI to generate processed output transport streams TSO . Further the TSD is configured to support one or more scrambling descrambling algorithms such as AES EBC cipher block chaining CBC CTR and the C2 cipher. The DMA controller stores and writes multimedia content data and other data to from memory and additionally is configures to support one or more scrambling descrambling algorithms such as DES 3DES DVB Multi 2 and the like using the stored CWs Ws and chip ID so as to scramble descramble content transmitted via the PCI bus . The unscrambled content is stored in the frame buffer . The RSA engine provides RSA based encryption decryption using the stored RSA exponent.

In at least one embodiment unscrambled versions of security certificates are stored in the frame buffer . In response to a revocation event an interrupt is generated and transmitted to the processing unit . The processing unit then loads and executes a microcode interrupt handling routine that implements the revocation re invocation process described herein wherein the security values e.g. the CWs IVs exponents and IDs may be modified in the PROM or the registers so as to revoke certain processing features.

Other embodiments uses and advantages of the present disclosure will be apparent to those skilled in the art from consideration of the specification and practice of the disclosure disclosed herein. The specification and drawings should be considered exemplary only and the scope of the disclosure is accordingly intended to be limited only by the following claims and equivalents thereof.

