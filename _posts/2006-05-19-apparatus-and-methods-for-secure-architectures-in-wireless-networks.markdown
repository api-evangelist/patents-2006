---

title: Apparatus and methods for secure architectures in wireless networks
abstract: Apparatus, methods, computer readable media and processors may provide a secure architecture within which a client application on a wireless device may, in some aspects, exchange information securely with resident device resources, and in other aspects, with a remote server over a wireless network.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08320880&OS=08320880&RS=08320880
owner: QUALCOMM Incorporated
number: 08320880
owner_city: San Diego
owner_country: US
publication_date: 20060519
---
The present Application for Patent claims priority to Provisional Application No. 60 701 252 entitled Methods and Apparatus for Secure Architectures in Wireless Networks filed Jul. 20 2005 assigned to the assignee hereof and hereby expressly incorporated by reference herein.

The described embodiments generally relate to wireless communication devices and computer networks and more particularly relate to apparatus and methods for secure architectures in wireless networks.

Wireless networking connects one or more wireless devices to other computer devices without a direct electrical connection such as a copper wire or optical cable. Wireless devices communicate data typically in the form of packets across a wireless or partially wireless computer network and open a data or communication channel on the network such that the device can send and receive data packets. The wireless devices often have wireless device resources including firmware incorporated on original equipment manufacturer OEM chipsets which individually and cooperatively operate and generate data in accordance to their design and specific protocol or configuration. Such designs and configurations may include for example accessing firmware resident diagnostic tools operable to transmit and receive data in open communication connections with networked devices.

Data being transmitted between wireless devices and remote servers often includes sensitive material and may be subject to malicious attack. For example client configurations may be downloaded from a remote server to a wireless device. As these configurations may provide insight into a vendor s network operations a vendor may wish to secure such transmissions from prying eyes. Furthermore network diagnostic applications resident on a wireless device may transmit network statistics or other log information to a remote server. These logs may contain information useful to a competitor and as a result may be targeted for interception. Furthermore intercepting the messages between the wireless client and the server may allow a competitor to reverse engineer the client server interface in order to spoof the legitimate server and communicate with the wireless client with malicious intent.

Furthermore within the wireless device itself unauthorized client applications downloaded to the device may maliciously or unintentionally access an application programming interface API with handset firmware with the potential for causing damage to the handset and to the network.

Accordingly it would be advantageous to provide apparatus and methods providing a secure architecture for wireless devices.

The described embodiments comprise apparatus methods computer readable media and processors operable on a wireless device and a remote device to provide a secure architecture in wireless networks within which a client application resident on the wireless device may exchange information securely with the remote server over a wireless network.

Cryptographic mechanisms may provide authentication of the identity of the remote server prior to downloading an encrypted command and a client configuration to the wireless device. A client data log may also be encrypted on the wireless device prior to uploading to the remote server. Furthermore the secure architecture may provide an authentication mechanism operable to protect both the wireless device and the wireless network from abuse by an unauthenticated remote server and or client application.

In some aspects a method for securely exchanging information comprises authenticating an identity of a client application resident on a wireless device based upon a request by the client application to access a device resource on the wireless device. The request is based on a remotely received information retrieval configuration. Further the method includes providing the client application with access to a predetermined portion of the device resource based upon a result of the authentication.

In a related aspect a machine readable medium comprises instructions which when executed by a machine cause the machine to perform operations comprising the actions noted above. Another related aspect comprises at least one processor is configured to perform the above described actions.

In other aspects a wireless device comprises means for authenticating an identity of a client application resident on a wireless device based upon a request by the client application to access a device resource on the wireless device. The request is based on a remotely received information retrieval configuration. Further in this aspect the wireless device further comprises means for providing the client application with access to a predetermined portion of the device resource based upon a result of the authentication.

In still other aspects a wireless communication device comprises a device resource comprising at least one of device related data and network related data. The wireless communication device in this aspect further comprises a resource interface module operable to receive an access request for access to the device resource wherein the access request is based on a remotely received information retrieval configuration. Further the access request comprises a client application module identification and a security mechanism. Additionally the resource interface module is operable to authenticate the client application module identification and a corresponding predetermined access level to the device resource based on the security mechanism.

In another aspect a method for secure information exchange with a wireless device over a wireless network comprises establishing a communication protocol with the wireless device and generating a collection configuration operable to cause the wireless device to collect predetermined information from a device resource on the wireless device. In this aspect the method further includes transmitting the collection configuration and security mechanism to the wireless device over the wireless network and receiving from the wireless device the predetermined information based on the collection configuration if the security mechanism authenticates the apparatus to the wireless device based on a predetermined security procedure.

In a related aspect a machine readable medium comprises instructions which when executed by a machine cause the machine to perform operations comprising the actions noted above. Another related aspect comprises at least one processor is configured to perform the above described actions.

In still other aspects a remote server comprises means for establishing a communication protocol with the wireless device and means for generating a collection configuration operable to cause the wireless device to collect predetermined information from a device resource on the wireless device. In these aspects the remote server further comprises means for transmitting the collection configuration and security mechanism to the wireless device over the wireless network and means for receiving from the wireless device the predetermined information based on the collection configuration if the security mechanism authenticates the apparatus to the wireless device based on a predetermined security procedure.

In yet other aspects an apparatus for exchanging data with a wireless device comprises a configuration generator operable to generate a configuration for receipt by a wireless device the configuration operable to cause the wireless device to collect predetermined information from a device resource on the wireless device. The apparatus further comprises an information repository operable to store information collected from the wireless device based on the configuration and a communications module and a processor operable to establish a connection between the apparatus and the wireless device over a wireless network. Additionally the apparatus comprises a security module operable to provide a predetermined security mechanism to the wireless device the predetermined security mechanism based on a predetermined exchange protocol with the wireless device wherein the predetermined security mechanism authenticates the apparatus to the wireless device.

Referring to a secure communications system may comprise in some aspects mechanisms and procedures for securely exchanging data information between predetermined wireless devices and corresponding predetermined remote network devices located across a wireless network. For example in some aspects a first server may be associated with a first group of wireless devices and a second server may be associated with a second group of wireless devices. The described aspects provide security mechanisms for example that prevent unauthorized communications between the first server and the second group of devices and between the second server and the first group of devices thereby providing a secure client server interface. In further aspects system may comprise mechanisms and procedures for securely exchanging data information within a wireless device such as between a client application and a wireless device resource. For example in some aspects the system provides for security mechanisms that prevent unauthorized communications between an application or code resident on the wireless device and predetermined wireless device resources thereby providing a secure client device resource interface.

For example in one aspect an information transfer client ITC module resident on a wireless device enables secure communication with an information transfer manager ITM module resident on a remote server over a wireless network . As such system may permit multiple secure and independent network connections over a common wireless network. One network may comprise for example remote server and at least one wireless device associated with one entity such as a first network carrier. Similarly a second network may comprise remote server and at least one wireless device associated with another entity such as a second network carrier.

Furthermore in an example of another aspect a secure resource interface module resident on wireless device may be operable to restrict access by client applications such as ITC module to application programming interface API which provides access to device resources . ITC module may include ITC control logic for controlling all operations of ITC module and may communicate with ITC security module . ITC security module provides a secure interface with remote networking devices such as remote server and ITM module and well as with local device resources such device resources via secure resource interface module .

Each of ITC module ITM module and secure resource interface module may include one or more secure mechanisms to provide authentication communications setup and secure transfer data. For example such secure mechanisms may include secure hash functions symmetric key encryption public key encryption and any other cryptography mechanism and or method to ensure the authentication of parties and the secure exchange of information. Thus in some aspects system provides a wireless device with a secure external communications interface and or in other aspects with a secure internal communication interface.

Referring to one aspect of a method for securely exchanging information within a wireless device may include at step a receiving a request to access wireless device resources . For example a client application such as ITC module resident on wireless device may interact with device resources to provide functionality to the device. As such ITC module may generate a request to access device resources and such a request may be received by secure resource interface module . Non limiting the request received at step may be initiated at power up of the wireless device prior to a first request for device data and upon user request. Request may be initiated to unlock API for future requests although no resource data need be transmitted at this time.

This aspect of the method may further include at step authenticating the client application making the access request. For example authentication software may be coded into each API or API may call upon secure resource interface module to perform the authentication. Authentication at step may comprise one or more cryptographic mechanisms and may include the generation of a digital signature by an ITC resource interface component of the client application. This data may then be forwarded to secure resource interface module .

Furthermore each device resource may have different levels of access and authentication may involve a client application requesting and or being assigned the proper access level. In some embodiments the assigned access level may be determined based upon a particular security mechanism such as a key provided by the client application at the time of authentication.

The method may further include at step exchanging information with a device resource. For example once authenticated a client application may make any number of requests of the device resource based on the granted predetermined level of access thereby allowing faster access to resource data . It should be noted however that in other aspects the number of requests may be limited and or each request may require a new authentication.

Additionally the method may include at step disabling access to the device resources. For example the secure resource interface module may at step remove access to device resource based on a lack of activity by the client application. Access may be reestablished upon re authentication of the client application. In other embodiments the interface between a client application and a device resource may be disabled at power down of the wireless device . Furthermore the interface between a client application and a device resource may be disabled by an attempt made by the client application to access device data outside of the authenticated access level.

At step the method may include determining if information is to be transmitted or received. For example if the remote server is to transmit data to the wireless device at step the IT client module may invoke IT client security module to initiate an authentication process to verify the identity and affiliation of the remote server . Methods of authenticating may include remote server invoking ITM security module to exchange predetermined authentication information according to predetermined authentication routines with IT client security module and in particular with ITC ITM interface portion . For example the authentication may involve one or more security mechanisms.

As discussed herein security mechanisms may include but are not limited to digital signatures secure hash functions asymmetric key encryption mechanisms utilizing public and private keys symmetric key encryption mechanisms and session key generation algorithms. These security mechanisms may be utilized in one or both of authentication processes and private information exchange processes.

Secure hash functions may provide the basis for electronic signatures and guaranteeing the integrity of information and operate by taking a variable length message and producing a fixed length hash. Changing a single bit in the message will change approximately half of the bits in the hash. The most commonly used cryptographic has functions are MD5 Message Digest which produces a 128 bit hash and SHA 1 Secure Hash Algorithm that produces a 160 bit hash.

A strong key generation algorithm requires a truly random number generator or at least a cryptographically secure pseudo random number generator. The seeding material for a pseudo random number generator should be as long as or longer than the session key needed. A pseudo random number generator algorithm generates always the same output with the same seeding material accordingly secure mechanisms may include a seed generator unavailable to others and may be set at the time of manufacture downloading or implemented in hardware for example by the use of a leaky diode.

After authentication the two parties may at step set up a mechanism to transmit encrypted data from the remote server to the wireless device . Setup may include the processing of secure setup procedure and may use one or more secure mechanisms stored in security mechanism storage to set up encrypted communications utilizing symmetric key encryption. Unlike the relatively slower authentication process of step the speed of symmetric key cryptography may better lend itself to transmitting larger data files securely between remote server and wireless device . Symmetric key encryption requires both sender and receiver having the same shared secret key. Symmetric key encryption algorithms may be implemented in hardware or software and may include Data Encryption Standard DES Triple DES 3DES International Data Key Encryption Algorithm IDEA Blowfish CAST 128 and CAST 256.

While these ciphers are fast key management that is the transmission of the symmetric key over an open wireless channel of wireless network is of great concern. Accordingly asymmetric key encryption otherwise known as public key encryption may be employed to solve the problem of secret key distribution by the use of two mathematically complementary keys. Public key encryption is the foundation of Electronic Commerce Digital Signatures and Virtual Private Networking.

Once an encrypted connection is set up the remote server may at step encrypt and transmit data for example client configuration information and or commands to the wireless device .

As previously disclosed based upon the methods and apparatus of system wireless device is operable to securely transmit a client log or other information to remote server .

Referring back to step in the case of transmitting data from a wireless device to a remote server there may be no required authentication of the wireless device on the remote server prior to transmitting the data. In the event of a scheduled data log upload by the wireless device to the remote server for example the wireless device is the device making the call and as the remote server is theoretically collecting logs from multiple wireless devices authentication at step is optional. However some aspects may include authenticating either the wireless device or the server in which case the authentication at step may include secure procedures and mechanisms similar to those comprising step . In other embodiments in which authentication is not performed control may pass directly to step at which time a secure connection may be set up between the remote server and the wireless device using secure setup procedure that may use one or more secure mechanisms stored in security mechanism storage .

As previously disclosed symmetric key encryption may be one cryptographic mechanism stored in storage and may be used at step to encrypt any data i.e. log data generated on wireless device . Further after encryption step may include transmitting the encrypted data to remote server .

Referring to wireless device may include any type of computerized device such as a cellular telephone personal digital assistant two way text pager portable computer and even a separate computer platform that has a wireless communications portal and which also may have a wired connection to a network or the Internet. The wireless device can be a remote slave or other device that does not have an end user thereof but simply communicates data across the wireless network such as remote sensors diagnostic tools and data relays.

Further wireless device may comprise a computer platform having input mechanism and output mechanism . Input mechanism may include but is not limited to a mechanism such as a key or keyboard a mouse a touch screen display and a voice recognition module. Output mechanism may include but is not limited to a display an audio speaker and a haptic feedback mechanism.

Computer platform may further comprise communications module embodied in hardware software and combinations thereof operable to receive transmit and otherwise enable communication between components internal to wireless device as well as to enable communications between wireless device and other devices on network .

Computer platform may also include memory which may comprise volatile and nonvolatile memory such as read only and or random access memory RAM and ROM EPROM EEPROM flash cards or any memory common to computer platforms. Further memory may include one or more flash memory cells or may comprise any secondary or tertiary storage device such as magnetic media optical media tape or soft or hard disk.

Furthermore memory may be operable to store original equipment manufacturer OEM applications and third party client applications such as information transfer client ITC module . In one non limiting aspect ITC module may include diagnostic software for example Remotely Accessible Performance Tool and OptimizeR RAPTOR and or MobileView software developed by Qualcomm Inc. of San Diego Calif.

Several mechanisms may be used to load applications into memory including but not limited to static installation at the time of manufacture downloading via wireless transmission over a wireless network and over a hardwired connection to a device such as a personal computer PC .

Device resources may include any information data code functionality etc. resident on wireless device . In some aspects device resources may include all or portions of memory . In other aspects device resources may include all or any portion of processor assembly which may further include an application specific integrated circuit ASIC or other chipset processor logic circuit registers and or other data processing device operable to execute client applications and application programming interface API .

Additionally device resources may include one or a combination of processing subsystems that perform specific operations and or provide specific functionality to wireless device . In one aspect such as in a cellular telephone aspect processing subsystems may include subsystems such as sound non volatile memory file system transmit receive searcher layer layer layer secure socket layer SSL main control remote procedure handset power management diagnostics digital signal processor vocoder messaging call manager Bluetooth system Bluetooth LPOS position determination position engine user interface sleep data services security authentication USIM SIM voice services graphics USB multimedia such as MPEG GPRS etc. It should be noted however that processing subsystems may vary depending on the given device and or application. Further for example in some aspects resource data that may be collected by ITC module may reside in registers within one or more processing subsystems .

In one non limiting aspect API may be a runtime environment executing on the respective wireless device and may call other modules i.e. secure resource interface module and device resources as required to process requests generated by a client application i.e. ITC module . One such runtime environment is Binary Runtime Environment for Wireless BREW software developed by Qualcomm Inc. of San Diego Calif. Other runtime environments may be utilized that for example operate to control the execution of applications on wireless computing devices. API as discussed herein is operable through secure resource interface module to manage access to device resources authenticating client applications prior to issuing a device call accessing resource data .

In some aspects referring to API calls upon secure resource interface module and its predetermined device data access procedures to authenticate a data access request made by the client application ITC module . Secure resource interface module may comprise hardware software firmware data and instructions for controlling access to API and its associated device data calls that provide interaction with device resources . Predetermined device data access procedures may include methods and or routines that authenticate components for interacting with device resources . For example device data access procedures may require the exchange of predetermined messages authentication and security related mechanisms such as device data access security mechanisms etc. in order to determine whether or not to allow access to at least a portion of API . Various authentication security mechanisms such as symmetric keys public private keys hash functions digital certificates etc. may be stored as device data access security mechanisms . Device data access procedures may vary for example depending on an identity of an application component module requesting access to device resources .

Furthermore in some aspects secure resource interface module may provide varying levels of access to device resources . For example depending upon the specific authentication security information passed during the authentication process API may permit certain device data calls to device resources while denying others. Non limiting access to device resources may be implemented using resource access mapping table that maps a particular access level to a particular device resource and requires a specific key to unlock the API . In operation secure interface module may respond to an application request for a specific access level by using key to authenticate the client application. If authenticated a second table client application access mapping table may be built to map the authenticated application to the corresponding access level . Tables and may both be stored in device data access security mechanisms and may be used to verify that future data calls to device resources are within the permissible access level of the calling client application.

Referring back to ITC module may include hardware software firmware data and or instructions for gathering device related and or network related information from wireless device and transmitting this information to a corresponding remote server such as remote server . For example in some aspects ITC module includes client control logic operable to execute and control the functionality of ITC module . In some aspects for example client control logic parses ITC configuration and executes information retrieval storage and transmission functionality based on the given configuration. For example client control logic may require access to device resources in order to perform diagnostic on and or retrieve information from wireless device and or network . According to a given ITC configuration client logic may for example retrieve resource data from one or more subsystems and or may require one or more subsystems to perform a specific operation. Additionally for example client control logic may create and transmit data log including resource data collected based on ITC configuration to remote server . Furthermore under control of client control logic the ITC module may request a download of client configuration from the remote server via communications module .

Referring to ITC module may include an ITC security module to provide for authentication and to ensure secure communications. The ITC security module includes ITC security control logic operable to control secure procedures for ITC module . In some aspects ITC security module may include an information transfer client information transfer manager ITC ITM interface portion operable to provide authenticated and or secure exchanges with ITM . In other aspects ITC security module may include an information transfer client resource ITC Resource interface portion operable to provide authenticated and or secure exchanges between ITC client module and device resources such as via API and the associated secure resource interface module . For example together with API ITC Resource interface provides logic for authenticating client applications on wireless device based upon a predetermined device resource security procedure . Similarly the ITC ITM interface provides logic to authenticate remote server and further comprises secure transmission procedure and secure reception procedure to respectively transmit and receive encrypted data between the wireless device and the remote server . Procedures and may include predetermined methods routines sequences of messages and secure mechanisms for establishing authentication and secure communications. For example secure mechanisms may include cryptographic devices and or algorithms including but not limited to secure hash functions such as MD5 and SHA 1 public key encryption algorithms such as RSA and pretty good privacy PGP symmetric key encryption algorithms including DES 3DES IDEA Blowfish CAST 128 and CAST 256 digital certificates and digital signatures.

In addition in some aspects ITC security module may include a security storage in which one or more of the secure mechanisms may reside for access by ITC security control logic . For example security storage may retain public and private keys used by ITC Resource interface and ITC ITM interface respectively for both authentication and data encryption decryption.

ITM may include a memory for storing data and instructions a processor for executing instructions and a communications module enabling communications internally within ITM and also with external devices.

Memory may include an information transfer manager ITM module for managing the collection and analysis of information from one or more devices such as wireless device . ITM module may include at least one of any type of hardware software firmware data and executable instructions. ITM module may comprise ITM control logic which is operable to execute the functionality of ITM module .

Some aspects of ITM may require ITM module to generate and transmit ITC configuration to wireless device in order to collect and report information such as device and or network diagnostic information. For example ITM may be associated with an entity such as a network service provider a device manufacturer etc. which desires to collect device related and or network related information from one or more associated wireless devices for example to monitor and or improve device and or network performance. ITC configuration may comprise for example a configuration message that directs a given device on what information to collect on when to collect the information and on when to transmit the information to ITM .

ITM control logic is operable to control the operation of configuration generator which may generate ITC configuration . For example configuration generator may allow for a selection between a number of collection and reporting parameters in order to define ITC configuration .

Furthermore ITM control logic may further be configured to receive data log from at least one wireless device store the log in log repository and control log analyzer in the generation of report . ITM control logic may further operate to control the operation of control command generator in the generation of control commands . Control commands when transmitted to wireless device are operable to perform such functions as uploading data log downloading ITC configuration as well as any function available on the wireless device.

Still referring to ITM module may include ITM security module which includes any hardware software firmware data and instructions that provide for the authentication of ITM to a wireless device and to allow for the establishment of a secure communications session between ITM and a wireless device. In some aspects for example ITM security module includes one or more predetermined secure transmission procedure and or secure reception procedures which define predetermined security mechanisms predetermined authentication processes and predetermined setup procedures to initiate a secure exchange of information with wireless device . For example predetermined procedures and may be utilized to encrypt decrypt data transmissions to from wireless device . Predetermined procedures and may also include one or more secure mechanisms such as symmetric public and private keys hash functions etc. to encrypt data and or messages and or to provide for authentication of an identity of a given wireless device and or of ITM . In some aspects for example ITM security module may include a security mechanism storage that serves as a repository for storing one or more security mechanisms in a manner accessible during execution of secure transmission and reception procedures and . The security mechanisms may be utilized to authenticate ITM to a wireless device and or to provide a cryptographic mechanism to protect the privacy of communications between the ITM and the wireless device.

Further ITM security module may comprise at least one of ITC security module and a secure resource interface module . As discussed above the information transfer client security module comprises a first set of predetermined mechanisms and procedures for authenticating the apparatus to the wireless device and for establishing a secure information exchange and the secure resource interface module comprises a second set of predetermined procedures and mechanisms for authenticating information transfer client module operable to execute configuration on the wireless device to the device resource. As such the secure transmission and reception procedures and and secure mechanisms may be correlated to the corresponding procedures and mechanisms of ITC security module and secure resource interface module to protect against improper information retrieval by rogue servers and or client applications.

Referring to wireless network may include any communications network operable at least in part for enabling wireless communications between wireless device and any other device connected to wireless network . Further wireless network may include all network components and all connected devices that form the network. For example wireless network may include at least one or any combination of a cellular telephone network a terrestrial telephone network a multicast network such as a Forward Link Only FLO network including the MediaFLO System available from Qualcomm Inc. of San Diego Calif. a digital video broadcasting DVB network such as DVB S for satellite DVB C for cable DVB T for terrestrial television DVB H for terrestrial television for handhelds a terrestrial telephone network a satellite telephone network an infrared network such as an Infrared Data Association IrDA based network a short range wireless network a Bluetooth technology network a ZigBee protocol network an ultra wide band UWB protocol network a home radio frequency HomeRF network a shared wireless access protocol SWAP network a wideband network such as a wireless Ethernet compatibility alliance WECA network a wireless fidelity alliance Wi Fi Alliance network and a 802.xx network a public switched telephone network a public heterogeneous communications network such as the Internet a private communications network and land mobile radio network.

Suitable examples of telephone networks include at least one or any combination of analog and digital networks technologies such as code division multiple access CDMA wideband code division multiple access WCDMA universal mobile telecommunications system UMTS advanced mobile phone service AMPS time division multiple access TDMA frequency division multiple access FDMA orthogonal frequency division multiple access OFDMA global system for mobile communications GSM single carrier 1X radio transmission technology RTT evolution data only EV DO technology general packet radio service GPRS enhanced data GSM environment EDGE high speed downlink data packet access HSPDA analog and digital satellite systems and any other technologies protocols that may be used in at least one of a wireless communications network and a data communications network.

According to system ITM and wireless devices may communicate over wired network e.g. a local area network LAN with a public key server . Public keys for example for use in the authentication and or secure communications procedures discussed herein may be placed on the public key server or sent by E mail to requesting devices. ITM and public key server may be present along with any other network components needed to provide cellular telecommunication services.

ITM wireless devices and or public key server may communicate with the carrier network through a data link such as the Internet a secure LAN WAN or other network. Carrier network may control the transmission of messages generally being data packets sent to a mobile switching center MSC . Further carrier network may communicate with MSC via a network such as the Internet and or POTS plain old telephone service . Typically in network a network or Internet portion transfers data and the POTS portion transfers voice information.

MSC may be connected to multiple base stations BTS by another network such as a data network and or Internet portion for data transfer and a POTS portion for voice information. BTS ultimately broadcasts messages wirelessly to wireless devices such as by short messaging service SMS or other over the air methods.

At step in some aspects the method may include establishing a connection to a remote server. For example wireless device may initiate an HTTP connection between communication modules and of wireless device and remote server respectively. The connection may be made under the control of the client control logic of wireless device and ITM module of remote server and may employ a secure socket layer SSL to establish a secure connection between a client and a server.

At steps and the method may include generating a random message to use as a basis for comparison in an authentication procedure and transmitting the random message to a remote server. For example under control of ITC security control logic and secure transmission procedure a random message is generated and may be transmitted to the remote server at step .

On the remote server at step the method may include receiving the random message and applying a predetermined security mechanism to the random message to create a server message digest. In this case the security mechanism may comprise some cryptographic mechanism only known by both an authenticated wireless device and an authenticating remote server. For example ITM security module may receive the transmitted random message and based upon secure transmission procedure apply a predetermined secure hash function to the message at step creating a server message digest. The hash function generator and other cryptographic algorithms coded in security mechanism are stored in security mechanism storage . The server message digest will be used at a later step to determine authenticity of the wireless device .

At step on the wireless device the method may further include creating an application digest based on applying a predetermined security mechanism to the random message. As noted above the predetermined security mechanism used by the wireless device should be the same security mechanism known to and used by the remote server in order for the device and server to be properly authenticated. For example after the ITC ITM interface transmits the random message to the ITM security module the client application may at step apply its own predetermined hash function to the random message creating an application message digest.

At step to the method may include encrypting the application digest to create a cipher digest for example to allow for the secure transmission of the application digest across a network. For example the ITC ITM interface may encrypt the application digest with a public key to create a cipher digest. Further the method may include transmitting the cipher digest to the remote server. For example the ITC ITM interface may transmit the cipher digest to remote server .

At step on remote server the method may include decrypting the cipher digest to obtain a server application digest. For example the ITM security module is operable to decrypt the received cipher digest using a private key corresponding to the public key used by the wireless device stored in security mechanism storage .

And at step the method may include comparing the server message digest with the server application digest to determine if they are equal and hence to authenticate the wireless device. For example ITM security module may compare the server application digest decrypted in step with the message digest created at step . If the two digests are equal then the wireless device is authenticated and the set up of an exchange of information may proceed with step . If the two digests are not equal then the wireless device is not authenticated and the communication may be terminated at step .

Modern encryption systems use a combination of symmetric and public key encryption. In some aspects as noted above the methods and apparatus disclosed herein may take advantage of the speed of symmetric encryption and the key management advantages of public key encryption to exchange data quickly and securely between remote server to wireless device .

At step wireless device and more particularly the secure transmission procedure of ITC ITM interface is operable to retrieve the public key of the remote server. In some embodiments the remote server s public keys may comprise secure mechanism statically loaded into security storage at the time of manufacture of wireless device . In other embodiments the wireless device may obtain the public key directly from the remote server across the wireless network via communications module . In other embodiments the wireless device may retrieve it from a third party as illustrated by key server in . In further embodiments keys may be entered via input mechanism such as from a PC keyboard and other input devices previously disclosed.

Following step the secure transmission procedure may at step generate and store a random session key. The session key may be generated by one of secure mechanisms and may include a software implemented version of a pseudo random number generator. In some aspects the session key may comprise a symmetric key which provides for a high rate of data exchange relative to an asymmetric key pair while still protecting the privacy of the exchanged data.

At step the session key may be encrypted with the public key retrieved at step and transmitted to the ITM security module of the remote server at step .

Since the ITM security module has the private key of the complementary key pair only the remote server can recover and store the session key at step .

At step the wireless device may use the session key stored at step in security storage to decrypt the encrypted information transmitted by remote server . In one aspect the decryption may be implemented by the ITC ITM interface and more specifically secure reception procedure of interface . Upon completion of step wireless device under control of client control logic may parse the decrypted data at step . In one aspect the data comprises commands to be executed on the wireless device. In other aspects the data comprises configuration data which is stored as ITC configuration .

Optionally at step once the information from remote server is decrypted and parsed wireless device may delete the session key. A new information exchange may then require a new session key thereby providing for enhanced security in exchanging information.

In some embodiments the wireless device may transmit a status indication back to the remote server. In other embodiments the wireless device may at step simply disconnect from the remote server if no further communication is required.

At step the wireless device may initiate a connection an HPPT connection for example with the remote server . This connection may be used to retrieve the remote server s public key at step . As previously disclosed the public key may be obtained via various mechanisms including downloading it from the remote server via a third party and being statically loaded onto the wireless device at the time of manufacture or via a PC.

At step the wireless device may generate a random session key which at step may be used to encrypt data log .

At step the session key may be encrypted with the remote server s public key and at step both the encrypted data log and the encrypted session key may be transmitted to the remote server over the wireless network .

Since only the ITM security module has the private key of the key pair only the remote server may operate at step to recover the session key and at step decrypt the received encrypted data log . At step the remote server may transmit an acknowledgement operable to notify the wireless device of the successful transfer of data. After receiving the acknowledgement at step the wireless device may at step disconnect from the remote server.

As previously disclosed the secure architecture described herein includes an authentication mechanism protecting static extension API from access by a non authenticated client application. discloses one such authenticating mechanism and includes a secure resource interface module being called upon by API to authenticate client application ITC module . Intra wireless device communications between the secure resource interface module and ITC module may be performed by communications module under control of API .

As previously disclosed authentication may be performed once at startup initialization downloading of the client application at a scheduled time and at a time determined by the user. Once authenticated API may process client application requests until such time as the API client application interface is disabled. The interface may be disabled via several mechanisms including timing out lack of activity for a determined amount of time and power down of the wireless device.

Furthermore authentication may involve assigning a specific access level to an application based upon information transferred between the client application and the API at the time of authentication. Access levels may amount to permissions wherein the wireless device may grant one application more or less permissions to access wireless device resources. Access to device resources may be controlled using a predetermined resource access level mapping table and a client application access level mapping table generated at the time of client application authentication.

Referring to a method for authenticating a client application is illustrated. It should be noted that the method of is one example of a plurality of possible client application authentication methods that may be utilized based on the discussion provided herein and thus this example should not be construed as being limiting. The method may start at step with ITC module generating a message which at step may be transmitted to secure resource interface module where it is received at step . The generated message may be random or may comprise information regarding an access level indicating the level of access required by the client application.

The secure resource interface module may at step apply a secure hash function to the message generating a message digest to be used for authenticating the client application at step . The secure hash function generator may be included with other cryptographic functions stored in device data security mechanism .

In addition to forwarding the message to secure resource interface module step may include passing control to step at which time the ITC security module portion of the ITC module may apply its own secure hash function to the message generated at step . The secure hash function applied by the ITC module may be implemented in code as part of device resource security procedure .

At step the ITC security module may encrypt the message digest of step and at step transmit the cipher digest to secure resource interface module .

The cipher digest may at step be received by the secure resource interface module and at step decrypted using a mathematically complementary key to the key used in step .

At step the message digest generated in step is compared to the message digest decrypted from the cipher digest in step . If the two digests are equal the authenticity of the client application and the access level contained in the body of the message received in step may be determined at step . Once determined a client application access level may be stored in client application access mapping table along with client application identification ID identifying the specific client application. The client ID and the associated access level may be checked by the API in subsequent client application data calls to determine whether to grant access to device resource data . In other embodiments no additional checks of the client application data calls may be made and once authenticated all subsequent data calls are processed without further checking 

If the digests compared at step are not equal API is locked at step and the client application is blocked from accessing the device resources requested.

Thus in some aspects a wireless device and in particular an information retrieval client on the wireless device is provided with mechanisms and routines that assure that a remote device requesting the information is properly associated with the wireless device and or the information retrieval client. These mechanisms and routines assure the remote device requesting information is not a rogue device trying to steal information. Further in other aspects wireless device resources are provided with mechanisms and routines that assure secured access to the resources and their associated device related and or network related information. Such mechanisms and routines assure that only authenticated and properly affiliated information retrieval clients are allowed access thereby thwarting rogue information retrieval clients.

In some aspects the affiliation between the wireless device and the remote server allows the properly authenticated remote server to control the settings of the authentication and secure information transfer mechanisms and protocols. The remote server may change the mechanisms and protocols on the wireless device at any time to provide for enhanced security. Similarly once dealing with an authenticated remote server the wireless device may direct changes with the mechanisms and protocols on the remote server. For example once authentication and secure information exchange is established prior to disconnecting the remote server and or the wireless device may conclude an information transfer session by establishing new secure mechanisms and or routines to use for the next session. Further in this same manner the authentication mechanisms and routines and the secure exchange mechanisms and routines between the client application and the device resources may be established and changed by the remote server and or by the wireless device.

The various illustrative logics logical blocks modules and circuits described in connection with the embodiments disclosed herein may be implemented or performed with a general purpose processor a digital signal processor DSP an application specific integrated circuit ASIC a field programmable gate array FPGA or other programmable logic device discrete gate or transistor logic discrete hardware components or any combination thereof designed to perform the functions described herein. A general purpose processor may be a microprocessor but in the alternative the processor may be any conventional processor controller microcontroller or state machine. A processor may also be implemented as a combination of computing devices e.g. a combination of a DSP and a microprocessor a plurality of microprocessors one or more microprocessors in conjunction with a DSP core or any other such configuration.

Further the steps of a method or algorithm described in connection with the embodiments disclosed herein may be embodied directly in hardware in a software module executed by a processor or in a combination of the two. A software module may reside in RAM memory flash memory ROM memory EPROM memory EEPROM memory registers a hard disk a removable disk a CD ROM or any other form of storage medium known in the art. An exemplary storage medium is coupled to the processor such that the processor can read information from and write information to the storage medium. In the alternative the storage medium may be integral to the processor. The processor and the storage medium may reside in an ASIC. The ASIC may reside in a user terminal. In the alternative the processor and the storage medium may reside as discrete components in a user terminal.

While the foregoing disclosure shows illustrative aspects and or embodiments it should be noted that various changes and modifications could be made herein without departing from the scope of the described aspects and or embodiments as defined by the appended claims. For example for enhanced security it should be noted that data stored on wireless device and or data stored on remote server may be stored in an encrypted format. Furthermore although elements of the described embodiments may be described or claimed in the singular the plural is contemplated unless limitation to the singular is explicitly stated. Additionally all or a portion of any aspect and or embodiment may be utilized with all or a portion of any other aspect and or embodiment unless stated otherwise.

