---

title: Network appliance for customizable quarantining of a node on a network
abstract: A system, method, and apparatus are directed to managing access to a network. An agent may intercept a network packet transmitted by an enforcement point in response to a request from a device to join the network. The agent identifies, based on the network packet, a port number on the enforcement point at which the request is received. The agent may transmit the port number to a NACA to enable security enforcement operations to be performed on the device. Another device may reside outside the quarantined network and be enabled by the NACA to direct a remediation measure to be performed on the device using at least the port number. The NACA may spoof an ARP response with an address of the NACA to restrict access to resources. The NACA may also place the device into one of a plurality of quarantined networks.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08520512&OS=08520512&RS=08520512
owner: McAfee, Inc.
number: 08520512
owner_city: Santa Clara
owner_country: US
publication_date: 20060731
---
The present application is a Continuation In Part of patent application Ser. No. 11 336 692 entitled Network Appliance for Securely Quarantining a Node on a Network filed on Jan. 19 2006 which claims priority from provisional application Ser. No. 60 647 646 entitled Network Appliance for Securely Quarantining a Node on a Network filed on Jan. 26 2005 the benefit of the earlier filing dates of which are hereby claimed under 35 U.S.C. 119 e and 120 and 37 C.F.R. 1.78 and which are each further incorporated by reference.

The present invention relates to network security and more particularly but not exclusively to enabling enforcement of access control on a network.

Businesses are deriving tremendous financial benefits from using the internet to strengthen relationships and improve connectivity with customers suppliers partners and employees. Progressive organizations are integrating critical information systems including customer service financial distribution and procurement from their private networks with the Internet. The business benefits are significant but not without risk. Unfortunately the risks are growing.

In response to the growing business risks of attacks potentials for legal suits federal compliance requirements and so forth companies have spent millions to protect the digital assets supporting their critical information systems. In particular many companies have recognized that the first security barrier to their business s information systems is their access control system.

Access control pertains to an infrastructure that is directed towards enforcing access rights for network resources. Access control may grant or deny permission to a given device user device or node for accessing a resource and may protect resources by limiting access to only authenticated and authorized users and or devices. Therefore there is a need in the industry for improved access control solutions. Thus it is with respect to these considerations and others that the present invention has been made.

The present invention now will be described more fully hereinafter with reference to the accompanying drawings which form a part hereof and which show by way of illustration specific exemplary embodiments by which the invention may be practiced. This invention may however be embodied in many different forms and should not be construed as limited to the embodiments set forth herein rather these embodiments are provided so that this disclosure will be thorough and complete and will fully convey the scope of the invention to those skilled in the art. Among other things the present invention may be embodied as methods or devices. Accordingly the present invention may take the form of an entirely hardware embodiment an entirely software embodiment or an embodiment combining software and hardware aspects. The following detailed description is therefore not to be taken in a limiting sense.

Throughout the specification and claims the following terms take the meanings explicitly associated herein unless the context clearly dictates otherwise. The phrase in one embodiment as used herein does not necessarily refer to the same embodiment though it may. As used herein the term or is an inclusive or operator and is equivalent to the term and or unless the context clearly dictates otherwise. The term based on is not exclusive and allows for being based on additional factors not described unless the context clearly dictates otherwise. In addition throughout the specification the meaning of a an and the include plural references. The meaning of in includes in and on. 

As used herein the term node refers to virtually any computing device that is capable of connecting to a network. Such devices include but are not limited to personal computers desktop computers multiprocessor systems mobile computing devices microprocessor based or programmable consumer electronics network PCs servers network appliances cellular phones PDAs or the like. Such devices may employ a wired and or a wireless mechanism to connect to the network.

As used herein the term Virtual Local Area Network VLAN Assignment Protocol VLAP refers to various mechanisms useable by a network device such as a switch router bridge client server or the like to request that a particular VLAN be employed for use in sending and or receiving a network packet. In one embodiment the network packet may be a request to a server. The server may use a policy look up or the like to determine the VLAN with which to respond. Thus in one embodiment a VLAP client includes client devices that are configured to employ VLAP while a VLAP server includes server devices that are configured to employ VLAP. The various mechanisms may include but are not limited to RADIUS MAC authentication VLAN Membership Policy servers VMPS or the like.

As used herein spoof and or spoof poisoning refers to the process of modifying information used by one device to send network packets to a second device by replacing the original destination address of the second device with the address of a spoofing device or any other network device to cause the device to send all or substantially all traffic to the address of the spoofing device instead of the intended second device.

As used herein 802.1x protocol or 802.1x refers to the standard IEEE 802.1X authentication protocol. The IEEE 802.1X authentication standard uses an existing protocol Extensible Authentication Protocol EAP for message exchange during an authentication process. Thus 802.1X may employ a variety of EAP authentication mechanisms including but not limited to MD5 Transport Layer Security TLS Tunneled Transport Layer Security TTLS Lightweight EAP LEAP PEAP or the like. 802.1X is configured to work over Ethernet Token rings and other wired as well as wireless networks. Typically in a wireless network with 802.1X a client device requests access to a resource through an 802.1X enabled switch access point or the like sometimes called an authenticator. The client device may then provide an EAP message to the switch. In one embodiment the message may be an EAP start message. In turn the switch may provide an EAP message to the client device requesting its identity. When the client provides its identity the switch may repackage the identity and forward it to an authentication server. The authentication server may then authenticate the client device and return an accept or reject message to the switch. In one embodiment the authentication server may employ a Remote Authentication Dial In User Service RADIUS however the invention is not so limited and virtually any authentication service may be employed including an X.509 Certification Authority server or the like. As used throughout this application including the claims 802.1X refers to the IEEE 802.1X protocol and all authentication protocols derived therefrom.

Briefly stated the present invention is directed towards an apparatus system and method for managing dynamic network access control. In one embodiment the invention enables management of network access control at a network switch port level. The invention provides services and controlled network access that includes quarantining nodes so that they may be identified audited and provided an opportunity to be brought into compliance with a security policy or the like. The invention is configured to detect a device seeking to join or otherwise access the network identify a switch port that the device is attempting to connect to and determine if the device is authentic and authorized to join the network. In one embodiment the network may be an intranet such as an enterprise s intranet or the like. If it is determined that the device is unauthorized and or unauthentic the device may be quarantined. In one embodiment the suspect device is quarantined using for example a Virtual Local Area Network VLAN . The act of quarantining the suspect device may also be explained to a user of the suspect device allowing the user and or device to be identified and registered. The suspect device may then be audited to determine if there are vulnerabilities that might further prevent the device from connecting to the network. If vulnerabilities are determined in one embodiment remediation action may be employed to guide the suspect device user and or administrator of the suspect device towards a resolution of the vulnerabilities such that the device may be reconfigured for acceptance onto the network.

An alternate embodiment of the present invention is directed towards a system method and apparatus for managing access to a network. An agent may intercept an network packet transmitted by an enforcement point in response to a request from a device to join the network. The agent identifies based on the network packet a port number on the enforcement point at which the request is received. The agent may transmit the port number to a NACA to enable security enforcement operations to be performed on the device. Another device may reside outside the quarantined network and be enabled by the NACA to direct a remediation measure to be performed on the device. The NACA may spoof an ARP response with an address of the NACA to restrict access to resources. The NACA may also place the device into one of a plurality of quarantined networks.

Moreover the network includes any computing communication infrastructure that may be configured to couple one computing device to another computing device to enable them to communicate. Such networks are enabled to employ any form of computer readable media for communicating data from one electronic device to another. Generally such networks can include the Internet in addition to local area networks LANs wide area networks WANs direct connections such as through a universal serial bus USB port other forms of computer readable media or any combination thereof. On an interconnected set of LANs including those based on differing architectures and protocols a router acts as a link between LANs enabling messages to be sent from one to another. Also communication links within LANs can include for example twisted wire pair or coaxial cable while communication links between networks may utilize analog telephone lines full or fractional dedicated digital lines including T1 T2 T3 and T4 Integrated Services Digital Networks ISDNs Digital Subscriber Lines DSLs wireless links including satellite links or other communications links known to those skilled in the art. Furthermore remote computers and other related electronic devices can be remotely connected to either LANs or WANs via a modem and temporary telephone link.

Networks may further employ a plurality of access technologies including 2nd 2G 3rd 3G generation radio access for cellular systems WLAN Wireless Router WR mesh or the like. Access technologies such as 2G 3G and future access networks may enable wide area coverage for mobile devices such as a mobile device with various degrees of mobility. For example such networks may enable a radio connection through a radio network access such as Global System for Mobil communication GSM General Packet Radio Services GPRS Enhanced Data GSM Environment EDGE Wideband Code Division Multiple Access WCDMA or the like. In essence such networks may include virtually any wireless and or wired communication mechanism by which data may travel between one computing device and another computing device.

The media used to transmit data in communication links as described above illustrates one type of computer readable media namely communication media. Generally computer readable media includes any media that can be accessed by a computing device. Computer readable media may include computer storage media communication media or any combination thereof.

Additionally communication media typically embodies computer readable instructions data structures program modules or other data in a modulated data signal such as a carrier wave or other transport mechanism and includes any data delivery media. The terms modulated data signal and carrier wave signal includes a signal that has one or more of its characteristics set or changed in such a manner as to encode data instructions data or the like in the signal. By way of example communication media includes wired media such as twisted pair coaxial cable fiber optics wave guides and other wired media and wireless media such as acoustic RF infrared and other wireless media.

In one embodiment the invention is directed towards providing protection for substantially every node from substantially every other node on an internal network e.g. intranets in part by preventing unauthorized or vulnerable nodes from fully connecting to the internal network. The invention may employ an apparatus such as a network appliance to perform network access enforcement.

As shown in the figure system includes security administrator auditor resources network administrator outside intelligence NACA directory services enforcement point device in question and end user .

Security administrator is in communication with auditor . Auditor is in communication with NACA and device in question . NACA is also in communication with resources network administrator outside intelligence directory services enforcement point and device in question . End user is in communication with device in question . Device in question is in further communication with enforcement point .

Device in question may include virtually any computing device that is configured to receive and to send information over a network. Such devices may include portable devices such as cellular telephones smart phones display pagers radio frequency RF devices infrared IR devices Personal Digital Assistants PDAs handheld computers wearable computers tablet computers integrated devices combining one or more of the preceding devices or the like. Device in question may also include other computing devices such as personal computers multiprocessor systems microprocessor based or programmable consumer electronics network PCs or the like. As such device in question may range widely in terms of capabilities and features. For example a client device configured as a cell phone may have a numeric keypad and a few lines of monochrome LCD display on which only text may be displayed. In another example a web enabled client device may have a touch sensitive screen a stylus and several lines of color LCD display in which both text and graphics may be displayed. Moreover the web enabled client device may include a browser application enabled to receive and to send wireless application protocol messages WAP and or wired application messages or the like. In one embodiment the browser application is enabled to employ HyperText Markup Language HTML Dynamic HTML Handheld Device Markup Language HDML Wireless Markup Language WML WMLScript JavaScript EXtensible HTML xHTML Compact HTML CHTML Voice XML or the like to display and send a message.

Device in question also may include at least one client application that is configured to receive content from another computing device. The client application may include a capability to provide and receive textual content graphical content audio content alerts messages notifications or the like. Moreover device in question may be further configured to communicate a message such as through a Short Message Service SMS Multimedia Message Service MMS instant messaging IM interne relay chat IRC mIRC Jabber Enhanced Messaging Service EMS text messaging Smart Messaging Over the Air OTA messaging or the like between another computing device or the like.

Enforcement point may include virtually any computing device that is configured to control the flow of network traffic. As shown enforcement point may include a network switch an enterprise switch a workgroup switch a Virtual Private Network VPN concentrator a Wi Fi access point or the like. Enforcement point may accept Simple Network Management Protocol SNMP requests to enable the control of the flow of network traffic. Enforcement point may also provide detection of the flow of network traffic. As shown NACA provides controls to enforcement point and enforcement point provides detection information to NACA . Also as shown enforcement point provides network traffic enforcement information such as Dynamic Host Configuration Protocol DHCP information to device in question . The enforcement information may enable device in question to route its network traffic appropriately.

End user may include virtually any computing device that is configured to receive and to send information over a network. End user may also include a user in control of the computing device wherein the user may be enabled to direct the resources and operations of another computing device. As shown end user may provide such directions and operations to device in question . In one embodiment end user may be a computing device enabled by user to provide directions and operations to device in question .

Resources represent virtually any computing device that is configured to provide remediation information over a network. Resources may include a database server a file server or the like. As shown resources may provide remediation information to NACA . However resources are not limited to merely providing remediation information. For example resources may also be configured to operate as website servers. However resources are not limited to web servers and may also operate a messaging server a File Transfer Protocol FTP server a database server content server or the like. Additionally each of resources may be configured to perform a different operation. Thus for example one of resources may be configured as a messaging server while another of resources may be configured as a database server. Moreover while s resources may operate as other than a website they may still be enabled to receive an HTTP communication. Devices that may operate as resources include personal computers desktop computers multiprocessor systems microprocessor based or programmable consumer electronics network PCs servers or the like.

Outside intelligence represents virtually any computing device that is configured to provide network intelligence information over a network including but not limited to antivirus information security agents security patches updates or the like. As shown outside intelligence may provide such information to NACA .

Directory services represent virtually any computing device that are configured to provide identity and permission information about a device network and or user over a network. As shown directory services may provide such information to NACA .

Auditor represents virtually any computing device that is configured to perform a security assessment audit of device in question and provide intelligence about device in question . In one embodiment the audit may be performed periodically on demand or based on a configuration and or detection of an event or the like. As shown auditor may provide such intelligence about device in question to NACA .

Security administrator may include virtually any computing device that is configured to receive and to send information over a network. System administrator may also include a user in control of the computing device wherein the user may have permissions to provide security information about a device network or the like. In one embodiment security administrator may be a computing device enabled by a user to provide such security information.

Network administrator may include virtually any computing device that is configured to receive and to send information over a network. Network administrator may also include a user in control of the computing device wherein the user may have permissions to provide information about a network security network topology configuration or the like. In one embodiment network administrator may be a computing device enabled by a user to provide such networking information.

NACA may include virtually any computing device that is configured to determine whether a new device may gain access to a network. As shown NACA is configured to interface to directory services to determine authorization of a user and or device. NACA may detect a new device attempting to connect to the network. As illustrated the new device may be device in question . In one embodiment NACA detects access attempts and manages access control at enforcement point . In one embodiment NACA may detect access attempts and manage access control at the switch port level.

NACA may quarantine the new device suspect node that is not authorized to connect to the network. NACA is not constrained to manage access control based solely on device authorization however. For example NACA may determine to quarantine a new device suspect node based on a user not being authorized a device not having been audited or audited within a defined time period an audit result intelligence that does not conform to a policy and or based on virtually any other intelligence about a device and or user that may indicate policy nonconformance. In one embodiment NACA may determine to quarantine a new device suspect node based on end user not being authorized to connect to the network access a resource or the like. In one embodiment NACA may receive the policy from auditor security administrator or the like. NACA may also receive intelligence about a device and or user that may indicate policy nonconformance from outside intelligence .

NACA may be configured to operate in one embodiment providing a policy that defines which sites servers or the like a quarantined device may access. NACA may operate with virtually any of a variety of switches routers gateways or the like to securely quarantine the device. In one embodiment NACA may employ an enterprise switch to quarantine the suspect device. However NACA does not require most switches to have updated hardware or firmware. In another embodiment NACA may quarantine the suspect node by employing Enforcement Point .

NACA may redirect quarantined devices such as device in question to a friendly web site where a user device and or the like may register schedule an audit find audit results intelligence and or receive remediation information. In one embodiment NACA may redirect quarantined devices to resources which may provide remediation information.

NACA may also be configured to provide a single point of control and reporting for an entire enterprise while remaining massively scalable. NACA is further configured to be easy to deploy and manage at least in part because it does not require agents. NACA recognizes that use of agents may result in decreased security for a variety of reasons including because they may require compatibility testing for critical systems may be accidentally or intentionally disabled may be cumbersome to deploy and maintain unsuitable for guests as well as potentially being unavailable for every type of device operating system or the like. However NACA is capable of receiving information from an agent when one is available.

Moreover NACA may operate with other protection initiatives. Additionally because in one embodiment it uses switches to enforce quarantine at OSI layer 2 rather than relying on DHCP NACA may increase security over more traditional initiatives.

NACA may be further configured to provide intelligence to wireless products thereby preventing rogue access points on a network. While a firewall may be directed towards blocking external threats to a network NACA further blocks internal as well as external threats. In one embodiment NACA may provide a VPN like access control to virtually an internal port.

NACA may be configured to verify that such applications as antivirus firewalls spyware detectors or the like are installed running properly configured and kept up to date before letting a device on a network. In one embodiment NACA may receive such intelligence from outside intelligence .

NACA may also ensure that a patch management product is operational and has successfully performed its actions upon a device. In one embodiment NACA can provide restricted access to quarantined devices so that patches can be deployed onto the device before joining the network.

NACA may employ auditor to perform an assessment of a device in question and provide intelligence to NACA . In one embodiment auditor may be an auditor network appliance device or the like. NACA is not constrained to receiving intelligence from an auditor however. NACA may receive intelligence about the network device in question or the like from virtually any source including an anitvirus application firewall spyware detector and even an agent. In one embodiment NACA may receive such intelligence from outside intelligence . NACA may employ policies provided by an administrator such as security administrator or network administrator and to provide reports to those administrators regarding the network device in question or the like. Based in part on the received intelligence and the policies NACA provides remedies to device in question directs enforcement point on how to enforce the policy or the like.

As illustrated switch is in communication with Internet devices firewall and auditor . Switch is in communication with NACA devices and core switch . Switch is in communication with NACA devices and core switch . Switch is in communication with NACA devices and core switch . Core switch is in communication with devices firewall auditor directory services management console and switches .

Devices may include virtually any computing device that is configured to receive and to send information over a network. Devices may operate substantially similar to device in question of . For example devices may request access to a network through a switch.

Auditors represent virtually any computing device that is configured to perform a security assessment audit of a device in question and provide intelligence about the device in question. Auditors may operate substantially similar to Auditor of . In one embodiment the suspect node device in question may be at least one of devices .

Directory services represent virtually any computing devices such as external enterprise directories that are configured to provide identity and permission information about a device network and or user over a network. Additionally directory services may operate substantially similar to directory services of .

Management console represents virtually any computing device that is configured to provide a single point of control of several NACAs including NACAs . In one embodiment not shown an administrator may be in communication with management console .

Switches and firewall may include virtually any computing device that is configured to control the flow of network traffic. For example switches and or core switch may be implemented as a router bridge network switch network appliance or the like. Switches and firewall may operate substantially similar to enforcement point of . For example switches and firewall may be employed to quarantine a suspect node device in question. Additionally firewall may include computing devices such as routers proxy servers gateways or the like that include software filters for shielding trusted networks within a locally managed security perimeter from external untrusted networks such as Internet . Moreover core switch may operate to separate or filter network traffic between an intranet network and an external network such as the internet.

NACAs may include virtually any computing device that is configured to enable a new device to gain access to a network and may operate substantially similarly to NACA . As shown NACAs may operate on either side of core switch providing support to a network segment within an intranet. In one embodiment NACAs may quarantine a suspect node device in question by employing at least one of switch core switch auditor and or firewall . In one embodiment NACAs may quarantine a suspect node device in question through a firewall such as firewall . NACAs may also receive intelligence about a device and or user that may indicate policy nonconformance from auditor through firewall . NACAs may also receive such intelligence from auditor through core switch .

As shown system includes enterprise directory service selected servers sites auditor console for multiple NACA remediation file server intranet workgroup switch devices new device and NACA . Workgroup switch may include 802.1x authenticator VLAP client switch management and SMNP management . NACA may includes Simple Network Management Protocol SNMP client SNMP trap sink 802.1x authentication server VLAP server proxy web server router web server directory service DHCP and audit extender .

As shown in the figure console for multiple NACA auditor enterprise directory service selected servers sites and remediation file server are in communication with workgroup switch through intranet . Intranet enables communication between console for multiple NACA auditor enterprise directory service selected servers sites and remediation file server and workgroup switch . Workgroup switch may be further in communication with a NACA . In one embodiment not shown console for multiple NACA auditor enterprise directory service selected servers sites and remediation file server may be in communication with NACA through a communication mechanism such as a secure channel a Simple Object Access Protocol SOAP connection a Secure Socket Layer SSL connection or the like. Although not shown console for multiple NACA may also be in communication with other switches and or other NACAs substantially similar to the components illustrated in . In one embodiment as shown new device is in communication with workgroup switch . Devices may also be in communication with workgroup switch .

Console for multiple NACA may be include virtually any computing device enabled to control at least one NACA such as NACA and or other NACAs. In one embodiment console for multiple NACA may operate substantially similar to management console of .

Auditor represents virtually any computing device that is configured to perform a security assessment audit of a device in question and provide intelligence about the device in question. In one embodiment auditor performs actions substantially similar to auditor of and may provide intelligence about a device and or user that may indicate policy nonconformance.

Enterprise directory service represent virtually any computing device such as an external enterprise directory that is configured to provide identity and permission information about a device network and or user over a network. In one embodiment enterprise directory service performs actions substantially similar to directory services of and may provide authorization information about a device and or a user of the device.

Selected servers servers and remediation files server represent virtually any computing device that is configured to provide remediation information over a network. Selected servers servers and remediation files server may provide remediation information to a quarantined device substantially similar to resources of .

Workgroup switch includes may include virtually any computing device that is configured to control the flow of network traffic. In one embodiment workgroup switch performs actions substantially similar to enforcement point . The components illustrated within workgroup switch may be employed in quarantining a device auditing the device granting the device access to some resources routing network traffic from the device to a NACA such as NACA or the like.

Devices may include virtually any computing device that is configured to receive and to send information over a network. Devices may operate substantially similar to device in question of . Devices may be previously audited and authorized devices and may have been granted access to the network. New device may represent a device that has requested access to a network through a workgroup switch .

NACA is not limited to the components illustrated within and more or less components may be implemented within NACA without departing from the scope of spirit of the invention. Moreover its components may be employed in conjunction with workgroup switch to quarantine a device audit the device provide remediation guidance to the device grant the device access to some resources or the like. In one embodiment NACA may be implemented employing a configuration such as is described in more detail below in conjunction with .

As shown SNMP trap sink 802.1x authentication server VLAP server proxy web server and router web server and plug in security modules are in communication with an Apache via SOAP HTTP or the like. Web browser may be in communication with Apache via HTML HTTPS. PHP may also be in communication with Apache through an API interface. Directory service SNMP client Apache debug tool Ironbars and SQL database are in communication with SAL . User interface may be in communication with PHP and in further communication with Apache via SOAP HTTP. SQL database may be in communication with audit extender and in further communication with directory service via LDAP.

SAL may include any computing service enabled to provide a security policy for use in quarantining nodes so that they may be identified audited and provided an opportunity to be brought into compliance with the security policy. SAL may also enable Apache Dynamic Shared Objects DSO COM objects or the like. These objects may implement the logic of SAL . In one embodiment SAL in conjunction with SNMP Trap Sink 802.1x Authentication Server VLAP server Proxy Web Server and Router Web Server may detect a device seeking to join the network identify a switch port that the device is attempting to connect to determine if the device is authentic and authorized to join the network and as appropriate quarantine the device grant the device access to the network or the like. An enterprise security system such as Ironbars may be in communication with and control of SAL . Debug tool may any computing device enabled to monitor and modify the operation of SAL via SOAP. Directory Service and SQL database may be in communication with SAL via LDAP. SQL database may act as an internal directory service and store any previous audit results intelligence associated with a suspect device. SQL database may also store some or all of the security policy information. Correspondingly audit extender may provide audit results intelligence to SQL database .

Web browser may be any web client software and or device enabled to provide information to a web server such as Apache . Apache may be an Apache web server but may be any other variety of web server. In one embodiment web browser provides the user interface for administering NACA of providing policies reporting remediation guidance or the like.

Plug in Security Modules may also be in communication with Apache via SOAP HTTP and may be enabled to direct the security measures associated with SNMP trap sink 802.1x authentication server VLAP server proxy web server and router web Server SAL or the like. PHP includes any software and or device enabled to provide the operating logic for Apache . However any enterprise software may be in communication with Apache and may provide the logic for the user interface embodying the invention. For example PHP may direct user interface to provide information to and retrieve information from SQL Database .

As shown policy engine is in communication with generic I O such as web browser of or the like configuration database and SAL API . Default policies is in communication with loader . Loader is in communication with configuration database . Configuration database is in communication with loader . Loader is in further communication with switch data library and SAL database . SAL is in communication with I O to switches SAL API SAL support utilities and SAL database .

In one embodiment generic I O policy engine SAL API switch adaptation layer SAL SAL support utilities and I O to switches may be embodied by SAL of . Policy engine may provide its Application Programming Interface API user interface or the like via generic I O . In one embodiment generic I O may provide a user interface for administering NACA of or the like. Default policies may operate as a database for storing security policies. In one embodiment default policies may operate substantially similar to SQL database of . Default policies provide the security policies to loader which in turn provides information to configuration database . In one embodiment configuration database may operate substantially similar to SQL Database of . Configuration database may provide security policies and configuration information to policy engine . Configuration database may also provide information to loader . Switch data library may also provide information about a switch to loader . In one embodiment the information may be configuration information security information dynamically loaded libraries objects or the like of a switch substantially similar to enforcement point of . SAL database may receive the information from loader and provide the information to SAL . SAL support utilities may also enable various configuration and control of SAL . Policy engine may control SAL via SAL API . Correspondingly SAL may provide information to policy engine via SAL API . In one embodiment policy engine may enable SAL to detect a device seeking to join the network identify a switch port that the device is attempting to connect to determine if the device is authentic and authorized to join the network and as appropriate quarantine the device grant the device access to the network or the like. SAL may provide its API user interface or the like via I O to switches .

As shown SNMP trap sink proxy web server and router web server Ironbars comm BIND auditor and new device are in communication with workgroup switch . Although not shown VLAP server 802.1x authentication server and directory service may also be in communication with workgroup switch . Workgroup switch may be in communication with an internet such as Intranet . CLI is in communication with administrator and demo core . Demo core is in communication with SNMP client SNMP trap sink and Ironbars comms . Static page is in communication with proxy web server and router web server . Live data is in communication with DHCP server . Fake DB is in communication with BIND .

As shown new device may include any computing device seeking to join a network by linking to workgroup switch . BIND may provide DNS information to Workgroup Switch . However virtually any other DNS servers may be utilized. In one embodiment fake DB may provide temporary domain names IP numbers DNS information or the like to the workgroup switch . New device and or other device seeking to join the network may be assigned temporary domain names IP numbers DNS information or the like. In another embodiment fake DB may provide such information associated with an intranet the Internet an enterprise network or the like. IronBars Comms may be virtually any computing device that is enabled to provide security measures for workgroup Switch . In one embodiment IronBars comms may operate substantially similar to Ironbars . As shown CLI may be in device that is enabled to direct demo core to perform operations as described in conjunction with and . In one embodiment demo core enables policies switch configuration information IP addresses port numbers VLAN numbers routes OIDs or the like. In one embodiment the information may be hard coded. In another embodiment such information may be dynamic and modifiable. CLI and demo core may operate substantially similar to SAL of and may detect a device seeking to join the network identify a switch port that the device is attempting to connect to determine if the device is authenticate and authorized to join the network quarantine the device grant the device access to the network or the like. Administrator may be any user and or device that is enabled to provide CLI with policies remediation instructions quarantine instructions or the like. In turn CLI may provide security reports reports about the current usage of VLANS associated with workgroup switch the default routes enabled by DHCP server audit results intelligence or the like to administrator .

As shown SW VLAN MAC table device vulnerability policy table global vulnerability policy table DHCP table ARP table WEB authentication table LDAP table RADIUS table and policy engine table may be accessible by and in communication with configuration engine . Policy entity table may be accessible by and in communication with policy engine . Additionally policy engine is in communication with vulnerability assess event and events handler .

As shown a policy database entry may be formed using a listed database table on the switch external servers and internal processes are employed to make two binds an IP MAC and a user IP bind. However the invention is not so limited and more or less binds and well as other binds may also be provided. In one instances user identity is not required since an actuator might not be employed to manage a user device.

The policy database includes three areas vulnerability scan prescription authentication provision and a quarantine policy. As shown vulnerability assess event enables the vulnerability scan prescription. Events handler enables authentication provisions such as detections of traps timing events or the like and the enablement of the control of authentication provisions. Policy engine enables the quarantine policy and may operate substantially similar to policy engine and directs how to interpret vulnerability and authentication results and a corresponding quarantine action. In one embodiment the quarantine policy may be enforced using any one or combination of IP MAC port address or the like. Policy engine may also enable other policies including authentication policies auditing schedules or the like. Policy Engine receives policy information from policy entity table which in turn provides the policy information to Configure Engine .

Configure engine may receive information from various configuration sources which may enable the configuration of the authentication policies auditing schedule quarantine policies or the like. Configuration Engine may also operate substantially similar to Policy Engine of SAL of or the like. Configuration engine may receive configuration information from various database tables ARP table DHCP table SW VLAN MAC table which contains VLAN and MAC address information device vulnerability policy table which contains device vulnerability policies global vulnerability policy table which contains global vulnerabilities policies WEB authentication table LDAP table and RADIUS table .

Thus as shown system of includes web server provision interface database administrator DBA database policy engine DHCP server relay auditor authentication channel directory service channel and SNMP command channel .

As shown provision interface is in communication with web server DBA and policy engine . DBA is in further communication with database policy engine DHCP server relay and auditor . Policy engine is also in communication with auditor authentication channel directory service channel and SNMP command channel .

As shown database may be served by a database administrator DBA that warrants the synchronization of the data provides an interface to internal modules that are independent of a database change or the like. In one embodiment database may contain tables substantially similar to those illustrated in . The database may be distributed in one embodiment. Web server may operate substantially similar to proxy web server router web server of Apache of or the like. Web server may provide administrator commands policies or the like to provision interface which may configure the information and route the information to DBA and policy engine . Policy engine may operate substantially similar to policy engine of SAL of or the like. DHCP is enabled by DHCP server relay . Auditor operates substantially similar to auditor of . Authentication channel operates substantially similar to VLAP server and 802.1x authentication server of and may enable the authentication of a new device seeking to join the network. Where DHCP and authentication is distributed Policy engine may employ directory service channel to obtain information including authentication information about a user and or a device. Policy engine may also use SNMP command channel to monitor and control a switch on which a new device may be seeking to gain access to a network. In one embodiment not shown the switch may be workgroup switch of .

Network appliance includes processing unit and a mass memory all in communication with each other via bus . The mass memory generally includes RAM ROM and one or more permanent mass storage devices such as hard disk drive tape drive optical drive and or floppy disk drive. The mass memory stores operating system for controlling the operation of network appliance . Any general purpose operating system may be employed. Basic input output system BIOS is also provided for controlling the low level operation of network appliance . As illustrated in network appliance also can communicate with the Internet or some other communications network via network interface unit which is constructed for use with various communication protocols including the TCP IP protocol. Network interface unit is sometimes known as a transceiver transceiving device network interface card NIC or the like.

Network appliance may also include an SMTP handler application for transmitting and receiving email. Network appliance may also include an HTTP handler application for receiving and handing HTTP requests and an HTTPS handler application for handling secure connections. The HTTPS handler application may initiate communication with an external application in a secure fashion.

Network appliance also includes input output interface for communicating with external devices such as a mouse keyboard scanner or other input devices not shown in . Likewise network appliance may further include additional mass storage facilities such as hard disk drive . Hard disk drive is utilized by network appliance to store among other things application programs databases or the like.

The mass memory as described above illustrates another type of computer readable media namely computer storage media. Computer storage media may include volatile nonvolatile removable and non removable media implemented in any method or technology for storage of information such as computer readable instructions data structures program modules or other data. Examples of computer storage media include RAM ROM EEPROM flash memory or other memory technology CD ROM digital versatile disks DVD or other optical storage magnetic cassettes magnetic tape magnetic disk storage or other magnetic storage devices or any other medium which can be used to store the desired information and which can be accessed by a computing device.

The mass memory also stores program code and data. One or more Applications are loaded into mass memory and run on operating system . Examples of application programs include email programs schedulers calendars web services transcoders database programs word processing programs spreadsheet programs and so forth. Application programs may further include those components described below in conjunction with including SNMP client SNMP trap sink 802.1x authentication server VLAP server proxy web server a router such as router web server directory service and audit extender that is configured to enable an audit across multiple network segments through a firewall or the like. However the invention is not limited to these applications and others may be implemented without departing from the scope of spirit of the invention. Mass storage may further include network access manager . In one embodiment network access manager enables the components of applications to quarantine a suspected device so that it may be identified audited and provided an opportunity to be brought into compliance with a security policy. In one embodiment network access manager may operate substantially similar to configuration engine of policy engine of SAL of or the like. Network access manager may be configured to perform at least those actions described in conjunction with and .

The operation of certain aspects of the invention will now be described with respect to and . illustrates embodiments of a process for enabling a new device to seek access to a network. one embodiment that may be used to summarize the process embodied by . Additionally illustrates substantially the same system topology and components as described in .

Processing begins at where NACA detects new device s attempt to access or otherwise join the network. Such attempt to access or join the network may be associated with a request to access a resource within the network. Typically the attempt may include an attempt to access a resource within a network such as an enterprise s intranet or the like. illustrates one embodiment of a possible configuration using a Virtual Local Area Network VLAN membership policy server. In one embodiment NACA may employ a VLAP server and VLAP client to detect that new device has requested to join the network based on some VLAP.

In an alternate embodiment illustrates NACA detecting new device s attempt to join the network. In one embodiment workgroup switch is set to employ 802.1x authenticator with NACA as the authenticator. In one embodiment the 802.1x protocol may be a wireless network access protocol. For example if new device has successfully been authenticated using an 802.1x protocol NACA may authorize new device to access or otherwise join the network. However the invention is not constrained to using 802.1x authentication and other authentication mechanisms may be employed without departing from the scope or spirit of the invention.

The process then moves to where NACA employs SNMP client 802.1x authentication server and switch management to read a bridging tale on the switch and determines a switch port number for a MAC address associated with new device . If the MAC address is valid NACA may enable new device s access to the network. In another embodiment if the MAC address is invalid NACA may quarantine new device or the like.

The process continues to where an authentication mechanism such as 802.1x authentication server triggers a change in the VLAN assignment for the port and the switch is reconfigured to enable management by NACA . In one embodiment the authentication mechanism is configured to generally accept virtually all requests. NACA may then quarantine new device by placing new device on a purgatory VLAN. As illustrated the purgatory VLAN is logically separated from a normal VLAN. In one embodiment purgatory VLAN may enable access to fewer resources than normal VLAN. For example purgatory VLAN may enable access to selected servers sites and or remediation file server .

The process then flows to where an alternative embodiment is illustrated that does not employ an 802.1x protocol. In this embodiment SNMP traps are employed to detect new device s established link. For example NACA may employ SNMP client SNMP trap sink and SNMP management to detect new device s established link. New device may again be placed in purgatory.

The process continues to from either and or to where new device is configured with a default route by NACA . As shown NACA operating as a DHCP server sets the default route to itself. In one embodiment NACA employs DHCP server to set the default route to itself.

As the process flows to web traffic may then be steered towards NACA . In one embodiment web traffic may be Hyper Text Transfer Protocol HTTP network traffic. Thus any web traffic goes through the default route. In one embodiment the default route is through router web server that serves all addresses for new device . Non web traffic may be configured to go through NACA . In one embodiment the non web traffic goes nowhere.

At new device and or a user associated with new device is registered. In one embodiment a registration server checks user credentials and or device credentials. In one embodiment router web server may act as the registration server receiving registration information from new device via an HTTP channel and verifying the validity of the credentials. Interfaces to an external directory service to determine the validity of the credentials may be via Lightweight Directory Access Protocol LDAP or the like. For example enterprise directory service may provide the validity of the credentials to directory service via LDAP. An internal directory service may also be employed to include any previous audit results intelligence associated with new device . Directory service may in turn provide the information to router web server so that router web server may verify the validity of the credentials.

At a request may be made to audit new device . In one embodiment auditor may provide intelligence to directory service via SOAP about new device and or the user of new device that may indicate policy nonconformance. The intelligence may also be provided to router web server which may in turn provide the intelligence to a device a user an administrator or the like.

Processing continues to where an audit mechanism such as auditor is employed to perform the requested audit. In one embodiment the audit mechanism may be a sub component of the NACA. For example audit extender may act alone or in conjunction with auditor as the auditor mechanism. Auditor and or audit extender may provide intelligence about new device and or the user of new device that may indicate policy nonconformance. In one embodiment auditor and audit extender are in communication via a secure channel such as an SSL TLS channel or the like. Additionally auditor and or audit extender may audit new device through an audit channel a secure channel such as an SSL TLS channel or the like. For example the audit channel may be the DHCP default route described in .

At illustrates one embodiment of Auditor providing the audit results intelligence to NACA via SOAP. The invention however is not constrained to the use of SOAP and another mechanism may also be used. The intelligence may also be provided to directory service via SOAP or another mechanism. In turn directory service may provide the intelligence to router web Server .

At if the audit results intelligence is determined to be satisfactory new device is accepted and the port is re assigned into a normal VLAN. In one embodiment SNMP client and switch management re assign the port into a normal VLAN. Processing continues to where new device then gets new DHCP information from DHCP Server and a proper default route. At new device then is provided network access.

However at if it is determined that the audit results intelligence is unsatisfactory for any of a variety of reasons new device is determined to be a vulnerable device and remediation may be provided. Router web server may act as restricted proxy server in one embodiment to allow access to remediation instructions downloads or the like. Proxy web server may also provide remediation guidance. Proxy web server and Router web server may direct web traffic from new device to remediation file server and auditor . Remediation file server may provide remediation guidance to new device based on the audit results intelligence provided by auditor .

Process begins after a start block at block where a device attempts to access or otherwise join a network. In one embodiment the device may request to join a network in order to gain access to a resource such as a server database or the like. In one embodiment the NACA may detect that the device is requesting to join the network and may manage access control at a network switch port level. For example the NACA may identify the switch port associated with the device.

Processing then continues to decision block where it is determined if the device is authorized to join the network. In one embodiment the NACA may quarantine a device suspect node that is not authorized to connect to the network. In another embodiment the NACA may quarantine the device that is not authentic and or authorized to connect to the network. The NACA may determine whether the device is authorized or authentic by at least employing SNMP to read a bridging tale on an enforcement point determining if a MAC address associated with the device is authorize performing 802.1x authentication on the device or the like.

If the determination is that the device is authorized then the device is granted access to the network and the process flows to block . In one embodiment the device may be granted access to the some resources on the network. However if the determination is that the device is not authorized to join the network then processing continues to decision block .

At decision block it is determined if an audit is to be performed. The NACA may determine that the device is to be audited based on a user associated with the device not being authorized a device not having been audited or not having been audited within a given time period an audit result intelligence does not conform to a policy or virtually any other intelligence about a device and or user that may indicate policy nonconformance based on a result or the like. In one embodiment the NACA may receive such intelligence from Auditor of Outside Intelligence or the like. The NACA may also be configured to interface to external enterprise directories such as Directory Services to determine authorization credentials or the like.

At decision block if it is determined that the device is to be audited then processing continues to block where the device is denied access to the network. In one embodiment the device may be denied access to the some resources while provided restricted access to another resource. Processing then continues to block where an audit is scheduled. In one embodiment scheduling of the audit may result in placing the device into an audit queue or the like where the device may wait until it is audited. When it is audited processing continues to block . In one embodiment the audit is performed by Auditor of or Auditor of and or Audit Extender .

However if at decision block the audit is not to be performed on the device then processing continues to block where the device may be placed into purgatory where the device may be quarantined. In one embodiment the NACA may place the device in purgatory by providing a policy that defines which sites servers or the like the device may access and or how. For example in one embodiment placement into quarantine may result in some or all of the device s network traffic being filtered through the NACA or other device. In one embodiment the network traffic may be further blocked redirected or the like based on being within quarantined. The NACA may operate with virtually any of a variety of switches routers gateways or the like to securely quarantine the device. In one embodiment the NACA employs an enterprise switch to place the device in purgatory. In another embodiment the NACA may quarantine the device by placing the device on a purgatory VLAN and sending to the device explanatory information relating to the quarantining the device. The NACA may place the device on the purgatory VLAN by employing at least one of an SNMP trap VLAP or an 802.1x protocol to detect a request to join the network by the device and assigning the device DHCP information which restricts access to the network or the like. In yet another embodiment the NACA may place the device in purgatory by providing a VPN like access control to every internal port. The NACA may also place a device in purgatory by redirecting the device to a friendly web site a proxy web site or the like. The friendly web site the proxy web site or the like may enable a user an administrator a device or the like to register schedule an audit find audit results intelligence and receive remediation information. In one embodiment network traffic from the device may be routed through the NACA to be examined filtered and or redirected as appropriate.

Processing next continues to decision block where a determination is made whether the user and or device registered successfully. In one embodiment a registration server checks user credentials and or device credentials. For example Router Web Server of may act as the registration server receiving registration information from the device via an HTTP channel and verifying the validity of the credentials and thus the success of the registration. If the user and or device register successfully then processing continues to block . Otherwise processing continues to block .

If at decision block the user and or device did not register successfully then processing continues to block where the NACA schedules an audit. In one embodiment the device may be placed into a wait queue to be audited. In another embodiment the device may be audited almost at once in which case processing proceeds to block .

At block an audit is performed on the device based on a policy. In one embodiment the audit is performed by Auditor of or Auditor of and or Audit Extender . To perform the audit the NACA may produce an intelligence based on at least one of whether at least one of antivirus detectors firewalls or spyware detectors are installed on the device running properly configured and kept up to date whether a patch management product is operational and has successfully performed patching actions upon the device and whether a positive second intelligence about the network is received from an auditing component and or an outside intelligence component such as Outside Intelligence or the like. However the NACA need not receive such intelligence from an auditing component. The NACA may receive intelligence about the network device in question or the like from virtually any source including an auditor appliance an anitvirus application firewall spyware detector and even an agent. The NACA may employ policies provided by an administrator such as Security Administrator and or Network Administrator shown in and provide reports regarding the network device in question or the like. Processing next continues to decision block .

At decision block it is determined if a result of the audit is satisfactory. In one embodiment the result of the audit is unsatisfactory if a vulnerability is determined to exist. For example vulnerabilities may exist if such applications as antivirus firewalls spyware detectors or the like are not installed running properly configured or kept up to date. If the result of the audit is satisfactory processing continues to block .

However if at decision block the result of the audit is unsatisfactory processing continues to block where an attempt may be made to resolve the unsatisfactory audit result. In one embodiment the NACA may guide the user associated with the device an administrator associated with the device or the device itself to resolve the vulnerabilities or other unsatisfactory audit result. In one embodiment resolving the unsatisfactory audit result may include granting the network device restricted access to quarantined devices deploying a remediation guidance such as patches and downloads to the network device enabling the user associated with the device the administrator associated with the device or the device itself to find a result of a previous audit and enabling scheduling of another audit. Processing then continues to block where the device is denied access to the network. As described above processing then continues to block where audit is scheduled. Processing then proceeds to block where the scheduled audit is performed.

At block a future audit may be scheduled for the device. Processing then continues to block where the device is granted access to the network. In one embodiment the NACA may grant the device access to the network by placing the device on a normal VLAN. In another embodiment network traffic from the device might no longer be routed through the NACA. Upon completion of block process may return to a calling process to perform other actions.

While system includes components similar to system system includes other components and a different configuration of components to enable agent processing ARP poisoning spoofing remote remediation by an administrator and the like. In this alternate embodiment intranet is in communication with NACA . Resources including internal external serves and captive web portal are in communication with intranet instead of NACA . Windows domain controller DHCP server AAA server and enterprise directory are also in communication with intranet . Alternatively AAA server and DHCP server may be in direct communication with NACA . AAA server may also be in communication directly with directory services . As shown security administrator may also be in communication with NACA over for example a web based user interface protocol such as HTTP or the like.

Intranet is a network enabled to couple a plurality of devices including NACA Windows domain controller DHCP server AAA server and enterprise directory .

As described above with respect to security administrator and network administrator may be a network device or a user in control of the network device. In one embodiment security administrator may be enabled by NACA to gain access to a device e.g. device in question that has been placed into quarantine. In one embodiment during the placement of a device into quarantine a device that is not in quarantine may be prohibited from communicating with a device that is in quarantine unless explicitly allowed by NACA as described herein. Similarly the device in quarantine is prohibited from communicating with a device not in quarantined.

In one embodiment NACA may explicitly allow communication between security administrator and the device in question to allow among other things security administrator to perform remote remediation measures on device in question .

In one embodiment security administrator and network administrator may be enabled to access and or control auditor and or NACA through a web interface or the like. In one embodiment security administrator and or network administrator may be enabled to access and or guide device in question to bring device in question into compliance with a security policy or the like so that device in question may be provided access to intranet and or resources . In one embodiment security administrator and or network administrator may provide remediation instructions to device in question .

In one embodiment security administrator and or network administrator may be enabled to access device in question in order to bring the device in to compliance with a security policy or the like. For example security administrator and or network administrator may guide an end user through self remediation configure policy rules and or additionally receive remediation instructions that would be presented to the end user.

AAA server may include any computing device enabled to provide authentication authorization and accounting of a user requesting access to a system in accordance with the present invention. In one embodiment AAA server may provide a RADIUS protocol to enable NACA to perform authentication authorization and accounting of the device. In one embodiment AAA server may retrieve information about the user from directory services . In another alternate embodiment AAA server may be included instead within NACA .

Windows domain controller includes any device configured to control access to a networked resource by using Windows network protocols an API or the like. NACA may utilize Windows domain controller to provide Windows domain authentication sniffing filtered access aggregation of vulnerability audits or the like. In one embodiment NACA may intercept a Windows authentication request and may activate an immediate vulnerability audit of the device requesting access.

DHCP server includes any device configured to control access to a networked resource by using the Dynamic Host Configuration Protocol DHCP described in more detail in RFC 2131. In one embodiment NACA may intercept a DHCP request. NACA may select a production VLAN based on a policy and the DHCP request. NACA may also relay the request to one of a plurality of DHCP servers which may reside in the production VLAN. In one embodiment DHCP server may reside in the production VLAN. In one embodiment NACA may also utilize DHCP server to quarantine a device to direct the device to remediation resources such as resources . For example NACA may cause DHCP server to direct network traffic from device in question to NACA during quarantine.

NACA may enable authorization and vulnerability assessment of a plurality of types of devices including but not limited to an IP telephone. In one embodiment enforcement point may be a HUB IP Telephone unmanaged switch smart WI FI access point basic WI FI access point smart VPN concentrator basic VPN concentrator or the like. In one embodiment enforcement point may enable NACA to enforce access control list ACL quarantine of device in question .

In one embodiment resources may include internal external servers configured to provide remediation information over a network. At least some of internal external servers may be accessible within a security perimeter such as behind a firewall or the like. At least some of internal external servers may be accessible outside of the security perimeter.

Captive web portal includes any web information that is provided by NACA in response to redirected web traffic from a quarantined network. In one embodiment web traffic from a quarantined network that is directed to a production network may be redirected to captive web portal by NACA or the like. In one embodiment captive web portal may present an authentication and or authorization mechanism and or information such as remediation information based on policy. In one embodiment the captive web portal may be substantially similar to the pages produced by router web server of not shown .

The captive web portal may provide an HTTP HTTPS based authentication mechanism that accepts usernames and passwords or the like. In one embodiment guest internet access is provided through the captive web portal. In one embodiment captive web portal informs an end user such as end user why device in question is quarantined how the end user may get guest access e.g. restricted access or the like. Captive web portal may help the end user to remove a device from a quarantine. For example captive web portal may point the end user to remediation resources. In another embodiment captive web portal may provide a contact for service support to the end user enable the end user to login through a web form enable the end user to download an agent such as agent or the like. In one embodiment captive web portal may provide custom remediation instructions and or other information based on a policy that applies to a device a type of the device a type of the user of the device or the like. For example based on the type of policy that applies to a device captive web portal may provide a particular level of details support contacts custom remediation instructions a web login for authentication and or enable the agent to be downloaded. In another embodiment captive web portal may provide an audit report of current vulnerabilities of device in question .

In one embodiment resources may include a dynamic fallback mechanism. The dynamic fallback mechanism may be enabled by process of . In one embodiment the dynamic fallback mechanism may utilize captive web portal .

In one embodiment NACA may receive from device in question and or enforcement point a device identity device health user identity and or location of device in question and a time of day of a network access.

In one embodiment NACA may quarantine a device e.g. device in question and redirect traffic to from the device to NACA without being directly in the packet path by performing ACL and or ARP poisoning and or spoofing. The redirected traffic may enable NACA to provide a captive web portal such captive web portal or the like.

In one embodiment Access Control List ACL and or Address Resolution Protocol ARP poisoning and or spoofing may be enabled by enforcement point which may supports the ability to selectively allow or deny packets from a device to network. In some embodiments enforcement point may include an ACL for restricting access to a network.

Enforcement point device in question and or NACA enables ARP processing for finding a host s hardware address when only its IP address is known. ARP processing is defined in RFC 826. Due to the overwhelming prevalence of IPv4 and Ethernet ARP is primarily used to translate Ethernet MAC addresses from IP addresses.

In one embodiment when device in question plugs into enforcement point and attempts to exchange packets with other devices on a network managed by enforcement point the packets are disabled from flowing unhindered. In this embodiment when device in question is plugged into enforcement point enforcement point is configured by NACA to disallow device in question from exchanging packets with any device other than the . In one embodiment this access restriction uses an Access Control List ACL rule operable on the on enforcement point . In one embodiment the ACL may include the following rules 

As described above rules and allows device A of a particular MAC e.g. Ethernet address to access NACA but disallows access to other MAC addresses.

In one embodiment NACA may also perform ARP spoofing and or poisoning to cause device in question to send all traffic to NACA instead of the originally intended destination device. This ARP spoofing and or poisoning may be accomplished by sending replies to device in question for any ARP queries it makes. These replies may include the NACA s address instead of the real address e.g. originally intended destination device s address . Additionally NACA may periodically resend other ARP packets to overwrite any answers device in question may have received from the originally intended destination device being spoofed. In one embodiment in order for NACA to receive the return traffic e.g. traffic sent from other devices back to the device in quarantine NACA may also ARP poisons the traffic as described above. By causing device in question to send all its traffic to the NACA NACA may apply it s firewall rules ACL rules or the like and only allow device in question to communicate with predetermined resources e.g. defined by an operator or the like .

In one embodiment device in question may include agent enabled to provide information about device in question . In one embodiment agent may provide information to NACA about which network switch a device e.g. device in question is plugged into. To properly enforce a device the NACA may need to know which port on a switch a device has plugged into. In one embodiment it is important for this information to be learned by the NACA as soon as the possible after the device is plugged into the port. Using agent e.g. running on the device this information is relayed to the NACA . In one embodiment a switch such as enforcement point emits a packet e.g. a discovery packet such as a Cisco Discovery Protocol CDP or the like that includes information about the switch such as IP address name of the port being plugged into VLAN the port is in or the like. Agent listens for this packet and when it hears the packet it sends the information or information derived therefrom to NACA . Thereby agent transmits the information about the port it is plugged into up to the NACA .

In one embodiment agent may receive information about device in question from outside intelligence . In one embodiment agent may send health and compliance checking information to NACA based on periodic scans of device in question and or an agent scan request for health and compliance checking information from NACA . In one embodiment NACA may determine to quarantine and or audit device in question based a processes as described in conjunction with and .

System illustrates components of the NACA and or configurations of communications between the components devices of system that are not described in conjunction with system . NACA operates substantially similar to NACA of . Enforcement point operates substantially similar to enforcement point of . Although not shown NACA includes components as described in conjunction with . Additionally as shown NACA also includes API knowledge database history database policy database health and compliance checking component policy engine and quarantine control .

Knowledge database and history database may be in communication with health and compliance checking component . Policy engine may be in communication with policy database health and compliance checking component quarantine control AAA server and enterprise directory . As shown policy engine may communicate with AAA server over a RADIUS protocol or the like. In one embodiment AAA server may be an optional component. As shown policy engine may communicate with enterprise directory over an LDAP protocol or the like to retrieve user identification information.

As shown security administrator may access report . Report may aggregate health compliance policy and or historical information about quarantined devices a network or the like. As shown security administrator may also provide remediation instructions or the like directly to NACA over a web user interface or the like. In an alternate embodiment access to a web site for remediation information may be filtered by HTTP SSL and or Server Message Block SMB filtering. In one embodiment the web site may be one of remediation resources including one of servers and or captive web portal .

Knowledge database history database and policy database includes any database enabled to store information. These databases may operate substantially similar to SQL database of . In one embodiment knowledge database includes information about network conditions current vulnerability assessments antivirus definitions or the like and or aggregates of such information. In one embodiment history database includes information about historical network conditions vulnerability assessments quarantines or the like and or aggregates of such information. In one embodiment policy database includes information to determine whether to quarantine a device and how to bring a device into compliance including configurations of acceptable device identity health user identity location and or time of day.

Health and compliance checking component includes any software and or hardware component enabled to audit a device and to determine if there are vulnerabilities that might further prevent the device from connecting to the network. In one embodiment health and compliance checking component may operate substantially similar to audit extender of . Health and compliance checking component may receive information about the health and policy compliance of new device directly from new device through a network scan of new device or from agent operating within new device or the like.

Health and compliance checking component may determine vulnerabilities assessment based at least in part on a history of intelligences of other devices that have been quarantined and or authorized. In one embodiment the history may be received from knowledge database and or history database . In one embodiment health and compliance checking component may send its vulnerability assessment to policy engine .

Policy engine operates substantially similar to policy engine of and policy engine of . Generally policy engine may be any component enabled to determine whether to quarantine a device based on associated vulnerabilities and or a policy. A policy includes a variety of conditions including group membership location machine type operating system type operating system patch level antivirus software versions installed on a device network request type e.g. location of network device for which access is requested user type or network port being accessed. A policy may be a Boolean test of the variety of conditions or the like. In one embodiment policy engine may determine a policy that applies to the device based on evaluating the Boolean test. In one embodiment the policy may be received from policy database . In one embodiment policy engine determines whether to quarantine new device based on a process substantially similar to process of process of and or process of . In one embodiment policy engine may send information indicating whether to quarantine the device in question to quarantine control .

In one embodiment quarantine control operates substantially similar to Switch Adaptation Layer SAL of and SAL of . Based on the received indication quarantine control is enabled to place new device in purgatory or the like through control of a switch access point or the like. For example quarantine control may enable enforcement point to direct traffic from a device e.g. One of devices to NACA and or to intranet so that the device may be brought into compliance with a policy such as a security policy defined in policy database or the like.

System includes enforcement point enforcement point NACA ports intranet DHCP server and devices . Enforcement point may include virtually any computing device that is configured to control the flow of network traffic and enable an access point capable of VLAN MAC binding. Such binding include a Wi Fi access point switch hub VPN concentrator or the like.

As shown enforcement point is in communication with enforcement point NACA intranet DHCP server and devices . Enforcement point is in communication with devices .

As shown port may be associated with a production VLAN i.e. VLAN . Ports may be associated with quartined VLANs i.e. VLAN to VLAN which may provide more limited resources than the VLAN .

In one embodiment multiple devices may be coupled to the same port on enforcement point . For example enforcement point may bind a device MAC address to multiple VLAN numbers thus supporting multiple devices on the same switch port. In one embodiment a port e.g. ports may be associated with multiple VLANs. In one embodiment enforcement point may be configured to tag an uplink traffic from one of devices with a different VLAN number thereby enabling the devices to access the associated VLANs e.g. a production or quarantined VLAN .

As shown enforcement point communicates with enforcement point through port which may be associated with multiple VLANs. Enforcement point may also be configured to bind MAC addresses of devices to a port on enforcement point that is associated with one of the multiple VLANs thereby enabling the devices to access the associated VLANs. Enforcement point may bind each one of devices to a different VLAN number. In one embodiment NACA communicates a VLAN number assignment to enforcement point and or enforcement point using a RADIUS protocol. In another embodiment an Address Resolution Protocol ARP announcement may coerce quarantined devices to communication with NACA .

In another embodiment a filter rule may prevent quarantined devices from communicating with any other port on enforcement point except a port associated with NACA . In one embodiment the filter rule may be executed on enforcement point and or NACA .

In one embodiment DHCP server may be associated with at least one of the multiple VLANs. In one embodiment each of the multiple VLANs may be associated with a different DHCP server not shown . The DHCP servers including DHCP server may route network traffic within the associated VLAN to NACA for quarantine and remediation analysis.

In one embodiment the multiple quarantined VLANs associated with ports may prohibit devices that have been quarantined from communicating with each other while other accessible quarantine resources are configured on the NACA .

In one embodiment when a device is put on a quarantine network e.g. onto a VLAN it is placed there along with any other quarantined devices. This quarantine network may be statically configured with the resources that are available to other devices in the quarantine VLAN.

In one embodiment NACA places a first device into quarantine by placing the switch port associated with the first device into a special VLAN. In this embodiment other network resources are not accessible in this VLAN except for access to the NACA . Instead traffic between the first device and the special VLAN goes through NACA and thus NACA is enabled to manage which resources the first device may access.

In one embodiment when a second device is placed into quarantine it is placed in that the same VLAN as the first quarantined device. NACA may still block the traffic from that device to any production networks e.g. VLAN associated with port but NACA does not stop the second device from communicating with the first device.

In an alternate embodiment the first and second quarantined devices may be blocked from communicating with each other. Using the multiple quarantined VLANs associated with ports NACA may place each quarantined device into a unique VLAN and thus prevent devices from talking with one another. The devices cannot talk to each other because NACA does not forward traffic between quarantine VLANS.

In this embodiment a configured list of VLANs e.g. VLAN Ids may be used for quarantine. This list may include as many VLANS as are available on the switch. These VLAN IDs may be logically placed in a pool and when a new device is placed into quarantine a VLAN ID may be taken from the pool and used for that device. The next device to be quarantined may be associated with the next VLAN ID in the pool or the like. Once the pool is exhausted devices may be added to one of the quarantine VLANs used by one of the other quarantined devices.

ARP manager may be configured to perform the operations described in conjunction with process of . ARP manager may detect ARP packets received at network interface unit and perform security operations based on the received packets. For example ARP manager may spoof ARP responses based on received ARP requests from a device seeking to join a network over network interface unit .

Agent manager may be configured to perform the operations described in conjunction with process of . Agent manager may enable another device to send e.g. forward remediation instructions over network interface unit to the device seeking to join the network. Agent manager may alert the other device that remediation actions are required for the device seeking to join the network by sending an alert message or the like over network interface unit .

Remote remediation manager may be configured to perform the operations described in conjunction with process of . Remote remediation manager may intercept a request from a device to join a network as described in . Based on the intercepted request remote remediation manager may place the device onto one of a plurality of quarantined networks e.g. VLANs .

Additionally applications may also include other components not shown such as knowledge database of history database policy database health and compliance checking component policy engine and quarantine control . In one embodiment applications may provide API to control the operations of these components to other applications and or network devices. In one embodiment API may be provided through an HTTPS access. In one embodiment policy engine and or quarantine control may control network interaction through network interface unit . For example policy engine and or quarantine control may utilize network interface unit to relay a DHCP request to a DHCP server relay a Windows domain authentication request to a domain controller relay a DNS lookup request to a DNS resolver relay and or filter a web request to an intranet relay a web request to a captive web portal for remediation instructions relay and or filter an SMB file share access request to an intranet provide SNMP or telnet access to a switch and or provide interaction with a RADIUS server.

In an alternate embodiment may be modified as described below to illustrate another logical flow diagram for managing access control using at least extended device credentials.

For example in the alternate embodiment at block it is determined whether the device should be remediated based on an identity of the user. In one embodiment the user may be authenticated via a Windows Domain login and the NACA observes the login via a web login and or an 802.1x login or the like. As used herein observes refers to the NACA sniffing network traffic between a client and a Windows Domain authentication server to determine whether authentication packets are being transmitted. In one embodiment block may perform substantially to process of as described below. For example in one embodiment if IEEE 802.1x is not enabled then an dynamic fallback mechanism such as a captive web portal may be provided. In one embodiment the dynamic fallback mechanism may provide custom remediation instructions based on a policy that applies to the device a type of the device a type of the user of the device or the like. If the user is identified as being unauthorized it is determined that the device should be remediated and processing continues to block . Otherwise processing then continues to block .

In the alternate embodiment at block the extended device credentials may be used to determine if an audit is to be performed. The extended device credentials may include a device health i.e. device vulnerabilities a device location and or time of day or the like. A device location may be a physical and or logical location. A physical device location may be determined by associating the device s IP address with a physical address location region country or the like. If for example it is determined that the device is located outside of a corporate LAN outside of a region country or the like then the device may be more susceptible to vulnerabilities and thus may require an audit. In one embodiment if the device is requesting to join the network during non business hours for example the device may be a suspect device and may require audits. If an audit is to be performed processing then continues to block . Otherwise processing continues to block .

At block the extended device credentials may be used to determine whether the device registered successfully. For example if a user is registering from a remote location and or during an improper time of day then registration may be denied. Processing the continues as in process .

At block it may be determined if a result of a background audit e.g. a scheduled future audit performed on the device indicates further remediation. In one embodiment the background audit may include more or other vulnerabilities assessment not performed at block . In one embodiment the background audit may be performed periodically based on a timing event or the like. If it is determined that the result of the background audit indicates further remediation then processing loops back to block . Otherwise processing continues to block .

In an alternate embodiment may also be modified similar to described above. For example blocks and blocks of process may be modified substantially similar to the modifications described above.

Processing begins at block where an agent intercepts a network packet transmitted by an enforcement point in response to a request from a device to join the network. In one embodiment data within the network packet may be received at Open Systems Interconnection OSI network layer. In one embodiment the information about the port includes a discovery protocol packet. In one embodiment the network packet is a discovery protocol packet e.g. a Cisco Discovery Protocol CDP packet or the like. In one embodiment the device plugs onto a port on a network switch e.g. an enforcement point and the network switch emits a discovery protocol packet. In one embodiment the agent receives the discovery protocol packet. In one embodiment the agent may be software and or a mechanism or the like residing on the device or external to device and in communication with the device as described in conjunction with agent of .

Processing next flows to block where the agent identifies based on the network packet information identifying a port on the enforcement point at which the request is received. This information may be a field or the like within the packet. The agent may parse the packet into header and payload information to retrieve this information.

Processing next flows to block where the agent transmits the information identifying the port to a network access control appliance NACA to enable security enforcement operations to be performed on the device. In one embodiment the NACA may receive the information through a message or the like. In response to the received information NACA may perform the operations described in process of process of process of or the like. Processing next returns to a calling process for further processing.

In one embodiment not shown the agent may make a connection to the NACA e.g. over TCP in order to transmit information to the NACA. In one embodiment this step is done before block and in another embodiment this step is performed after block .

Processing begins at block where a request to join the network by the device is detected. Block corresponds to block of .

Processing next flows to block where in response to the request one of a plurality of quarantined networks is determined for placing the device wherein devices on different quarantined networks are disabled from accessing each other. In one embodiment an enforcement point such as enforcement point of may enable multiple VLANs. In one embodiment the determination may be made by detecting the available VLANs e.g. not already managing another device onto which to place the device seeking access to the network. In another embodiment the determination may be made randomly on a schedule a list of available VLANs to be used for quarantine or the like.

Processing next flows to block where the device is placed onto the determined one of the plurality of quarantined networks. In one embodiment a NACA may place the device one of the VLANs by employing at least one of an SNMP trap VLAN Assignment Protocol VLAP or an 802.1x protocol or the like as described above. In one embodiment not shown block may be performed in conjunction with block in order to place the device onto the determined one of the plurality of VLANs. In another embodiment as shown the blocks may be performed after the device is placed and or assigned onto the determined one of the plurality of quarantined networks. Thus the device is segregated from other devices on another one of the plurality of quarantined networks.

Processing next flows to decision block where a determination is made whether the device is 802.1X capable. In one embodiment the client may automatically send an 802.1X authentication request such as an EAP response message to a switch thereby indicating that it is 802.1X capable. In another embodiment the switch may send an 802.1X initiation request such as an EAP request identity message or the like to the client. If the client is 802.1X capable it may respond with an 802.1X authentication request. In one embodiment upon receipt of an 802.1X authentication request message from the client the determination is made that the client is 802.1X capable. For example the NACA may act as an authentication server to determine that the client is 802.1X capable upon receipt of the 802.1X authentication request. In another embodiment the NACA acting as an authentication proxy may make this determination upon detecting an 802.1X traffic request being forwarded between the switch and an authentication server.

In one embodiment the NACA may provide a web page or other interface to the client device. In one embodiment the interface may enable a user of the client device to initiate a non 802.1X authentication mechanism. Initiation of the non 802.1X authentication mechanism may then indicate that the client device in incapable of 802.1X authentication.

However the invention is not limited to a client device s failure to respond and or provide an 802.1X authentication message or to further initiate a non 802.1X authentication mechanism. For example a variety of other predefined failure conditions may also be employed to determine if the client device is 802.1X authentication capable including but not limited to the client device providing an incorrect authentication credential a failed or out of date supplicant an inoperable switch or the like.

In any event if at decision block the determination is made that the client device is 802.1X capable processing then continues to block where the switch and the authentication server are enabled to employ 802.1X authentication and 802.1X authorization is performed on the device. In one embodiment the NACA may act as the authentication server. In one embodiment the NACA puts a switch port on the switch into an auto mode thus enabling 802.1X authentication detection. In one embodiment 802.1X packets may be processed on the switch port while other packets may be dropped or otherwise ignored by the switch. Processing then continues to block . If at decision block the determination is made that the client is not 802.1X capable processing then continues to block .

At block the NACA may be enabled to employ a non 802.1X mechanism to authenticate and or authorize the device. In one embodiment this may be through an interface such as a Command Line Interface CLI a web page or the like that may be provided to the client device. In one embodiment this non 802.1X may be a captive web portal or the like. The interface may enable entry of such non 802.1X authentication inputs as a user name password a digital certificate a token or the like. Thus the user of the device may be enabled to be authorized to access resources on the network through the non 802.1X mechanism. Processing next flows to block .

At block security enforcement operations are enabled to be performed on the quarantined device. For example NACA may perform the operations described in process of process of process of or the like to secure the device and bring the device into compliance with a security policy. For example a NACA may based on the intercepted request of the device to join the network forward remediation messages from a security administrator such as security administrator of and to the device. In one embodiment an agent or the like may receive the remediation messages and perform operations on the device such as installing anti virus software or the like to remediate the device.

Processing next flows to block where another device outside the quarantined network e.g. one of a plurality of quarantined networks is enabled to direct a remediation measure to be performed on the device to bring the device into compliance with a security policy. Processing next returns to a calling process for further processing.

In an alternate embodiment not shown a different first authentication and or authorization mechanism may be determined to be enabled at block . For example CLI and or web page authentication and or authorization may be determined. At block the first mechanism may be used to authenticate and or authorize the device. If the device fails the first measure at block then processing flows to block where a second mechanism may be used to authenticate and or authorize the device such as a web based mechanism. Processing then continues to block as described above.

Processing begins at block where Address Resolution Protocol ARP request including a requested destination address is intercepted from a device.

Processing next flows to block where in response to the ARP request an ARP response is sent to the device wherein the ARP response includes the destination address as an address of a Network Access Control Appliance NACA or another device enabled to secure access to a network. In one embodiment the destination address is replaced with the address of the NACA or other device . Thereby the ARP response is spoofed with the address of the NACA or other device . Thus the device will send data to the NACA that was intended for the originally requested destination address.

Processing next flows to block where the NACA or other device receives a request for a resource within the network wherein the request is destined to NACA based on the address of the NACA received within the ARP response.

Processing next flows to block where access to the resource is restricted. In one embodiment the access is restricted if the device is not authorized to access the resource. In one embodiment the process of restricting access may be similar to the operations of block of . In one embodiment restricting access the comprises at least one of restricting access based on an authorization in an Access Control List ACL or providing a mechanism for authentication or authorization to the device.

Processing next flows to block where periodically another ARP request is sent to the device wherein the other ARP response includes a destination address of the other ARP request as e.g. replaced with the NACA or other device thereby spoofing the destination address used by the device. Processing next continues to a calling process for further processing.

It will be understood that each blocks of the flowchart illustration may be performed in an alternate order or some blocks may be omitted without departing from the spirit and scope of the present invention. Further blocks from may be combined or the like without departing from the spirit and scope of the present invention.

It will be understood that each block of the flowchart illustration and combinations of blocks in the flowchart illustration can be implemented by computer program instructions. These program instructions may be provided to a processor to produce a machine such that the instructions which execute on the processor create means for implementing the actions specified in the flowchart block or blocks. The computer program instructions may be executed by a processor to cause a series of operational steps to be performed by the processor to produce a computer implemented process such that the instructions which execute on the processor to provide steps for implementing the actions specified in the flowchart block or blocks.

Accordingly blocks of the flowchart illustration support combinations of means for performing the specified actions combinations of steps for performing the specified actions and program instruction means for performing the specified actions. It will also be understood that each block of the flowchart illustration and combinations of blocks in the flowchart illustration can be implemented by special purpose hardware based systems which perform the specified actions or steps or combinations of special purpose hardware and computer instructions.

The above specification examples and data provide a complete description of the manufacture and use of the composition of the invention. Since many embodiments of the invention can be made without departing from the spirit and scope of the invention the invention resides in the claims hereinafter appended.

