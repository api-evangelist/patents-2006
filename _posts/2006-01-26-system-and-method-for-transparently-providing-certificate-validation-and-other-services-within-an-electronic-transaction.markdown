---

title: System and method for transparently providing certificate validation and other services within an electronic transaction
abstract: A system and method are disclosed for transparently providing certificate validation and other services without requiring a separate service request by either a relying customer or subscribing customer. In a preferred embodiment, after the subscribing customer digitally signs a document (e.g., a commercial document such as a purchase order), it forwards the document to a trusted messaging entity which validates the certificates of both the subscribing customer and relying customer and the respective system participants of which they are customers. If the certificates are valid, the trusted messaging entity appends a validation message to the digitally-signed document and forwards the document to the relying customer. A validation message is also preferably appended to a digitally-signed receipt from the relying customer and transmitted to the subscribing customer. In this way, both the relying customer and subscribing customer obtain certification of their respective counterparty to the transaction.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07734924&OS=07734924&RS=07734924
owner: IdenTrust, Inc.
number: 07734924
owner_city: San Francisco
owner_country: US
publication_date: 20060126
---
This patent application is a continuation of and claims priority from U.S. patent application Ser. No. 09 950 315 filed Sep. 10 2001 now U.S. Pat. No. 7 000 105 entitled System and Method for Transparently Providing Certificate Validation and Other Services Within an Electronic Transaction which patent application claims priority from U.S. provisional patent application Ser. No. 60 231 317 filed Sep. 8 2000 entitled Proposed Joint Solution and e Trust A Global Solution both of which patent applications is are hereby incorporated by reference.

The world of electronic commerce has created new challenges to establishing relationships between contracting parties. One of those challenges springs from the fact that the parties to the transaction cannot see or hear each other and cannot otherwise easily confirm each other s identity and authority to act.

One remedy for this problem is to provide each contracting party with a private key for signing transmitted messages. The signing party makes available an associated public key that decrypts messages signed with the party s private key and thus enables a receiving party to confirm the identity of the sender.

But the sender s public key may not be known a priori to the recipient. In that event the sender may transmit with its signed message a digital certificate issued by a certification authority. The certificate is itself a signed electronic document signed with the private key of the certification authority certifying that a particular public key is the public key of the sender.

In some cases the recipient may be unfamiliar with the public key of the certification authority or may not know whether the certificate is still valid. In that event the recipient may wish to check the validity of the certificate with an entity that it trusts.

A system and method are disclosed for transparently providing certificate validation and other services without requiring a separate service request by either a relying customer or subscribing customer. In a preferred embodiment these services are provided within the context of a four corner trust model. The four corner model comprises a subscribing customer sometimes referred to as the buyer and a relying customer sometimes referred to as the seller who engage in an on line transaction.

In a preferred embodiment the buyer is a customer of a first financial institution referred to as an issuing participant. The issuing participant acts as a certification authority for the buyer and issues the buyer a hardware token including a private key and a digital certificate signed by the issuing participant.

In a preferred embodiment the seller is a customer of a second financial institution referred to as the relying participant. The relying participant acts as a certification authority for the seller and issues the seller a hardware token including a private key and a digital certificate signed by the relying participant. The system also includes a root entity that maintains a root certification authority that issues digital certificates to the issuing and relying participants.

In a preferred embodiment the present system also comprises a trusted messaging entity. The trusted messaging entity is preferably a neutral trusted third party that facilitates secure service messaging in the present system.

In a preferred embodiment after a subscribing customer digitally signs a document e.g. a commercial document such as a purchase order it forwards the document to the trusted messaging entity. The trusted messaging entity validates the certificates of subscribing customer relying customer issuing participant and relying participant. In a preferred embodiment validation requests in the present system are preferably formatted in accordance with the Online Certificate Status Protocol OCSP .

If all the certificates are valid the trusted messaging entity appends a validation message to the digitally signed document and forwards the document to the relying customer. The relying customer generates and digitally signs a receipt and transmits the receipt to the trusted messaging entity. A validation message is also preferably appended to the digitally signed receipt and transmitted to the subscribing customer. In this way both the relying customer and subscribing customer obtain certification of their respective counterparty to the transaction.

In a preferred embodiment all service messages transmitted in the present system are either received transmitted and or forwarded by the trusted messaging entity. The trusted messaging entity preferably time stamps and logs each service message that it sends or receives for non repudiation purposes.

The trusted messaging entity s logs preferably ensure that other system entities will not be able to repudiate service messages associated with a system service. If for example a system participant denies having transmitted a particular service message the trusted messaging entity s logs may be used to determine whether the message was sent. As such the trusted messaging entity s logs provide a centralized vehicle for facilitating non repudiation concerning services provided in the present system.

a root entity the root entity maintaining a root certification authority adapted to issue digital certificates 

a first participant maintaining a first certification authority adapted to issue a digital certificate to a first customer 

a second participant maintaining a second certification authority adapted to issue a digital certificate to a second customer 

means for receiving by a trusted messaging entity a first digitally signed message from the first customer 

means for generating by the trusted messaging entity service requests for validation of the first customer s digital certificate the second customer s digital certificate and digital certificates issued to the first participant and second participant respectively by the root entity 

means for transmitting by the trusted messaging entity the service request for validation of the first customer s digital certificate to the first participant the service request for validation of the second customer s digital certificate to the second participant and the validation requests for the first and second participants digital certificates to the root entity 

means for generating by the trusted messaging entity a second digitally signed message comprising an indication that the first customer s digital certificate is valid and

means for transmitting by the trusted messaging entity the first and second digitally signed messages to the second customer.

transmitting a first validation request for a digital certificate of the issuing participant to a root entity 

transmitting a second validation request for a digital certificate of the subscribing customer to the issuing participant 

transmitting a third validation request for a digital certificate of the relying participant to the root entity 

transmitting a fourth validation request for a digital certificate of the relying customer to the relying participant 

if the first second third and fourth validation responses are positive creating a first digitally signed message that indicates the validity of the subscribing customer digital certificate and

transmitting the digitally signed document and the first digitally signed message to the relying customer.

In a preferred embodiment the first and second validation requests may be signed with a private key associated with a certificate that names the relying participant and the third and fourth validation requests may be signed with a private key associated with a certificate that names the issuing participant. The four validation requests may preferably be made by the trusted messaging entity acting on behalf of a disclosed principal. The disclosed principal for the first and second validation requests may preferably be the relying participant and the disclosed principal for the third and fourth validation requests may preferably be the issuing participant.

In a preferred embodiment the four validation requests may be signed with a private key associated with a certificate issued to the trusted messaging entity. The trusted messaging entity may be acting as a principal in the system or as an agent for an undisclosed principal with respect to these requests.

In a preferred embodiment the first digitally signed message may be signed with a private key associated with a certificate that names the relying participant. The trusted messaging entity may be acting as an agent for a disclosed principal with respect to this message which may preferably be the relying participant.

providing a trusted messaging entity with a first certificate that names a first participant and a second certificate that names a second participant 

signing by the trusted messaging entity the first message with a private key associated with the first certificate 

transmitting the first message by the trusted messaging entity whereby the trusted messaging entity acts as an agent for a disclosed principal that is the first participant 

signing by the trusted messaging entity the second message with a private key associated with the second certificate and

transmitting the second message by the trusted messaging entity whereby the trusted messaging entity acts as an agent for a disclosed principal that is the second participant.

In a preferred embodiment the first and second messages may be validation requests. In a preferred embodiment the first and second messages may be transmitted to the root entity. In a preferred embodiment the first message may be transmitted to the second participant and the second message may be transmitted to the first participant.

The features and advantages described in the specification are not all inclusive and many additional features and advantages will be apparent to one of ordinary skill in the art in view of the drawings specification and claims hereof.

The present disclosure relates to a system and method for transparently providing certificate validation and other services without requiring a separate service request by either a relying customer or subscribing customer. In a preferred embodiment this service is performed within the context of a four corner trust model that comprises a neutral trusted third party. A preferred embodiment of this four corner model is shown in .

As shown in the four corner model preferably comprises a first institution and a second institution . First institution is referred to as the issuing participant because it is a participant in the present system and issues to its customers tokens that include a private key and a digital certificate signed by the issuing participant as described below. Second institution is referred to as the relying participant because it is a participant in the present system and its customers rely on representations made by issuing participant and issuing participant s customers as described below. Participants may preferably be banks or other financial institutions.

Also shown in are a first customer and a second customer . First customer and second customer are preferably customers of issuing participant and relying participant respectively. First customer is sometimes referred to as the subscribing customer because it subscribes to services provided by issuing participant . First customer is sometimes referred to as the buyer because it typically fills that role in transactions with second customer as described below.

Second customer is referred to as the relying customer because it relies on representations made by other system entities. Second customer is also sometimes referred to as the seller because it typically fills that role in transactions with first customer as described below. It should be recognized however that although the description below speaks primarily in terms of a buyer and a seller first customer and second customer may instead have different roles in a given transaction. For example first customer may be a borrower repaying a loan to second customer .

Also shown in is a root entity . Root entity is preferably an organization that establishes and enforces a common set of operating rules for facilitating electronic commerce and electronic communications. The operating rules preferably define the rights obligations and liabilities of each system entity in connection with provision of system services. Root entity may be owned jointly by a plurality of banks and or other financial institutions that have agreed to adhere to these operating rules. One exemplary embodiment of such a root entity is described in copending U.S. application Ser. No. 09 502 450 filed Feb. 11 2000 entitled System and Method for Providing Certification Related and Other Services and in copending U.S. application Ser. No. 09 657 623 filed Sep. 8 2000 entitled System and Method for Providing Certificate Related and Other Services which are hereby incorporated by reference.

In a preferred embodiment the system of also comprises a trusted messaging entity . Trusted messaging entity is preferably a neutral trusted third party that facilitates secure service messaging in the present system. As described below in a preferred embodiment all service messages used in the present system are either received transmitted or forwarded by trusted messaging entity .

In a preferred embodiment trusted messaging entity time stamps and logs each service message that it sends or receives for non repudiation purposes. If a dispute arises between system entities the information stored by trusted messaging entity may be used to resolve the dispute.

Logging all service messages with a neutral entity facilitates non repudiation in the present system. Without such logging service message logs relating to system services would be fragmented across the logs of a plurality of system entities. By contrast logging all service messages at a single entity provides a consolidated log and enables full non repudiation of all messages relating to a system service.

It should be noted that in preferred embodiments of the present system participants root entity relying customer and or subscribing customer may also choose to log service messages that they send or receive. In a preferred embodiment however trusted messaging entity s logs remain the primary vehicle for resolving disputes between other system entities relating to the system services described below.

As will be recognized although the preferred embodiments described below speak primarily in terms of customer acting as a subscribing customer and customer acting as a relying customer the roles of these two customers may at times be reversed even within a single transaction and with respect to a single document. For example in connection with a particular transaction customers may prepare a contract to be signed by both parties. With respect to customer s signature on the contract customer is the subscribing customer and customer is the relying customer. By contrast with respect to customer s signature on the contract customer is the subscribing customer and customer is the relying customer.

Participants and root entity are also each preferably provided with a link for communicating with trusted messaging entity over a trusted messaging network . An HTTP adaptor is provided to integrate link into public key infrastructure PKI applications running on computer systems written for use with HTTP such as validation applications run by OCSP responders .

Trusted messaging entity is preferably provided with a time stamp component adapted to time stamp service messages that it sends and receives. Trusted messaging entity is also preferably provided with an HSM for signing and verifying signatures on messages and with a log used to log all service messages sent or received by trusted messaging entity as described below.

In a preferred embodiment trusted messaging entity is also preferably provided with a certificate repository for storing all digital certificates issued to it by root entity and system participants e.g. participants . Trusted messaging entity uses these certificates to digitally sign service messages that it creates as described in more detail below.

Subscribing customer is preferably provided with a Web browser adapted to receive and transmit information via the Internet. Subscribing customer is also preferably provided with a smartcard subsystem adapted to sign electronic messages. In a preferred embodiment smartcard subsystem may include a smartcard reader a smartcard driver a smartcard token and other software as described in U.S. provisional application Ser. No. 60 224 994 filed Aug. 14 2000 entitled Signing Interface Requirements Smart Card Compliance Requirements Warranty Service Functional Requirements and Additional Disclosure and copending U.S. application Ser. No. 09 928 999 filed Aug. 14 2001 entitled System and Method for Secure Smartcard Issuance which are hereby incorporated by reference.

Relying customer is preferably provided with a Web server adapted to receive and transmit information including serving Web pages over a communication network such as the Internet. Web server is preferably provided with an associated HSM for signing and verifying signatures on messages.

In a preferred embodiment subscribing customer and relying customer are also each preferably provided with a trusted services platform . Trusted services platform is preferably software developed jointly by root entity and trusted messaging entity that is adapted to provide a secure network connection for subscribing customer and relying customer to communicate with trusted messaging entity .

In a preferred embodiment service messages transmitted to or from trusted messaging entity by or to subscribing customer or relying customer are sent over the Internet via trusted services platform . Other messages between customers that do not relate to requesting or receiving system services for example messages from one customer to another during negotiation of a contract or conveying a contract to be signed may preferably be transmitted directly from one customer to another via for example the Internet or other network without using trusted services platform or routing the messages via trusted messaging entity as described below.

In a preferred embodiment each system entity is preferably provided with at least two digital certificates and corresponding private keys to facilitate authentication an identity certificate and a utility certificate.

The identity private key is used to produce digital signatures that are required by root entity as evidence of an entity s contractual commitment to the contents of an electronic transaction such as a purchase order.

The utility private key is used to provide additional transactional security. Typically utility certificates are used to support secure socket layers SSL to sign secure multipurpose internet mail extension S MIME messages and for other utility applications. Any reference in this document to the term certificate refers to an identity certificate unless otherwise stated.

In a preferred embodiment root entity in its capacity as a certification authority uses a root private key to create the digital certificates of each system participant e.g. issuing participant and relying participant and trusted messaging entity . In addition it uses the root private key to create digital certificates for each system component maintained by root entity that has digital signing capability such as OCSP responder .

In addition each system participant e.g. issuing participant and relying participant in its capacity as a certification authority uses the private key associated with its certificate from root entity to create the digital certificates of its customers e.g. subscribing customer and relying customer . In addition it uses this private key to create digital certificates for each system component that it maintains that has digital signing capability such as its OCSP responder . In an alternative embodiment the digital certificates for system components with digital signing capability that are maintained by a participant may be issued by root entity .

It should be noted that each customer may be a business entity such as a corporation that employs many individuals. In such cases customers preferably authorize some or all of these individual employees to transact and utilize system services on their behalf. Issuing participant preferably issues a separate smartcard token having a distinct private key and associated digital certificate to each authorized employee of subscribing customer . Similarly relying participant in its capacity as issuing participant to relying customer preferably issues a separate smartcard token having a distinct private key and associated digital certificate to each authorized employee of relying customer . The digital certificates preferably include the individual employee s name and identify the customer for whom he or she works. In an alternative embodiment the private key may instead be included in a software token provided to the individual.

It should be recognized that although the description that follows speaks primarily in terms of messages or other data being signed by a subscribing customer or relying customer the signature may in fact typically be created by an individual employee using his or her digital certificate and associated private key acting in a representative capacity for his or her employer.

In a preferred embodiment each system participant e.g. participants uses the private key associated with its digital certificate from root entity to create a customer communication certificate for use by trusted messaging entity . The participants forward these certificates to trusted messaging entity which stores them in certificate repository . As described below trusted messaging entity uses the customer communication certificate from a particular system participant when communicating with the participant s customers.

In an alternative embodiment these customer communication digital certificates may be issued by root entity as long as each certificate names a specific system participant so that messages signed with the private key associated with the certificate that are sent by trusted messaging entity to the participant s customers will be associated by the customer with its participant and or recognized by the customer as having been sent on behalf of its participant.

In addition in one preferred embodiment each system participant e.g. participants uses the private key associated with its digital certificate from root entity to create an OCSP signing certificate for use by trusted messaging entity . The participants forward these certificates to trusted messaging entity which stores them in certificate repository . Trusted messaging entity uses the OCSP signing certificate from a particular participant to sign validation requests when acting as an agent for the participant in the first preferred embodiment for providing a certificate validation service described below. If desired a single certificate may be issued to trusted messaging entity which may serve as both a customer communication certificate and an OCSP signing certificate.

In an alternative embodiment these OCSP signing digital certificates may be issued by root entity as long as each certificate names a specific system participant so that messages signed with the private key associated with the certificate that are sent by trusted messaging entity to other system participants or root entity will be associated by the message recipient with the participant and or recognized by the message recipient as having been sent on behalf of the participant.

In a second preferred embodiment root entity uses the root private key to create an OCSP signing certificate for use by trusted messaging entity . Root entity forwards this certificate to trusted messaging entity which stores it in certificate repository . Trusted messaging entity uses the OCSP signing certificate issued by root entity to sign validation requests in the second preferred embodiment for providing a certificate validation service described below.

It should be noted that the system entities may each be provided with additional components not shown in such as the components described in copending U.S. application Ser. No. 09 657 605 filed on Sep. 8 2000 entitled System and Method for Providing Certificate Validation and Other Services U.S. provisional application Ser. No. 60 224 994 filed Aug. 14 2000 entitled Signing Interface Requirements Smart Card Compliance Requirements Warranty Service Functional Requirements and Additional Disclosure U.S. provisional application Ser. No. 60 259 796 filed Jan. 4 2001 entitled Warranty Manager Application Programming Interface Warranty Messaging Specification and Warranty Manager Functional Requirements copending U.S. application Ser. No. 09 928 998 filed Aug. 14 2001 entitled System and Method for Providing Warranties in Electronic Commerce copending U.S. application Ser. No. 09 928 999 filed Aug. 14 2001 entitled System and Method for Secure Smartcard Issuance and copending U.S. application Ser. No. 09 929 035 filed Aug. 14 2001 entitled System and Method for Facilitating Signing by Buyers in Electronic Commerce which are hereby incorporated by reference.

In a preferred embodiment the architecture described above may be used to provide a plurality of system services to customers . Preferred embodiments for providing one such service a certificate validation service are described below. In a preferred embodiment all service messages described in connection with the following preferred embodiments are digitally signed by the message sender using an appropriate private key associated with a digital certificate issued to the message sender.

A first preferred embodiment for providing a certificate validation service is described in connection with . Beginning with in step a subscribing customer visits a relying customer s Web site. The parties preferably authenticate themselves to each other over an SSL session with their utility keys.

In step Web server communicates data to be digitally signed to browser e.g. a purchase order for an agreed to transaction . In a preferred embodiment Web server may also communicate to browser a copy of relying customer s digital certificate either as part of the data to be signed or separately.

In step the data to be signed is forwarded to smartcard subsystem which signs the data to create a digitally signed document. The digitally signed document preferably includes a copy of subscribing customer s digital certificate.

In step browser transmits the digitally signed document to trusted messaging entity over the Internet via trusted services platform message in . If in step above subscribing customer received a copy of relying customer s digital certificate with or as part of the data to be signed subscribing customer includes this certificate with the digitally signed document transmitted to trusted messaging entity . Otherwise in step relying customer transmits a copy of its certificate directly to trusted messaging entity message in .

In step trusted messaging entity identifies the issuing participant and relying participant for the particular transaction from the subscribing customer and relying customer certificates respectively. In step trusted messaging entity verifies subscribing customer s signature on the document using subscribing customer s public key and the signatures on subscribing customer s and relying customer s certificates using the public keys of issuing participant and relying participant respectively .

In step trusted messaging entity retrieves from certificate repository its OCSP signing certificate issued to it by the relying participant hereafter RP OCSP signing certificate . In step trusted messaging entity creates a certificate validation request for issuing participant s certificate signs the request with the private key associated with its RP OCSP signing certificate and transmits the request to root entity message in . In requesting this validation trusted messaging entity preferably acts as an agent for relying participant .

In step root entity checks the validity of the issuing participant s certificate using its OCSP responder . In step root entity transmits the validation response for this certificate to trusted messaging entity message in .

In step trusted messaging entity creates a certificate validation request for subscribing customer s certificate signs the request with the private key associated with its RP OCSP signing certificate and transmits the request to issuing participant message in . In requesting this validation trusted messaging entity preferably acts as an agent for relying participant .

In step issuing participant checks the validity of subscribing customer s certificate using its OCSP responder . In step issuing participant transmits the validation response for this certificate to trusted messaging entity message in .

In step trusted messaging entity retrieves from certificate repository its OCSP signing certificate issued to it by issuing participant hereafter IP OCSP signing certificate . In step trusted messaging entity creates a certificate validation request for relying participant s certificate signs the request with the private key associated with its IP OCSP signing certificate and transmits the request to root entity message in . In requesting this validation trusted messaging entity preferably acts as an agent for issuing participant .

In step root entity checks the validity of the relying participant s certificate using its OCSP responder . In step root entity transmits the validation response for this certificate to trusted messaging entity message in .

In step trusted messaging entity creates a certificate validation request for relying customer s certificate signs the request with the private key associated with its IP OCSP signing certificate and transmits the request to relying participant message in . In requesting this validation trusted messaging entity preferably acts as an agent for issuing participant .

In step relying participant checks the validity of relying customer s certificate using its OCSP responder . In step relying participant transmits the validation response for this certificate to trusted messaging entity message in .

In step trusted messaging entity determines whether the validation responses received from root entity issuing participant and relying participant are positive i.e. indicate that the certificates that were the subjects of the requests were valid . If one or more of the validation responses are not positive i.e. indicate that one or more of the certificates that were the subjects of the requests were revoked suspended or unknown trusted messaging entity transmits a message not shown to subscribing customer conveying this fact and informing subscribing customer that its digitally signed document will not be delivered to relying customer step .

Otherwise in step trusted messaging entity retrieves from certificate repository the customer communication certificate issued to it by relying participant hereafter RP customer communication certificate . In step trusted messaging entity creates a message confirming the validity of the subscribing customer s digital certificate signs the message with the private key corresponding to its RP customer communication certificate appends the message confirming validity to the digitally signed document to form a validated document and transmits the validated document to relying customer message in . In signing this message trusted messaging entity preferably acts as an agent for relying participant .

In a preferred embodiment validation messages generated by trusted messaging entity may be implemented as wrappers that include a digital signature generated by trusted messaging entity and other validation related information that is wrapped around a customer s digitally signed message e.g. a document from subscribing customer or a receipt from relying customer . In this case a hash created by trusted messaging entity in generating the digital signature may preferably be based at least in part on the customer s digitally signed message.

In step relying customer generates a receipt for the transaction and digitally signs it. In step relying customer transmits the digitally signed receipt to trusted messaging entity message in .

In step trusted messaging entity retrieves from certificate repository its customer communication certificate issued to it by issuing participant hereafter IP customer communication certificate . In step trusted messaging entity creates a message confirming the validity of the relying customer s digital certificate signs the message with the private key corresponding to its IP customer communication certificate appends the message confirming validity to the digitally signed receipt to form a validated receipt and transmits the validated receipt to subscribing customer message in . In signing this message trusted messaging entity preferably acts as an agent for issuing participant . In a preferred embodiment trusted messaging entity may revalidate the relying customer s certificate with relying participant before generating the validated receipt and forwarding it to subscribing customer .

A second preferred embodiment for providing a certificate validation service is described in connection with . Beginning with in step a subscribing customer visits relying customer s Web site. The parties preferably authenticate themselves to each other over an SSL session with their utility keys.

In step Web server communicates data to be digitally signed to browser e.g. a purchase order for an agreed to transaction . In a preferred embodiment Web server may also communicate to browser a copy of relying customer s digital certificate either as part of the data to be signed or separately.

In step the data to be signed is forwarded to smartcard subsystem which signs the data to create a digitally signed document. The digitally signed document preferably includes a copy of subscribing customer s digital certificate.

In step browser transmits the digitally signed document to trusted messaging entity over the Internet via trusted services platform message in . If in step above subscribing customer received a copy of relying customer s digital certificate with or as part of the data to be signed subscribing customer includes this certificate with the digitally signed document transmitted to trusted messaging entity . Otherwise in step relying customer transmits a copy of its certificate directly to trusted messaging entity message in .

In step trusted messaging entity identifies the issuing participant and relying participant for the particular transaction from the subscribing customer and relying customer certificates respectively. In step trusted messaging entity verifies subscribing customer s signature on the document using subscribing customer s public key and the signatures on subscribing customer s and relying customer s certificates using the public keys of issuing participant and relying participant respectively .

In step trusted messaging entity retrieves from certificate repository its OCSP signing certificate. In contrast to the first preferred embodiment described above in this second preferred embodiment trusted messaging entity is provided with only one OCSP signing certificate which it uses in requesting certificate validations.

In step trusted messaging entity creates a certificate validation request for issuing participant s certificate signs the request with the private key associated with its OCSP signing certificate and transmits the request to root entity message in . In a preferred embodiment trusted messaging entity acts as a principal in signing this message. In an alternative preferred embodiment trusted messaging entity acts as an agent acting for an undisclosed principal in signing this message where the undisclosed principal is relying participant .

In step root entity checks the validity of the issuing participant s certificate using its OCSP responder . In step root entity transmits the validation response for this certificate to trusted messaging entity message in .

In step trusted messaging entity creates a certificate validation request for subscribing customer s certificate signs the request with the private key associated with its OCSP signing certificate and transmits the request to issuing participant message in . In a preferred embodiment trusted messaging entity acts as a principal in signing this message. In an alternative preferred embodiment trusted messaging entity acts as an agent acting for an undisclosed principal in signing this message where the undisclosed principal is relying participant .

In step issuing participant checks the validity of subscribing customer s certificate using its OCSP responder . In step issuing participant transmits the validation response for this certificate to trusted messaging entity message in .

In step trusted messaging entity creates a certificate validation request for relying participant s certificate signs the request with the private key associated with its OCSP signing certificate and transmits the request to root entity message in . In a preferred embodiment trusted messaging entity acts as a principal in signing this message. In an alternative preferred embodiment trusted messaging entity acts as an agent acting for an undisclosed principal in signing this message where the undisclosed principal is issuing participant .

In step root entity checks the validity of the relying participant s certificate using its OCSP responder . In step root entity transmits the validation response for this certificate to trusted messaging entity message in .

In step trusted messaging entity creates a certificate validation request for relying customer s certificate signs the request with the private key associated with its OCSP signing certificate and transmits the request to relying participant message in . In a preferred embodiment trusted messaging entity acts as a principal in signing this message. In an alternative preferred embodiment trusted messaging entity acts as an agent acting for an undisclosed principal in signing this message where the undisclosed principal is issuing participant .

In step relying participant checks the validity of relying customer s certificate using its OCSP responder . In step relying participant transmits the validation response for this certificate to trusted messaging entity message in .

In step trusted messaging entity determines whether the validation responses received from root entity issuing participant and relying participant are positive. If one or more of the validation responses are not positive trusted messaging entity transmits a message not shown to subscribing customer conveying this fact and informing subscribing customer that its digitally signed document will not be delivered to relying customer step .

Otherwise in step trusted messaging entity retrieves from certificate repository its customer communication certificate issued to it by relying participant hereafter RP customer communication certificate . In step trusted messaging entity creates a message confirming the validity of the subscribing customer s digital certificate signs the message with the private key corresponding to its RP customer communication certificate appends the message confirming validity to the digitally signed document to form a validated document and transmits the validated document to relying customer message in . In signing this message trusted messaging entity preferably acts as an agent for relying participant .

In step relying customer generates a receipt for the transaction and digitally signs it. In step relying customer transmits the digitally signed receipt to trusted messaging entity message in .

In step trusted messaging entity retrieves from certificate repository its customer communication certificate issued to it by issuing participant hereafter IP customer communication certificate . In step trusted messaging entity creates a message confirming the validity of the relying customer s digital certificate signs the message with the private key corresponding to its IP customer communication certificate appends the message confirming validity to the digitally signed receipt to form a validated receipt and transmits the validated receipt to subscribing customer message in . In signing this message trusted messaging entity preferably acts as an agent for issuing participant . In a preferred embodiment trusted messaging entity may revalidate the relying customer s certificate with relying participant before generating the validated receipt and forwarding it to subscribing customer .

Both the first and second preferred embodiments described above transparently validate a subscribing customer certificate during a transaction without requiring a validation request by either the subscribing customer or relying customer. Moreover the two embodiments provide each party to a transaction with validation of its counterparty s certificate. Furthermore in both embodiments the validation messages transmitted to the subscribing customer and relying customer are signed with private keys associated with respective digital certificates that name an entity trusted by the customer receiving the validation message i.e. its participant.

But the two preferred embodiments also differ substantially in both technical effect and legal respects. In terms of technical effect in the first preferred embodiment trusted messaging entity is issued participant specific OCSP signing certificates preferably one for each participant in the present system. By contrast in the second preferred embodiment trusted messaging entity is issued only one OCSP signing certificate which it uses to sign all validation requests.

Moreover from a legal perspective in the first preferred embodiment when trusted messaging entity creates and transmits validation requests for subscribing customer s certificate and issuing participant s certificate it acts as an agent for relying participant . Similarly when trusted messaging entity creates and transmits validation requests for relying customer s certificate and relying participant s certificate it acts as an agent for issuing participant . By contrast in the second preferred embodiment when trusted messaging entity creates and transmits validation requests for subscribing customer s certificate relying customer s certificate issuing participant s certificate or relying participant s certificate it acts either as a principal within the system or as an agent acting on behalf of an undisclosed principal.

These technical and legal distinctions between the two embodiments can have significant effects on the system s operation and liability model. When trusted messaging entity acts as principal in the present system it acquires direct liability to other system entities for damages suffered as a result of negligent or intentional errors committed by trusted messaging entity . As noted above in a preferred embodiment root entity preferably develops a set of operating rules for the present system that define the rights obligations and liabilities of each system entity in connection with provision of system services. If as in one version of the second preferred embodiment described above trusted messaging entity acts as a principal within the system it will typically be necessary to create an additional section of such operating rules that define the rights and obligations of trusted messaging entity in the present system.

Moreover under the law of agency even if as in the second version of the second preferred embodiment described above trusted messaging entity acts as agent for an undisclosed principal trusted messaging entity will typically acquire direct liability to system entities with which it interacts that it would not acquire if acting as agent for a disclosed principal as described below. In addition if no steps are taken to clarify the status of trusted messaging entity it may be unclear whether it is acting as a principal or as an agent for an undisclosed principal when taking a given action which may lead to further ambiguities concerning its liability to other system entities.

By contrast in the first preferred embodiment described above trusted messaging entity acts as agent for a disclosed principal in requesting validation of digital certificates. In this preferred embodiment under the law of agency the liability of trusted messaging entity will typically be limited to liability to its principal the counterparty will have recourse only against that principal not its agent. Liability between agent and principal can be addressed by appropriate contracts between them. Moreover the contracts apportioning liability between agent and principal may be tailored to the desires of the particular parties to the contract. Thus for example trusted messaging agent could establish one arrangement for apportioning liability with a first participant and a second arrangement for apportioning liability with a second participant. In contrast in an embodiment in which trusted messaging entity assumes liability to other system entities as in the first preferred embodiment the scope of such liability is typically best addressed in the system operating rules and would therefore typically apply uniformly to trusted messaging entity s relationships with all system participants.

Furthermore because trusted messaging entity uses a participant specific certificate to request certificate validations the principal on whose behalf it is acting is always clear. This is especially beneficial because trusted messaging entity may in quick succession request validation for a plurality of certificates from a plurality of entities acting in the various requests as agent for different principals. The use of participant specific certificates thus provides a simple and efficient mechanism to clearly disclose and track the principal on whose behalf trusted messaging entity is acting when it takes a given action.

This ability to identify and track the entity for whom trusted messaging entity is acting may be especially beneficial to root entity . For example root entity may want or be obligated under the operating rules to count the number of validation requests that it receives on behalf of each system participant e.g. participant s . If trusted messaging entity uses a single OCSP signing certificate for all validation requests to root entity root entity will be unable to allocate those requests among the various system participants on whose behalf they were made.

It should be recognized that although the steps in the process flows for the first and second preferred embodiments described above are described in a particular order the steps may be performed in other orders in alternative preferred embodiments. For example in one alternative embodiment trusted messaging entity may validate the certificates of issuing participant and subscribing customer before obtaining a copy of the certificate of relying customer . It should also be recognized that some of the steps described above as distinct may be implemented as a single step. For example a single request to root entity may be defined requesting validation of both issuing participant s and relying participant s certificates.

In a preferred embodiment the above described architecture may serve as a platform for providing other system services in addition or as alternatives to the certificate validation service described above. For example the architecture may be used to provide a warranty service in which a system entity financially guarantees the identity of a subscribing customer and promises to reimburse a relying customer for losses that it suffers as a result of reliance on the subscribing customer s digital signature.

The above described architecture may also be used to provide payment guarantee and performance guarantee services. In a preferred embodiment a payment guarantee service may be used by a relying customer to obtain a guarantee from an entity that it trusts that a subscribing customer will honor a financial obligation. In a preferred embodiment a performance guarantee service may be used by a subscribing customer to obtain a guarantee from an entity that it trusts that relying customer will honor an obligation that it undertakes to perform.

In a preferred embodiment trusted messaging entity time stamps and logs each service message that it sends or receives for non repudiation purposes. Accordingly trusted messaging entity logs data for ensuring non repudiation of a service performed within the context of the present system. For example if an issuing participant denies having validated the identity of a subscribing customer the logs maintained by the trusted messaging entity may be consulted to determine whether a signed validation response for the subscribing customer was issued by the issuing participant. In another example if a relying customer denies having received a digitally signed document the logs maintained by the trusted messaging entity may be consulted to determine whether a signed receipt for the document was received from the relying customer.

While the invention has been described in conjunction with specific embodiments it is evident that numerous alternatives modifications and variations will be apparent to those skilled in the art in light of the foregoing description.

