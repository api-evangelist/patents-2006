---

title: Response time detection in a network having shared interfaces
abstract: A method that includes activating and deactivating two counts between an active state and not an active state such that no more than one count at a time is in an active state. The method also includes receiving a request packet of information that requires a reply and incrementing the count that is in an active state, and setting a flag in the request packet of information that requires a reply, the flag being set to correspond to the count that is in the active state. The method further includes receiving a reply packet of information corresponding to a previously received request packet of information, the reply packet of information having a flag setting corresponding to the previously received request packet of information, and decrementing the count that corresponds to the flag setting of the reply packet of information. A network is also disclosed.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07639628&OS=07639628&RS=07639628
owner: University of Notre Dame du lac
number: 07639628
owner_city: Notre Dame
owner_country: US
publication_date: 20060714
---
The present application claims priority to U.S. Patent Application No. 60 699 055 filed Jul. 14 2005 entitled Time Out Detection in Shared Interfaces the entire disclosure of which is hereby incorporated by reference in its entirety.

This invention was made with Government support under a subcontract to Subcontract No. NBCH3039003 awarded by DOI NBC. The Government has certain rights in the invention.

Embodiments of the present invention relate to the field of computer networks and more particularly to response time detection in a network having shared interfaces.

Generally computer networks include numerous components in the form of for example computing devices and peripheral devices. These devices may be represented as nodes such as requester nodes each of which is capable of making one or more independent requests for something from one of a plurality of acceptor nodes. Additionally each device may be represented as including a plurality of such nodes and may even be viewed as its own network. For communication efficiency it is assumed that all requests from requestor nodes are funneled through a common communication conduit to acceptor nodes. The entrance to this communication conduit may be represented as a gateway which serves as a network interface. Generally with such networks there is a maximum time that each individual request from a requestor node may be pending after it has been sent until a response from the acceptor node should arrive back at the requestor node. After this period of time a record of this lack of response may be desired and a signal provided to some other apparatus. While one of the most common reasons for such a signal is to declare that a response has not been generated in some predetermined period of time and thus perhaps never will due to a malfunction somewhere in the system other applications may wish to use this information to gauge overall system performance such as for example what is the average time between a request and a response.

In conventional systems one possible way in which to handle time out detecting may be to associate a watchdog timer with each and every request start the timer when a request is made and stop it when the response arrives. If the watchdog timer reaches a maximum before a response arrives the timer flags a possible error condition. Such timers may be found in either the requesters or the gateway or both. One problem with such an approach is that once all timers are in use no more requests may be made.

A second possible approach to error detecting may be to bundle at the gateway all requests over some period of time until all requests from a prior bundle have been received. Once the prior bundle of requests has been received a new bundle of requests may be released. Such an approach may require a potentially large or unbounded amount of storage at the gateway to defer requests. Additionally it may insert needless delays in moving the requests out to the system where they may be handled.

Another possible approach to the error detecting may be to maintain either in the gateway or each requestor for each outgoing request a request identifier time tag at which a request was sent. The time tag may be erased when the response is received. Periodic checks of all time tags stored in the gateway may identify when a request is overdue. However once again such an approach requires resources that once all are in use may require suspending more requests until one or more of the resources are available.

In the following detailed description reference is made to the accompanying drawings which form a part hereof wherein like numerals designate like parts throughout and in which is shown by way of illustration embodiments in which the invention may be practiced. It is to be understood that other embodiments may be utilized and structural or logical changes may be made without departing from the scope of the present invention. Therefore the following detailed description is not to be taken in a limiting sense and the scope of embodiments in accordance with the present invention is defined by the appended claims and their equivalents.

Various operations may be described as multiple discrete operations in turn in a manner that may be helpful in understanding embodiments of the present invention however the order of description should not be construed to imply that these operations are order dependent.

The description may use perspective based descriptions such as up down back front and top bottom. Such descriptions are merely used to facilitate the discussion and are not intended to restrict the application of embodiments of the present invention.

For the purposes of the present invention the phrase A B means A or B. For the purposes of the present invention the phrase A and or B means A B or A and B . For the purposes of the present invention the phrase at least one of A B and C means A B C A and B A and C B and C or A B and C . For the purposes of the present invention the phrase A B means B or AB that is A is an optional element.

The description may use the phrases in an embodiment or in embodiments which may each refer to one or more of the same or different embodiments. Furthermore the terms comprising including having and the like as used with respect to embodiments of the present invention are synonymous.

Embodiments of the present invention provide a mechanism for response time detection in a network having shared interfaces with potentially large numbers of concurrent outstanding requests.

As illustrated in the requestor nodes function as requesters wherein the nodes request a service from acceptor nodes within the network which serve as acceptors. The acceptor nodes provide the requested service of the requester nodes. Thus a requester node forwards a request packet of information to the gateway which forwards the request packet of information to an appropriate acceptor node. The acceptor node performs the requested service and then forwards a reply packet of information to the gateway which forwards the reply packet of information to the original requester node. Those skilled in the art will understand that some requester nodes may also be acceptor nodes and vice versa. However for simplicity and clarity the present invention will be described wherein requestor nodes are on the left hand side of the gateway as illustrated in and acceptor nodes are located on the right hand side as illustrated in . In accordance with various embodiments some or even all of the acceptors nodes do not share a gateway.

In accordance with various embodiments of the present invention requests in the form of request packets of information from requester nodes include one or more flag bits that may be set by a gateway or network interface. In accordance with various embodiments of the present invention the one or more flag bits may not be modified in any way by the network. Such bits may serve as a flag and remain attached to the request packet of information as it moves through the network.

The gateway in accordance with various embodiments of the present invention includes a period timer that may be set to at least some predetermined amount of time when a request may be outstanding before signaling a time out or the occurrence of an event. Such a timer is independent of the number of outstanding requests that may be pending from a single node or from all the nodes to which the gateway is connected.

In accordance with various embodiments of the present invention there may be two or more counters wherein each counter is configured to maintain one or more counts. In other embodiments there may be at least one counter within the gateway that may be configured via software to maintain two or more counts. In accordance with various embodiments of the present invention there is one or more flag bits provided within the gateway. In an embodiment the gateway includes a flag bit that alternates between one of two states for example A or B. Each of the states of the flag bit is uniquely associated with a unique count. Thus in such an embodiment one of the counts is associated with state A and the other count is associated with state B.

Each count is initially set to zero in accordance with various embodiments of the present invention. Thus the gateway is initially in a quiescent state. The gateway then sets the flag bit to a first state for example A. The gateway also sets the timer to a desired or predetermined time period. When a first request is made by a requestor and reaches the gateway the timer is started. The timer decrements as time advances in accordance with various embodiments of the present invention. Alternatively the timer may increment and signal when a predetermined amount of time is reached.

In accordance with various embodiments of the present invention for each request packet of information forwarded from a requestor on the left side of including the first which activates the timer the packet of information s flag bit is set to the current value of the gateway s flag bit which for this example is currently A. The count associated with the value A is incremented once each time the gateway handles an outgoing request. Thus the counter containing count A is currently in an active state.

For each request packet of information that moves through the network from the gateway nothing is done to the request packet of information s flag bit in accordance with various embodiments of the present invention. The request packet of information reaches an acceptor node which processes the request packet of information. Once complete the acceptor node forwards a reply packet of information back to the gateway. The reply packet of information includes one or more bits that serve as flag bits. The reply packet of information has its flag bit or bits set to the state of the corresponding requestor packet of information which in this example is A. The reply packet of information is forwarded to the gateway which then forwards the reply packet of information to the original requesting node. When the reply packet of information arrives at the gateway the gateway checks the reply packet for its flag bit and decrements the appropriate count. Thus only request packets of information and returning reply packets of information that pass through the gateway affect the counts in the gateway.

In accordance with various embodiments of the present invention when the timer reaches the pre determined amount of time the gateway changes the flag value for example from A to B and the timer is reset. Prior to changing the flag bit and restarting the timer the value of the count associated with the new state to be active i.e. the count that has been in an inactive state is checked. If the value is non zero then a signal may be generated indicating the occurrence of this event. The signal may be forwarded to some entity desiring the information. The event may in accordance with various embodiments of the present invention may be a time out.

After a change in the flag value new request packets of information now have their flag bits set to B and the count associated with B is incremented as new request packets of information pass through the gateway. If a received request packet of information at an acceptor has a flag of B a corresponding reply packet of information prepared at the acceptor has its flag set to B. As reply packets of information arrive at the gateway the gateway checks their flag bit s and decrements the appropriate count whether or not the appropriate count is in an active state or an inactive state. Thus depending upon the flag bit of the reply packet of information either count A or count B is decremented. This process of alternating between states A and B may be repeated over and over.

Accordingly as may be seen in for an example for various embodiments of the present invention assume that at the beginning of a first predetermined period of time T A and its associated count become the active state A active . The count associated with A equals zero at this initial point. During T five request packets of information pass through the gateway Rto R and have their flag bits set to A. The count associated with A has its value incremented by one for each of the five request packets of information during T. Two corresponding reply packets of information Reand Re pass through the gateway during T reply packets of information having a flag bit set to B may also pass through the gateway during T but are not shown for clarity purposes . The count associated with A has its value decremented by one for each of the two reply packets of information during T. At the end of the first predetermined period of time T B and its associated count are to become the active state B active for a second predetermined period of time T. Request packets of information that pass through the gateway Twill now have their flag bits set to B not shown for clarity purposes . The count associated with state A has a value of three at this point. During the second predetermined period of time T reply packets of information corresponding to requests Rand R Reand Re pass through the gateway reply packets of information having a flag bit set to B may also pass through the gateway during T but are not shown for clarity purposes . The count associated with A is decremented by one for each of the two reply packets of information during T. At the end of the second predetermined period of time T A and its associated count are to become the active state A active . The gateway checks the value associated with count A and discovers that it has a value of one since a reply packet of information was not received for each of the five request packets of information that passed through the gateway during T. Thus in accordance with various embodiments of the present invention a signal indicating the occurrence of this event may be generated.

As may be seen in in accordance with various embodiments of the present invention the system will wait at least one predetermined time period from when a request packet of information arrives at the gateway before generating a signal such as when a request Rpasses through the gateway just before the end of one predetermined time period A active and the check of count A is made just at the start of the next time that A is the active state A active one predetermined time period later. In an embodiment the system will also wait no longer than just under two predetermined time periods before generating a signal such as when a request Rpasses through the gateway just after the start of a predetermined time period A active and no reply is received before the next time A is the active state A active and the count is checked.

If a count ever reaches a negative value in accordance with various embodiments of the present invention the gateway will declare a protocol error since more replies have been received than requests were made.

In accordance with various embodiments of the present invention when both counts are concurrently zero the gateway may infer that there are no outstanding requests from either an A or B time period and thus the system is idle. Thus in accordance with the various embodiments of the present invention when such a quiescent state for the system i.e. both counts have values of zero is reached the timer may be reset. However once another outgoing request is passed to the gateway the timer should be allowed to restart timing.

In accordance with various embodiments of the present invention there may be packets of information sent by requesting nodes through the gateway that do not require a reply. Thus in accordance with various embodiments of the present invention the gateway recognizes such packets of information and passes the packets of information onto the network without incrementing the count that is in an active state.

An acceptor node in accordance with various embodiments of the present invention may realize that processing of the request packet of information may take a longer amount of time than usual or may be delayed for various reasons. In such an instance the acceptor node may forward an intermediate response to the gateway to inform the gateway of the delay. The intermediate message includes a flag bit to inform the gateway to which count state the intermediate message pertains. The intermediate message may also optionally include information regarding to which request packet of information the intermediate message pertains. In order to prevent generation of a signal the gateway may extend the current time period so that the counts states are not switched before a full additional period of time has passed. Also upon receipt of the intermediate message the gateway does not decrement a count. Alternatively this timer extension may be performed only if the flag in the intermediate response is a different value from that currently maintained by the gateway.

Alternatively in accordance with various embodiments of the present invention when greater control of the maximum period at which a signal is guaranteed to be generated more than two states may be provided and thus more than two counts. Each of the counts may be maintained on separate individual counters one associated with each state. Also the states may be ordered in some specific pattern that is repeated over and over as needed. For example there may be states A B and C. The counts in such an example alternate from A to B to C back to A and so on with respect to setting of flag bits within a request packet of information at the gateway. The process proceeds as previously described with the gateway checking the value of a count just before it becomes active and possibly generating a signal.

In such embodiments that include more than two states an acceptor node may send an intermediate message to the gateway informing it to decrement the count associated with a state and increment the count of a different state. This informs the gateway that a response for a request may be coming one or more time periods later than expected. For example the gateway increments by one the count associated with the current active state and decrements the appropriate count associated with the particular request packet of information. In some embodiments of the present invention the gateway may be configured to generate a signal if multiple intermediate messages are received for the same request packet of information which may indicate a potential stall in processing of the corresponding request packet of information. Additionally the gateway may simply generate a signal if the intermediate message indicates that the reply packet of information is going to be advanced too many states.

As previously noted with reference to the system will wait just under two predetermined time periods if a request Rpasses through the gateway just after the start of a predetermined time period A active and no reply is received before the next time A is the active state A active . Likewise the system will wait at least one predetermined time period from when a request packet of information arrives at the gateway before generating a signal if a request Rpasses through the gateway just before the end of one predetermined time period A active and no reply is received before the next time A is the active state A active . In various embodiments this situation may be modified to almost arbitrary timing accuracy by increasing the number of flag bits and corresponding counts. If there are N states as opposed to only two states i.e. log N flag bits then there are N counts one for each state. The system will cycle through the states in a predetermined order and wrapping around from state N 1 to state 0 once again starting from a quiescence system state of all counts equaling zero. When the system changes from state i to state j where j equals i 1 modulo N the system first checks the count associated with state j and proceeds only if the count equals zero. If the count associated with state j is non zero then a time out error may be declared. If a desired time out time is at least T seconds the period timer may be set to T N 1 seconds. Requests may now be timed out after somewhere between T if the request originated just before a period ended to T T N 1 if the request originated just after the beginning of a period .

In accordance with various embodiments of the present invention the signal of may include more information than just a positive indication that one or more requests were not responded to in a timely fashion. The response signal may also include for example the count at the beginning of the period and or the total number of requests that were sent out during the period when the count was originally active. With such information the entity receiving the signal may then be able to deduce interesting system performance characteristics such as what percentage of requests are not being handled within the predetermined period of time. Depending on the application this may for example trigger some attempt to load balance the system better and move some requesters or acceptors to different parts of the network.

Although certain embodiments have been illustrated and described herein for purposes of description of the preferred embodiment it will be appreciated by those of ordinary skill in the art that a wide variety of alternate and or equivalent embodiments or implementations calculated to achieve the same purposes may be substituted for the embodiments shown and described without departing from the scope of the present invention. Those with skill in the art will readily appreciate that embodiments in accordance with the present invention may be implemented in a very wide variety of ways. This application is intended to cover any adaptations or variations of the embodiments discussed herein. Therefore it is manifestly intended that embodiments in accordance with the present invention be limited only by the claims and the equivalents thereof.

