---

title: Heart rate meter and heart beat detecting method
abstract: A heart rate meter includes a heart beat detecting unit for detecting a heart beat waveform of a living body and a signal processor  for detecting a heart beat from the heart beat waveform. The signal processor  includes a heart beat signal generating processor  for adding a predetermined frequency characteristic to the signal within a predetermined narrow band of the heart beat waveform to generate a heart beat signal, and a heart beat detecting processor  for detecting a heart beat from a waveform distortion that is added to the heart beat signal by the heart beat signal generating processor. The heart beat signal generating processor  subjects the signal within the predetermined narrow band of the heart beat waveform to a signal processing, thereby removing the noise component existing in the frequency band, other than the primary component of the heart beat waveform, and performs signal processing to add the predetermined frequency characteristic, thereby generating a heart beat signal in which the signal intensity of a frequency component is amplified. The heart beat detecting processor  detects the waveform distortion added to the heart beat signal by the heart beat signal generating processor. Even when there is a variation in the measuring condition and signal characteristics such as the frequencies and the crest values of the fundamental wave, higher harmonic, and noise component are changed, a heart beat is accurately detected.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08655436&OS=08655436&RS=08655436
owner: Citizen Holdings Co., Ltd.
number: 08655436
owner_city: Tokyo
owner_country: JP
publication_date: 20060905
---
The present invention relates to a heart rate meter and a heart beat detecting method and more particularly it relates to a method for removing noise such as motion artifact and disturbance noise being included in a heart beat waveform.

Conventionally various heart rate meters have been suggested for measuring a heart rate of a living body. By way of example the patent document 1 is known as disclosing a pulse detecting circuit which irradiates a light from a light emitting device onto a body detects a reflected light or a transmitted light therefrom by a light receiving device and converts a received signal into a pulse signal thereby detecting the pulse.

In using the heart rate meter as described above it is demanded that the pulse rate is stably displayed as against noise and there are some suggestions for enhancing the stability of the pulserate display e.g. patent document 2 patent document 3 and patent document 4 .

The patent document 2 discloses a technique which focuses attention on the point that a pulse width caused by a noise is relatively narrow and provides a pulse wave evaluation means between a pulse wave detecting circuit and a pulse wave operation means for evaluating the pulse width of pulse signals outputted from the pulse wave detecting circuit. With the pulse wave evaluation means only a signal evaluated as a normal pulse wave signal is transferred to the pulse wave operation means and thereby obtaining a stability in displaying the pulse.

The patent document 3 discloses a technique to remove a body motion by using an acceleration sensor and wavelet transformation. In this document it is disclosed as the following the acceleration sensor detects a body motion waveform assuming the body motion as an acceleration and the body motion waveform is subjected to the wavelet transformation to generate body motion analytical data for each frequency domain in addition a pulse waveform detected from a detection target part of the living body is subjected to the wavelet transformation to generate pulse wave analytical data for each frequency domain and the body motion analytical data is subtracted from the pulse wave analytical data so as to detect a pulse.

The patent document 4 also discloses that in the photoplethysmography PPG for optically detecting heart rate information a noise being a high frequency component is removed from a PPG signal by using the wavelet transformation.

A heart rate is measured by a heart rate meter under various measuring conditions such as during non exercise and during exercise. As to the heart beat waveforms detected by the heart rate meter under such various conditions there are various signal properties such as a frequency and a crest value not only in a basic waveform but also in a noise component superimposed thereon.

By way of example the basic waveform may contain the higher harmonic like the second harmonic in addition to a fundamental frequency component. The noise component may include a disturbance noise being an electrical high frequency noise which breaks into the heart beat sensor and a transmission system and further includes a motion artifact being a micro vibration generated due to a positional displacement of a mounting point of the heart beat sensor which occurs when a person to be measured with the heart beat sensor mounted thereon performs exercise.

The frequency and the crest value of the fundamental wave and the higher harmonic vary depending on the condition under which the person to be measured uses the heart rate meter and various characteristics are shown under each of the conditions for example non exercise state exercise initiation state and during exercise state.

Here it is to be noted that the heart rate of a human body is approximately 20 to 220 bpm heart beats per minute and the fundamental frequency in this state falls into the frequency band of 0.33 20 bpm 60 sec to 3.67 220 bpm 60 sec Hz. If a higher harmonic up to the second harmonic is considered it falls into the frequency band of 0.33 20 bpm 60 sec to 7.34 3.67 2 Hz. The non patent document is taken as an example as the document describing the heart rate. The non patent document describes the heart rate during exercise as a relational expression Maximum heart rate during exercise 220 Age. That is 220 bpm is set as the upper limit. On the other hand as for the lower limit the non patent document 1 describes that there is a known example of the lowest actual measured value of a ski player who shows the heart rate of 28 bpm in resting state.

In general in the non exercise state the heart rate is a low value for instance not higher than 80 bpm and the fundamental frequency is not higher than 1.34 Hz with small amplitude. The non patent document discloses actual measured data showing that in the non exercise state 90 or more of the measured persons have the heart rate that falls into the range of 50 to 80 bpm. On the other hand during exercise the heart rate becomes higher than 80 bpm as well as the fundamental frequency becomes higher and in addition the signal amplitude increases for instance at least 1.5 times or more according to the blood flow being increased by the exercise.

In order to remove the noise component included in the heart beat waveform it is generally considered to extract signal components within the frequency band that contains the primary component by using a band pass filter or the like which has a predetermined frequency bandwidth as a passband.

As described above the heart rate of a human body has a frequency band of the primary component from 0.33 20 bpm 60 sec to 3.67 220 bpm 60 sec Hz the frequency components of the heart beat waveform and are made to pass through the band pass filter having the passband of 0.33 20 bpm 60 sec to 3.67 220 bpm 60 sec Hz and thereby it is possible to extract the fundamental frequency and its second harmonic as the primary component of the heart beat waveform. For example in the non exercise state the fundamental frequency 1.34 HZ and its second harmonic 2.67 Hz can be extracted and during exercise the fundamental frequency 3.0 Hz can be extracted .

However since the frequency band of the noise component is from 3 to 30 Hz there exists an overlapping part in the frequency band e.g. 3.0 Hz to 3.67 Hz between the frequency band of the primary component and the frequency band of the noise component in the heart beat waveform. Therefore it is a problem that if there is a noise component in the overlapping part of the frequency part this noise component cannot be removed e.g. the noise component in .

As described above if the noise included in the heart beat waveform is removed by the signal processing that extracts a signal component in the frequency band where the primary component is included and removes the signal component in the other frequency band there is a problem that the noise component existing within the extracted band cannot be removed. Similar problems are found not only in the processing by the band pass filter as described above but also in another method according to a frequency analysis such as using the aforementioned wavelet transformation.

Furthermore as shown in since the noise component having a lower frequency increases during exercise it is not possible to remove the noise component which is generated within the passband of the band pass filter . During the exercise the fundamental frequency becomes higher and accordingly the second harmonic goes out of the passband of the band pass filter. Therefore the second harmonic is removed and the primary component includes only the fundamental frequency. As thus described during exercise the noise component remains and the primary component only includes the fundamental frequency resulting in that a problem occurs i.e. S N ratio is deteriorated.

As discussed above since the variation of the measuring condition may cause various signal properties such as the frequency and the crest value of the fundamental wave higher harmonic and noise component there is a problem that it becomes more difficult to remove the noise component for effectively detecting the primary component included in the heart beat waveform and therefore an accurate detection of the heart rate is hampered.

In view of the situation above an object of the present invention is made to solve the conventional problems and it is directed to accurately detecting a heart rate even when the variation of the measuring condition causes various signal properties such as the frequency and the crest value of the fundamental wave higher harmonic and noise component which are included in the heart beat waveform.

The present invention is directed to a heart rate meter including a heart beat waveform detecting unit for detecting a heart beat waveform of a living body and a signal processor for detecting a heart beat from the heart beat waveform.

The signal processor includes a heart beat signal generating processor for subjecting the heart beat waveform to a signal processing to generate a heart beat signal and a heart beat detecting processor for detecting a heart beat from the heart beat signal generated by the heart beat signal generating processor.

The heart beat signal generating processor according to the present invention performs the signal processing for adding a predetermined frequency characteristic and thereby generating a heart beat signal in which a signal intensity of a frequency component is amplified. This amplification of the signal intensity of the frequency component increases the primary component of the heart beat waveform and reduces a noise component.

The heart beat signal generating processor includes a signal amplifier for amplifying a signal of a frequency component of the heart beat waveform. This signal amplifier amplifies the frequency component in a lower band of the heart beat waveform at low gain and amplifies the frequency component in a higher band at high gain. Accordingly a predetermined frequency characteristic is added to the heart beat waveform and thereby increasing the primary component of the heart beat waveform and reducing the noise component. In this signal processing for instance the frequency component of the heart beat waveform is subjected to the signal amplification according to a differential property.

In addition the heart beat signal generating processor is able to include a band pass filtering process. With this configuration a signal within a predetermined narrow band of the heart beat waveform is subjected to the signal processing thereby removing the noise component in the frequency band other than the primary component of the heart beat waveform.

The signal processing for removing the noise component and amplifying the signal intensity which is performed in the heart beat signal generating processor adds a waveform distortion to the heart beat signal. The waveform distortion according to the present invention increases the primary component of the heart beat waveform and reduces the noise component. Accordingly a strong correlation is generated between the waveform distortion and the heart beat. Therefore this waveform distortion provides heart beat information with a preferable S N ratio.

The heart beat detecting processor according to the present invention detects the waveform distortion added to the heart beat signal by the heart beat signal generating processor whereby noise effects are reduced and the heart beat can be detected without any error.

It is to be noted that a heart beat sensor and a detecting circuit can constitute the heart beat detecting unit. By way of example an optical reflection sensor or a transmission sensor may serve as the heart beat sensor. If the heart beat sensor outputs an optical signal the detecting circuit converts the optical signal into an electrical signal and subjects the signal to the signal amplification as appropriate.

The heart beat signal generating processor according to the present invention performs a narrowband signal processing that subjects a predetermined frequency band within the frequency provided in the heart beat signal to a signal processing.

The heart beat signal generating processor includes a band pass filter through which the frequency component in the predetermined narrow band out of the frequency component of the heart beat waveform is made to pass and either of the disturbance noise component and the motion artifact component or both the disturbance noise component and the motion artifact component are removed and a signal amplifier for amplifying the frequency component that passed through the band pass filter at high gain on the high frequency side.

The band pass filter removes the noise component in the frequency band other than the primary component of the heart beat waveform. The passband of the band pass filter has a frequency range as the following a frequency not lower than the frequency of the second harmonic of the highest heart beat waveform in the first state of heart beat is assumed as a cutoff frequency in the higher band. In addition a frequency not higher than the fundamental frequency of the lowest heart beat waveform in the first state of heart beat is assumed as a cutoff frequency in the lower band.

The signal amplifier performs the amplification by emphasizing the frequency component on the higher frequency side according to the amplification based on the differential property for instance. The differential property may be a first order differential property or a second order differential property and it may be another differential property having a higher order. However considering the S N ratio of the heart beat waveform the hardware configuration forming the signal processor and the cost benefit performance thereof the second order differential property is appropriate which allows the gain of 40 dB. According to the differential property such as the second order differential property the frequency component on the high frequency side of the heart beat signal is emphasized and amplified.

The signal amplifier is provided with an amplification characteristic that maximizes the amplification degree around the fundamental frequency of the highest heart beat waveform in the second state of heart beat and the component around this frequency is more emphasized and amplified. Accordingly the noise component is amplified at low gain and the component of the fundamental frequency and the second harmonic of the heart beat are amplified at high gain whereby the effect of the noise is reduced.

The amplification characteristic of the signal amplifier is provided with a frequency band where the gain is lowered gradually in the frequency range where the frequency is higher than the frequency at the highest amplification degree. With this configuration even when the frequency of the second harmonic fluctuates the signal component can be effectively acquired without missing any of the signal components and it is further possible to capture another harmonic component having a higher order.

Therefore the heart beat signal generating processor of the present invention is provided with a frequency characteristic which combines the followings the frequency range assuming the frequency not higher than the fundamental frequency of the lowest heart beat waveform in the first state of heart beat as a cutoff frequency in the lower band and assuming the frequency not lower than the second harmonic of the highest heart beat waveform in the first state of heart beat as a cutoff frequency in the higher band and the amplification characteristic that maximizes the amplification degree around the frequency of the fundamental frequency of the highest heart beat waveform in the second state of heart beat.

In the frequency characteristic as described above the frequency range is set by the frequency that is determined by the first state of heart beat. The first state of heart beat is assumed as a state where the heart rate is low and therefore the fundamental frequency is low and the second state of heart beat is assumed as a state where the heart rate is high and therefore the fundamental frequency is high. Furthermore it is assumed that the primary component of the heart beat waveform indicates the fundamental frequency and the second harmonic.

Here it is to be noted that there is a certain range as to the frequency which can be taken in the first state and the fundamental frequency and the second harmonic of the heart beat waveform may fluctuate within a given frequency range depending on a measuring target and a measuring condition.

Within the frequency range the frequency not higher than the fundamental frequency of the lowest heart beat waveform is assumed as the cutoff frequency in the lower band whereby it is possible to set the frequency that is conceivable to be the lowest in the low frequency including the primary component as a standard of the frequency on the lower band.

Similarly within this frequency range of the fundamental frequency and the second harmonic frequency the frequency not lower than the frequency of second harmonic of the highest heart beat waveform is assumed as the cutoff frequency on the higher band whereby it is possible to set the frequency that is conceivable to be the highest in the high frequency including the primary component as a standard of the frequency on the higher band.

Therefore this passband indicates a frequency band having an extended range including frequencies as standards the fundamental frequency of the lowest heart beat waveform and the frequency of the second harmonic of the highest heart beat waveform.

Since the frequency range is set as described above if a frequency component within this frequency range is detected out of the frequency components of the heart beat waveform this frequency component always includes the primary component of the heart beat the fundamental frequency or the second harmonic and therefore it is possible to obtain a heart beat signal from the primary component being detected.

On the other hand in the aforementioned frequency characteristic the amplification characteristic amplifies the frequency component on the high frequency side in a scale larger than the frequency component on the low frequency side and the amplification degree is rendered to be the highest around the fundamental frequency of the highest heart beat waveform in the second state of heart beat. The second state of heart beat is set to have a high heart rate per unit time and a high fundamental frequency whereby amplification at a high degree can be performed for the fundamental frequency component that is conceivable as the highest in the high frequency band which includes the primary component.

By setting the amplification characteristic as described above even when the fundamental frequency becomes high in the second state the second harmonic goes out of the aforementioned frequency range and the fundamental frequency becomes only the primary component of the heart beat waveform included in the frequency range the fundamental frequency can be amplified with reliability and the signal thereof can be amplified on a larger scale compared to the signals of the other frequencies. Therefore the S N ratio of the heart beat information can be enhanced enabling acquisition of the heart beat signal from the detected primary component.

It is possible to assume that the first state of heart beat is non exercise state and the second state of heart beat is during exercise state.

In the aforementioned heart beat signal generating processor performs the amplification process by emphasizing the frequency component on the high frequency side and therefore a heart beat signal being generated has an emphasized slope component. Since the slope component is generated based on the primary component of the heart beat waveform the number of the slope parts corresponds to the number of heart beats. The heart beat detecting processor according to the present invention detects this slope component and thereby the heart beat is detected.

The heart beat detecting processor according to one aspect of the present invention detects a waveform slope component of the heart beat signal and when it coincides with a predetermined waveform slope component a heart beat is detected. It is to be noted that any of the signal variation during the rise time of the heart beat signal waveform and the signal variation during the fall time thereof may be employed as the slope component. Alternatively both of the signal variations may be employed. In this case since the detected result becomes twice as large as the heart rate the detected value is made half to obtain the heart rate.

The heart beat detecting processor according to another aspect of the present invention is provided with a waveform distortion detecting unit for detecting a waveform distortion that is added to the heart beat signal using a crest value and inclination of a heart beat signal as a detecting condition. This waveform distortion detecting unit detects the waveform distortion as a heart beat.

Here the detecting condition includes that the heart beat signal has a predetermined crest value or higher and the inclination of the heart beat signal shows a monotonous increase or a monotonous decrease within a predetermined period or alternatively it shows both the monotonous increase and the monotonous decrease.

The predetermined crest value may be a frequency component around the frequency of the second harmonic of the highest heart beat waveform of the heart beat during non exercise. In general the crest value of the fundamental frequency of the heart beat waveform is higher than the crest value of the second harmonic. In addition the crest value during exercise becomes higher than the crest value during non exercise. Further in general the crest value of the second harmonic of the heart beat waveform is higher than the crest value of the noise component in many cases.

In view of the situation above it is possible to determine the presence or absence of the primary component of the heart beat waveform by setting a detecting condition in which the crest value higher than the frequency component around the frequency of the second harmonic during non exercise time is detected.

It is further possible to set the predetermined period to be a period range not longer than a quarter of the heart beat waveform period. If the primary component of the heart beat waveform includes at least the fundamental frequency and the second harmonic the period characteristic thereof is assumed as a quarter of the heart beat waveform at the longest. Therefore the primary component of the heart beat is increased monotonously or decreased monotonously during at least the period range of not longer than a quarter of the heart beat waveform period. This period range corresponds to the width of the aforementioned slope part.

Here if a heart beat signal is obtained by sampling the heart beat waveform successive sampling points are detected the number of which corresponds to the value obtained by the following computation the time range being a quarter of the heart beat waveform is divided by the sampling period. Then when the values of the sampling points are larger than the frequency component around the frequency of the second harmonic of the highest heart beat waveform during non exercise and the values increase monotonously or decrease monotonously the waveform distortion is detected as a heart beat.

In addition to the aforementioned aspect of the heart rate meter the present invention includes another aspect directed to a method for removing a noise of the heart beat waveform and detecting a heart beat.

The heart beat detecting method includes a heart beat waveform detecting step for detecting a heart beat waveform of a living body a heart beat signal generating step for subjecting the heart beat waveform to a signal amplification processing to generate a heart beat signal in such a manner that frequency component in a lower band of the heart beat waveform is amplified at low gain and the frequency component in a higher band of the heart beat waveform is amplified at high gain a waveform distortion detecting step for detecting a waveform distortion that is added to the heart beat signal in the heart beat signal generating step and a heart beat detecting step for detecting a heart beat from the waveform distortion.

In the heart beat signal generating step the signal amplification processing subjects the frequency component of the heart beat waveform to the signal amplification according to a differential property and the heart beat detecting step detects the waveform distortion thereby allowing a detection of a fundamental wave or a second harmonic of the heart beat waveform or both the fundamental wave and the second harmonic as the heart beat.

Here one aspect of the heart beat signal generating step includes two processes of narrowband signal processing including a band pass processing that allows passage of the frequency component in a predetermined narrow band out of the frequency component of the heart beat waveform so as to remove a disturbance noise or a motion artifact or both the disturbance noise and the motion artifact and a signal amplification processing for subjecting the frequency component in the narrow band to the signal amplification according to the differential property such as a second order differential property which amplifies signals on the high frequency side at a high amplification degree.

In another aspect of the heart beat signal generating step the band pass processing is performed with a restriction of a frequency range assuming the frequency not higher than the fundamental frequency of the lowest heart beat waveform in the first state of heart beat as a cutoff frequency in the lower band and the frequency not lower than the frequency of the second harmonic of the highest heart beat waveform in the first state of heart beat as the a cutoff frequency in the higher band. In addition the signal amplification processing is performed with an amplification characteristic that maximizes the amplification degree around the fundamental frequency of the highest heart beat waveform in the second state. By combining those processing above the signal amplification is performed by emphasizing within the frequency range the heart beat waveform around the fundamental frequency of the highest heart beat waveform in the second state.

The band pass processing restricts the frequency range assuming the fundamental frequency of the lowest heart beat waveform measured in the non exercise state as the lower band frequency and assuming the fundamental frequency of the highest heart beat waveform measured in the during exercise state as the higher band frequency.

The waveform distortion detecting step according one aspect of the present invention detects a waveform slope component of the heart beat signal and extracts a predetermined waveform slope component whereby the noise component is removed and only the heart beat is detected.

Any of the signal variation during the rise time of the heartbeat signal waveform and the signal variation during the fall time thereof may be employed as the slope component. Alternatively the signal variations during both the rise time and the fall time may be employed.

The waveform distortion detecting step according to another aspect of the present invention detects a waveform distortion that is added to the heart beat signal setting the crest value and the inclination of the heart beat signal as the detecting condition and the waveform distortion being detected is obtained as a heart beat.

Here as described above the detecting condition includes that the heart beat signal has a crest value being equal to or higher than a predetermined value and the heart beat signal shows a monotonous increase or a monotonous decrease within a predetermined period or alternatively both the monotonous increase and the monotonous decrease and the predetermined crest value corresponds to a frequency component around the frequency of the second harmonic of the highest heart beat waveform of the heart beat in the non exercise state.

According to the present invention even when the measuring condition varies and there are changes in the signal properties such as the frequencies and the crest values of the fundamental wave higher harmonic and noise component included in the heart beat waveform it is possible to detect an accurate heart beat.

Hereinafter a heart rate meter and a procedure for removing noise component from a heart beat waveform to detect a heart beat according to the present invention will be explained in detail with reference to the accompanying drawings.

Firstly an overview of the present invention will be explained with reference to . In a heart rate meter of the present invention includes a heart beat waveform detecting unit A for detecting a heart beat waveform of a living body and a signal processor for detecting the heart beat that is obtained by subjecting the detected heart beat waveform to a signal processing. Here the signal processor is provided with a heart beat signal generating processor B and a heart beat detecting processor C. A heart rate detecting unit D detects a heart rate based on the heart beat detected in the signal processor . Here the heart rate detecting unit D includes a heart rate counter for counting the heart rate and a heart rate notifying unit for notifying the heart rate being counted by means of displaying transmitting recording or the like.

It is to be noted here that the heart beat waveform detecting unit A may be made up of a heart beat sensor and a detecting circuit which acquires a detected signal from an output of the heart beat sensor for instance. By way of example an optical sensor may serve as the heart beat sensor and the detecting circuit converts the output such as an optical signal acquired from the heart beat sensor into an electrical signal. If necessary the detecting circuit subjects the signal to amplification and converts the signal into a digital signal according to A D conversion.

The signal processor includes a heart beat signal generating processor B for generating a heart beat signal by subjecting signals in a predetermined narrow band of the heart beat waveform to a filtering process and a signal amplification process and a heart beat detecting processor C for detecting a heart beat from the waveform distortion that is added to the heart beat signal according to an addition of a predetermined frequency characteristic by the heart beat signal generating processor B.

A narrowband signal processor may constitute the heart beat signal generating processor B. The narrowband signal processor includes two processing contents and

The first processing content is to remove a noise component existing in the frequency band other than the primary component of the heart beat waveform and the removal can be performed by extracting a signal within a predetermined narrow band from the frequency band of the heart beat waveform being captured. The heart beat waveform includes as the primary component the frequency components of a fundamental frequency and its n order higher harmonic. The n order higher harmonic approaches the heart beat waveform as the larger number is taken as n . However in general a crest value of the n order higher harmonic becomes smaller as the n becomes larger. Therefore if relatively low precision is sufficient for example in such a case of detecting a heart rate the second order harmonic is enough setting 2 to n .

Therefore in the example here it is assumed that the primary component of the heart beat waveform corresponds to the frequency components of the fundamental frequency and the second harmonic. illustrates an overview of the heart beat waveform the fundamental frequency and the second harmonic. shows an example of the heart beat waveform and shows the frequency component of the fundamental frequency and the frequency component of the second harmonic which are included in the heart beat waveform . It is to be noted here that the fundamental frequency and the second harmonic can be obtained by a frequency analysis such as Fourier transform.

On the frequency axis there exists a frequency component caused by a noise in addition to the frequency components of the fundamental frequency and the second harmonic as the primary component of the heart beat waveform.

The noise as described above may include a disturbance noise which breaks into the heart beat sensor or into the circuitry and a position indicator motion noise that is generated when the heart beat sensor is displaced from the position to be measured. The frequency included in the noise is various depending on the noise source or the like and such frequency appears both inside and outside the frequency range where the primary component of the heart beat waveform exists.

The narrowband signal processor sets a frequency range where the frequency component of the fundamental frequency and the second harmonic as the primary component of the heart beat waveform appears and by using this frequency range the band of the heartbeat waveform is narrowed to generate narrowband signals which are signals only within the frequency range. By making the heart beat waveform to be a narrow band the noise component having the frequency outside the frequency range can be removed.

By way of example a band pass filter can implement the first processing content that removes the noise component.

Next the second processing content held by the narrowband signal processor is to amplify a signal intensity of the frequency component and thereby generating a heart beat signal. This signal processing can be performed by adding a predetermined frequency characteristic to the heart beat waveform. This signal processing for adding the predetermined frequency characteristic increases the primary component of the heart beat waveform and reduces the noise component.

Even when the noise component is removed by the aforementioned narrowband signal processing the noise component which appears within the frequency range of the fundamental frequency and the second harmonic is not removed but remains causing a factor which deteriorates the S N ratio of the heart beat signal.

The second processing of the narrowband signal processor is performed to subject a crest value of the primary component to the signal amplification as to the primary component and the noise component of the heart beat waveform so as to enlarge a difference in signal intensity between the primary component and the noise component whereby the S N ratio of the heart beat signal is enhanced. In here there is shown an example that the frequency component of the second harmonic is subjected to the signal amplification.

The second processing content that subjects the crest value of the primary component to the signal amplification can be implemented for example by a differential property processing that mainly subjects the second harmonic to the signal amplification. The differential property processing may be a second order differential property processing. It is to be noted here that the second order differential property processing is one example of the differential property processing as described below. In addition the differential property processing is also an example for performing the signal amplification at high gain in a high frequency domain.

The removal of the noise component and the amplification of the signal intensity performed in the narrowband signal processing may add a waveform distortion to the heart beat signal E in . The signal intensity amplification performed in the narrowband signal processing subjects the frequency component of the primary component in particular the fundamental frequency and the second harmonic to non linear signal amplification. Therefore the intensity ratio of the frequency component included in the heart beat signal obtained by this signal amplification becomes different from the intensity ratio of the frequency component included in the original heart beat waveform. This means that a waveform distortion is added to the heart beat signal.

According to this waveform distortion the heart beat waveform is distorted from the original signal form. Since the primary component of heart beat waveform is increased and the noise component is reduced the waveform distortion achieves a stronger correlation with the heat beat rather than the heart beat waveform. Therefore by detecting the waveform distortion obtained by the narrowband signal processing the heart beat information can be obtained at a preferable S N ratio.

Detailed example of the narrowband signal processing according to the band pass filter and the second order differential property processing will be explained below with reference to .

A waveform distortion detecting unit may constitute the heart beat detecting processor C. The waveform distortion detecting unit detects a predetermined slope component included in the heart beat signal for instance and detects a heart beat by associating this slope with the heart beat. The slope component may be obtained either from a signal variation during the rise time of the heart beat signal waveform or from a signal variation during the fall time. Alternatively it may be obtained from the signal variations in both of the rise time and the fall time.

The waveform distortion detecting unit detects the waveform distortion added to the heart beat signal setting the crest value and the slope of the heart beat signal as a detecting condition.

The detecting condition includes that the heart beat signal shows a predetermined crest value or higher and the slope of the heart beat signal shows a monotonous increase or a monotonous decrease within a predetermined period of time or alternatively both the monotonous increase and the monotonous decrease.

The predetermined crest value may be a frequency component for example around the frequency of the second harmonic of the highest heart beat waveform of the heart beat during non exercise.

As for the heart beat waveform in general the crest value of the fundamental frequency of the heart beat waveform is higher than the crest value of the second harmonic and the crest value during exercise is higher than the crest value during non exercise. Furthermore in many cases the crest value of the second harmonic of the heart beat waveform is higher than the crest value of the noise component.

In view of above situation the primary component of the heart beat is detected setting the crest value as the first condition. By setting the crest value of the frequency component around the frequency of the second harmonic during non exercise as a threshold value there is a possibility that the frequency component smaller than this crest value does not include the primary component of the heart beat and the frequency component larger than the crest value includes the primary component.

However the frequency component of the noise component may goes over the aforementioned crest value depending on the size. Therefore it is not possible to detect the primary component of the heart beat just by determining the primary component of the heart beat waveform based on the crest value.

Given the situation above the slope during a predetermined period of time is set as the second condition to detect the primary component of the heart beat. If the primary component of the heart beat waveform includes at least the fundamental frequency and the second harmonic it is assumed that the period characteristic of the primary component is a quarter of the period of the heart beat waveform at the longest. In this case the primary component of the heart beat increases monotonously or decreases monotonously during at least the period range of not longer than a quarter of the heart beat waveform period.

Therefore the heart beat is detected setting the condition of the slope in such a manner that the signal monotonously increases or monotonously decreases in a predetermined period the period having a width not longer than a quarter of the heart beat waveform period.

If the heart beat signal is sampling data successive sampling points are obtained the number of which corresponds to the value that is calculated by dividing the duration of time being one quarter of the heart beat waveform period by the sampling period. If the values of the sampling points are larger than the frequency component around the frequency of the second harmonic of the highest heart rate waveform as to the heart beat during non exercise and the values of the sampling points show monotonously increase or monotonously decrease this heart beat signal is detected as the heart beat.

Next with reference to a schematic configuration of the heart rate meter according to the present invention will be explained. It is to be noted here that an optical sensor is illustrated as an example of the heart beat sensor .

The heart rate meter includes a heart beat sensor for acquiring heart beat information from a living body a detecting circuit for generating a detected signal from an output of the heart beat sensor a signal processor for subjecting the detected signal from the detecting circuit and detecting a heart beat a heart rate counter for counting a heart rate and a heart rate notification unit for notifying the heart rate being counted.

The heart beat sensor is provided with a light emitting device driven by the light emitting circuit for irradiating light on the living body and a light receiving device for receiving the light that is scattered or reflected or transmitted from the living body . shows a schematic sectional view for explaining one configuration example of the heart beat sensor and shows the configuration example for irradiating light against the living body and detecting the light being reflected. The light emitting device and the light receiving device are opposed to each other placing a shielding plate therebetween and they are located in a manner being symmetrical with respect to an irradiated point not illustrated . Here the shielding plate blocks the light that is directly incident from the light emitting device to the light receiving device

The light irradiated from the light emission device onto the living body is scattered by the tissue in the living body and the blood in the blood vessel and emitted outwardly from the living body . The intensity of the light emitted from the living body fluctuates according to a blood stream. The heart rate meter according to the present invention detects the heart beat based on the variation of the light intensity that fluctuates according to the blood stream.

The detecting circuit includes a light receiving circuit which receives the optical signal obtained from the light receiving element and converts the signal into a detected signal being an electrical signal an amplifier circuit which subjects the detected signal to signal amplification and an A D converter that converts the signal into a digital signal.

The signal processor includes a narrowband signal processor which performs the noise removal by the aforementioned band pass filter the second order differential property or the like and signal amplification of the second harmonic and a heart beat detecting unit slope detecting unit for generating a waveform distortion of the heart beat signal generated by the narrowband signal processor and detecting a heart beat.

The heart rate counter counts a heart rate from the heart beat obtained by the signal processor and the heart rate notification unit notifies the heart rate counted in the heart rate counter . It is to be noted that this notification includes displaying recording transmission and the like of the heart rate.

The heart rate meter includes as shown in described above the heart beat sensor the detecting circuit the signal processor the heart rate counter and the notification unit . A detected signal from the tactile sensor A serving as the heart beat sensor is subjected to the signal amplification by the amplifier circuit in the detecting circuit and converted into a digital signal by the A D converter

In this configuration example the tactile sensor A is provided as the heart beat sensor . Here the tactile sensor A generically represents a sensor for detecting an oscillation emitted from a living body and by way of example this sensor detects a heart beat by detecting a pulse of arterial vessel within the living body.

As the tactile sensor A various sensors are available depending on a manner how to detect the oscillatory wave. For example if a pressure sensor is employed as the tactile sensor A an oscillatory wave is detected as a variation of pressure. Alternatively if an oscillation sensor is employed as the tactile sensor A the oscillatory wave is detected as variation of oscillation. The variation of oscillation being detected is a variation in amplitude frequency or the like.

The tactile sensor A detects via the skin an oscillatory wave propagating through the tissue of the living body. Therefore the tactile sensor A is mounted in proximity to a portion to be measured where a pulse of the living body can be detected. The detection sensitivity of the tactile sensor A can be improved by bringing it into contact with the skin in proximity to the portion to be measured. Furthermore by pressing the tactile sensor A against the skin the detection sensitivity can be enhanced more.

The tactile sensor A detects an oscillatory wave that fluctuates according to a blood stream the detecting circuit subjects a detected signal to a signal amplification in the amplifier circuit and the A D converter converts the amplified signal into a digital signal

It is to be noted here that the configuration and signal processing operations of the narrowband signal processor and the waveform distortion detecting unit within the signal processor and the heart rate counter the configuration and the signal processing of the heart rate notification unit and the operations of each unit are the same as those explained above with reference to . Therefore tedious explanation will not be given here.

If an optical sensor is employed as the heart beat sensor a portion for detecting a heart beat signal can be specified within a narrow range and a heart beat state at a specified position can be detected. Alternatively if a tactile sensor is employed as the heart beat sensor a heart beat signal can be obtained from a wide range and therefore a high precision in deciding the position for mounting the heart beat sensor is not necessary. In addition it is possible to reduce a faulty detection due to a displacement of the sensor while being used.

Next with reference to examples of the band pass filter and the second order differential property will be explained with respect to the noise component removal and the signal amplification of the second harmonic in the heart beat signal generating processor B.

The band pass filter is a filter which allows a passage of the frequency component in the predetermined narrow band out of the frequency component of the heart beat waveform and thereby either of the disturbance noise component and the motion artifact component or both the disturbance noise component and the motion artifact component are removed.

As shown in the band pass filter sets a lower band frequency F as a cutoff frequency in the lower band and the band pass filter sets a higher band frequency F as a cutoff frequency in the higher band.

Here the lower band frequency F of the band pass filter may be set as the frequency equal to or lower than the fundamental frequency of the lowest heart beat waveform in the first state of heart beat and the higher band frequency F of the band pass filter may be set as the frequency equal to or higher than the second harmonic of the highest heart beat waveform in the first state of heart beat. Here the first state of heart beat may be assumed as non exercise time when the person to be measured does not perform any exercise. There are individual differences in the heart rate during non exercise but by way of example the heart rate may be set to 20 bpm to 80 bpm. It is to be noted that bpm represents the heart rate per minute. Since these heart rates respectively correspond to 0.33 Hz and 1.34 Hz. Therefore the lower band frequency F may be set to 0.33 Hz and the higher band frequency F may be set to 2.68 Hz 1.34 Hz 2 .

The second order differential property subjects the high frequency side to the signal amplification at a high amplification degree. As shown in the second order differential property has an amplification degree that increases linearly from the low frequency side directed to the high frequency side frequency F. The high frequency side frequency F sets a differential upper limit of the second order differentiation.

Here the fundamental frequency of the highest heart beat waveform in the second state of heart beat may be set as the high frequency side frequency F of the second order differential property. In this case the second state of heart beat can be assumed as the during exercise time when the person to be measured are performing exercise. There are individual differences in the heart rate but the heart rate can be set to 220 bpm. This heart rate corresponds to 3.67 Hz.

It is to be noted on the low frequency side the amplification degree around the lower band frequency F of the band pass filter is set to be 1 approximately.

Here the noise component noise components such as motion artifact and disturbance noise during exercise is approximately 3 to 30 Hz. Therefore as shown in if the noise components are superimposed on the frequency characteristic of the aforementioned numerical values example a major part of the noise component during exercise goes out of the passband of the band pass filter and then removed. The noise component in proximity to 3 to 3.67 Hz within the noise component during the exercise overlaps the second order differential property and therefore it is not removed. As discussed above as for the noise component that appears in this frequency range the primary component of the heart beat waveform is emphasized and amplified by the waveform distortion detection slope detection of the present invention generating a difference in crest value between the primary component and the noise component whereby the S N ratio is enhanced and the precision in detecting the heart beat is improved.

Since the frequency characteristic as shown in is based on the aforementioned numeric value example different frequency characteristics appear if different numeric value examples are employed. For example a part of the frequency which indicates the highest amplification degree may be slightly deviated but there is a common trend that the amplification degree increases from the low frequency side to the high frequency side.

In the frequency higher than the high frequency side frequency F the gain is set in such a manner that the gain is not reduced precipitously but it is lowered gradually. Accordingly even when the fundamental frequency and the second harmonic of the heart beat signal are displaced toward a frequency higher than the high frequency side frequency F they are not cut off and can be used for detecting the heart beat. It is further possible that a third harmonic can also contribute to the heart beat detection.

Hereinafter with reference to operations according to the band pass filter and the second order differential property in the first state of heart beat during non exercise will be explained. With reference to operations according to the band pass filter and the second order differential property in the second state of heart beat during exercise will be explained. It is to be noted that a size ratio of each of the frequency components described below is arbitrarily set for illustrative purposes and it does not represent the actual state.

Firstly with reference to operations according to the band pass filter and the second order differential property in the first state of heart beat during non exercise will be explained.

The signal shown in indicates the frequency components that are obtained by allowing the frequency components shown in to pass through the band pass filter as shown in . According to the band pass filter the noise components existing in a frequency domain higher than the higher band frequency F are removed.

The signal as shown in represents the frequency components that are obtained by subjecting the signal after passing the band pass filter to the signal amplification according to the second order differential property as shown in . According to the second order differential property the frequency component around the higher band frequency F is amplified more drastically. In the frequency component of the second harmonic and the noise component are emphasized and amplified.

Next with reference to operations according to the band pass filter and the second order differential property in the second state of heart beat during exercise will be explained.

The signal as shown in represents a frequency components obtained by allowing the aforementioned frequency components as shown in FIG. A to pass through the band pass filter as shown in . The band pass filter removes the noise component and the second harmonic existing in the frequency higher than the higher band frequency F.

The signal as shown in represents frequency components that are obtained by subjecting the signal after passing through the band pass filter to the signal amplification according to the second order differential property as shown in . According to the second order differential property the frequency component around the high frequency side frequency F is amplified more drastically. In the frequency component of the fundamental frequency and the noise component are emphasized and amplified.

Hereinafter with reference to to an example of signal processing by the heart beat signal generating processor A narrowband signal processing will be described. and respectively illustrate the state before processing and the state after processing when no exercise is performed. and respectively illustrate the state before processing and the state after processing immediately after the exercise is initiated. and respectively illustrate the state before processing and the state after processing during exercise. In each of the figures the reference mark a indicates a waveform and the reference mark b indicates a frequency component.

As illustrated in the original waveform before the narrowband signal processing during non exercise shows low amplitude since the blood stream remains at a low level and further the noise level is low because any exercise is performed. illustrates a waveform that is obtained by subjecting this waveform to the narrowband signal processing. According to the waveform distortion by the narrowband signal processing the waveform is deformed from the original waveform but the S N ratio is enhanced. It is to be noted that the solid line in represents a curvature component of the higher band frequency F and the part of the waveform on and higher than this line indicates the primary component of the heart beat.

When the frequency components of and are compared the signal level within the frequency ranges F to F is enhanced according to the narrowband signal processing.

Next a situation immediately after the exercise initiation will be explained. As shown in in the original waveform before the narrowband signal processing immediately after initiation the exercise the blood stream is at the low level and therefore the amplitude of the heart beat waveform is low. However since the exercise is initiated the noise level becomes higher and therefore the S N ratio is deteriorated.

When the frequency component in is compared with the frequency component in the signal level in the frequency range from F to F is enhanced by the narrowband signal processing.

As shown in in the original waveform before the narrowband signal processing during the exercise the heart beat and the blood stream are increased and the amplitude of the heart beat waveform is increased.

In addition when the frequency component in is compared with the frequency component in the signal level including the noise in the frequency range from F to F is enhanced by the narrowband signal processing.

Next with reference to one configuration example of the narrowband signal processing will be explained. It is to be noted here that a digital filter constitutes the example as shown in where an input signal is assumed as a sampling signal.

The band pass filter illustrated in is an example of FIR Finite Impulse Response model. The frequency F and the frequency F in the passband of the narrow band are set by using the sampling period and the factors h to hm defined by the coefficient multipliers .

The second order differential property as illustrated in sets the differential upper limit F by the sampling period and the number of units which are set as the delay units for backward difference.

In the example discussed above there is illustrated a case of the second order differential property as the amplification characteristic of the signal amplification. However the amplification characteristic is not limited to the second order differential property but it may be a first order differentiation or higher order differential property. In addition it may be the amplification characteristic other than the differential property.

Any order of the differential property may be employed however in here an example is shown using the second order differentiation which can obtain the gain of 40 dB for instance considering the level of the S N ratio of the heart beat signal being detected the circuit configuration of the signal processing cost benefit performance and the like.

As the amplification characteristic to achieve a higher gain for a higher frequency domain in addition to the differential property the step like gain as shown in may be employed. In the gain around the frequency F is set to 1 the gain around the high frequency F is set to be higher and therebetween the gain varies stepwise. It is to be noted that the number of steps can be set arbitrarily.

Next the waveform distortion detection slope detection being the heart beat detecting processor C of the present invention will be explained with reference to the flowchart of illustrating a relationship between the period and the slope part illustrating the waveform distortion according to the fundamental frequency illustrating the slope detection using the sampling point and being an actual example of the waveform distortion detection.

In the flowchart shown in the waveform distortion detection slope detection is performed by using sampling values which are obtained by sampling the detected waveform at regular intervals S .

In when the period of the heart beat is assumed as T the waveform distortion detection is performed at the duration of time i.e. a quarter of the period T of the heart beat waveform. In order to perform the waveform distortion detection within the duration of time T 4 when the sampling period is assumed as t successive sampling points S to S are detected the number of which corresponds to the value obtained by dividing the duration of time T 4 by the sampling period t T 4 t . If the values of the sampling points S to S are larger than the frequency component around the frequency of the second harmonic of the highest heart beat waveform during non exercise and the values monotonously increase or monotonously decrease the waveform distortion is detected as a heart beat.

For example if the maximum heart beat F during exercise is assumed as 3.367 Hz for instance the slope detection is performed at the duration of time equal to or less than a quarter of this period 68 msec Here when the sampling period is assumed as 12 msec the detection is performed at the sampling number of times of 5.67 or less. It is to be noted here that if the sampling number of times is larger than this value 5.67 the sampling goes over the quarter period and therefore disabling the slope detection.

In view of this situation above five times are set as the sampling number of times. A sampling value obtained at S is collected for each of the sampling points the number of which is required at least for obtaining angle of the slope and those values are stored in S to S sequentially. It is to be noted that each sampling value is replaced every time the sampling is performed and the sampling value having been replaced is discarded sequentially from the oldest one S .

As a first condition for detecting the waveform distortion it is determined whether or not the values of the sampling points S to S are larger than a set value. As the set value the frequency component around the frequency of the second harmonic of the highest heart beat waveform of the heart beat during non exercise may be employed. As discussed above if the values are larger than this set value it is possible to remove noise component S .

Next as the second condition for detecting the waveform distortion it is determined whether or not the slope of the sampling points S to S indicates continuous monotonous increase or monotonous decrease within a predetermined period.

In the case of all the sampling values S to S are larger than the set value H being the first condition and the sampling values S to S have the relationship S

In the case of all the sampling values S to S are larger than the set value H satisfying the first condition but the sampling value S is smaller than the sampling value S and the second condition of S

If both of the first and the second conditions in S and in S are satisfied it is determined that there has been one heart beat according to this slope part S . Then the heart beat is counted sequentially to obtain a heart rate S and the heart rate being counted is notified. The notification means includes a display and in addition it includes data recording on a recording medium and data transmission to other device.

The configuration as shown in includes a storing means for storing the inputted sampling values S to S sequentially a first comparing means for comparing the sampling values S to S stored in the storing means with the set value a second comparing means in which a result of the comparison from the first comparing means and the sampling values S to S stored in the storing means are inputted and when the sampling values S to S are larger than the set value the order of the sizes of the sampling values S to S is determined and the counter for counting the heart rate based on the result of the determination from the second comparing means .

A method for detecting the heart beat waveform according to the present invention can be applied not only to the heart rate meter but also to an apparatus that measures a body function using the heart beat as one data such as a body function measuring apparatus.

