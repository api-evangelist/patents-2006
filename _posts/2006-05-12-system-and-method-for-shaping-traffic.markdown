---

title: System and method for shaping traffic
abstract: In accordance with embodiments, there are provided mechanisms and methods for shaping traffic. These mechanisms and methods for shaping traffic can enable embodiments to control traffic flow at a network gatekeeper based upon policies implementing service level agreements dictating traffic characteristics permitted to applications and/or by network node. The ability of embodiments to provide service level agreement based control of network traffic can enable control of traffic flow by application and/or by network node.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07788386&OS=07788386&RS=07788386
owner: BEA Systems, Inc.
number: 07788386
owner_city: Redwood Shores
owner_country: US
publication_date: 20060512
---
The present application claims the benefit of U.S. Provisional Patent Application No. 60 733 823 entitled SYSTEM AND METHOD FOR A GATEKEEPER IN A COMMUNICATIONS NETWORK by Reto Kramer et al. filed on Nov. 4 2005 which is incorporated herein by reference in its entirety.

The following commonly owned co pending United States Patents and Patent Applications including the present application are related to each other. Each of the other patents applications are incorporated by reference herein in their entirety 

U.S. patent application Ser. No. 11 378 188 entitled SYSTEM AND METHOD FOR MANAGING COMMUNICATIONS SESSIONS IN A NETWORK by Reto Kramer et al. filed on Mar. 17 2006 

U.S. patent application Ser. No. 11 384 056 entitled SYSTEM AND METHOD FOR A GATEKEEPER IN A COMMUNICATIONS NETWORK by Reto Kramer et al. filed on Mar. 17 2006 

U.S. Patent Application No. 60 800 949 entitled DIAMETER PROTOCOL AND SH INTERFACE SUPPORT FOR SIP SERVER ARCHITECTURE by Anno Langen et al. filed on May 17 2006 

U.S. Patent Application No. 60 801 091 entitled SIP AND HTTP CONVERGENCE IN NETWORK COMPUTING ENVIRONMENTS by Anno Langen et al. filed on May 16 2006 

U.S. Patent Application No. 60 800 943 entitled HITLESS APPLICATION UPGRADE FOR SIP SERVER ARCHITECTURE by Anno Langen et al. filed on May 16 2006 

U.S. Patent Application No. 60 801 083 entitled ENGINE NEAR CACHE FOR REDUCING LATENCY IN A TELECOMMUNICATIONS ENVIRONMENT by Anno Langen et al. filed on May 16 2006 

U.S. patent application Ser. No. 11 434 022 entitled SYSTEM AND METHOD FOR CONTROLLING DATA FLOW BASED UPON A TEMPORAL POLICY by Narendra Vemula et al. filed on May 15 2006 

U.S. patent application Ser. No. 11 434 024 entitled SYSTEM AND METHOD FOR CONTROLLING ACCESS TO LEGACY PUSH PROTOCOLS BASED UPON A POLICY by Bengt Inge Jakobsson et al. filed on May 15 2006 

U.S. patent application Ser. No. 11 434 010 entitled SYSTEM AND METHOD FOR CONTROLLING ACCESS TO LEGACY MULTIMEDIA MESSAGE PROTOCOLS BASED UPON A POLICY by Andreas Janson filed on May 15 2006 and

U.S. patent application Ser. No. 11 434 025 entitled SYSTEM AND METHOD FOR CONTROLLING ACCESS TO LEGACY SHORT MESSAGE PEER TO PEER PROTOCOLS BASED UPON A POLICY by Andreas Janson filed on May 15 2006.

A portion of the disclosure of this patent document contains material which is subject to copyright protection. The copyright owner has no objection to the facsimile reproduction by anyone of the patent document or the patent disclosure as it appears in the Patent and Trademark Office patent file or records but otherwise reserves all copyright rights whatsoever.

The current invention relates generally to managing telecommunications and more particularly to a mechanism for shaping traffic.

Conventionally telecommunications and network infrastructure providers have relied on often decades old switching technology to providing routing for network traffic. Businesses and consumers however are driving industry transformation by demanding new converged voice data and video services. The ability to meet these demands often can be limited by existing IT and network infrastructures that are closed proprietary and too rigid to support these next generation services. As a result telecommunications companies are transitioning from traditional circuit switched Public Switched Telephone Networks PSTN the common wired telephone system used around the world to connect any one telephone to another telephone to Voice Over Internet Protocol VoIP networks. VoIP technologies enable voice communication over vanilla EP networks such as the public Internet. Additionally a steady decline in voice revenues has resulted in heightened competitive pressures as carriers vie to grow data service revenues and reduce chum through the delivery of these more sophisticated data services. Increased federal regulation security and privacy issues as well as newly emerging standards can further compound the pressure.

However delivering these more sophisticated data services has proved to be more difficult than first imagined. Existing IT and network infrastructures closed proprietary network based switching fabrics and the like have proved to be too complex and too rigid to allow the creation and deployment of new service offerings.

The invention is illustrated by way of example and not by way of limitation in the figures of the accompanying drawings in which like references indicate similar elements. References to embodiments in this disclosure are not necessarily to the same embodiment and such references mean at least one. While specific implementations are discussed it is understood that this is done for illustrative purposes only. A person skilled in the relevant art will recognize that other components and configurations may be used without departing from the scope and spirit of the invention.

In the following description numerous specific details are set forth to provide a thorough description of the invention. However it will be apparent to those skilled in the art that the invention may be practiced without these specific details. In other instances well known features have not been described in detail so as not to obscure the invention.

Although a diagram may depict components as logically separate such depiction is merely for illustrative purposes. It can be apparent to those skilled in the art that the components portrayed can be combined or divided into separate software firmware and or hardware components. For example one or more of the embodiments described herein can be implemented in a network accessible device appliance such as a router. Furthermore it can also be apparent to those skilled in the art that such components regardless of how they are combined or divided can execute on the same computing device or can be distributed among different computing devices connected by one or more networks or other suitable communication means.

In accordance with embodiments there are provided mechanisms and methods for shaping traffic. These mechanisms and methods for shaping traffic can enable embodiments to control traffic flow at a network gatekeeper based upon policies implementing service level agreements dictating traffic characteristics permitted to applications and or by network node. The ability of embodiments to provide service level agreement based control of network traffic can enable control of traffic flow by application and or by network node.

In an embodiment and by way of example a system is provided. The system embodiment includes a policy engine to assign a priority to each one of a plurality of service requests received from one or more applications. The priority selected based upon a service level agreement SLA . A manager schedules each one of the plurality of service requests between a plurality of sub queues and at a priority level corresponding to the priority assigned to each service request. A dispatcher randomly assigns each one of a plurality of read operations between the plurality of sub queues weighted by bandwidth fraction of each priority level to select a queue from which to de queue.

As used herein the terms service and web service are used interchangeably and are intended to be broadly construed to include any application program or process resident on one or more computing devices capable of providing services to a requestor or other recipient including without limitation network based applications web based server resident applications web portals search engines photographic audio or video information storage applications e Commerce applications backup or other storage applications sales revenue planning marketing forecasting accounting inventory management applications and other business applications and other contemplated computer implemented services. As used herein the term application broadly includes any data entry update query or program that processes data on behalf of a user. Users may be human or computational entities.

As used herein the term web services protocol is defined as a communications protocol that can be used for providing services between two or more applications over a network. Typical web services protocols include without limitation Short Message Peer to Peer protocol SMPP protocol Push Application Protocol PAP protocol Multimedia Messaging Services MM7 protocol and Internet Message Access Protocol IMAP protocol. As used herein the term legacy protocol is defined as a communications protocol implemented by existing applications or telecommunications systems. As used herein the term policy is defined as a computational object including information for enforcing a limitation a decision or otherwise causing a control point to take some action or refrain from taking some action to shape traffic. As used herein the term shaping traffic is defined to mean maintaining or altering at least one of an amount a rate a bandwidth or any other characteristic of information flow over a channel.

A SIP server and a network gatekeeper comprise a portfolio of product collectively comprise a communications platform . The SIP server provides the communications platform with a subsystem in which application components that interact with SIP based networks may be deployed. The network gatekeeper provides a policy driven telecommunications Web services gateway that allows granular control over access to network resources from un trusted domains.

A variety of shared and re usable software and service infrastructure components comprise the communications platform . For example an application server such as the WebLogic Application Server by BEA Systems Inc. of San Jose Calif. This application server may be augmented and adapted for deployment in telecommunications networks while providing many features and functionality of the WebLogic Server counterpart widely deployed in enterprise computing environments. Application server embodiments for use in the telecommunications applications can provide a variety of additional features and functionality such as without limitation 

Analogously communications platform embodiments can provide a variety of additional features and functionality such as without limitation 

Communications platform comprises a Session Initiation Protocol SIP Server WLSS and a Network Gatekeeper WLNG . Tools for interacting with Web Services such as a Web Service Universal Description Discovery Interface WS UDDI a Web Service Business Process Execution Language WS BPEL may be coupled to the SIP Server and the Network Gatekeeper in embodiments. A log trace and database can assist with troubleshooting. In some deployments the communications platform can interface with processes that monitor underlying network function such as Operations Support Systems Business Support Systems OSS BSS system via RA protocol adapters . RA protocol is a protocol for submission of billing information that are maintained in the network gatekeeper and sent to a carrier s existing billing infrastructure. Embodiments can include one or more of the following services OSS BSS services. For example and without limitation Operations Support Systems services can include activation service assurance usage metering and provisioning including designing assigning and inventory. Business Support Systems can include billing including invoicing rating taxation and collections customer management including order entry customer self services customer care trouble ticketing and customer relationship management. Such interfaces can provide access to Operation Administration and Maintenance OAM applications and others. A policy engine controls access by one or more third party services not shown and services not shown to resource elements not shown in a network layer.

A Service Creation Environment SCE enables service providers to create applications using a higher level programming abstraction tool to expedite application creation. Other types of tools may be provided in embodiments to enable internal staff who are not necessarily software engineers e.g. business analysts IT MIS staff but are programmers or have programming skills e.g. internal software engineers with knowledge of the carrier s network etc. but perhaps less savvy as high power J2EE software engineers to be able to create or modify applications.

A communications platform embodiment can provide an open high performance software based fault tolerant platform that allows operators to maximize revenue potential by shortening time to market and significantly reducing per service implementation and integration cost and complexity. The communications platform is suitable for use by for network infrastructure vendors network operators and communications service providers in multiple deployment scenarios ranging from fully IP multi media subsystem IMS oriented network architectures to hybrid and highly heterogeneous network architectures. It is not restricted to use only in carrier networks however and may be deployed in Enterprise communications networks without restriction or extensive customization. When deployed in conjunction with an IP multimedia subsystem the communications platform can serve in the role of an IMS SIP application server and offers communications service providers an execution environment in which to host applications such as the WebLogic Network Gatekeeper components and standard service enablers. The following diagrams illustrate example network gatekeeper embodiments in telecommunications systems.

As illustrated by and by way of example an embodiment of a communications platform provides an easy to use integrated configuration driven intermediary between service providers third party service providers and end users . The communications platform embodiment illustrated by comprises an application layer with interfaces to applications of the service providers and third party service providers and a network layer to interface with the end users via one or more network resource elements . Communications platform further comprises a gatekeeper layer interposed between the application layer and the network layer for managing and controlling information flowing between layers and .

At the application layer third party service providers and service providers are provided protocol adapters to make services available to callers over a network via the gatekeeper layer provided by the communications platform . Access to network resource elements by services may be achieved using one or more web services protocol adapters . The protocol adapters provide an interface mechanism enabling the network gatekeeper to intercept protocol communications from services and control access to network resource elements by the services in accordance with one or more policies. While illustrated here with reference to an embodiment having adapters to specific protocols including without limitation a Short Message Peer to Peer protocol SMPP protocol adapter a Push Application Protocol PAP protocol adapter a Multimedia Messaging Services MM7 protocol adapter and an Internet Message Access Protocol IMAP protocol adapter embodiments may include any number or kind of protocols and are neither limited to nor required to possess these illustrated protocol adapters.

The gatekeeper layer includes a gatekeeper that comprises a plurality of functional elements working in concert to control access to network resource elements at the network layer by services according to one or more policies. In an embodiment a service level agreement SLA comprises one or more policies governing access to the network layer . A policy engine provides enforcement of the service level agreements. Service level agreements specify e.g. how many messages customer A sends an hour and if over a contract limit customer A starts paying more and so forth. In one embodiment capabilities to create customize and execute service level agreement provisions as policies are provided. A charging mechanism determines charges to callers for making a call using network resource elements e.g. determine charges for network traffic i.e. calls according to charging information payment amount schedule priorities and the like. Charging mechanism may access data including Call Data Records CDR and or Event Data Records EDR in order to determine charges. In one embodiment the charging mechanism determines an allocation of charges to be apportioned to the third party providing the service. As shown by the dotted lines in the actions of the policy engine and other functional elements of the gatekeeper provide virtual isolation layers between services at the application layer and network resource elements at the network layer . The isolation layers indicate that the gatekeeper layer functional elements can be isolated from and unaffected by the particulars of protocols interfaces and the like used by applications services and callers communicating using the network via the gatekeeper .

The gatekeeper layer may include one or more resource interfaces to interface with legacy protocols or other web services protocols as a mechanism to reach callers and end user applications clients via the network layer . While illustrated here with reference having resource interfaces to specific protocols including without limitation an SMPP protocol adapter a PAP protocol adapter an MM7 protocol adapter and an IMAP protocol adapter embodiments may include any number or kind of protocols and are neither limited to nor required to possess these illustrated resource interfaces. An extension toolkit not shown enables partners to develop resource interfaces for other protocols to include into the gatekeeper layer .

Network layer includes one or more resource elements such as without limitation a Parlay protocol gateway an IMS IP multi media subsystem an SMSCs short message service center and MMSCs multi media messaging service center each of which provides a mechanism for moving information through the network to one or more end user services .

The techniques described above with reference to will now be described with reference to an example embodiment that employs counters to measure traffic through the gatekeeper system. In an example embodiment traffic counters are provided for one or more of global node traffic for a service capability application traffic for a service capability and application traffic for a service capability and node id. The application traffic limits are specified in a Service Level Agreement SLA for the application. The global node limit is specified in the global node SLA. Traffic for a certain application can be assigned a priority in the SLA. Traffic can be rejected in policy enforcement point if a specific Application has submitted requests faster than its limit. The service capability enforces overall traffic levels per application and sets traffic priority according to SLA specified limits. On node level the plug in manager enforces specific node limits for each application set in the application level node SLA and global node restrictions set in the node contracts in the global node SLA.

In an embodiment the guarantee and restriction levels may be assigned with a five step priority level. This way different services service providers can have different priorities for their prioritized and non prioritized traffic. It is noteworthy that if the guarantee level is really used as a guarantee to an application the highest possible value should be assigned for all applications. Otherwise the guaranteed traffic for certain value added service providers VASPs will actually have a lower priority compared to guaranteed traffic for other applications.

In an embodiment a technique for an application traffic for a service type and network node id includes a counter that is compared to the value specified in the value added service providers VASPs level node SLA.

To understand how the node level restrictions are enforced the routing concept will next be described with reference to an example embodiment. The network gatekeeper is connected to network nodes through network plug in resource elements . There is typically a plurality of plug in resource elements connected to the same network node at the same time since the network gatekeeper is a distributed system that works in active active mode. Each plug in resource element serves a specific traffic type SMS MMS user location etc and is assigned a certain node ID. If several plug in resource elements are connected to the same network node they will have the same node ID. This node ID is the base of the node contracts in the node SLA s i.e. there is one node contract for each node ID . In an embodiment an OAM procedure Plugin manager setResourceNodeId may be used to prepare this configuration. Multiple plug in resource elements can have the same node id e.g. two CIMD plugins connected to the same SMSC .

A plug in manager enforces the network node level restrictions in two steps a scheduling step and a dispatching step. The scheduling step is entered when a service request has been approved and prioritized according to the service capability level. The plug in manager schedules the service request. The plug in manager will then first determine the set of possible plug in network elements for this request based on the service type SMS user location etc address plan and plug in load level. The available plug in network elements are then passed to the policy rule enforcing the network gatekeeper functionality. This rule will first determine the node ID of each plug in and then compare the current load onto each node with the restrictions in the global node contract and the node contract of the VASP. If the outcome of any of these checks is that load levels for the node have been exceeded the corresponding plug in network element is removed from a list of available plug in network elements . Finally the plug in manager will select a plug in network element from the remaining ones on the list based on a round robin selection scheme.

In the dispatching step a dispatcher randomizes each read operation between sub queues weighted on the bandwidth fractions of each priority level. If the selected queue is empty the dispatcher tries to de queue from the highest priority queue and downwards.

In an embodiment illustrated by each plug in network element has a set of priority queues one for each priority level. If the sub queue corresponding to the given priority is full a request is rejected since the system is then handling more traffic of the specific priority than it is dimensioned to handle. The priority queues have a size that is configurable by a plug in network element manager. When tuning that queue size users consider the amount of traffic that fits in the queue that is lost from the dispatching process if the server that handles that queue is shut down abruptly. The plug in network element manager plug in network element manager and a priority task manager is also configured with a percentage bandwidth distribution between the queues to configure how they share the total network node bandwidth.

The priority task manager dispatches entries from the priority queues at the highest possible rate but the priority task manager that routes data to plug in network elements connected to the same network and referenced by the same node ID and will synchronize their current distribution rate through a global node counter. Once a maximum rate per second specified in the global node contract for that node is reached the dispatchers will stop dispatching until the node counter has been reset i.e. a new second has been entered .

In other aspects the invention encompasses in some embodiments computer apparatus computing systems and machine readable media configured to carry out the foregoing methods. In addition to an embodiment consisting of specifically designed integrated circuits or other electronics the present invention may be conveniently implemented using a conventional general purpose or a specialized digital computer or microprocessor programmed according to the teachings of the present disclosure as will be apparent to those skilled in the computer art.

Appropriate software coding can readily be prepared by skilled programmers based on the teachings of the present disclosure as will be apparent to those skilled in the software art. The invention may also be implemented by the preparation of application specific integrated circuits or by interconnecting an appropriate network of conventional component circuits as will be readily apparent to those skilled in the art.

The present invention includes a computer program product which is a storage medium media having instructions stored thereon in which can be used to program a computer to perform any of the processes of the present invention. The storage medium can include but is not limited to any type of rotating media including floppy disks optical discs DVD CD ROMs microdrive and magneto optical disks and magnetic or optical cards nanosystems including molecular memory ICs or any type of media or device suitable for storing instructions and or data.

Stored on any one of the machine readable medium media the present invention includes software for controlling both the hardware of the general purpose specialized computer or microprocessor and for enabling the computer or microprocessor to interact with a human user or other mechanism utilizing the results of the present invention. Such software may include but is not limited to device drivers operating systems and user applications.

Included in the programming software of the general specialized computer or microprocessor are software modules for implementing the teachings of the present invention including but not limited to providing mechanisms and methods for shaping traffic as discussed herein.

Various embodiments may be implemented using a conventional general purpose or specialized digital computer s and or processor s programmed according to the teachings of the present disclosure as can be apparent to those skilled in the computer art. Appropriate software coding can readily be prepared by skilled programmers based on the teachings of the present disclosure as can be apparent to those skilled in the software art. The invention may also be implemented by the preparation of integrated circuits and or by interconnecting an appropriate network of conventional component circuits as can be readily apparent to those skilled in the art.

Basic features. These include standards services such as Voice mail Caller ID Call waiting and call forwarding the ability to forward a call to a different number .

Advanced features. The list of advanced features is operators specific. Following is a brief list of advanced features 

Call logs The ability to view calls made over a given period of time online ability to associate names with phone numbers integrate call log information to other applications such as IM.

Do not disturb The ability to specify policies around receiving calls for example all calls during office hours to be automatically forwarded to a mobile terminal all calls during the night to be directed to voice mail etc.

Locate me This is advanced call forwarding. Rather than have all calls forwarded to a single location e.g. voice mail when the caller is busy Locate me can try multiple terminals in series or in parallel. For example a user may have two office locations a mobile and a pager and it may make sense to forward a call to both office locations first then the pager and then the mobile terminal. Locate me is another example of feature interaction.

Personal conferencing A user could use an existing application e.g. IM client to schedule a Web audio conference to start at a certain time. Since the IM client already has personal profile information the conferencing system sends out the Web conference link information either through IM and or email to the participants. The phone contact information in the profile is used to automatically ring the participants at the time of the conference.

Lifetime number This is the facility where a single virtual number can travel with a customer wherever they live. Even if they move the old number continues to work and reaches them at their new location. This is really the analog of static IP addresses in a phone network.

Speed dial This is the ability to dramatically expand the list of numbers that can be dialed through short key and accelerator combinations. This is another example of a converged application since it s very likely that when a user will set up this information when they work through the call logs on the operator user portal and the updated information needs to be propagated to the network side in real time.

Depending on the service level agreement users are willing to sign up to the quality of media delivered e.g. of frames per second will vary. The policy engine enables segmenting the customer base by revenue potential and to maximize return on investment made in the network.

A typical example here is the need for applications that have a short lifetime extremely high usage peaks within their lifetime and immediacy. For example voting on American Idol during the show or immediately afterwards has proved to be an extremely popular application.

The final class of applications is one that combines wireline and wireless terminal usage scenarios. An example of an integrated application is the following a mobile terminal user is on a conference call on their way to work. When he reaches his office he enters a special key sequence to transfer the phone call to his office phone. The transfer happens automatically without the user having to dial in the dial in information again. It s important to note hear that this capability be available without the use of any specific support from the hand set a transfer button for example .

Various embodiments include a computer program product which is a storage medium media having instructions stored thereon in which can be used to program a general purpose or specialized computing processor s device s to perform any of the features presented herein. The storage medium can include but is not limited to one or more of the following any type of physical media including floppy disks optical discs DVDs CD ROMs microdrives magneto optical disks holographic storage ROMs RAMs PRAMS EPROMs EEPROMs DRAMs VRAMs flash memory devices magnetic or optical cards nanosystems including molecular memory ICs and any type of media or device suitable for storing instructions and or information. Various embodiments include a computer program product that can be transmitted in whole or in parts and over one or more public and or private networks wherein the transmission includes instructions which can be used by one or more processors to perform any of the features presented herein. In various embodiments the transmission may include a plurality of separate transmissions.

Stored one or more of the computer readable medium media the present disclosure includes software for controlling both the hardware of general purpose specialized computer s and or processor s and for enabling the computer s and or processor s to interact with a human user or other mechanism utilizing the results of the present invention. Such software may include but is not limited to device drivers operating systems execution environments containers user interfaces and applications.

The foregoing description of the preferred embodiments of the present invention has been provided for purposes of illustration and description. It is not intended to be exhaustive or to limit the invention to the precise forms disclosed. Many modifications and variations can be apparent to the practitioner skilled in the art. Embodiments were chosen and described in order to best explain the principles of the invention and its practical application thereby enabling others skilled in the relevant art to understand the invention. It is intended that the scope of the invention be defined by the following claims and their equivalents.

