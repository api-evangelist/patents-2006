---

title: VOIP barge-in support for half-duplex DSR client on a full-duplex network
abstract: Providing VOIP barge-in support for a half-duplex DSR client on a full-duplex network by buffering, in a half-duplex DSR client, input audio from the full-duplex network; playing, through the half-duplex DSR client, the buffered input audio; pausing, during voice activity on the half-duplex DSR client, the playing of the buffered input audio; sending, during voice activity on the half-duplex DSR client, speech for recognition through the full-duplex network to a voice server; receiving in the half-duplex DSR client through the full-duplex network from the voice server notification of speech recognition, the notification bearing a time stamp; and, responsive to receiving the notification, resuming the playing of the buffered input audio, including playing only buffered VOIP audio data bearing time stamps later than the time stamp of the recognition notification.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=07848314&OS=07848314&RS=07848314
owner: Nuance Communications, Inc.
number: 07848314
owner_city: Burlington
owner_country: US
publication_date: 20060510
---
The field of the invention is data processing or more specifically methods apparatus and products for providing voice over the Internet Protocol VOIP barge in support for a half duplex distributed speech recognition DSR client on a full duplex network

User interaction with applications running on small devices through a keyboard or stylus has become increasingly limited and cumbersome as those devices have become increasingly smaller. In particular small handheld devices like mobile phones and PDAs serve many functions and contain sufficient processing power to support user interaction through other modes such as multimodal access. Devices which support multimodal access combine multiple user input modes or channels in the same interaction allowing a user to interact with the applications on the device simultaneously through multiple input modes or channels. The methods of input include speech recognition keyboard touch screen stylus mouse handwriting and others. Multimodal input often makes using a small device easier. Multimodal applications often run on servers that serve up multimodal web pages for display on a multimodal browser. A multimodal browser as the term is used in this specification generally means a web browser capable of receiving multimodal input and interacting with users with multimodal output. Multimodal browsers typically render web pages written in XHTML Voice X V . X V provides a markup language that enables users to interact with an multimodal application often running on a server through spoken dialog in addition to traditional means of input such as keyboard strokes and mouse pointer action. X V adds spoken interaction to standard web content by integrating XHTML extensible Hypertext Markup Language and speech recognition vocabularies supported by VoiceXML. For visual markup X V includes the XHTML standard. For voice markup X V includes a subset of VoiceXML. For synchronizing the VoiceXML elements with corresponding visual interface elements X V uses events. XHTML includes voice modules that support speech synthesis speech dialogs command and control and speech grammars. Voice handlers can be attached to XHTML elements and respond to specific events. Voice interaction features are integrated with XHTML and can consequently be used directly within XHTML content.

The performance of speech recognition systems receiving speech that has been transmitted over voice channels particularly mobile channels can be significantly degraded when compared to using an unmodified signal. The degradations are as a result of both relatively low bit rate speech coding and channel transmission errors. A Distributed Speech Recognition DSR system addresses these problems by eliminating the speech channel and instead using an error protected data channel to send a parameterized representation of the speech which is suitable for recognition. The processing is distributed between terminal or client device and a voice server. The client performs the feature parameter extraction the front end of the speech recognition function. The speech features then are transmitted over a data channel to a remote back end recognizer or speech recognition engine on a voice server. This architecture substantially reduces transmission channel effects on speech recognition performance.

In many instances of client devices however the client device is capable of half duplex communication only. That is the client device may accept audio input from a user or deliver audio output to a user but cannot do both at the same time. The data communications full duplex network that connects the half duplex DSR client to a voice server typically is a full duplex network capable of sending data and receiving data to and from a client device both at the same time. Barge in is a feature of a DSR system that allows a user to interrupt at any time while a prompt is playing permitting natural exchange between an experienced user and the DSR system. In a DSR system that supports half duplex DSR clients barge in support is a challenge because audio input from TTS conversion on a voice server for example may be played to a user despite the fact that the user attempted a barge in because of the half duplex nature of the DSR client that can send or receive audio but not both at the same time.

Methods apparatus and computer program products are described for providing VOIP barge in support for a half duplex DSR client on a full duplex network by buffering in a half duplex DSR client input audio from the full duplex network where the input audio includes VOIP audio data for output through the half duplex DSR client and the buffered input audio bears time stamps playing through the half duplex DSR client the buffered input audio pausing during voice activity on the half duplex DSR client the playing of the buffered input audio sending during voice activity on the half duplex DSR client speech for recognition through the full duplex network to a voice server receiving in the half duplex DSR client through the full duplex network from the voice server notification of speech recognition the notification bearing a time stamp and responsive to receiving the notification resuming the playing of the buffered input audio including playing only buffered VOIP audio data bearing time stamps later than the time stamp of the recognition notification.

The foregoing and other objects features and advantages of the invention will be apparent from the following more particular descriptions of exemplary embodiments of the invention as illustrated in the accompanying drawings wherein like reference numbers generally represent like parts of exemplary embodiments of the invention.

Exemplary methods apparatus and products for providing VOIP barge in support for a half duplex DSR client on a full duplex network according to embodiments of the present invention are described with reference to the accompanying drawings beginning with . sets forth a network diagram illustrating an exemplary system for providing VOIP barge in support for a half duplex DSR client on a full duplex network according to embodiments of the present invention.

The system of operates generally to provide VOIP barge in support for a half duplex DSR client on a full duplex network according to embodiments of the present invention by buffering in a half duplex DSR client input audio from the full duplex network where the input audio includes VOIP audio data for output through the half duplex DSR client and the buffered input audio bears time stamps playing through the half duplex DSR client the buffered input audio pausing during voice activity on the half duplex DSR client the playing of the buffered input audio sending during voice activity on the half duplex DSR client speech for recognition through the full duplex network to a voice server receiving in the half duplex DSR client through the full duplex network from the voice server notification of speech recognition the notification bearing a time stamp and responsive to receiving the notification resuming the playing of the buffered input audio including playing only buffered VOIP audio data bearing time stamps later than the time stamp of the recognition notification. In this example input audio from the full duplex network is implemented as Voice Over Internet Protocol VOIP .

A half duplex DSR client is an automated device automated computing machinery or a computer program running on an automated device that is capable of accepting speech input and streaming digitized speech to a voice server for recognition. The digitized speech may be compressed according to telephony industry standard codecs including those used for Distributed Speech Recognition. A half duplex DSR client may be implemented for example as a voice enabled browser on a laptop a voice browser on a telephone handset an online game implemented with Java on a personal computer and with other combinations of hardware and software as may occur to those of skill in the art.

As explained in more detail below each of the example half duplex DSR clients in the system of includes a microphone an audio amplifier a digital to analog converter and a DSR client software application capable of accepting from a user speech for recognition parameterizing the speech by extracting speech parameters and sending the speech to a voice server for recognition. The half duplex DSR clients in this example are also typically capable of employing voice activity detection VAD to distinguish voice activity from non voice audio signals and identify only the voice activity as speech to be transmitted for recognition.

Each of the example half duplex DSR clients in the system of is capable of providing VOIP barge in support for a half duplex DSR client on a full duplex network according to embodiments of the present invention by buffering in the half duplex DSR client input audio from the full duplex network where the input audio is composed of VOIP audio data for output through the half duplex DSR client playing through the half duplex DSR client the buffered input audio pausing during voice activity on the half duplex DSR client the playing of the buffered input audio sending during voice activity on the half duplex DSR client speech for recognition through the full duplex network to a voice server receiving in the half duplex DSR client through the full duplex network from the voice server notification of speech recognition the notification bearing a time stamp and responsive to receiving the notification resuming the playing of the buffered input audio including playing only buffered VOIP audio data bearing time stamps later than the time stamp of the recognition notification. The use of these four example half duplex DSR clients is for explanation only not for limitation of the invention. Any automated computing machinery capable of accepting speech from a user sending the speech to a voice server and receiving and playing speech prompts and responses from the voice server may function as a half duplex DSR client for providing VOIP barge in support according to embodiments of the present invention.

The system of also include a voice server which is connected to full duplex network through full duplex wireline connection . The voice server is a computer that runs a DSR server application program that provides voice recognition services for half duplex DSR clients by accepting requests for speech recognition and returning text representing recognized speech. Voice server also provides text to speech TTS conversion for voice prompts and voice responses to user input in DSR client applications such as for example X V applications or Java Speech applications. In some embodiments the voice server may be configured to provide in response to a request from a half duplex DSR client for text to speech conversion time stamps on audio prompts and responses that are then streamed back as part of the audio input to the half duplex device in such an embodiment the time stamps represent the time when audio packets are transmitted from the voice server. Alternatively the voice server may be configured to provide in response to a request from a half duplex DSR client for text to speech conversion audio prompts and responses without time stamps that are streamed back as part of the audio input to the half duplex device and the half duplex device may then be configured to insert time stamps representing the time when audio packets are received in the half duplex device.

Voice server also provides to a half duplex DSR client a notification of voice recognition when the voice server recognizes speech sent to the voice server from the half duplex DSR client for recognition. The voice server may include a time stamp on the notification of voice recognition the time stamp representing the time when the notification is transmitted from the voice server. Alternatively the voice server may transmit the notification without a time stamp and the half duplex device may be configured to associate a time stamp with the notification the time stamp in that case representing the time when the notification is received at the half duplex DSR client.

The system of includes a full duplex network that connects the half duplex DSR clients and the voice server for data communications. A full duplex network for providing VOIP barge in support for a half duplex DSR client on a full duplex network according to embodiments of the present invention is a data communications full duplex network composed of a plurality of computers that function as data communications routers connected for data communications with a packet switching protocols. Such a full duplex network may be implemented with optical connections wireline connections or with wireless connections. Such a full duplex network may include intranets internets local area full duplex networks LANs and wide area full duplex networks WANs . Such a full duplex network may implement 

The arrangement of the voice server the half duplex DSR clients and the full duplex network making up the exemplary system illustrated in are for explanation not for limitation. Data processing systems useful for providing VOIP barge in support for a half duplex DSR client on a full duplex network according to various embodiments of the present invention may include additional servers routers other devices and peer to peer architectures not shown in as will occur to those of skill in the art. Full duplex networks in such data processing systems may support many data communications protocols in addition to those noted above. Various embodiments of the present invention may be implemented on a variety of hardware platforms in addition to those illustrated in .

Providing VOIP barge in support for a half duplex DSR client on a full duplex network in accordance with the present invention is generally implemented with one or more voice servers computers that is automated computing machinery that provide speech recognition. For further explanation therefore sets forth a block diagram of automated computing machinery comprising an example of a computer useful as a voice server in providing VOIP barge in support for a half duplex DSR client on a full duplex network according to embodiments of the present invention. The voice server of includes at least one computer processor or CPU as well as random access memory RAM which is connected through a high speed memory bus and bus adapter to processor and to other components of the voice server.

Stored in RAM is a DSR server application a module of computer program instructions capable of operating a voice server in a system that supports providing VOIP barge in support for a half duplex DSR client on a full duplex network according to embodiments of the present invention by providing voice recognition services for half duplex DSR clients by accepting requests for speech recognition and returning text representing recognized speech. DSR server application also includes computer program instructions that provide text to speech TTS conversion for voice prompts and voice responses to user input in DSR client applications such as for example X V applications or Java Speech applications. In some embodiments the DSR server application may be configured to provide in response to a request from a half duplex DSR client for text to speech conversion time stamps on audio prompts and responses that are then streamed back as part of the audio input to the half duplex device in such an embodiment the time stamps represent the time when audio packets are transmitted from the voice server. Alternatively the DSR server application may be configured to provide in response to a request from a half duplex DSR client for text to speech conversion audio prompts and responses without time stamps that are streamed back as part of the audio input to the half duplex device and the half duplex device may then be configured to insert time stamps representing the time when audio packets are received in the half duplex device.

DSR server application also includes computer program instructions that provide to a half duplex DSR client a notification of voice recognition when the voice server recognizes speech sent to the voice server from the half duplex DSR client for recognition. The DSR server application may include a time stamp on the notification of voice recognition the time stamp representing the time when the notification is transmitted from the voice server to the half duplex device. Alternatively the DSR server application may transmit the notification without a time stamp and the half duplex DSR client may be configured to associate a time stamp with the notification the time stamp in that case representing the time when the notification is received at the half duplex DSR client.

DSR server application typically is a user level multimodal server side computer program. DSR server application may for example be implemented with a set of VoiceXML documents which taken together comprise a VoiceXML application. DSR server application may for example alternatively be implemented as a web server that supports X V by providing responses to HTTP requests from X V clients.

Also stored in RAM is a VoiceXML interpreter a module of computer program instructions that parses and executes VoiceXML. VoiceXML input to VoiceXML interpreter may originate from VoiceXML clients of half duplex DSR clients or from X V clients of half duplex DSR clients. In this example VoiceXML interpreter interprets and executes VoiceXML segments provided to VoiceXML interpreter through DSR server application .

Also stored in RAM is a speech recognition engine a module of computer program instructions that accepts digitizedspeech for recognition as preprocessed by a half duplex DSR client converts the digitizedspeech to text parses the converted speech against a vocabulary or grammar and returns text representing recognized speech. Also stored in RAM is a Text To Speech TTS Engine a module of computer program instructions that accepts text as input and returns the same text in the form of digitally encoded speech for use in providing speech as prompts for and responses to users of DSR systems. In this example such digitally encoded speech is provided by the voice server for streaming as input audio in the form of VOIP through a full duplex network to a half duplex DSR client.

Also stored in RAM is an operating system . Operating systems useful in voice servers according to embodiments of the present invention include UNIX Linux Microsoft NT AIX IBM s i5 OS and others as will occur to those of skill in the art. Operating system DSR server application VoiceXML interpreter speech recognition engine and Text To Speech Engine in the example of are shown in RAM but many components of such software typically are stored in non volatile memory also for example on disk drive .

Voice server of includes bus adapter a computer hardware component that contains drive electronics for high speed buses the front side bus the video bus and the memory bus as well as drive electronics for the slower expansion bus . Examples of bus adapters useful in voice servers according to embodiments of the present invention include the Intel Northbridge the Intel Memory Controller Hub the Intel Southbridge and the Intel I O Controller Hub. Examples of expansion buses useful in voice servers according to embodiments of the present invention include Industry Standard Architecture ISA buses and Peripheral Component Interconnect PCI buses.

Voice server of includes disk drive adapter coupled through expansion bus and bus adapter to processor and other components of the voice server . Disk drive adapter connects non volatile data storage to the voice server in the form of disk drive . Disk drive adapters useful in voice servers include Integrated Drive Electronics IDE adapters Small Computer System Interface SCSI adapters and others as will occur to those of skill in the art. In addition non volatile computer memory may be implemented for a voice server as an optical disk drive electrically erasable programmable read only memory so called EEPROM or Flash memory RAM drives and so on as will occur to those of skill in the art.

The example voice server of includes one or more input output I O adapters . I O adapters in voice servers implement user oriented input output through for example software drivers and computer hardware for controlling output to display devices such as computer display screens as well as user input from user input devices such as keyboards and mice. The example voice server of includes a video adapter which is an example of an I O adapter specially designed for graphic output to a display device such as a display screen or computer monitor. Video adapter is connected to processor through a high speed video bus bus adapter and the front side bus which is also a high speed bus.

The exemplary voice server of includes a communications adapter for data communications with other computers and for data communications with a full duplex network . Such data communications may be carried out serially through RS 232 connections through external buses such as a Universal Serial Bus USB through data communications full duplex networks such as IP full duplex networks and in other ways as will occur to those of skill in the art. Communications adapters implement the hardware level of data communications through which one computer sends data communications to another computer directly or through a full duplex network. Examples of communications adapters useful for providing VOIP barge in support for a half duplex DSR client on a full duplex network streaming audio through a full duplex network to a half duplex DSR client according to embodiments of the present invention include modems for wired dial up communications Ethernet IEEE 802.3 adapters for wired full duplex network communications and 802.11 adapters for wireless full duplex network communications.

Providing VOIP barge in support for a half duplex DSR client on a full duplex network in accordance with the present invention is generally implemented with one or more half duplex DSR clients that is automated computing machinery or computers. In the system of for example all the half duplex DSR clients are implemented to some extent at least as computers. For further explanation therefore sets forth a block diagram of automated computing machinery comprising an example of a computer useful as a half duplex DSR client in providing VOIP barge in support for a half duplex DSR client on a full duplex network according to embodiments of the present invention. The half duplex DSR client of includes at least one computer processor or CPU as well as random access memory RAM which is connected through a high speed memory bus and bus adapter to processor and to other components of the half duplex DSR client.

Stored in RAM is a half duplex DSR client application a module of computer program instructions capable of providing VOIP barge in support for a half duplex DSR client on a full duplex network according to embodiments of the present invention by buffering input audio from a full duplex network where the input audio includes VOIP audio data for output through the half duplex DSR client and the buffered input audio bears time stamps playing the buffered input audio pausing during voice activity on the half duplex DSR client the playing of the buffered input audio sending during voice activity on the half duplex DSR client speech for recognition through the full duplex network to a voice server receiving through the full duplex network from the voice server notification of speech recognition the notification bearing a time stamp and responsive to receiving the notification resuming the playing of the buffered input audio including playing only buffered VOIP audio data bearing time stamps later than the time stamp of the recognition notification.

Also in RAM is an input memory buffer . Input memory buffer is a segment of memory organized by a data structure such as for example a FIFO queue as a buffer for temporary storage of input audio from a full duplex network. The input audio is packets of computer data digitally encoded packets of VOIP audio data to be output in sequence through the half duplex DSR client that is played through a sound card decoded by a codec amplified by an audio amplifier and output through an audio speaker to the ear of a user.

Also in RAM is an output memory buffer . Output memory buffer is a segment of memory organized by a data structure such as for example a FIFO queue as a buffer for temporary storage of speech for recognition in a half duplex DSR client. The speech for recognition is packets of computer data digitally encoded packets of VOIP audio data to be output in sequence from the half duplex DSR client to a full duplex network.

Also in RAM is a media thread of the DSR client application . Media thread is a set of computer program instructions capable of controlling a half duplex DSR client so as to play buffered input audio and pause the play of buffered input audio during voice activity on the half duplex DSR client. Media thread may record speech for recognition during the voice activity for transmission to a voice server. Or media thread may provide speech for recognition directly to a send thread for transmission to a voice server through a shared memory segment or some other method of inter process communication. Or in some embodiments media thread may itself be configured to transmit speech for recognition to a voice server.

Media thread may be configured to receive through a full duplex network from a voice server notification of speech recognition the notification bearing a time stamp. The voice server may affix the time stamp representing the time when the notification is transmitted from the voice server or the media thread in such an embodiment may affix the time stamp to represent the time when the notification is received in the half duplex DSR client.

Media thread responsive to receiving a notification of voice recognition is configured to resume the playing of the buffered input audio including playing only buffered VOIP audio data bearing time stamps later than the time stamp of the recognition notification. That is media thread is configured to discard buffered input audio bearing time stamps earlier than the time when the notification of speech recognition was sent from the voice server. Or if the notification is not time stamped by the voice server media thread may be configured to discard buffered input audio bearing time stamps earlier than the time when the notification of speech recognition is received in the half duplex DSR client.

Also in RAM is a receive thread of the DSR client application . Receive thread is a set of computer program instructions capable of causing a half duplex DSR client to buffer input audio by receiving VOIP audio data through an input audio stream from a full duplex network and storing the VOIP audio data in an input memory buffer. In addition in embodiments where the media thread is not configured to receive the notification of speech recognition for example receive thread may be configured to receive through a full duplex network from a voice server notification of speech recognition the notification bearing a time stamp. The voice server may affix the time stamp representing the time when the notification is transmitted from the voice server or the media thread in such an embodiment may affix the time stamp to represent the time when the notification is received in the half duplex DSR client.

Also in RAM is a send thread of the DSR client application . Send thread is a set of computer program instructions capable of causing a half duplex DSR client to send speech for recognition from an output memory buffer through an output audio stream to a full duplex network.

Also stored in RAM is a speech parameter extraction engine a module of computer program instructions that accepts digitally encoded speech from a sound card for example extracts from the encoded speech parameters that describe the speech sufficiently to support speech recognition and provides the parameterized speech to the DSR client application for sending to a voice server.

Also stored in RAM is an operating system . Operating systems useful in half duplex DSR clients according to embodiments of the present invention include UNIX Linux Microsoft NT AIX IBM s i5 OS and others as will occur to those of skill in the art. Operating system half duplex DSR client application and speech parameter extraction engine in the example of are shown in RAM but many components of such software typically are stored in non volatile memory also.

The half duplex DSR client of includes a bus adapter a computer hardware component that contains drive electronics for the high speed buses the front side bus the video bus and the memory bus as well as for the slower expansion bus . Examples of bus adapters useful in half duplex DSR clients according to embodiments of the present invention include the Intel Northbridge the Intel Memory Controller Hub the Intel Southbridge and the Intel I O Controller Hub. Examples of expansion buses useful in half duplex DSR clients according to embodiments of the present invention include Industry Standard Architecture ISA buses and Peripheral Component Interconnect PCI buses.

Half duplex DSR client of includes disk drive adapter coupled through expansion bus and bus adapter to processor and other components of the half duplex DSR client . Disk drive adapter connects non volatile data storage to the half duplex DSR client in the form of disk drive . Disk drive adapters useful in half duplex DSR clients include Integrated Drive Electronics IDE adapters Small Computer System Interface SCSI adapters and others as will occur to those of skill in the art. In addition non volatile computer memory may be implemented for a half duplex DSR client as an optical disk drive electrically erasable programmable read only memory space so called EEPROM or Flash memory RAM drives and so on as will occur to those of skill in the art.

The example half duplex DSR client of includes one or more input output I O adapters . I O adapters in half duplex DSR clients implement user oriented input output through for example software drivers and computer hardware for controlling output to display devices such as computer display screens as well as user input from user input devices such as keyboards and mice. The example half duplex DSR client of includes video adapter which is an example of an I O adapter specially designed for graphic output to a display device such as a display screen or computer monitor. Video adapter is connected to processor through a high speed video bus bus adapter and the front side bus which is also a high speed bus.

The example half duplex DSR client of also includes sound card which is an example of an I O adapter specially designed for accepting analog audio signals from a microphone and converting the audio analog signals to digital form for further processing by a VAD engine and a speech parameter extraction engine . Sound card is connected to processor through expansion bus bus adapter and front side bus .

The exemplary half duplex DSR client of includes a communications adapter for data communications with other computers and for data communications with full duplex network . Such data communications may be carried out through serially through RS 232 connections through external buses such as a Universal Serial Bus USB through data communications full duplex networks such as IP full duplex networks and in other ways as will occur to those of skill in the art. Communications adapters implement the hardware level of data communications through which one computer sends data communications to another computer directly or through a full duplex network. Examples of communications adapters useful for providing VOIP barge in support for a half duplex DSR client on a full duplex network according to embodiments of the present invention include modems for wired dial up communications Ethernet IEEE 802.3 adapters for wired full duplex network communications and 802.11b adapters for wireless full duplex network communications.

For further explanation sets forth a functional block diagram of exemplary apparatus for providing VOIP barge in support for a half duplex DSR client on a full duplex network according to embodiments of the present invention. The example of includes a half duplex DSR client that as explained in more detail below can play audio output or accept speech input but cannot do both at the same time.

The example half duplex DSR client includes an input memory buffer a segment of memory organized by a data structure such as for example a FIFO queue as a buffer for temporary storage of input audio from a full duplex network . The example half duplex DSR client also includes an output memory buffer a segment of memory organized by a data structure such as for example a FIFO queue as a buffer for temporary storage of speech for recognition to be sent in sequence from the half duplex DSR client to a full duplex network .

The example half duplex DSR client also includes a media thread which is as explained in more detail below a set of computer program instructions capable of controlling a half duplex DSR client so as to play buffered input audio and pause the play of buffered input audio during voice activity on the half duplex DSR client. Media thread may record speech for recognition during the voice activity for transmission to a voice server in an output memory buffer for example. Or media thread may provide speech for recognition directly to a send thread for transmission to a voice server through a shared memory segment or some other method of inter process communication for example. Or in some embodiments media thread may itself be configured to transmit speech for recognition to a voice server through its own VOIP connection for example.

Media thread may be configured to receive through a full duplex network from a voice server notification of speech recognition the notification bearing a time stamp. Media thread may receive notification of speech recognition out of band in this sense Buffering input audio may be carried out by a receive thread that receives VOIP audio data from an input audio stream in accordance with a first VOIP data communications protocol RTP or H.323 for example while the media thread receives notification of speech recognition through a second out of band VOIP data communications protocol the IETF s Distributed Multimodal Synchronization Protocol DMSP or SIP for example. In this way the input audio from the voice server is received according to one protocol and the speech recognition notification is received out of band through another protocol in fact even through a separate data stream a separate VOIP connection and a separate full duplex connection to the network . Media thread may establish its own VOIP connection through the full duplex network to voice server as for example a Transmission Control Protocol TCP connection using for example a socket implemented with a sockets application programming interface API for TCP and attach an input data stream to the socket through which the media thread may receive from the voice server notifications of speech recognition. The voice server may affix the time stamp representing the time when the notification is transmitted from the voice server or the media thread in such an embodiment may affix the time stamp to represent the time when the notification is received in the half duplex DSR client.

Media thread responsive to receiving a notification of voice recognition is configured to resume the playing of the buffered input audio including playing only buffered VOIP audio data bearing time stamps later than the time stamp of the recognition notification. That is media thread is configured to discard buffered input audio bearing time stamps earlier than the time when the notification of speech recognition was sent from the voice server. Or if the notification is not time stamped by the voice server media thread may be configured to discard buffered input audio bearing time stamps earlier than the time when the notification of speech recognition is received in the half duplex DSR client.

The example half duplex DSR client also includes a receive thread a set of computer program instructions capable of causing a half duplex DSR client to buffer input audio by receiving VOIP audio data through an input audio stream from a full duplex network and storing the VOIP audio data in an input memory buffer . In addition in embodiments where the media thread is not configured to receive the notification of speech recognition directly through its own data communications connection for example receive thread may be configured to receive through a full duplex network from a voice server notification of speech recognition the notification bearing a time stamp.

In such embodiments the receive thread receives VOIP audio data from an input audio stream in accordance with a VOIP data communications protocol and also receives notification of speech recognition through the same VOIP data communications protocol RTP or H.323 for example. RTP or an H.323 protocol may be modified to include notifications of speech recognition by use of an existing flag field in a current message type or such a protocol may be improved by addition of a new message type to represent a notification of speech recognition. This configuration is an in band notification where the notification is received through the same protocol used to stream the input audio from the voice server to the half duplex DSR client.

In such embodiments the receive thread is configured to provide the received notification of speech recognition to the media thread after which the media thread will discard from the input memory buffer all buffered input audio having time stamps earlier than the time stamp on the notification and resume playing the buffered input audio. The voice server may affix the time stamp representing the time when the notification is transmitted from the voice server or the receive thread in such an embodiment may affix the time stamp to represent the time when the notification is received in the half duplex DSR client.

The example half duplex DSR client also includes a send thread a set of computer program instructions capable of causing a half duplex DSR client to send speech for recognition from an output memory buffer through an output audio stream to a full duplex network . As mentioned above the media thread the receive thread and the send thread typically are implemented as components of a DSR client application program of the half duplex DSR client.

The example half duplex DSR client also includes an operating system . Operating systems useful in half duplex DSR clients according to embodiments of the present invention include UNIX Linux Microsoft NT AIX IBM s i5 OS and others as will occur to those of skill in the art.

The example half duplex DSR client includes a sound card that in turn includes an analog to digital converter a codec an audio amplifier and a voice activity detection VAD engine . The analog to digital converter accepts an analog audio signal from a microphone and converts the signal to digital form which is then encoded into a standard audio encoding format by codec which then may be recorded in output memory buffer to be sent to full duplex network . Codec is also capable of decoding buffered input audio to be played to a user through an audio speaker .

The sound card also includes a voice activity detection VAD engine a module of computer program instructions that detect voice activity on the microphone of the half duplex DSR client and advise media thread of the voice activity. There are a number of ways in which VAD engine may detect voice activity 

Having detected voice activity the VAD engine may advise media thread of the voice activity by use of a VAD interrupt. That is VAD engine is configured to cause the sound card to issue an operating system interrupt referred to here as a VAD interrupt and media thread is configured with an interrupt handler that is registered in the operating system of the half duplex DSR client as a listener for VAD interrupts from the sound card. VAD interrupts may include at least two types one advising onset of voice activity and another advising cessation of voice activity.

Half duplex DSR client is half duplex in this sense The sound card in this example can accept as input buffered input audio to play through a speaker to a user or the sound card can provide output of digitized encoded audio signals for media thread to record but the sound card cannot both accept input for playing and provide output for recording at the same time. Similarly the media thread is configured to provide buffered input audio as input to the sound card for playing to a user or to accept output for recording but not both at the same time.

Media thread is configured to avoid loss of input audio therefore by playing buffered input audio through the sound card until receipt of a VAD interrupt indicating onset of voice activity. Then during voice activity that is before notification of speech recognition the media thread records output from the sound card as speech for recognition in output memory buffer . After receiving a notification of speech recognition the media thread resumes the playing of the buffered input audio playing only buffered input audio bearing time stamps later than the time stamp of the recognition notification.

Because buffered input audio packets from the full duplex network are buffered during voice activity the receive thread runs all the time the input memory buffer contains input audio that becomes irrelevant when voice activity representing a barge in begins. When the media thread resumes the playing of the buffered input audio after receiving notification of speech recognition playing only buffered input audio bearing time stamps later than the time stamp of the recognition notification none of the now irrelevant buffered input audio is played. Discarding buffered input audio bearing time stamps earlier than the notification of speech recognition discards buffered input audio representing prompts and responses rendered irrelevant by the barge in. Rather than being forced to listen to prompts and responses that the user now knows to be irrelevant the user is smoothly presented with the next pertinent prompt or response through the half duplex DSR client.

In this example the media thread records speech for recognition in the output memory buffer . In effect speech for recognition is buffered in a manner similar to the buffering of input audio. Because the speech for recognition is so recorded the send thread can begin sending the speech for recognition as soon as voice activity begins asynchronously with respect to the recording process with no need to wait until all the speech for recognition has been recorded. The media thread upon cessation of voice activity blocks or waits until receipt of a voice recognition notification. Send thread sends the speech for recognition to the full duplex network asynchronously with respect to the recording process in accordance with a VOIP protocol.

VOIP standing for Voice Over Internet Protocol is a generic term for routing speech over an IP based full duplex network. The speech data flows over a general purpose packet switched full duplex network instead of traditional dedicated circuit switched voice transmission lines. Protocols used to carry voice signals over the IP full duplex network are commonly referred to as Voice over IP or VOIP protocols. VOIP traffic may be deployed on any IP full duplex network including full duplex networks lacking a connection to the rest of the Internet for instance on a private building wide local area full duplex network or LAN. 

Many protocols are used to effect VOIP. The two most popular types of VOIP are effected with the IETF s Session Initiation Protocol SIP and the ITU s protocol known as H.323. SIP clients use TCP and UDP port to connect to SIP servers. SIP itself is used to set up and tear down calls for speech transmission. VOIP with SIP then uses RTP for transmitting the actual encoded speech. Similarly H.323 is an umbrella recommendation from the standards branch of the International Telecommunications Union that defines protocols to provide audio visual communication sessions on any packet full duplex network.

Methods for COding DECoding speech are referred to as codecs. The European Telecommunications Standards Institute ETSI provides several codecs for encoding speech for use in DSR including for example the ETSI ES 201 108 DSR Front end Codec the ETSI ES 202 050 Advanced DSR Front end Codec the ETSI ES 202 211 Extended DSR Front end Codec and the ETSI ES 202 212 Extended Advanced DSR Front end Codec. In standards such as RFC3557 entitled

In the example of therefore the VOIP connection may implement a full duplex network connection through which audio may stream in both directions at the same time as for example a Transmission Control Protocol TCP connection using for example a socket implemented with a sockets application programming interface API for TCP. The send thread may attach an output audio stream to the socket and the receive thread may attach an input audio stream to the socket. Then the send thread may receive input audio from the full duplex network through the input audio stream and the receive thread may send output audio to the full duplex network through the output audio thread both effectively at the same time.

For further explanation sets forth a flow chart illustrating an exemplary method of providing VOIP barge in support for a half duplex DSR client on a full duplex network according to embodiments of the present invention. In the following discussion the method of is described with reference to the method elements in the flow chart of and also with reference to the system illustrated in .

The method of includes buffering in the half duplex DSR client input audio from the full duplex network the input audio comprising VOIP audio data for output through the half duplex DSR client. In the method of the input audio from the full duplex network may be implemented as VOIP and the half duplex DSR client may include a DSR client application . In the method of buffering input audio may be carried out by receiving by a receive thread reference on that is a component of the DSR client application VOIP audio data as VOIP from the full duplex network through an input audio stream on and storing the VOIP audio data in an input memory buffer on .

In this example the buffered input audio bears time stamps. The time stamps are data values in the structure of the buffered input audio representing either the time when a packet of input audio data was transmitted from the voice server or when the packet was received in the half duplex DSR client. A receive thread on of a half duplex DSR client for example may insert time stamps in the buffered input audio the time stamps indicating when the input audio was received by the half duplex DSR client. Alternatively the voice server may insert time stamps in the VOIP audio data the time stamps indicating when the audio was transmitted from the voice serve to the half duplex DSR client. Inserting the time stamps by the server reduces the complexity of the half duplex DSR client and it is anticipated that there will be many more half duplex DSR clients than voice servers. Moreover many half duplex DSR clients will be small devices cell phones PDAs and the like. On the other hand inserting the time stamps by the half duplex DSR client saves network bandwidth. Which is preferred depends on the particular DSR implementation.

The method of also includes playing through the half duplex DSR client the buffered input audio . In the method of playing the buffered input audio may be implemented by playing the buffered input audio by a media thread on . Such a media thread may be implemented as a component of DSR client application .

The method of also includes detecting voice activity on the half duplex DSR client. In the method of detecting voice activity on the half duplex DSR client may be carried out by detecting voice activity by a VAD engine on and advising by the VAD engine a media thread on of the voice activity. As described in more detail above the VAD engine may advise the media thread of voice activity by use of a VAD interrupt.

The method of also includes pausing during voice activity on the half duplex DSR client the playing of the buffered input audio . In the method of pausing the playing of the buffered input audio may be implemented by pausing the playing of the buffered input audio by a media thread on .

The method of also includes sending during voice activity on the half duplex DSR client speech for recognition to be sent to the full duplex network and through the network to the voice server . In the method of sending speech for recognition to the full duplex network may be carried out by sending by a send thread on speech for recognition as recorded by a media thread on in an output memory buffer on .

The method of also includes receiving in the half duplex DSR client through the full duplex network from the voice server notification of speech recognition where the notification bears a time stamp. The time stamp is a value in a data field of the notification data structure representing the time when the notification was transmitted from the voice server or the time when the notification was received in the half duplex DSR client. The time stamp borne by the notification may be affixed by the voice server to the notification of speech recognition so that the time stamp represents the time when the notification is sent from the voice server to the half duplex DSR client. Alternatively the time stamp may be affixed to the notification by a receive thread or a media thread when the notification is received in the half duplex DSR client. If the time stamp is affixed to the notification in the half duplex DSR client the time stamp represents the time when the notification was received in the half duplex DSR client.

Receiving in the half duplex DSR client through the full duplex network from the voice server notification of speech recognition may carried out in band where buffering input audio is carried out receiving by a receive thread on VOIP audio data from an input audio stream in accordance with a VOIP data communications protocol and receiving notification of speech recognition is effected the same VOIP data communications protocol RTP or H.323 for example. Receiving in the half duplex DSR client through the full duplex network from the voice server notification of speech recognition may carried out out of band where buffering input audio is carried out receiving by a receive thread on VOIP audio data from an input audio stream in accordance with one VOIP data communications protocol RTP or H.323 for example and receiving notification of speech recognition is effected with another VOIP data communications protocol DMSP or SIP for example.

The method of also includes resuming the playing of the buffered input audio in response to receiving the notification of speech recognition playing only buffered input audio bearing time stamps later than the time stamp of the recognition notification. That is a media thread on for example discards buffered input audio rendered irrelevant by a barge in.

In view of the explanations set forth above in this paper readers will recognize that the benefits of providing VOIP barge in support for a half duplex DSR client on a full duplex network according to various embodiments of the present invention typically include an improved ability for a user to barge in on a voice dialog with a DSR system while reducing the risk that the user will be required to listen to prompts and responses rendered irrelevant by the barge in.

Exemplary embodiments of the present invention are described largely in the context of a fully functional computer system for providing VOIP barge in support for a half duplex DSR client on a full duplex network. Readers of skill in the art will recognize however that the present invention also may be embodied in a computer program product disposed on signal bearing media for use with any suitable data processing system. Such signal bearing media may be transmission media or recordable media for machine readable information including magnetic media optical media or other suitable media. Examples of recordable media include magnetic disks in hard drives or diskettes compact disks for optical drives magnetic tape and others as will occur to those of skill in the art. Examples of transmission media include telephone full duplex networks for voice communications and digital data communications full duplex networks such as for example Ethernets and full duplex networks that communicate with the Internet Protocol and the World Wide Web. Persons skilled in the art will immediately recognize that any computer system having suitable programming means will be capable of executing the steps of the method of the invention as embodied in a program product. Persons skilled in the art will recognize immediately that although some of the exemplary embodiments described in this specification are oriented to software installed and executing on computer hardware nevertheless alternative embodiments implemented as firmware or as hardware are well within the scope of the present invention.

It will be understood from the foregoing description that modifications and changes may be made in various embodiments of the present invention without departing from its true spirit. The descriptions in this specification are for purposes of illustration only and are not to be construed in a limiting sense. The scope of the present invention is limited only by the language of the following claims.

